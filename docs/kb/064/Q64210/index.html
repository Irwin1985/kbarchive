<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q64210: How to Simulate Bound Executables with BASIC 6.00 - 7.10 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q64210: How to Simulate Bound Executables with BASIC 6.00 - 7.10" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/064/Q64210/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/064/Q64210/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q64210: How to Simulate Bound Executables with BASIC 6.00 - 7.10","url":"http://jeffpar.github.io/kbarchive/kb/064/Q64210/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q64210-how-to-simulate-bound-executables-with-basic-600---710">Q64210: How to Simulate Bound Executables with BASIC 6.00 - 7.10</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q64210
Product(s): See article
Version(s): 6.00 6.00b 7.00 7.10 | 6.00 6.00b 7.00 7.10
Operating System(s): MS-DOS | OS/2
Keyword(s): ENDUSER | SR# S900724-5 | mspl13_basic
Last Modified: 27-JUL-1990

Although Microsoft BASIC Compiler versions 6.00 and 6.00b and
Microsoft BASIC Professional Development System (PDS) versions 7.00
and 7.10 for MS-DOS and MS OS/2 can create protected and real mode
programs, they cannot create bound programs. A bound program is one
that can run both in protected mode and real mode (DOS). However,
there is a way to simulate the functionality of a bound program by
creating a real mode version of the program and then linking the
protected mode version with a module-definition file containing the
STUB statement. The procedure for doing this is described below.

This information applies to Microsoft BASIC Compiler versions 6.00 and
6.00b for MS-DOS and MS OS/2 and Microsoft BASIC PDS versions 7.00 and
7.10 for MS-DOS and MS OS/2.

The STUB statement adds a DOS versions 3.x (real mode) executable file
to the beginning of the protected mode program being created by
LINK.EXE. The syntax of the STUB statement is the following:

   STUB 'filename'

Here, filename is the name of a real mode executable file. This real
mode stub is invoked whenever the program is executed under DOS 2.x or
DOS 3.x (or the DOS compatibility box of OS/2). By default, the linker
adds its own standard stub that terminates after displaying a message
similar to the following:

   This program cannot run in DOS mode.

You can use the STUB statement to replace this standard stub with a
real mode program that exactly emulates the behavior of a protected
mode version, thus simulating a bound executable.

The following is an example of the steps necessary to do this. This
example uses the following two BASIC source files:

   REALMODE.BAS
   ------------

   PRINT "This program has the same output in protected and real modes."

   PROTMODE.BAS
   ------------

   PRINT "This program has the same output in protected and real modes."

Here are the steps:

1. Create a real mode version of the program as you normally would.
   For our example, the following two commands accomplish this:

      bc /Lr realmode.bas;
      link realmode.obj;

2. Create a module-definition file containing the STUB statement. You
   can do this with any text editor. Make sure the file is saved as an
   ASCII text file. For our example, the module-definition file
   (PROTMODE.DEF) would look like this:

      STUB 'REALMODE.EXE'

3. Create the protected mode version of the program, linking with the
   module-definition file created in Step 2. Compile the program as
   you normally would, but when linking, include the name of the
   module-definition file in the fifth link parameter. The compile
   and link commands for our example would be as follows:

      bc /Lp protmode.bas;
      link protmode.obj,,,,protmode.def;

When PROTMODE.EXE is run from a protected mode session, the following
will be the output:

   This program has the same output in protected and real modes.

When PROTMODE.EXE is run from a DOS (real mode) session, REALMODE.EXE
will be executed instead of PROTMODE.EXE. Remember that REALMODE.EXE
is appended to the beginning of PROTMODE.EXE, so it is not necessary
to have a copy of REALMODE.EXE in the current directory. The output
will be the same as if PROTMODE were run from a protected mode
session:

   This program has the same output in protected and real modes.
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>