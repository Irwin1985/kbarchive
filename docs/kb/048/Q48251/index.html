<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q48251: Mixed-Language Examples for Calling Pascal Are Incorrect | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q48251: Mixed-Language Examples for Calling Pascal Are Incorrect" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/048/Q48251/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/048/Q48251/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q48251: Mixed-Language Examples for Calling Pascal Are Incorrect","url":"http://jeffpar.github.io/kbarchive/kb/048/Q48251/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q48251-mixed-language-examples-for-calling-pascal-are-incorrect">Q48251: Mixed-Language Examples for Calling Pascal Are Incorrect</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q48251
Product(s): See article
Version(s): 5.00 5.10 | 5.10
Operating System(s): MS-DOS | OS/2
Keyword(s): ENDUSER | docerr H_MASM S_PasCal | mspl13_c
Last Modified: 16-JAN-1990

In the "Microsoft Mixed-Language Programming Guide" provided with C
Versions 5.00 and 5.10, MASM Versions 5.00 and 5.10, and Pascal
Version 4.00, there is a sample Pascal module that is incorrect. This
module is called Pfun and it appears in three different sections of
the manual. Pfun can be found in the following locations:

1. Page 30, Section 2.5.2 "Calling Pascal from Basic -- Function Call"

2. Page 44, Section 3.5.2 "Calling Pascal from C -- Function Call"

3. Page 57, Section 4.5.2 "Calling Pascal from FORTRAN -- Function Call"

If the Pascal source code shown on these pages is compiled, the
following errors occur:

  21  7   begin
= 22  8     Fact := Fact * n;
      8  --------------^Warning 171 Insert (
      8  ----------------^268 Cannot Begin Expression  Skipped
      8  -------------------^Warning 155 ; Assumed ,
      8  -------------------^257 Parameter List Size Wrong Begin Ski

To get the code to compile correctly, all of the incorrect references
to Fact must be removed and replaced by a temporary variable. The
following source code contains the necessary changes to the Pfun
module so that it will compile and run without any errors:

module Pfun;
  function Fact (n : integer) : integer;

{Integer parameters received by value, the Pascal default. }

  var   temp : integer;

  begin
     temp := 1;
     while n &gt; 0 do
        begin
            temp := temp * n;
            n := n - 1;
        end;
     Fact := temp;
  end;
end.

Note: There is an incorrect reference to the errors in the Fact
function in the Pascal Version 4.00 README.DOC file. This correction
does not work.
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>