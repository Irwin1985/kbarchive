<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q48479: Correction for BASIC Calling POWER2, &quot;Mixed-Language&quot;: Page 81 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q48479: Correction for BASIC Calling POWER2, &quot;Mixed-Language&quot;: Page 81" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/048/Q48479/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/048/Q48479/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q48479: Correction for BASIC Calling POWER2, &quot;Mixed-Language&quot;: Page 81","url":"http://jeffpar.github.io/kbarchive/kb/048/Q48479/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q48479-correction-for-basic-calling-power2-mixed-language-page-81">Q48479: Correction for BASIC Calling POWER2, "Mixed-Language": Page 81</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q48479
Product(s): See article
Version(s): 4.00 4.00b 4.50
Operating System(s): MS-DOS
Keyword(s): ENDUSER | docerr B_BasicCom S_C H_MASM S_PasCal | mspl13_basic
Last Modified: 7-FEB-1990

The following correction applies to Page 81 of the "Microsoft
Mixed-Language Programming Guide," which is provided with C Versions
5.00 and 5.10, Macro Assembler Versions 5.00 and 5.10, and Pascal
Version 4.00 (but is NOT provided with QuickBASIC Version 4.00, 4.00b,
or 4.50, Microsoft BASIC Compiler Version 6.00 or 6.00b, or Microsoft
BASIC Professional Development System (PDS) Version 7.00).

On Page 81 of the "Microsoft Mixed-Language Programming Guide," the
BASIC program example is incomplete. The structure of the code as
shown incorrectly returns a value of 0 (zero) for the POWER2 assembler
function. This error occurs because POWER2(3,5) is interpreted by
BASIC to be an array as opposed to a FUNCTION as it was intended to
be.

To correct the program, add the following line after the DEFINT A-Z
statement:

   DECLARE FUNCTION Power2 (x, y)

The program in its entirety should read:

   DEFINT A-Z
   DECLARE FUNCTION Power2 (x, y)
   PRINT "3 times 2 to the power of 5 is ";
   PRINT Power2(3,5)
   END

This BASIC program can be compiled with Microsoft QuickBASIC Versions
4.00, 4.00b, and 4.50 for MS-DOS, Microsoft BASIC Compiler Versions
6.00 and 6.00b for MS-DOS and MS OS/2, or Microsoft BASIC PDS Version
7.00 for MS-DOS and MS OS/2.

The assembly language routine on Page 82 is correct and returns the
expected values when you add the above DECLARE in the BASIC code.
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>