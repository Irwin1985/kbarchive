<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q278154: How to Extract SMTP Addresses for Mailbox Recipients | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q278154: How to Extract SMTP Addresses for Mailbox Recipients" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/278/Q278154/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/278/Q278154/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q278154: How to Extract SMTP Addresses for Mailbox Recipients","url":"http://jeffpar.github.io/kbarchive/kb/278/Q278154/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q278154-how-to-extract-smtp-addresses-for-mailbox-recipients">Q278154: How to Extract SMTP Addresses for Mailbox Recipients</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q278154
Product(s): Microsoft Exchange
Version(s): 5.5
Operating System(s): 
Keyword(s): exc55
Last Modified: 24-NOV-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, version 5.5 
-------------------------------------------------------------------------------

SUMMARY
=======

This article describes how to extract Simple Mail Transfer Protocol (SMTP)
addresses for Mailbox Recipients [the "E-mail Address (Internet)" object] from
the Exchange Server directory's global address list and export them into a .csv
file. You can then use this file to import and create Custom Recipients in
another organization

MORE INFORMATION
================

NOTE: This procedure is successful if you have only one SMTP address for each
recipient. If you have more than one SMTP address for each recipient, you must
remove the additional addresses before you attempt the following steps. You can
remove the extra addresses from the E-mail addresses tab (located in Mailbox
properties). You can also remove the addresses after you export them to the .csv
file by modifying the column for this value.

To extract SMTP addresses, follow these steps:

1. Start the Exchange Administrator program.

2. Under Site Name, click the Recipients container.

3. On the View menu, click Mailboxes.

4. Make sure the Recipients container is still highlighted, and then on the View
  menu, click Columns.

5. Move the following columns to the "Show the following columns" section in the
  right pane:

   - E-mail Address (Internet) [this is your SMTP address]

   - Display Name

   - First Name

   - Last Name

   - Directory Name

6. Move any other unnecessary columns to the Available columns section in the
  left pane.

7. Click Apply, and then click OK.

8. Click one of the names in the Detail window in the right pane of the Exchange
  Administrator program.

9. On the Edit menu, click All.

10. On the File menu, click "Save Window Contents", and save the file as a Comma
  Delimited File (.csv).

11. Copy the new .csv file to the Exchange-based server in the target
  organization where you want to import the mailbox recipients as Custom
  Recipients.

You can use this SMTP information to create Custom Recipients in another Exchange
organization. To do this, follow these steps:

NOTE: This process must be done on a computer that has Excel installed so that
the data can be viewed and manipulated in spreadsheet format.

1. Start the Exchange Administrator program on a server in the organization in
  which you want to create Custom Recipients.

2. Click your site name, and then on the File menu, point to New, click Other,
  and then click Recipients Container.

3. Create a new Recipients container named "Other Organization Custom
  Recipients."

4. Open the .csv file using Excel. The following column headers are displayed:

   - E-mail Address (Internet)

   - Display Name

   - First Name

   - Last Name

   - Directory Name

5. Change the column header for "E-mail Address (Internet)" to "E-mail Address"
  (without the quotes).

6. Add an additional column and name it "Obj-Class," and configure the value to
  be "Remote" for all of the rows of recipients in your spreadsheet. The
  Obj-Class column should be the first column on the spreadsheet.

NOTE: Save this file as a .csv file.

7. In the Exchange Administrator program, on the Tools menu, click Directory,
  click Import, and then click Custom Recipients. The target .csv file contents
  are imported to the Custom Recipients container that you previously created.

NOTE: Make a backup copy of your target directory database before you import the
information.
If errors occur when you import the file, a file is created in the same directory
as the .csv file that you are creating. This file contains a list of any
recipients that failed to be imported due to errors. The file's extension is
.err and opens as a .csv file. For readability purposes, you can append this
file with a .csv extension and open it in spreadsheet format.

You can review the application event log on the server to find out why a
recipient was not imported. The events are designated as:

  TYPE: ERROR
  SOURCE: MSExchangeDSImp

The events provide information that you need to correct data on any recipient
address that was not imported.

If you need to run this procedure again in the future, either to update your
Custom Recipients container, or to accommodate changes for newly added or
inactive recipients, run the procedure again, but first delete the contents of
the Custom Recipients container before importing the directory.

For additional information, click the article number below to view the article in
the Microsoft Knowledge Base:

  Q155414 XADM: Bulk Import/Export FAQ

Additional query words: InterOrg Sync Tool GAL

======================================================================
Keywords          : exc55 
Technology        : kbExchangeSearch kbExchange550 kbZNotKeyword2
Version           : :5.5
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>