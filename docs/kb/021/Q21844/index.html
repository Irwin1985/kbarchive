<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q21844: Integer Overflow Handling in Compiler Differs from Interpreter | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q21844: Integer Overflow Handling in Compiler Differs from Interpreter" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/021/Q21844/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/021/Q21844/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q21844: Integer Overflow Handling in Compiler Differs from Interpreter","url":"http://jeffpar.github.io/kbarchive/kb/021/Q21844/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q21844-integer-overflow-handling-in-compiler-differs-from-interpreter">Q21844: Integer Overflow Handling in Compiler Differs from Interpreter</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q21844
Product(s): See article
Version(s): 1.00 1.01 1.02 2.00 2.01 3.00 4.00 4.00b 4.50
Operating System(s): MS-DOS
Keyword(s): ENDUSER | | mspl13_basic
Last Modified: 27-DEC-1989

Question:
   Why does the compiler give negative numbers or "Overflow" errors in
intermediate calculations involving two integers, when the same program
works correctly in the IBM BASICA and GW-BASIC Interpreters?
   The following program is an example of the problem:

   10 FOR I%=240 TO 300
   20 Z! = INT( 130 * I% )
   30 PRINT I%,Z!
   40 NEXT

   The above program will give incorrect negative results in
QuickBASIC Version 1.x when I% exceeds 252 and Z! exceeds 32K
(32,767).
   In QuickBASIC Versions 2.x and greater, you will get an "Overflow"
error.
   The same program will run in GW-BASIC and IBM BASICA completely
through to I%=300 and print the correct values for Z!.

Response:
   The above program will work properly if you make the integer
constant "130" into a single-precision constant ("130!" or "130.") or
double-precision constant "130#" as shown in the following example:

   20 Z! = INT( 130! * I% )

   QuickBASIC Version 1.x should not give negative results when an
integer overflow occurs. This problem was corrected in Version 2.x and
later, in which you properly get an "Overflow" message.
   The QuickBASIC compiler handles integer overflow differently than
the GW-BASIC and IBM BASICA Interpreters handle it.
   When the compiler compiles a mathematical expression, it has to
decide at compile time how to most efficiently optimize the expression
into machine language. When the compiler sees the intermediate
calculation 130*I% in the above program, it decides to restrict it to
integer limits at compile time because 130*I% is the product of two
integers. Changing the intermediate expression to the product of an
integer and a higher-precision constant or variable will prevent the
overflow problem.
   The interpreters are able to dynamically make the decision at
run time to convert 130*I% to a single-precision constant to avoid
integer overflow. The disadvantage of dynamic handling is the slower
speed of the interpreters when compared with the compiler.
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>