<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q192171: BUG: OLEDragDrop Fails on Contained Windowless Controls | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q192171: BUG: OLEDragDrop Fails on Contained Windowless Controls" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/192/Q192171/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/192/Q192171/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q192171: BUG: OLEDragDrop Fails on Contained Windowless Controls","url":"http://jeffpar.github.io/kbarchive/kb/192/Q192171/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q192171-bug-oledragdrop-fails-on-contained-windowless-controls">Q192171: BUG: OLEDragDrop Fails on Contained Windowless Controls</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q192171
Product(s): Microsoft Visual Basic for Windows
Version(s): WINDOWS:6.0
Operating System(s): 
Keyword(s): kbGrpDSVB
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Learning Edition for Windows, version 6.0 
- Microsoft Visual Basic Professional Edition for Windows, version 6.0 
- Microsoft Visual Basic Enterprise Edition for Windows, version 6.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

Setting the ControlContainer property of a User Control to True allows a
developer or end user to place a control on the User Control at the control's
run-time. If you place a Windowless control on the User Control when the User
Control is in run-time, the Windowless control's OLEDragDrop will fail. You will
be able to drag over the control but the mouse cursor will never change to let
you know that you can do a drop.

RESOLUTION
==========

Use a windowed control.

STATUS
======

Microsoft has confirmed this to be a bug in the Microsoft products listed at the
beginning of this article.

MORE INFORMATION
================

Setting the ControlContainer property to True allows you to develop a control
that can contain other controls in the same way the PictureBox control can
contain other controls. When a windowless control is the contained control on a
User Control, the no-drop cursor doesn't change and releasing the mouse over the
control has no effect when you are doing an OLEDragDrop.

Steps to Reproduce Behavior
---------------------------

1. Create a new Standard EXE project in Visual Basic. Form1 is created by
  default.

2. From the Project menu, select Components, check "Microsoft Windowless
  Controls 6.0," then click OK. If you don't have the Windowless controls
  Installed, please see the REFERENCES section for how to install them.

3. From the Project menu, select Add User Control.

4. Set the ControlContainer property to True and the BackColor of the User
  Control to some color you can see.

5. Place a TextBox and UserControl1 onto Form1.

6. Place a WLText control on the instance of UserControl1 that is on Form1.

7. Set the following properties for Text1:

  OLEDragMode = 1-Automatic OLEDropMode = 2-Automatic

8. Set the following properties for WLText1:

  OLEDragMode = 1-wlOLEDragAutomatic OLEDropMode = 2-wlOLEDropAutomatic

9. Save and run the project. Try highlighting the text in Text1, then dragging
  it over WLText1. You will see that the mouse drag cursor does not change to a
  drop cursor.

10. Stop the project and remove the WLText1 from UserControl1. Repeat step 4 but
  use a standard TextBox.

11. Set the following properties for Text2:

  OLEDragMode = 1-Automatic OLEDropMode = 2-Automatic

12. Repeat step 7 and you will be able to do a drag and drop to Text2.

REFERENCES
==========

For additional information, please see the following article in the Microsoft
Knowledge Base:

  Q189950 HOWTO: Install the Microsoft Windowless Controls for VB6

Additional query words: kbDSupport kbDSD kbVBp kbCtrl kbVBp600bug

======================================================================
Keywords          : kbGrpDSVB 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB600Search kbVBA600 kbVB600
Version           : WINDOWS:6.0
Issue type        : kbbug

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>