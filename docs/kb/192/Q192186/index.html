<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q192186: XADM: Troubleshooting Dr. Watson in Store.exe Because of IMC | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q192186: XADM: Troubleshooting Dr. Watson in Store.exe Because of IMC" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/192/Q192186/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/192/Q192186/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q192186: XADM: Troubleshooting Dr. Watson in Store.exe Because of IMC","url":"http://jeffpar.github.io/kbarchive/kb/192/Q192186/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q192186-xadm-troubleshooting-dr-watson-in-storeexe-because-of-imc">Q192186: XADM: Troubleshooting Dr. Watson in Store.exe Because of IMC</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q192186
Product(s): Microsoft Exchange
Version(s): 4.0,5.0,5.5
Operating System(s): 
Keyword(s): 
Last Modified: 05-MAR-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, versions 4.0, 5.0, 5.5 
-------------------------------------------------------------------------------

SUMMARY
=======

This article lists steps used to troubleshoot Dr. Watson errors in Store.exe,
caused by the Microsoft Exchange Server Internet Mail Service. The problem is
caused by a "bad" message coming into the MSExchangeIMS. The Exchange Server
information store will return a Dr. Watson error while trying to convert the
content of the "bad" message. The following events will usually be found in the
application event log:

  Event ID: 4116
  Source: MSExchangeIMC
  Description: An error was returned from the messaging software the
  Internet Mail Service uses to process messages on the Microsoft Exchange
  Server. It is possible that the piece of mail being processed at the
  time will not be delivered. The message that was being processed has
  been moved to the "BAD" folder. Use the appropriate utilities found in
  the SUPPORT directory of your Exchange CD to view and manipulate these
  messages.

  Event ID: 4117
  Source: MSExchangeIMC
  Description: An error was returned from the messaging software the
  Internet Mail Service uses to process messages on the Microsoft Exchange
  Server. As a result, the message in spool file XXXXXXXX failed to be
  delivered. The message has been moved to the Imcdata\In\Archive
  directory.

MORE INFORMATION
================

The following steps should be used to resolve the issue. If there is not a
current fix for the problem, the steps included will help you gather the
necessary data for a prompt resolution:

1. Make sure the proper symbols are loaded on the Exchange Server computer. For
  information about the steps needed to load Exchange Server symbols for Dr.
  Watson, please see the following article in the Microsoft Knowledge Base:

  Q150564 XADM: How to load Exchange Symbols for DR. Watson

2. Set Diagnostics Logging of MSExchangeIMC\Message Archival to Maximum. This
  can be set from the Diagnostics Logging tab on the server's Properties page.

3. Gather information leading up to the reproduction of the error. For example,
  starting the MSExchangeIMC service may result in the Dr. Watson error with
  Store.exe.

  NOTE: This may take time if a particular type of message causes the crash.

4. After reproducing the Dr. Watson in Store.exe, open the Drwtsn32.log file
  using Notepad. Find the function name where the fault occurred. The easiest
  way to do this is by scrolling to the bottom of the Drwtsn32.log file and
  searching "up" for the word 'Fault.' This will place you in the dump of the
  last Dr. Watson error encountered. Make a note of the function name, and
  search the Knowledge Base for related Dr. Watson erroring in that function.

5. Depending on the cause of the problem, the following events may or may not
  appear in the application event log:

     Event ID: 4116
     Source: MSExchangeIMC
     Description: An error was returned from the messaging software the
     Internet Mail Service uses to process messages on the Microsoft
     Exchange Server. It is possible that the piece of mail being
     processed at the time will not be delivered. The message that was
     being processed has been moved to the "BAD" folder. Use the
     appropriate utilities found in the SUPPORT directory of your Exchange
     CD to view and manipulate these messages.

     Event ID: 4117
     Source: MSExchangeIMC
     Description: An error was returned from the messaging software the
     Internet Mail Service uses to process messages on the Microsoft
     Exchange Server. As a result, the message in spool file XXXXXXXX
     failed to be delivered. The message has been moved to the
     Imcdata\In\Archive directory.


  If these events appear, search the \Exchsrvr\Imcdata\In\Archive folder for the
  spool file mentioned above (for example, XXXXXXXX). This is, most likely, the
  "bad" message that caused the information store to crash.


6. If a resolution still has not been reached, a case should be opened with the
  Exchange Server support group. The following information will need to be
  gathered. This information should be zipped up and sent to Microsoft using
  FTP, or any other form of file transfer:

   - User.dmp

   - Drwtsn32.log

   - Application event log

   - &lt;bad message&gt; from \Exchsrvr\Imcdata\In\Archive folder




Additional query words: DrWatson Dr-Watson debug store.dbg

======================================================================
Keywords          :  
Technology        : kbExchangeSearch kbExchange500 kbExchange550 kbExchange400 kbZNotKeyword2
Version           : :4.0,5.0,5.5
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>