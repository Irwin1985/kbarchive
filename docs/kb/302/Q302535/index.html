<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q302535: SMS: Problems with Smsapm32.exe with No Distribution Points | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q302535: SMS: Problems with Smsapm32.exe with No Distribution Points" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/302/Q302535/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/302/Q302535/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q302535: SMS: Problems with Smsapm32.exe with No Distribution Points","url":"http://jeffpar.github.io/kbarchive/kb/302/Q302535/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q302535-sms-problems-with-smsapm32exe-with-no-distribution-points">Q302535: SMS: Problems with Smsapm32.exe with No Distribution Points</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q302535
Product(s): Microsoft Systems Management Server
Version(s): 2.0,2.0 SP1,2.0 SP2,2.0 SP3
Operating System(s): 
Keyword(s): kbenv kbtool kbsms200 kbsms200bug kbAdvertisement kbSoftwareDist kbsms200preSP4fix
Last Modified: 09-MAY-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server versions 2.0, 2.0 SP1, 2.0 SP2, 2.0 SP3 
-------------------------------------------------------------------------------

SYMPTOMS
========

When a program has a mandatory advertisement, but is not mandatory over slow
links, APM reschedules the program to run at the next run time, which is right
away. This results in Smsapm32.exe repeatedly trying to run the advertised
program. During this time, the Smsapm32.log file rolls over very quickly, and
the Smsapm32.exe process generates a large amount of processor utilization. As
soon as a valid distribution point is found, the program runs.

RESOLUTION
==========

To resolve this problem, obtain the latest service pack for Systems Management
Server version 2.0. For additional information, please see the following article
in the Microsoft Knowledge Base:

  Q288239 SMS: How to Obtain the Latest Systems Management Server 2.0 Service
  Pack



STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products that are
listed at the beginning of this article. This problem was first corrected in
Systems Management Server 2.0 Service Pack 4.

MORE INFORMATION
================

A variety of network conditions and errors can generate the symptoms that are
related to this problem. However, defining user connection limits on the
distribution point shares (SMSPKGx$) also generates the symptoms.

The following entries from the Smsapm32.log file show some of the Smsapm32.exe
behavior that is associated with this problem:

SCHEDULER   : Return code = 0x80070043; The network name cannot be 
found.~~; ERROR: the path is not accessible.  
SCHEDULER   : The Distribution Point path was not added to the program 
location list.~  
SCHEDULER   : Completed enumeration.~ 
SCHEDULER   : Successfully populated the program location list with 0 
distribution points from a total available number of 1.~  
SCHED DATA  : Failed to set up program.  Program location list is not 
populated.~
SCHED DATA  : Access to all distribution points is through slow links.~
SCHED DATA  : Handling an error condition (0xe0040013) for program Manual 
Test in package Test Application.~ 
SCHED DATA  : Beginning with a job run status set to 
APA_RUNSTATUS_NOT_RUNNING.~ 
SCHED DATA  : The error requires that some type of reschedule action be 
taken.~ 
SCHED DATA  : Attempting to get action for failure condition 0xe0040013.~
SCHEDULER   : The monitor has indicated that a countdown dialog is 
required before executing a scheduled program.~ 
SCHED DATA  : This job does  require a countdown dialog.~  
SCHED DATA  : The network is too slow.  Use the next schedule time.~  
SCHED DATA  : Returning action code 4.~

The preceding log entries suggest that the network was "too slow". However, this
is the log entry that occurs when the advertisement property Assignments are not
mandatory over slow links is enabled and no distribution points are found.

A hotfix does exist for this problem. However, Microsoft recommends that you
apply the hotfix that is described in the following Microsoft Knowledge Base
article:

  Q302674 Advertisement Doesn't Run After Distribution Point Is Unavailable

This is a closely-related problem, and the hotfix that is described in that
article also contains the fix for the problem that is described in this article.

Additional query words: prodsms

======================================================================
Keywords          : kbenv kbtool kbsms200 kbsms200bug kbAdvertisement kbSoftwareDist kbsms200preSP4fix 
Technology        : kbSMSSearch kbSMS200 kbSMS200SP1 kbSMS200SP2 kbSMS200SP3
Version           : :2.0,2.0 SP1,2.0 SP2,2.0 SP3
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>