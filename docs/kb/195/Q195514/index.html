<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q195514: FIX: Error Loading File When Converting a 2.6 Form in VFP 6.0 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q195514: FIX: Error Loading File When Converting a 2.6 Form in VFP 6.0" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/195/Q195514/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/195/Q195514/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q195514: FIX: Error Loading File When Converting a 2.6 Form in VFP 6.0","url":"http://jeffpar.github.io/kbarchive/kb/195/Q195514/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q195514-fix-error-loading-file-when-converting-a-26-form-in-vfp-60">Q195514: FIX: Error Loading File When Converting a 2.6 Form in VFP 6.0</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q195514
Product(s): Microsoft FoxPro
Version(s): WINDOWS:6.0
Operating System(s): 
Keyword(s): kberrmsg kbContainer kbCtrl kbMiscTools kbvfp600 kbvfp600bug kbVS600sp3fix
Last Modified: 14-OCT-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, version 6.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you open a converted 2.6 form in Visual FoxPro 6.0, the following error
message appears if the converted 2.6 form has a radio button control or a line
object:

  Error Loading File - record number&lt;n&gt;...ColorSource: Expression
  evaluated to an illegal value.

CAUSE
=====

The value three (3) is assigned to ColorSource for both the option group control
and the line object during the conversion. A ColorSource property of three is
invalid for both of the controls in Visual FoxPro 6.0.

Invisible buttons have this problem, too.

Shape objects might also have this problem.

RESOLUTION
==========

There are at least three methods for resolving this problem. They are listed
below.

NOTE: Before attempting any of these resolutions, back up your files.

Method 1
--------

1. Open up the form file (.scx) as a table.

2. Go to the Properties column of the offending record, and change the
  ColorSource value from three to four.

  For further information, refer to step 4 in the following Steps to Reproduce
  Behavior section.

Method 2
--------

This method works for Invisible Buttons as well as Option Groups.

Modify the Convert.app as follows:

NOTE: The source code for Convert.app is located in the ..\VFP98\Tools\Convert
folder.

1. Open the Convert.pjx and click the Other Files tab.

2. Under Text Files, open the convert file. This is a header file (.h) that
  defines constants used in the Convert.app.

3. Search for I_DEFCOLORSOURCE. Your search should find the following line:

        #DEFINE I_DEFCOLORSOURCE   3&amp;&amp; default color source

4. Change the 3 to a 4, and save and close the file.

5. Rebuild the Convert.app from the Project Manager.

6. Copy the new Convert.app to the ..\VFP98 folder. Be sure to verify that the
  _converter system memory variable points to the correct file. You can also
  check this in the Options dialog box by clicking the File Locations tab and
  looking at the path listed under Converter.

Method 3
--------

Use the Visual FoxPro Transformer application.

NOTE: This is probably the best solution because other aspects of converted forms
can be changed with the Transformer, many forms at one time. The Transfrm.app is
located in the ..\VFP98\Tools\Transfrm folder.

Note that as the Help file states:

  "The Transformer is not supported by Microsoft Support Services either
  electronically or via telephone."

To learn more about the Transformer, go to the Transformer topic in Visual FoxPro
Help. "Help Transformer," without quotes, typed in the Command window should
bring it up.

To use the Transformer to resolve the problem described in this article, follow
these steps after doing a Functional conversion on the form(s):

1. Run the Transfrm.app. It might be easier to copy it to the VFP98 directory
  first and use DO HOME()+"transfrm.app" to start it.

2. On the Files tab, add your .scx file or the directory that contains the .scx
  files that need transformed.

3. In the Rules tab, fill in the following:

  Property: colorsource
  Value: 4
  Files: *.scx
  Classes: OptionGroup

4. Click Add to add this rule. Do the same for Invisible Buttons and Line and
  Shape objects if the converted forms contain them.

5. To save these rules for use at a later time, click the save button and type a
  table name.

6. On the Log tab, deselect the Create Log Only check box and click Transform.

7. The converted form(s) should now open without errors.

STATUS
======

Microsoft has confirmed this to be a bug in the Microsoft products listed at the
beginning of this article.

This bug was corrected in Visual Studio 6.0 Service Pack 3 for Options Groups.

This problem was not corrected for Invisible Buttons.

For more information about Visual Studio service packs, please see the following
articles in the Microsoft Knowledge Base:

Q194022 INFO: Visual Studio 6.0 Service Packs, What, Where, Why

Q194295 HOWTO: Tell That Visual Studio 6.0 Service Packs Are Installed

MORE INFORMATION
================

Steps to Reproduce Behavior
---------------------------

1. In FoxPro for Window 2.6, create a screen, place a radio button on the
  screen, and save the screen.

2. Open the 2.6 screen in Visual FoxPro 6.0. When Visual FoxPro prompts you for
  a conversion, select functional conversion.

3. After conversion, the following error message appears:

  Error loading file - record number 5. opgOpt1 &lt;or one of its
  members&gt;.ColorSource: Expression evaluated to an illegal value.

4. To open the form in Visual FoxPro 6.0, open the .scx as a table with the USE
  command, for example:

  USE myscreen.scx.

5. In the command window, perform a BROWSE, go to the Properties column of the
  offended record (as described in the error message), and double- click to
  open the memo window.

6. Change the ColorSource value from 3 to 4.

7. Save the changes, and close the table.

8. Open the form in Visual FoxPro 6.0.

Additional query words:

======================================================================
Keywords          : kberrmsg kbContainer kbCtrl kbMiscTools kbvfp600 kbvfp600bug kbVS600sp3fix 
Technology        : kbVFPsearch kbAudDeveloper kbVFP600
Version           : WINDOWS:6.0
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>