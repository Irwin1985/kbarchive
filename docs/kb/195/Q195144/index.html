<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q195144: Copying Files with Mix of LFN and SFN May Lead to Data Loss | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q195144: Copying Files with Mix of LFN and SFN May Lead to Data Loss" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/195/Q195144/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/195/Q195144/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q195144: Copying Files with Mix of LFN and SFN May Lead to Data Loss","url":"http://jeffpar.github.io/kbarchive/kb/195/Q195144/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q195144-copying-files-with-mix-of-lfn-and-sfn-may-lead-to-data-loss">Q195144: Copying Files with Mix of LFN and SFN May Lead to Data Loss</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q195144
Product(s): Microsoft Windows NT
Version(s): 2000,4.0
Operating System(s): 
Keyword(s): kbWinNT400sp5fix kbshell kbWin2000sp3fix
Last Modified: 15-AUG-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows NT Workstation version 4.0 
- Microsoft Windows NT Server version 4.0 
- Microsoft Windows NT Server, Enterprise Edition version 4.0 
- Microsoft Windows 2000 Server 
- Microsoft Windows 95 
-------------------------------------------------------------------------------

SYMPTOMS
========

When files are copied from a source having a mixture of short filenames and long
filenames, the copy operation may lead to lost files.

This problem can happen when the copy operation is performed using any of the
following programs:

- COPY

- XCOPY

- Windows NT Explorer

- Windows NT Backup

CAUSE
=====

This problem happens when a file with a long filename is copied and a new short
filename is generated for the file in the destination folder. If a file exists
in the source folder and it has a name matching the newly generated short
filename, this file will replace the first file and the content of the first
file is lost. For example:

  Source Directory :

  C:\source&gt; dir /x

  08/21/98  02:03p        &lt;DIR&gt;                          .
  08/21/98  02:03p        &lt;DIR&gt;                          ..
  08/20/98  02:32p                     17                YXXXXX~1.XXX
  08/20/98  02:32p                     7 YXXXXX~2.XXX    yxxxxxxxxx.xxx
    4 File(s)              14 bytes

  C:\source&gt; copy *.* c:\dest
  yxxxxxxxxx.xxx
  YXXXXX~1.XXX
       2 file(s) copied.

  C:\source&gt; dir c:\dest

  09/15/98  09:27a        &lt;DIR&gt;                          .
  09/15/98  09:27a        &lt;DIR&gt;                          ..
  08/20/98  02:32p                     17 YXXXXX~1.XXX   yxxxxxxxxx.xxx
    3 File(s)             17 bytes

NOTE: The File yxxxxxxxxx.xxx gets copied first and the short filename generated
for that is YXXXXX~1.XXX. When the copy program copies YXXXXX~1.XXX to the
destination, it finds a match in file name and replaces the existing file with
its contents.

In NTBackup, if both the short named file, and the NTFS converted long file names
are the same, you are prompted whether to replace the existing file or not.
Overwriting the file may result in data loss as the file names will be the same
but the contents will not be.


RESOLUTION
==========

Windows NT 4.0 with Internet Explorer 4
---------------------------------------

To resolve this problem, obtain the latest service pack for Windows NT 4.0 or the
individual software update. For information on obtaining the latest service
pack, please go to:

- http://www.microsoft.com/windows/servicepacks/

-or-

- Q152734 How to Obtain the Latest Windows NT 4.0 Service Pack

For information on obtaining the individual software update, contact Microsoft
Product Support Services. For a complete list of Microsoft Product Support
Services phone numbers and information on support costs, please go to the
following address on the World Wide Web:

  http://support.microsoft.com/default.aspx?scid=fh;EN-US;CNTACTMS


Windows NT 4.0 without Internet Explorer 4
------------------------------------------

To resolve this problem, obtain the latest service pack for Windows NT 4.0 or the
individual software update. For information on obtaining the latest service
pack, please go to:

- http://www.microsoft.com/windows/servicepacks/

-or-

- Q152734 How to Obtain the Latest Windows NT 4.0 Service Pack

For information on obtaining the individual software update, contact Microsoft
Product Support Services. For a complete list of Microsoft Product Support
Services phone numbers and information on support costs, please go to the
following address on the World Wide Web:

  http://support.microsoft.com/default.aspx?scid=fh;EN-US;CNTACTMS


Windows 2000 with Internet Explorer
-----------------------------------

To resolve this problem, obtain the latest service pack for Windows 2000. For
additional information, click the following article number to view the article
in the Microsoft Knowledge Base:

  Q260910 How to Obtain the Latest Windows 2000 Service Pack

The English version of this fix should have the following file attributes or
later:

  Date      Time      Version         Size        File name
-------------------------------------------------------------
5/11/2001   10:51a   5.0.3315.1000   2,337,552    Shell32.dll


Windows 95 with Internet Explorer 4.0
-------------------------------------

A supported fix is now available from Microsoft, but it is only intended to
correct the problem that is described in this article. Apply it only to
computers that are experiencing this specific problem.

To resolve this problem, contact Microsoft Product Support Services to obtain the
fix. For a complete list of Microsoft Product Support Services phone numbers and
information about support costs, visit the following Microsoft Web site:

  http://support.microsoft.com/default.aspx?scid=fh;EN-US;CNTACTMS

NOTE: In special cases, charges that are ordinarily incurred for support calls
may be canceled if a Microsoft Support Professional determines that a specific
update will resolve your problem. The usual support costs will apply to
additional support questions and issues that do not qualify for the specific
update in question.

The English version of this fix should have the following file attributes or
later:

  Date      Time     Size       File name      Platform
  -------------------------------------------------------------
  03/02/99  06:40p  1,431,264   Shell32.dll   (Windows 95)



NOTE: The fixes mentioned above only fixes Windows NT Explorer initiated copies.
The COPY/XCOPY behaviour is unchanged by design.

WORKAROUND
==========

You can work around this problem by using the Windows NT Resource Kit utility,
Robocopy, to copy the files.

Windows NT Backup
-----------------

If the short file named files (for example, Drawg~12.dwg) are created by legacy
applications and these applications cannot be upgraded, the following methods
can be employed:

- Use the FAT formatted partitions on Windows NT Servers for compatibility with
  these applications and use share-level security.

The following are less optimum workarounds but are mentioned here for
convenience.

- Disable the auto-generation of the short file names on NTFS volumes as per
  the following article in the Microsoft Knowledge Base:

  Q210638 How to Disable Automatic Short File Name Generation

- Use different directories for long and short named files.


STATUS
======

Windows NT
----------

Microsoft has confirmed that this is a problem in the Microsoft products that are
listed at the beginning of this article. This problem was first corrected in
Windows NT 4.0 Service Pack 5.

Windows 2000
------------

Microsoft has confirmed that this is a problem in the Microsoft products that are
listed at the beginning of this article. This problem was first corrected in
Windows 2000 Service Pack 3.

Additional query words: kbShell 4.00

======================================================================
Keywords          : kbWinNT400sp5fix kbshell kbWin2000sp3fix 
Technology        : kbWinNTsearch kbWinNTWsearch kbWinNTW400 kbWinNTW400search kbWinNT400search kbwin2000Serv kbWinNTSsearch kbWinNTSEntSearch kbWinNTSEnt400 kbWinNTS400search kbWinNTS400 kbwin2000ServSearch kbwin2000Search kbWin95search kbZNotKeyword3
Version           : :2000,4.0
Hardware          : ALPHA x86
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>