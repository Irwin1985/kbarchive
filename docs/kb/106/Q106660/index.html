<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q106660: RUN /N Not Working Correctly with MS-DOS Batch File | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q106660: RUN /N Not Working Correctly with MS-DOS Batch File" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/106/Q106660/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/106/Q106660/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q106660: RUN /N Not Working Correctly with MS-DOS Batch File","url":"http://jeffpar.github.io/kbarchive/kb/106/Q106660/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q106660-run-n-not-working-correctly-with-ms-dos-batch-file">Q106660: RUN /N Not Working Correctly with MS-DOS Batch File</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q106660
Product(s): Microsoft FoxPro
Version(s): 2.50 2.50a 2.50b 3.00
Operating System(s): 
Keyword(s): 
Last Modified: 25-AUG-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, version 3.0 
- Microsoft FoxPro for Windows, versions 2.5, 2.5a, 2.5b 
-------------------------------------------------------------------------------

SUMMARY
=======

In FoxPro for Windows versions 2.5, 2.5a, and 2.5b, the order in which lines of
code are executed within a program file may seem to be altered when you are
using the RUN command with a /N parameter to execute an MS-DOS executable or
batch file. The /N parameter stands for NOWAIT and allows program execution to
continue before the command is completed. This makes it seem as if the MS-DOS
batch file is not being executed until after the other commands.

MORE INFORMATION
================

In FoxPro for Windows, the /N parameter is used for calling Windows-based
applications with the RUN command. The /N parameter of the RUN command has an
optional numeric value that can be included immediately after it to specify how
the Windows-based application is opened. The possible settings include /N1, /N2,
/N3, /N4, and /N7.

These parameters are not intended for use with MS-DOS executables or batch files.
If any of these parameters are used to call an MS-DOS executable or batch file,
Windows will execute the file in the background and FoxPro will remain the
active application.

Steps to Reproduce the Behavior
-------------------------------

1. In FoxPro for Windows, from the File menu, choose New.

2. Select File, and then choose the New button.

3. In the text editing window, type "DIR" (without the quotation marks).

4. From the File menu, choose Save, and use RUNTEST.BAT as the filename. Choose
  the Save button.

5. From the File menu, choose New.

6. Select Program, and then choose the New button.

7. Enter the following two lines of code in the program window:

        RUN /N4 runtest.bat
        WAIT WINDOW "This is a test"

8. From the File menu, choose Save, and use ATEST.PRG as the program name.
  Choose the Save button.

9. Run the program you just created, by issuing the following command in the
  Command window:

        DO atest

The WAIT WINDOW message will appear on the screen before FoxPro shells to MS-DOS
to execute the RUN command. This is because the batch file is running in the
background, while FoxPro continues to execute the program code. This makes it
seem like the WAIT WINDOW command is executed before the batch file, when
actually both commands are being executed simultaneously under the multitasking
environment.

To correct this situation, remove the /N parameter from the RUN command. For
example:

     RUN runtest.bat

This allows FoxPro to execute the RUN command first and then execute the
following code after returning from the RUN command.

REFERENCES
==========

"Language Reference," L3-840

Additional query words: VFoxWin FoxWin 2.50 2.5a 2.5b

======================================================================
Keywords          :  
Technology        : kbVFPsearch kbAudDeveloper kbFoxproSearch kbFoxPro250 kbFoxPro250a kbFoxPro250b kbVFP300
Version           : 2.50 2.50a 2.50b 3.00

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>