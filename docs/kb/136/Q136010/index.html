<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q136010: How to Use a Custom Method as a User-Defined Function (UDF) | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q136010: How to Use a Custom Method as a User-Defined Function (UDF)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/136/Q136010/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/136/Q136010/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q136010: How to Use a Custom Method as a User-Defined Function (UDF)","url":"http://jeffpar.github.io/kbarchive/kb/136/Q136010/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q136010-how-to-use-a-custom-method-as-a-user-defined-function-udf">Q136010: How to Use a Custom Method as a User-Defined Function (UDF)</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q136010
Product(s): Microsoft FoxPro
Version(s): WINDOWS:3.0
Operating System(s): 
Keyword(s): 
Last Modified: 15-FEB-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, version 3.0 
-------------------------------------------------------------------------------

SUMMARY
=======

This article gives details about how to create and use custom methods.

In FoxPro version 2.x, you can define procedures and functions in the cleanup
code of FoxPro version 2.x screens. Forms in Visual FoxPro don't have an
analogous place for defining procedures and functions, so you can:

- Put cleanup code in a procedure file contained in the Project Manager, and
  issue a SET PROCEDURE TO statement.

-or-

- Create functions and procedures as custom methods of the form. These custom
  methods can then be referenced the same as any other method of the form or
  other object.

MORE INFORMATION
================

Custom methods can be coded to behave as functions behave; that is, they can
return a value simply by ending the code definition with RETURN x where x is the
name of a variable whose value is set in the method.

Custom methods should not begin with the PROCEDURE or FUNCTION command, which is
normally used to indicate that a procedure or function is being defined, nor
should they end with ENDPROC or ENDFUNC.

Step-by-Step Example
--------------------

1. Create a new form, and add two text boxes (Text1 and Text2) and two command
  buttons (Command1 and Command2).

2. Add the Customer and Orders tables from the Testdata database to the data
  environment of the form.

3. Set the ControlSource for the Text1 box to:

     customer.cust_id

4. Set the ReadOnly property for the Text1 box to True (.T.).

5. Leave the ControlSource property for the Text2 box blank.

6. On the Form menu, click New Method. Enter Custcount as the name of the new
  method.

7. Change the caption of the Command1 button to "Count orders," and enter the
  following code in the Click event procedure:

     nNum = thisform.custcount()
     thisform.text2.value = nNum
     thisform.refresh

8. Change the caption of the Command2 button to Skip, and enter the following
  code in the Click event procedure:

     skip
     thisform.refresh

9. Enter the following code for the Custcount custom method:

     x = 0
     select orders
     go top
     count to x for orders.cust_id = thisform.text1.value
     select customer
     return x

When you click the Count orders button, the Custcount custom method is called to
count how many orders exist in the Orders table for the current record in the
Customer table. This number is returned to the Count orders button.

Additional query words: VFoxWin

======================================================================
Keywords          :  
Technology        : kbVFPsearch kbAudDeveloper kbVFP300
Version           : WINDOWS:3.0

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>