<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q136529: BUG: MDI Child Form Is Drawn Without Title in Certain Cases | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q136529: BUG: MDI Child Form Is Drawn Without Title in Certain Cases" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/136/Q136529/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/136/Q136529/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q136529: BUG: MDI Child Form Is Drawn Without Title in Certain Cases","url":"http://jeffpar.github.io/kbarchive/kb/136/Q136529/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q136529-bug-mdi-child-form-is-drawn-without-title-in-certain-cases">Q136529: BUG: MDI Child Form Is Drawn Without Title in Certain Cases</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q136529
Product(s): Microsoft Visual Basic for Windows
Version(s): 3.0,4.0
Operating System(s): 
Keyword(s): 
Last Modified: 15-MAY-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Enterprise Edition, 16-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition for Windows, version 3.0 
- Microsoft Visual Basic Standard Edition for Windows, version 3.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

An MDI child form is drawn incorrectly at first when it is maximized in the Load
event procedure of the MDI parent form by setting the child form's Windowstate
property when the child form's height and width dimensions match those of the
parent form. When drawn, the child form is missing the Title bar, Control box,
and Restore button.

WORKAROUND
==========

If the MDI parent form is resized, the child form is drawn correctly with its
Title bar, Control box, and Restore button.

The form is also drawn correctly if the height and width of the child form is set
to the ScaleHeight and the ScaleWidth of the MDI parent instead of numerical
values. For example, the following code sizes the child to the same dimensions
as the MDI parent form, and then maximizes the form:

     MDIForm1.Width = 6000
     MDIForm1.Height = 3000
     Form1.Width = MDIForm1.ScaleWidth
     Form1.Height = MDIForm1.ScaleHeight
     Form1.WindowState = 2   'Maximize the child window

Replace the code in step 4 of the "Steps to Reproduce Problem" section of this
article with this code to see that the child form is painted correctly when the
example is run.

STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products listed at
the beginning of this article. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.

MORE INFORMATION
================

Steps to Reproduce Problem
--------------------------

1. On the File menu, click New Project. Form1 is created by default.

2. Add a MDI parent form. In version 4.0, click MDI Form on the Insert menu. In
  version 3.0, click New MDI Form on the File menu.

3. Set the MDIChild property of Form1 to True.

4. In the Load event of an MDI parent form, place this code:

     MDIForm1.Width = 6000
     MDIForm1.Height = 3000
     Form1.Width = 6000
     Form1.Height = 3000
     Form1.WindowState = 2   'Maximize the child window

5. Run the code by pressing the F5 key.

Observe that the child form has been incorrectly painted. Refreshing the child
form after it is maximized does not result in the child form being correctly
painted.

Additional query words: 3.00 4.00 buglist3.00 buglist4.00 vb4win vb4all

======================================================================
Keywords          :  
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB400Search kbVB300Search kbVB400 kbVB300 kbVB16bitSearch
Version           : :3.0,4.0
Issue type        : kbbug

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>