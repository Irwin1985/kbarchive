<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q267932: Secure Communication Shows Key Manager Button, But No Edit | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q267932: Secure Communication Shows Key Manager Button, But No Edit" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/267/Q267932/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/267/Q267932/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q267932: Secure Communication Shows Key Manager Button, But No Edit","url":"http://jeffpar.github.io/kbarchive/kb/267/Q267932/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q267932-secure-communication-shows-key-manager-button-but-no-edit">Q267932: Secure Communication Shows Key Manager Button, But No Edit</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q267932
Product(s): Internet Information Server
Version(s): 4.0
Operating System(s): 
Keyword(s): 
Last Modified: 13-MAY-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Server version 4.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you attempt to secure a Web site, the Edit button is not available and only
a Key Manager button appears. This does not allow you the option to select
Require Secure Channel when accessing this resource (for example, adding or
removing secure communication(s) to a site or virtual directory).


CAUSE
=====

The Web server requires that at least one key is installed in order to make
modifications to SSL settings. If a Web site is set to use SSL and the only key
in Key Manager under WWW is deleted, then the Edit button is removed and
replaced with a Key Manager button.

This problem generally occurs when an attempt to use SSL has failed. When the
steps are reversed that were followed to secure a site or virtual directory,
this problem is duplicated. Prior to removing any Key from Key Manager, the site
must have the Requires Secure Channel when accessing this resource check box
cleared and must also have the Encryption Settings Require 128-bit encryption
check box cleared. If no key exists, then all Web sites that are set to use SSL
are unreachable and receive a "403 Forbidden" error message.

RESOLUTION
==========

To resolve this issue, follow these steps:

1. Click Start, click Run, type "Cmd" (without the quotation marks), and then
  click OK.

2. Type "cd \" (without the quotation marks), and then press ENTER.

3. Type "cd winnt\system32\inetsrv\adminsamples" (without the quotation marks),
  and then press ENTER.

4. Type "cscript adsutil.vbs set w3svc/1/root/accessssl false" (without the
  quotation marks), and then press ENTER.

NOTE: Step 4 assumes that SSL was being Required on the Default Web Site and not
at a virtual directory level. If a Virtual Directory or file required it only,
then the command would look like the following:

  "cscript adsutil.vbs set w3svc/x/root/y/z false" (without the quotation
  marks)

where x is the Site Number (1,2,3,etc.), y is the VirtualDirName (if exists), and
z is the FileName (if exists).


WORKAROUND
==========

A key request must be generated in order to have the option of editing SSL
Settings. The steps to correct this problem are as follows:

1. In Key Manager, right-click WWW, and then select Create New Key.

2. Choose the option to save to a text file, and then give the file a name.

3. Type in the answers to the questions regarding Organization, Organizational
  Unit, Common Name, City, State, and Country.

4. After the key request is created, close Key Manager, and Committ All Changes.

5. Close the MMC, and then re-open the Internet Service Manager.

6. Right-click the site or virtual directory that you want to secure or
  unsecure, and then click Properties.

7. Click the Directory Security tab to see an Edit button.

8. Return to any Web site where the "403 Forbidden" error message is being
  displayed, select Directory Security, select Secure Communications, and then
  click Edit.

9. Click to uncheck the Requires Secure Channel when accessing this resource
  check box, and make sure that the Require 128-bit encryption check box under
  the Encryption Settings is not selected (checked).

NOTE: For secure communications (SSL) to work correctly, a key request must be
completed and the key successfully installed. For additional information on
completing the key request and correctly setting up SSL, click the article
number below to view the article in the Microsoft Knowledge Base:

  Q171084 How to Install a Certificate

You can also open Key Manager by clicking the Start menu, clicking Run, and
typing "Keyring" (without the quotation marks).

MORE INFORMATION
================

This problem does not occur when you use IIS 5.0 in Windows 2000. In IIS 5.0,
the functions of the Key Manager have been ported to the Certificate Server. To
secure a Web site in IIS 5.0, a Server Certificate must be installed and
validated. If this is not the case, then the Edit button is not available
(grayed) and all SSL Settings are removed.


Additional query words:

======================================================================
Keywords          :  
Technology        : kbiisSearch kbiis400
Version           : :4.0
Issue type        : kbprb
Solution Type     : kbpending

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>