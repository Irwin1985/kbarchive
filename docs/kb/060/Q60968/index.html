<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q60968: QBX.EXE 7.10 Expanded Memory Usage Better Than 7.00; 32K Table | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q60968: QBX.EXE 7.10 Expanded Memory Usage Better Than 7.00; 32K Table" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/060/Q60968/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/060/Q60968/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q60968: QBX.EXE 7.10 Expanded Memory Usage Better Than 7.00; 32K Table","url":"http://jeffpar.github.io/kbarchive/kb/060/Q60968/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q60968-qbxexe-710-expanded-memory-usage-better-than-700-32k-table">Q60968: QBX.EXE 7.10 Expanded Memory Usage Better Than 7.00; 32K Table</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q60968
Product(s): See article
Version(s): 7.00 7.10
Operating System(s): MS-DOS
Keyword(s): ENDUSER | SR# S900228-5 | mspl13_basic
Last Modified: 10-AUG-1990

The QuickBASIC Extended environment (QBX.EXE) can use up to 16 MB
(megabytes) of Lotus-Intel-Microsoft (LIM) 4.0 expanded memory
under MS-DOS. If the expanded memory is available, QBX.EXE
automatically stores in it SUBs, FUNCTIONs, and module-level code
units that are no greater than 16K in size. If QBX.EXE is invoked with
the /Ea switch, arrays that are no greater than 16K in size are also
stored in expanded memory.

In QBX.EXE in BASIC PDS version 7.00, the memory is allocated in 16K
pages; for example, a 2K procedure consumes 16K and wastes 14K (16K
minus 2K) of expanded memory. Also, when one or more SUBs or FUNCTIONs
are stored in expanded memory, QBX.EXE makes a one-time allocation of
32K (two 16K pages) in expanded memory as overhead for its own
internal tables.

QBX.EXE in BASIC PDS version 7.10 is enhanced so that memory is
allocated in 1K pages; for example, a 1K procedure or array takes up
1K, thus using expanded memory much more efficiently than in QBX.EXE
7.00.

This article applies to Microsoft BASIC Professional Development
System (PDS) versions 7.00 and 7.10 for MS-DOS.

Examples of Expanded Memory Usage in QBX.EXE 7.00
-------------------------------------------------

As an example for BASIC PDS 7.00, suppose QBX.EXE is run on a machine
for which FRE(-3) reports that 2720K of expanded memory is available.
When the first module-level statement is entered, FRE(-3) would then
return 2704K, 16K less. When the first SUB or FUNCTION is created
after that, FRE(-3) would return 2656K, 48K less -- 16K for the SUB or
FUNCTION itself and 32K for QBX.EXE's internal tables.

When SUBs, FUNCTIONs, module-level code units, or arrays (if /Ea is
used) are deleted, QBX.EXE deallocates the expanded memory they were
using. The tables, however, will not be deallocated unless New Program
is chosen from the File menu.

In 7.00, a single-element integer array takes the same expanded memory
space (16K) as an array with 8192 elements. Likewise, a SUB with a
single PRINT statement takes the same space (16K) as a large SUB with
hundreds of statements. (This is no longer true in 7.10, where
expanded memory usage is more efficient.)

To use expanded memory to its best potential in the QBX.EXE 7.00
environment, you should try to make your SUBs as close to the 16K
limit as possible without exceeding it. (This is not necessary in
7.10.) The size of the SUBs (in kilobytes) is listed in the View Subs
(F2) dialog box to the right of each SUB.

Likewise, arrays in QBX.EXE 7.00 will use expanded memory more
efficiently if they are dimensioned to be just under the 16K page
size. (This is not necessary in 7.10.)

References:

Microsoft BASIC Professional Development System (PDS) versions 7.00
and 7.10 offer expanded memory support under the Lotus-Intel-Microsoft
version 4.0 Expanded Memory Specification (LIM 4.0 EMS) for code and
data in the QBX.EXE environment under MS-DOS. Earlier versions do not
offer any expanded memory support. LIM 4.0 EMS support is discussed in
the "Microsoft BASIC 7.0: Getting Started" manual and in the
"Microsoft BASIC 7.1: Getting Started" manual.

To be compatible with BASIC PDS 7.00 or 7.10, the expanded-memory
device driver must observe the LIM 4.0 EMS.
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>