<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q103182: ADT/ODE: Function to Determine Retail or Run-Time Version | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q103182: ADT/ODE: Function to Determine Retail or Run-Time Version" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/103/Q103182/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/103/Q103182/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q103182: ADT/ODE: Function to Determine Retail or Run-Time Version","url":"http://jeffpar.github.io/kbarchive/kb/103/Q103182/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q103182-adtode-function-to-determine-retail-or-run-time-version">Q103182: ADT/ODE: Function to Determine Retail or Run-Time Version</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q103182
Product(s): Microsoft Access Distribution Kit
Version(s): WINDOWS:1.1,2.0,7.0,97
Operating System(s): 
Keyword(s): kbusage
Last Modified: 08-JUL-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Access Distribution Kit, version 1.1 
- Microsoft Access Developer's Toolkit, versions 2.0, 7.0 
- Microsoft Office 97 Developer Edition 
-------------------------------------------------------------------------------

Moderate: Requires basic macro, coding, and interoperability skills.

SUMMARY
=======

This article demonstrates how to use a function to determine if your Microsoft
Access application is running in the run-time or the retail version of Microsoft
Access. This function can be used to prevent your application from being used in
the retail version of Microsoft Access.

The SysCmd() function, added in Microsoft Access 1.1, enables you to display a
meter in the Microsoft Access status bar. Although SysCmd() was designed to
display a meter, the number 6 was added to return whether the application is
running in the run-time or the retail version of Microsoft Access.

This article assumes that you are familiar with Visual Basic for Applications and
with creating Microsoft Access applications using the programming tools provided
with Microsoft Access. For more information about Visual Basic for Applications,
please refer to your version of the "Building Applications with Microsoft
Access" manual.

NOTE: Visual Basic for Applications is called Access Basic in Microsoft Access
versions 1.x and 2.0. For more information about Access Basic, please refer to
the "Introduction to Programming" manual in Microsoft Access version 1.x or the
"Building Applications" manual in Microsoft Access version 2.0

MORE INFORMATION
================

The following example demonstrates how to create a function called IsRunTime()
that you can use to prevent an application from being run in the retail version
of Microsoft Access.

1. Add the following function called IsRuntime() to a new or existing module in
  your application:

        Function IsRuntime ()
           On Error GoTo ErrIsRuntime
           IsRuntime = SysCmd(6)

        ByeIsRuntime:
           Exit Function

        ErrIsRuntime:
           If (Err = 5) Then
              IsRuntime = False
           Else
              Error Err
           End If
           Resume ByeIsRuntime
        End Function

     Note that it is necessary to trap for Err = 5, Illegal Function Call,
     in case your application is being run in Microsoft Access version 1.0,
     which does not support the SysCmd(6) call.

2. Create the following macro and save it with the name AutoExec:

        Macro Name   Condition   Action
        -------------------------------------------------
        AutoExec                 Not IsRuntime()   MsgBox
                     ...         Quit

        AutoExec Actions
        --------------------------------------------------------------
        MsgBox
           Message: Invalid setup, run YourAppName setup and try again.
           Beep: Yes
           Type: Critical
           Title: YourAppName
        Quit

Additional query words:

======================================================================
Keywords          : kbusage 
Technology        : kbOfficeSearch kbAudDeveloper kbAccessSearch kbOffice97Search kbAccessDevTK200 kbOffice97 kbZNotKeyword3 kbAccessDevTK700 kbAccessDistKit110 kbOffice97DevSearch
Version           : WINDOWS:1.1,2.0,7.0,97
Hardware          : x86
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>