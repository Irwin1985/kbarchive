<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q273821: HOWTO: Programmatically Set Parameter Values for Command Object | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q273821: HOWTO: Programmatically Set Parameter Values for Command Object" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/273/Q273821/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/273/Q273821/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q273821: HOWTO: Programmatically Set Parameter Values for Command Object","url":"http://jeffpar.github.io/kbarchive/kb/273/Q273821/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q273821-howto-programmatically-set-parameter-values-for-command-object">Q273821: HOWTO: Programmatically Set Parameter Values for Command Object</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q273821
Product(s): Microsoft Visual Basic for Windows
Version(s): 6.0
Operating System(s): 
Keyword(s): kbADO kbMDAC
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Professional Edition for Windows, version 6.0 
- Microsoft Visual Basic Enterprise Edition for Windows, version 6.0 
-------------------------------------------------------------------------------

SUMMARY
=======

This article describes how to programmatically set or change parameter values
for a Command Object in the DataEnvironment.

MORE INFORMATION
================

1. Create a new Visual Basic Standard EXE project. Form1 is created by default.

2. From the Project menu, choose Add Data Environment. DataEnvironment1 and
  Connection1 are created by default.

3. Right-click Connection1, choose Properties, select Microsoft OLE DB Provider
  for SQL Server, and then click Next.

4. Select your SQL Server Name. Select the Use a specific User name and
  password: option to log on to your server. Provide the proper User Name and
  Password information for your chosen server, and check Allow Saving Password.
  Select the Northwind database on your SQL Server, click Test Connection, and
  then click OK.

5. Right-click Connection1 and choose Add Command. Command1 is created by
  default.

6. Right-click on Command1 and choose Properties. Choose Connection1 as the
  Connection for Command1.

7. Choose the SQL Statement option as the Source of Data. Enter the following
  SQL statement in the text box that appears:

"Select EmployeeID, LastName, Country from Employees where Country=?" (without
the quotation marks)

8. On the Parameters tab, Param1 is created by default. Select Input as the
  Direction, adVarChar as the DataType for the Input Parameter, click Apply,
  and then click OK.

9. Close the DataEnvironment window.

10. Draw a Text Box and a Command Button on Form1, and set the Text Property of
  the Text Box to blank.

11. On the Toolbox, right-click and select Components. Select the Microsoft
  DataGrid (OLEDB) control from the list of available controls, click Apply,
  and then click Close.

12. Draw a DataGrid control to Form1. DataGrid1 is created by default. NOTE: Do
  not set the DataSource and DataMember properties for DataGrid1. Leave these
  blank.

13. Copy the following code into the click event of Command1:

  Dim mystr As String
  mystr = Text1.Text

  DataEnvironment1.Command1 mystr

  Set DataGrid1.DataSource = DataEnvironment1.rsCommand1
  DataGrid1.Refresh

14. Run the project. Enter "USA" (without the quotation marks) in the Text Box,
  click the Command Button, and note that the grid is populated with Employees
  who are located in the USA.

Additional query words:

======================================================================
Keywords          : kbADO kbMDAC 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB600Search kbVBA600 kbVB600
Version           : :6.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>