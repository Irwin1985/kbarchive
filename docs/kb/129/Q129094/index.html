<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q129094: FIX: GP Fault in Visual C++ When Separators in Top Level Menu | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q129094: FIX: GP Fault in Visual C++ When Separators in Top Level Menu" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/129/Q129094/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/129/Q129094/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q129094: FIX: GP Fault in Visual C++ When Separators in Top Level Menu","url":"http://jeffpar.github.io/kbarchive/kb/129/Q129094/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q129094-fix-gp-fault-in-visual-c-when-separators-in-top-level-menu">Q129094: FIX: GP Fault in Visual C++ When Separators in Top Level Menu</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q129094
Product(s): Microsoft C Compiler
Version(s): winnt:
Operating System(s): 
Keyword(s): kbenv kbide kbVC kbVC200bug kbVC210bug kbVC220fix kbGrpDSToolskbbuglist kbfixlist
Last Modified: 30-JUL-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual C++, 32-bit Enterprise Edition, versions 2.0, 2.1 
- Microsoft Visual C++, 32-bit Professional Edition, versions 2.0, 2.1 
- Microsoft Visual C++, 32-bit Learning Edition, versions 2.0, 2.1 
-------------------------------------------------------------------------------

NOTE: This problem exists only when running the above versions of Microsoft
Visual C++, 32-bit Edition, under Windows 95 M8 Beta.

SYMPTOMS
========

The Visual C++ version 2.0 and 2.1 menu editor causes a general protection (GP)
fault in the M8 beta of Windows 95 when adding a separator to a top level menu
or opening a menu resource with a separator in the top level menu.

RESOLUTION
==========

If it is necessary to edit a resource that contains a top-level menu separator,
you must open the &lt;project&gt;.rc file in a text editor and remove the
top-level menu separators. Then you can use the Resource Editor to edit a menu
resource.

STATUS
======

Microsoft has confirmed this to be a bug in the Microsoft products listed at the
beginning of this article. This problem has been corrected in Visual C++ version
2.2.

MORE INFORMATION
================

This bug is best observed in the following two scenarios.

Scenario One - Steps to Reproduce Problem
-----------------------------------------

1. Generate an AppWizard application and select 'Both container and server' in
  the step 3 property page.

2. Open the &lt;project&gt;.rc file.

3. Open the menu folder.

4. Open the menu with the ID IDR_&lt;project&gt;TYPE_CNTR_IP.

A GP fault will now occur in Visual C++. Choose &lt;Close&gt; because
&lt;Ignore&gt; will cause Windows 95 to hang.

Scenario Two - Steps to Reproduce Problem
-----------------------------------------

1. Repeat steps 1 through 3 from Scenario One.

2. Open any menu.

3. Open the properties box for the empty menu item, and add a separator by
  clearing the Popup checkbox and checking Separator.

A GP fault will now occur in Visual C++. Choose &lt;Close&gt; because
&lt;Ignore&gt; will cause Windows 95 to hang.

Additional query words: 2.00 2.10 4.00 crash chicago ole GPF

======================================================================
Keywords          : kbenv kbide kbVC kbVC200bug kbVC210bug kbVC220fix kbGrpDSTools kbbuglist kbfixlist
Technology        : kbVCsearch kbAudDeveloper kbVC200 kbVC210 kbVC32bitSearch
Version           : winnt:
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>