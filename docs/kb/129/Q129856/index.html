<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q129856: Use DAO GetRows Method to Fill Variant Arrays | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q129856: Use DAO GetRows Method to Fill Variant Arrays" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/129/Q129856/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/129/Q129856/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q129856: Use DAO GetRows Method to Fill Variant Arrays","url":"http://jeffpar.github.io/kbarchive/kb/129/Q129856/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q129856-use-dao-getrows-method-to-fill-variant-arrays">Q129856: Use DAO GetRows Method to Fill Variant Arrays</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q129856
Product(s): Microsoft Visual Basic for Windows
Version(s): 4.00
Operating System(s): 
Keyword(s): kbcode kbDatabase
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Professional Edition, 16-bit, for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 16-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 32-bit, for Windows, version 4.0 
-------------------------------------------------------------------------------

SUMMARY
=======

This article summarizes how to use the GetRows method in Visual Basic version
4.0.

The GetRows method was added to the RecordSet object to facilitate testing from
Visual Basic of a lower-level C/C++ GetRows method that will be used by Visual
C++ developers. It was later found to be generally useful in many places. This
function is not documented in the Visual Basic Help file or the manuals, but can
be found by using the Object Browser under the RecordSet object. It is described
in the ReadMe file included with Visual Basic version 4.0.

MORE INFORMATION
================

The GetRows method retrieves multiple rows of a recordset into an array. Here is
the syntax:

     variant = recordset.GetRows (numrows)

- variant is the name of a variant to hold the returned data.

- numrows is the number of rows to retrieve.

GetRows returns the specified number of rows and all the fields (columns) into a
variant containing an array. Subsequent rows contain the data.

After a call to GetRows, the current record is positioned at the next unread row.
In other words, GetRows has the same positioning effect as Move numrows.

If more rows are requested than are available, only the number available are
returned. Use Ubound to determine how many rows were actually fetched. The array
is sized to fit the number of rows returned.

For example, if you returned the results into a variant called a, you could use
the following code to determine how many rows were actually returned:

     numreturned = Ubound(a,2) + 1

The "+ 1" is used because the first data returned is in the zero (0) element of
the array.

The number of rows that can be fetched is constrained by available memory and
should be chosen to suit your application. Don't expect to use GetRows to bring
your whole table into an array.

Because all fields of the recordset are returned in the array, including long
memo and binary fields, you may want to use a query that restricts the columns
returned.

Code Sample
-----------

  ' This example uses the GetRows method to bring two fields
  ' from the Orders table into memory.

  Dim db as Database
  Dim rs as Recordset
  Dim data as Variant

  Set db = OpenDatabase("sales.mdb")
  Set rs = db.OpenRecordset("Select OrderId, CustId from Orders")

  While Not rs.eof
     data = rs.GetRows(10)
     ' .... do something with the data
  Wend

  rs.Close
  db.Close

Additional query words: 4.00 Excel vb4win vb4all

======================================================================
Keywords          : kbcode kbDatabase 
Technology        : kbVBSearch kbAudDeveloper kbVB400Search kbVB400 kbVB16bitSearch
Version           : 4.00

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>