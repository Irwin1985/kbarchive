<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q129571: PRB: Formset.LOAD Is Not the First Event to Fire | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q129571: PRB: Formset.LOAD Is Not the First Event to Fire" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/129/Q129571/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/129/Q129571/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q129571: PRB: Formset.LOAD Is Not the First Event to Fire","url":"http://jeffpar.github.io/kbarchive/kb/129/Q129571/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q129571-prb-formsetload-is-not-the-first-event-to-fire">Q129571: PRB: Formset.LOAD Is Not the First Event to Fire</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q129571
Product(s): Microsoft FoxPro
Version(s): WINDOWS:3.0
Operating System(s): 
Keyword(s): 
Last Modified: 12-FEB-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, version 3.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When a form set contains a Data Environment, the BeforeOpenTables event and the
OpenTables method of the Data Environment are triggered before the Load event of
the form set. This article explains the reason behind this implementation and
offers a workaround if you want the Load event to execute before the tables are
opened.

CAUSE
=====

The Load event of a form set usually sets the environment of a form. In
particular, it can be used to bind data to controls on a form. Therefore, in
most cases, tables and views must be loaded before the LOAD event of a form set
is executed. Thus, the OpenTables method of the data environment is, by default,
called before the Load event of the form set is executed.

WORKAROUND
==========

If you do not want the tables or views to be opened when the Load event of a
form set is executed, set the AutoOpenTables property of the form to .F.. You
can then call the OpenTables method of the data environment to open the tables
automatically. For example, use the following command in any method of the
form:

     THISFORMSET.DataEnvironment.Opentables

STATUS
======

This behavior is by design.

MORE INFORMATION
================

Following is the sequence of events that are executed when a form set created in
Visual FoxPro version 3.0 is loaded or unloaded. The order of events might
differ if the form is converted from a FoxPro version 2.x screen. In this
example, the form set is named FORMSET1 and contains a form named FORM1 and a
data environment called DATAENVIRONMENT. This list was generated by executing
the following code for the following events and methods:

     ACTIVATE SCREEN
     ?PROGRAM()

     FORMSET1.LOAD
     .DATAENVIRONMENT.OPENTABLES
     .DATAENVIRONMENT.BEFOREOPENTABLES
     FORMSET1.FORM1.LOAD
     FORMSET1.DATAENVIRONMENT.INIT
     FORMSET1.FORM1.INIT
     FORMSET1.INIT
     FORMSET1.SHOW
     FORMSET1.ACTIVATE
     FORMSET1.FORM1.ACTIVATE
     FORMSET1.FORM1.GOTFOCUS
     FORMSET1.FORM1.QUERYUNLOAD
     FORMSET1.DESTROY
     FORMSET1.FORM1.DESTROY
     FORMSET1.FORM1.UNLOAD
     FORMSET1.UNLOAD
     FORMSET1.DATAENVIRONMENT.CLOSETABLES
     FORMSET1.DATAENVIRONMENT.AFTERCLOSETABLES
     FORMSET1.DATAENVIRONMENT.DESTROY

NOTE: The OPENTABLES method calls the BEFOREPOPENTABLES event before the tables
are actually opened. However, the code in the event handler is executed before
the tables are opened, and this is the reason why OPENTABLES prints before
BEFOREOPENTABLES prints.

For more information about the sequence of events that are triggered when a form
runs, execute the sample program called EVENTS.SCX located in the
SAMPLES\CONTROLS\EVENTS directory.

Additional query words: VFoxWin

======================================================================
Keywords          :  
Technology        : kbVFPsearch kbAudDeveloper kbVFP300
Version           : WINDOWS:3.0

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>