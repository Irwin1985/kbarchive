<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q262856: SMS: Invalid Pointer Causes Low-rights Client Install to Fail | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q262856: SMS: Invalid Pointer Causes Low-rights Client Install to Fail" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/262/Q262856/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/262/Q262856/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q262856: SMS: Invalid Pointer Causes Low-rights Client Install to Fail","url":"http://jeffpar.github.io/kbarchive/kb/262/Q262856/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q262856-sms-invalid-pointer-causes-low-rights-client-install-to-fail">Q262856: SMS: Invalid Pointer Causes Low-rights Client Install to Fail</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q262856
Product(s): Microsoft Systems Management Server
Version(s): winnt:2.0
Operating System(s): 
Keyword(s): kbsetup kbClient kbsms200 kbDiscovery
Last Modified: 30-JUL-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server version 2.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When a non-administrative user installs the Systems Management Server 2.0 client
on a Windows NT 4.0 system via the logon installation method, installation fails
and no client components are installed. When this behavior occurs, the following
error is present in the Wn_logon.log:

  ASSIGNMENT ***************************************
  Before adding new sites, there are 1 site keys and 0 sites in the site list
     Site Key #0: "XXX"
  Some sites in the registry are not assigned
  Assessing assignment state from "\SITES\XXX"
  Calling GetAccessiblePath with \SITES\XXX\ 
  GetAccessiblePath failed for NAL path \SITES\XXX\. Error = 0x80004003
  Warning: Unable to Check Assignment for site "XXX" - Invalid pointer
  After adding any new sites, there are 1 site keys and 0 sites in the site list
     Site Key #0: "XXX" 
  Not writing Site List data back to the registry (no new sites)
  Client is not assigned to any sites - finished.
   STATUS CALLBACK -  -
  ReWriteSitesRegistry returning 28931
  Finished CliEx processing.
  Unloading CliEx.

CAUSE
=====

This behavior occurs because the logged on user is not able to create registry
entries under the HKEY_CLASSES_ROOT registry hive. As a result, Network
Abstraction Layer (NAL) components are not installed correctly and the client
installation cannot be completed.

RESOLUTION
==========

On the system experiencing this problem, verify the Interactive Group has the
following permissions on HKEY_CLASSES_ROOT and all its subkeys:

- Query Value

- Set Value

- Create Subkey

- Enumerate Subkeys

- Notify

- Delete

- Read Control

NOTE: These are the default permissions for the Interactive Group, but may have
been changed by an administrator for security purposes.

MORE INFORMATION
================

When the Systems Management Server client core components are installed, several
Nal.dll files must be registered under the HKEY_CLASSES_ROOT registry hive. If
these files are not registered, NAL is unable to resolve paths on behalf of
System Management Server client components, resulting in failure to install the
client.

Additional query words: prodsms

======================================================================
Keywords          : kbsetup kbClient kbsms200 kbDiscovery 
Technology        : kbSMSSearch kbSMS200
Version           : winnt:2.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>