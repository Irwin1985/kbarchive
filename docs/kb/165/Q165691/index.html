<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q165691: INFO: Visual C++ 5.0 Readme, Sample Program Issues | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q165691: INFO: Visual C++ 5.0 Readme, Sample Program Issues" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/165/Q165691/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/165/Q165691/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q165691: INFO: Visual C++ 5.0 Readme, Sample Program Issues","url":"http://jeffpar.github.io/kbarchive/kb/165/Q165691/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q165691-info-visual-c-50-readme-sample-program-issues">Q165691: INFO: Visual C++ 5.0 Readme, Sample Program Issues</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q165691
Product(s): Microsoft C Compiler
Version(s): 5.0
Operating System(s): 
Keyword(s): 
Last Modified: 31-JUL-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual C++, 32-bit Enterprise Edition, version 5.0 
- Microsoft Visual C++, 32-bit Professional Edition, version 5.0 
-------------------------------------------------------------------------------

SUMMARY
=======

Sample Program Issues
---------------------

  New Visual C++ 5.0 Samples
  Updated Samples
  ATL Samples COMMAP, CONNECT, and DRAWSERV Do Not Register Correctly When
  Path Contains Spaces
  CUSTOMWZ Sample Missing Files
  Get Sendtime and Settime Samples from the Compact Disc
  ATL CIRC Sample Fails in Some Containers
  ATLCON Sample Fails Under MinCRT Configurations
  ATLBUTTON Sample Returns Incorrect Property Values
  ATL POLYGON Sample Does Not Build in Release Mode
  Link Error in Debug Build of COM Sample acdual/mfcctrl
  Typo in tan and tanh Sample
  BINDENRL Sample Fails to Copy STDREG32.MDB
  Access Violation in Visual Basic 5 When Running COMEXCEL Sample
  Running OLE SDK Samples
  Running InOLE2 SDK Samples

MORE INFORMATION
================

The samples on the first Visual C++ CD are accessible from any directory browser
(Windows Explorer or File Manager, for example). Sample code remains available
for viewing and download from sample abstracts in the documentation.

New Visual C++ 5.0 Samples
--------------------------

Try out the samples located in the \DEVSTUDIO\VC\SAMPLES directory of the first
Visual C++ CD. These include examples of using the new compiler support for COM
and samples for ATL. They also include a new Custom AppWizard sample.

Updated Samples
---------------

The most recent versions of the following samples are in the DevStudio\Vc\Samples
directory on the disc that includes "Microsoft Visual C++" on the label. (Disc 1
if you purchased Visual C++; Disc 3 if you purchased Visual Studio.) Do not use
the versions that you can find in the InfoViewer's Samples abstracts. Instead,
copy the files from the Microsoft Visual C++ disc to your hard drive.

MFC Samples

- OLDBARS
- SUPERPAD
- OLEVIEW
- WORDPAD
- EXTBIND
- MDIBIND
- BINDENRL
- REGSVR
- SMILEY
- DAOCTL
- ODBCINFO

ATL Samples

- CIRC
- POLYGON

Enterprise Samples

- SENDTIME
- SETTIME

Com Samples

- ALLINONE
- INPROC
- LABRADOR

SDK Samples

- AXSCRIPT
- URLPAD

ATL Samples COMMAP, CONNECT, and DRAWSERV Do Not Register Correctly When
Path Contains Spaces
---------------------------------------------------------------------------------------------

These ATL samples do not register correctly when their path contains spaces.

Workaround

Edit their corresponding .RGS files and add single quotes around all occurrences
of %MODULE%. For example, you would change a line containing the following:

     InprocServer32 = s %MODULE%

to the following:

     InprocServer32 = s '%MODULE%'

NOTE: DRAWSERV is a sample program within the DCOM ATL sample.

CUSTOMWZ Sample Missing Files
-----------------------------

The CUSTOMWZ sample in the DevStudio\Vc\Samples\appwiz\ directory is missing some
essential files.

To obtain the entire sample, with all of its files, install it from the
"CUSTOMWZ: A Custom AppWizard" topic in the online documentation. To find this
topic, choose the Search command from the Help menu, enter the comma- delimited
string, "CUSTOMWZ: A Custom AppWizard", on the Query tab, and then click the
Query button.

Get Sendtime and Settime Samples From the Compact Disc
------------------------------------------------------

The files for the Sendtime and Settime samples downloaded from the Enterprise
sample abstracts in the online documentation will not compile.

Workaround

Manually copy the correct files for these samples from the
DevStudio\VC\Samples\Ent\time directory. This directory is on the disc that
includes "Microsoft Visual C++" on the label. (Disc 1 if you purchased Visual
C++; Disc 3 if you purchased Visual Studio.)

ATL CIRC Sample Fails in Some Containers
----------------------------------------

For correct functionality in certain containers, objects passing properties must
support the propputref semantics. The CIRC sample as installed from the online
abstract supports propput instead of propputref. Therefore, you should use the
CIRC sample from the DevStudio\Vc\Samples\Atl\circ directory. To see the correct
propputref syntax, look in the Circ.idl file. This directory is on the disc that
includes "Microsoft Visual C++" on the label. (Disc 1 if you purchased Visual
C++; Disc 3 if you purchased Visual Studio.)

ATLCON Sample Fails Under MinCRT Configurations
-----------------------------------------------

To successfully run the ATL sample, ATLCON, under a MinCRT configuration, you
must remove the WinMain entry point as follows:

1. On the Projects menu, click Settings.

2. In the Settings For: drop-down list, choose one of the MinCRT configurations.

3. On the Link tab, choose the Output category.

4. Remove the text in the Entry-point symbol edit box.

ATLBUTTON Sample Returns Incorrect Property Values
--------------------------------------------------

The ATLBUTTON sample returns incorrect values for the properties ImageHover and
ImagePush. To correct the sample change the file AtlButton.h so that the
function get_ImageHover uses m_bstrFilename[1].Copy() and change get_ImagePush
so that it uses m_bstrFilename[2].Copy().

ATL POLYGON Sample Does Not Build in Release Mode
-------------------------------------------------

If you copy the ATL POLYGON sample from the online documentation, it will not
build in Release mode as it incorrectly defines the _ATL_MIN_CRT macro. The
sample on the disc does not have this problem. (Disc 1 if you purchased Visual
C++; Disc 3 if you purchased Visual Studio.)

Workaround

1. Select the Settings command from the Project menu

2. Choose the C/C++ tab. In the General category, remove _ATL_MIN_CRT from the
  Preprocessor definitions edit box. 3.Choose the Link tab. In the Output
  Category, remove DllMain from the Entry-point symbol edit box.

Link Error in Debug Build of COM Sample acdual/mfcctrl
------------------------------------------------------

This sample will fail under debug builds looking for comsuppd.lib. To fix the
problem, go into the Project Settings dialog box and remove _COM_DEBUG from the
Preprocessor definitions box in the C/C++ Preprocessor section.

Typo in tan and tanh Sample
---------------------------

In the documentation of tan and tanh, there is a typo in the sample. The current
sample shows:

     printf( "tan( %f ) = %f\n", x, y );
     printf( "tanh( %f ) = %f\n", y, x );

It should be:

     printf( "tan( %f ) = %f\n", pi/4, x );
     printf( "tanh( %f ) = %f\n", x, y );

The correct output is:

  tan( 0.785398 ) =  1.000000
  tanh( 1.000000 ) = 0.761594

See both the \DEVSTUDIO\VC\SAMPLES and the \OLEDB\SAMPLES directories on the
first Visual C++ CD.

BINDENRL Sample Fails to Copy STDREG32.MDB
------------------------------------------

To build the BINDENRL sample, you'll need to manually copy the database file
stdreg32.mdb into the same local directory that you copy the samples source
files. You will find stdreg32.mdb in the
DEVSTUDIO\VC\Samples\mcl\mfc\database\daoenrol directory. This directory is on
the disc that includes "Microsoft Visual C++" on the label. (Disc 1 if you
purchased Visual C++; Disc 3 if you purchased Visual Studio.)

Access Violation in Visual Basic 5.0 When Running COMEXCEL Sample
-----------------------------------------------------------------

If you get an access violation while running the COMEXCEL sample in Visual Basic
5.0 under Windows NT V4.0, please install the Windows NT Service Pack 2.

Running OLE SDK Samples
-----------------------

Before you run an OLE SDK sample, you should first copy the following
subdirectories from the first VC++ product CD

  DevStudio\VC\Samples\SDK\ole\include
  DevStudio\VC\Samples\SDK\ole\lib

to the following subdirectories on the disk (in this case c:) that will hold the
OLE samples

  c:\samples\ole\include
  c:\samples\ole\lib

You can now install the sample files in any directory on the disk (in this case
c:) and compilation will find the include and lib directories. If you have an
MSTOOLS environment variable defined, you should put the include and lib
directories in the following location on your hard disk: MSTOOLS path\samples.

Running InOLE2 SDK Samples
--------------------------

Before you run an InOLE2 SDK sample, you should first copy the following
subdirectories from the first VC++ product CD

  DevStudio\VC\Samples\SDK\ole\inole2\inc
  DevStudio\VC\Samples\SDK\ole\inole2\lib

to the following subdirectories on the disk (in this case c:) that will hold the
OLE samples

  c:\samples\ole\inole2\inc c:\samples\ole\inole2\lib

You can now install the sample files in any directory on the disk (in this case
c:) and compilation will find the inc and lib directories. If you have an
MSTOOLS environment variable defined, you should put the inc and lib directories
in the following location on your hard disk: MSTOOLS path\samples.

======================================================================
Keywords          :  
Technology        : kbVCsearch kbAudDeveloper kbVC500 kbVC32bitSearch kbVC500Search
Version           : 5.0

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>