<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q165824: ADT/ODE: End Statement in Run-Time Application Causes Error | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q165824: ADT/ODE: End Statement in Run-Time Application Causes Error" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/165/Q165824/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/165/Q165824/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q165824: ADT/ODE: End Statement in Run-Time Application Causes Error","url":"http://jeffpar.github.io/kbarchive/kb/165/Q165824/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q165824-adtode-end-statement-in-run-time-application-causes-error">Q165824: ADT/ODE: End Statement in Run-Time Application Causes Error</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q165824
Product(s): Microsoft Access Distribution Kit
Version(s): WINDOWS:7.0
Operating System(s): 
Keyword(s): kbcode kberrmsg kbdta
Last Modified: 01-JUL-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Access Developer's Toolkit, version 7.0 
- Microsoft Office 97 Developer Edition 
-------------------------------------------------------------------------------

Moderate: Requires basic macro, coding, and interoperability skills.

SYMPTOMS
========

If you use the End statement in Visual Basic for Applications code in a run-time
application, when the statement is executed, you may receive the following error
message and then the application quits:

  Execution of this application has stopped due to a run-time error. The
  application cannot continue and will be shut down.

Note that this does not happen in the retail version of Microsoft Access.

CAUSE
=====

The End statement causes a UserReset error in Microsoft Access, which is treated
as a run-time error. Run-time errors in a run-time application cause the
application to quit. Note that this happens even if your application contains
error handling procedures.

RESOLUTION
==========

Rewrite your code so it does not use the End statement. If it is appropriate,
you can use the Exit Sub or Exit Function statement to exit the procedure. Note,
however, that the Exit statement only exits the currently running procedure. If
you are running a nested procedure, the main procedure continues to run after
you issue the Exit statement, and you must provide a mechanism to exit the main
procedure as well.

MORE INFORMATION
================

If you use the feature in Microsoft Access 7.0 and 97 that allows you to convert
macros into Visual Basic code modules, the StopAllMacros macro action will
translate to an End statement in Visual Basic code.

Steps to Reproduce Behavior
---------------------------

1. Start Microsoft Access and create a new database named RTError.mdb.

2. Create a module and type the following procedure:

        Sub CauseError()
           On Error GoTo Err_Handler
           MsgBox "Click OK to cause a run-time error"
           End
           Exit Sub
           Err_Handler:
           MsgBox Error$
        End Sub

3. Save the module as Module1, and then close it.

4. Create a new form not based on any table or query in Design view:

     Form: Form1
     ------------------------
     Caption: Startup Form

     Command button:
        Name: Command0
        Caption: Cause Error
        OnClick: =CauseError()

5. Save the form as Form1, and then close it.

6. On the Tools menu, click Startup.

7. In the Startup dialog box, select Form1 in the Display Form box, and then
  click OK.

8. Start the Setup Wizard and create setup files that contain RTError.mdb, the
  Microsoft Access Run-Time Version, and the Workgroup Administrator.

9. Install the run-time application and start it. When Form1 opens, click the
  Cause Error button. Note that you receive the error message, and then your
  application quits.

REFERENCES
==========

For more information about the End statement, search the Help Index for "End
statement."

For more information about converting macros to Visual Basic modules, search the
Help Index for "converting macros."

Additional query words:

======================================================================
Keywords          : kbcode kberrmsg kbdta 
Technology        : kbOfficeSearch kbAudDeveloper kbAccessSearch kbOffice97Search kbOffice97 kbZNotKeyword3 kbAccessDevTK700 kbOffice97DevSearch
Version           : WINDOWS:7.0
Hardware          : x86
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>