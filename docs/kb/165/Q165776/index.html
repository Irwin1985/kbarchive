<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q165776: FIX: Admin Cannot See Files with Project Security Enabled | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q165776: FIX: Admin Cannot See Files with Project Security Enabled" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/165/Q165776/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/165/Q165776/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q165776: FIX: Admin Cannot See Files with Project Security Enabled","url":"http://jeffpar.github.io/kbarchive/kb/165/Q165776/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q165776-fix-admin-cannot-see-files-with-project-security-enabled">Q165776: FIX: Admin Cannot See Files with Project Security Enabled</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q165776
Product(s): Microsoft SourceSafe
Version(s): WINDOWS:5.0,97
Operating System(s): 
Keyword(s): kbSSafe500bug kbVS97sp1fix
Last Modified: 03-MAY-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual SourceSafe for Windows, version 5.0 
- Microsoft Visual Studio 97 
-------------------------------------------------------------------------------

SYMPTOMS
========

1. The SourceSafe Admin does not see any files in a project in the SourceSafe
  explorer.

2. The error message: "this command only works on projects" appears when doing
  various SourceSafe operations.

3. When assigning rights by project to a parent project, not all subprojects
  inherit the rights.

4. When assigning rights by project, or rights assignments to users, you receive
  the following error: Error writing to file.


CAUSE
=====

The Rights.dat file is corrupted when you assign more than 16 users the rights
(by project) to an individual project.

RESOLUTION
==========

To prevent this from happening, do one of the following:

- Turn off project security. This provides all users global-full or read-only
  access rights. With project security turned off, you can set read-only access
  by selecting the Read Only check box on the Users menu under Edit User in the
  Admin module.

- Limit user-right settings to 16 or less users per project.

Once the problem occurs, the Rights.dat file has become corrupted and the entire
user management and rights system must be rebuilt. Use the following steps to do
this:

1. Make sure that the Visual SourceSafe server and all client installations are
  upgraded to Visual SourceSafe 5.0 Service Pack 1 or later, or to a later
  version of Visual SourceSafe.

2. Rename the Rights.dat file in the VSS\data directory.

3. Run analyze -f on the data directory.

This will rebuild the Rights.dat file, but there will be no project security
information. You will need to run the Visual SourceSafe Admin module and
re-create rights by user or by project.

STATUS
======

Microsoft has confirmed this to be a bug in the Microsoft products listed at the
beginning of this article.
This bug was corrected in Visual Studio 97 Service Pack 1.

For additional information about the Visual Studio 97 Service Pack 1, please see
the following article in the Microsoft Knowledge Base:

  Q170365 INFO: Visual Studio 97 Service Packs - What, Where, and Why

MORE INFORMATION
================

Steps to Reproduce Behavior
---------------------------

1. Create a new Visual SourceSafe database.

2. Add at least 1 project and at least 1 file to that project.

3. In the Admin program, add 16 users.

4. Setup the users with any combination of rights (R,RC,RCA,RCAD) to the new
  project.

5. At this point, Admin should still have access to the project.

6. Add the 17th user and give him/her rights as well.

7. Run SSEXP, login as Admin and try to view the file(s) in the project.

Additional query words: password missing administrator

======================================================================
Keywords          : kbSSafe500bug kbVS97sp1fix 
Technology        : kbVSsearch kbSSafeSearch kbAudDeveloper kbSSafe500 kbVS97 kbVS97Search
Version           : WINDOWS:5.0,97
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>