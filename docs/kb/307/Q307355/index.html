<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q307355: HOW TO: Call a Web Service in Visual FoxPro 7.0 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q307355: HOW TO: Call a Web Service in Visual FoxPro 7.0" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/307/Q307355/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/307/Q307355/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q307355: HOW TO: Call a Web Service in Visual FoxPro 7.0","url":"http://jeffpar.github.io/kbarchive/kb/307/Q307355/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q307355-how-to-call-a-web-service-in-visual-foxpro-70">Q307355: HOW TO: Call a Web Service in Visual FoxPro 7.0</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q307355
Product(s): Microsoft FoxPro
Version(s): 7.0
Operating System(s): 
Keyword(s): kbInternet kbMiscTools kbvfp kbGrpDSFox kbDSupport kbvfp700 kbHOWTOmaster
Last Modified: 12-JUL-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, version 7.0 
-------------------------------------------------------------------------------


IN THIS TASK
------------

- SUMMARY

   - How to Call the AirportWeather Web Service

   - Find the AirportWeather Web Service
- Call the AirportWeather Web Service

- REFERENCES

SUMMARY
=======

This step-by-step article describes how to call the AirportWeather Web service
by using Visual FoxPro 7.0.

How to Call the AirportWeather Web Service
------------------------------------------

Visual FoxPro 7.0 contains several features that make working with Web services
easier, including IntelliSense and a FoxPro Foundation Class to simplify working
with the SOAP toolkit.

AirportWeather is a service that looks up the current weather at any NOAA airport
observation post. This code sample displays a message box with the current
weather conditions at Seattle-Tacoma International Airport.

NOTE: To call Web services in Visual FoxPro 7.0, you must have the Microsoft SOAP
Toolkit version 2.0 installed. You can install the SOAP Toolkit from the Visual
FoxPro 7.0 installation CD or by downloading it from the following Microsoft
Developer Network (MSDN) Web site:

  Microsoft SOAP Toolkit
  http://msdn.microsoft.com/downloads/default.asp?URL=/code/sample.asp?url=/msdn-files/027/001/580/msdncompositedoc.xml

The client parts of the SOAP Toolkit come preinstalled on Microsoft Windows XP,
so you don't need a separate download.


If you are behind a firewall, you may have problems running this code.

Find the AirportWeather Web Service:

1. Browse to the following Web site:

  XMethods.com
  http://xmethods.com/

2. Scroll down to the AirportWeather service name (owned by Cape Clear).

3. Click the service name to browse to the following Web site:

  http://xmethods.com/detail.html?id=129

4. Click the WSDL URL, to see the formal definition of the Web service at the
  following Web site:

  http://www.capescience.com/webservices/airportweather/AirportWeather.wsdl

  For help with the other features of the service, see the following Web site:

  http://www.capescience.com/webservices/airportweather/index.html

5. Copy the WSDL URL onto the clipboard.

Call the AirportWeather Web Service:

1. In Visual FoxPro 7.0, start the IntelliSense Manager from the Tools menu.

2. On the Types tab, click Web Services. Note that you receive an error message
  if you do not have SOAP version 2.0 or later installed. You also receive a
  warning if you do not have Microsoft Internet Information Server (IIS)
  installed, but you can continue.

3. For Web Service Name, type "AirportWeather" (without the quotation marks).

4. For WDSL URL Location, paste the WSDL URL that you copied in step 5 of the
  previous section
  (http://www.capescience.com/webservices/airportweather/AirportWeather.wsdl).

5. Click Register, and the Web service information is saved in the IntelliSense
  FoxCode.dbf table.

6. Create a new program (for example, Aw.prg).

7. In the code window, type "LOCAL loAW AS AirportWeather" (without the
  quotation marks). Note that AirportWeather is included in the list of types
  that IntelliSense displays.

8. Press ENTER. IntelliSense fills in the following code:

  LOCAL loWS
  loWS = NEWOBJECT("Wsclient",HOME()+"ffc\_webservices.vcx")
  loWS.cWSName = "AirportWeather"
  loAw = loWS.SetupClient("http://live.capescience.com/wsdl/AirportWeather.wsdl", "AirportWeather", "Station")

9. Paste the following code at the end of the program:

  LOCAL loAW as AirportWeather
   LOCAL loWS
   loWS = NEWOBJECT("Wsclient",HOME()+"ffc\_webservices.vcx")
   loWS.cWSName = "AirportWeather"
   loAW = loWS.SetupClient("http://live.capescience.com/wsdl/AirportWeather.wsdl", "AirportWeather", "Station")
   loAW.ConnectorProperty("Timeout") = 60 * 1000 &amp;&amp; milliseconds
   LOCAL loSummary, lcMessage
   loSummary = loAW.getSummary("KSEA")
   WITH loSummary
   TEXT TO lcMessage NOSHOW
   Location: &lt;&lt;.Item(1).Text&gt;&gt;
   Wind: &lt;&lt;.Item(2).Text&gt;&gt;
  Sky Conditions: &lt;&lt;.Item(3).Text&gt;&gt;
   Temperature: &lt;&lt;.Item(4).Text&gt;&gt;
   Humidity: &lt;&lt;.Item(5).Text&gt;&gt;
   Barometer: &lt;&lt;.Item(6).Text&gt;&gt;
   Visibility: &lt;&lt;.Item(7).Text&gt;&gt;
   ENDTEXT
   
   MESSAGEBOX(TEXTMERGE(lcMessage), "KSEA Weather Conditions") 
  ENDWITH

Note that after you type "loAW." (without the quotation marks), IntelliSense
displays the various methods of the Web service. After you select getSummary,
IntelliSense displays a tooltip with its parameters and return value. Note that
it returns a value of type WeatherSummary:. This is a complex type that is
parsed into a COM object with the SOAP Toolkit.

The AirportWeather service has other methods that return simple strings, which
can be displayed normally.

10. Run the program.

The third-party products that are discussed in this article are manufactured by
companies that are independent of Microsoft. Microsoft makes no warranty,
implied or otherwise, regarding the performance or reliability of these
products.

In particular, we cannot guarantee that this Web service will be available when
you read this article. The principles in the article will apply to any Web
service, so if necessary, choose another one to test against, and modify the
display code accordingly.

REFERENCES
==========

For additional information about Visual FoxPro and Web Services, see the
"Walkthrough: Creating Web Services with Visual FoxPro" Visual FoxPro 7.0 white
paper and the "Web Services Overview" topic in the Visual FoxPro 7.0
documentation.


Additional query words:

======================================================================
Keywords          : kbInternet kbMiscTools kbvfp kbGrpDSFox kbDSupport kbvfp700 kbHOWTOmaster 
Technology        : kbVFPsearch kbAudDeveloper kbVFP700
Version           : :7.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>