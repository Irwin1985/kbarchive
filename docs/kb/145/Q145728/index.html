<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q145728: HOWTO: Create a Listbox with Clickable Checkboxes | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q145728: HOWTO: Create a Listbox with Clickable Checkboxes" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/145/Q145728/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/145/Q145728/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q145728: HOWTO: Create a Listbox with Clickable Checkboxes","url":"http://jeffpar.github.io/kbarchive/kb/145/Q145728/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q145728-howto-create-a-listbox-with-clickable-checkboxes">Q145728: HOWTO: Create a Listbox with Clickable Checkboxes</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q145728
Product(s): Microsoft Visual Basic for Windows
Version(s): WINDOWS:4.0
Operating System(s): 
Keyword(s): kbGrpDSVB
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Standard Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 32-bit, for Windows, version 4.0 
-------------------------------------------------------------------------------

SUMMARY
=======

Many Windows programs incorporate listboxes with embedded checkboxes as part of
their user interface. The References dialog in Visual Basic 4.0 is one example
of this kind of listbox. This article shows how to implement a listbox with this
functionality in Visual Basic 4.0 by using the ListView control.

NOTE: With Visual Basic versions 5.0 and later, you can set the Style property of
the intrinsic listbox control to indicate a "CheckBox" style.

MORE INFORMATION
================

The ListView control has the capability to show images and text for each item in
a list. The graphics to be displayed are held in an associated ImageList control
and can be checked and unchecked checkboxes or whatever images are desired.

NOTE: To use ImageList controls with the ListView control, you must associate a
particular ImageList control with the Icons and SmallIcons properties, as
follows:

      ListView1.Icons = ImageList1
      ListView1.SmallIcons = ImageList2

Follow these steps to create a listbox with the capability to display graphics
and text:

1. Start Visual Basic 4.0, 32-bit, or if it is already running, open a new
  project.

2. Place a ListView and an ImageList control on the form.

3. Right click on the ImageList control and select Properties. On the General
  tab, ensure that the '16 x 16' option button is selected. Switch to the
  Images tab and use the Insert Picture button to add two images to the
  ImageList. So that the code below will work without modification, make the
  first picture the 'unchecked' image, and the second the 'checked'. Visual
  Basic 4.0 does not ship with images that represent simple checked and
  unchecked checkboxes. Two complementary icons that are included in the Icons
  directory beneath the Visual Basic directory can be used (e.g. the
  Trash02a.ico and Trash02b.ico icons located in the \Icons\Computer
  directory.) Or, if you have a previous version of Visual Basic, these icons
  can be easily created with the IconWorks sample that is included with
  previous versions of Visual Basic.

4. Insert these lines of code in the General Declaration section of the form.

        'store the item selected in the ItemClick event
        'for use in the DblClick event
        Private ItemClicked As ListItem

5. Add the following code into the code window for the form. The operation of
  the code is explained in the included comments.

        Private Sub Form_Load()
            Dim itmX As ListItem
            Dim i As Integer

            'loop and add 10 items to the ListView control
            'this code should be replaced by your add item code
            For i = 1 To 10
                Set itmX = ListView1.ListItems.Add()
                'set icon to unchecked
                itmX.SmallIcon = 1
                itmX.Text = "ListItem " &amp; i
            Next i

            'other views will work, but will allow additional
            'behavior over a standard listbox
            ListView1.View = lvwList

            'display full label
            ListView1.LabelWrap = False
        End Sub

        Private Sub ListView1_DblClick()

            'toggle icon between checked and unchecked
            'use the private ItemClicked variable set in the
            'ListView1_ItemClick event
            With ItemClicked
                If .SmallIcon = 1 Then
                    .SmallIcon = 2
                Else
                    .SmallIcon = 1
                End If
            End With
        End Sub

        Private Sub ListView1_ItemClick(ByVal Item As ListItem)
            'since there is no ItemDblClick event, save the item
            'clicked on for use in the ListView's DblClick Event
            Set ItemClicked = Item
        End Sub

REFERENCES
==========

Online help for ListView and ImageList controls

Additional query words: kbVBp400 kbVBp500 kbVBp600 kbVBp kbdsd kbDSupport kbControl

======================================================================
Keywords          : kbGrpDSVB 
Technology        : kbVBSearch kbAudDeveloper kbVB400Search kbVB400
Version           : WINDOWS:4.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>