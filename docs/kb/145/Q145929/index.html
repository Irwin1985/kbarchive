<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q145929: PRB: Visual FoxPro Creates Public Variable for ControlSource | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q145929: PRB: Visual FoxPro Creates Public Variable for ControlSource" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/145/Q145929/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/145/Q145929/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q145929: PRB: Visual FoxPro Creates Public Variable for ControlSource","url":"http://jeffpar.github.io/kbarchive/kb/145/Q145929/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q145929-prb-visual-foxpro-creates-public-variable-for-controlsource">Q145929: PRB: Visual FoxPro Creates Public Variable for ControlSource</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q145929
Product(s): Microsoft FoxPro
Version(s): WINDOWS:3.0,3.0b
Operating System(s): 
Keyword(s): 
Last Modified: 05-FEB-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b 
-------------------------------------------------------------------------------

SYMPTOMS
========

In a form, the scope of a variable set as a control source is public. This
variable is declared in a program. By default, a variable declared in a
procedure is private, so you would expect this variable to be private.

CAUSE
=====

The form is running in a modeless environment. When the form is modeless,
program execution does not pause after the form is displayed. When the program
is completed, control is returned to the Command window. If the form is still
displayed when you return to the Command window, users can input data. This
means that the input variables need to be accessible. To prevent errors, Visual
FoxPro automatically scopes input variables as public when the Command window is
active. So, if the source of the data of a control is a variable, its scope is
changed to PUBLIC when the Command window is accessed.

RESOLUTION
==========

Use a modal form or a READ EVENTS to pause program execution and prevent the
scope of the variable from changing.

You can also declare the ControlSource variable as a property of a form to scope
it to the form object.

STATUS
======

This is by design.

MORE INFORMATION
================

Steps to Reproduce Behavior
---------------------------

1. Create a new form.

2. Add a text box to the form.

3. Change the ControlSource property of the text box to cCity.

4. Create a program that contains the following code:

     cCity="Atlanta"
     DO FORM &lt;form name&gt;
     DISPLAY MEMORY like cCity

5. Run the program. The variable cCity is private.

6. When control is back in the Command window, type:

     DISPLAY MEMORY like cCity

  The variable is public.

To execute a form, you can use the syntax DO FORM &lt;form name&gt; LINKED. The
LINKED keyword causes the form to be released when the variable that references
the form object goes out of scope. By not including the LINKED keyword, you
ensure that the form is visible when the variable that references it goes out of
scope. In the example, the reference to the form is released, but the form is
still visible.

Additional query words: VFoxWin

======================================================================
Keywords          :  
Technology        : kbVFPsearch kbAudDeveloper kbVFP300 kbVFP300b
Version           : WINDOWS:3.0,3.0b

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>