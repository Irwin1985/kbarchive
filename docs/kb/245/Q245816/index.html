<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q245816: SMS: Screen Saver Disabled After Applying the Hotfix for Q193269 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q245816: SMS: Screen Saver Disabled After Applying the Hotfix for Q193269" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/245/Q245816/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/245/Q245816/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q245816: SMS: Screen Saver Disabled After Applying the Hotfix for Q193269","url":"http://jeffpar.github.io/kbarchive/kb/245/Q245816/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q245816-sms-screen-saver-disabled-after-applying-the-hotfix-for-q193269">Q245816: SMS: Screen Saver Disabled After Applying the Hotfix for Q193269</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q245816
Product(s): Microsoft Systems Management Server
Version(s): winnt:1.2
Operating System(s): 
Keyword(s): kbsms120 kbsms120bug
Last Modified: 06-AUG-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server version 1.2 
-------------------------------------------------------------------------------

SYMPTOMS
========

After you apply the hotfix that is described in the following Microsoft
Knowledge Base article, the screen saver on clients running Microsoft Windows 95
or Microsoft Windows 98 may not start:

  Q193269 SMS: Remote Control to Win9x Clients Fails w/Winsock2, Using IP

This problem occurs only if you start Wuser9x.exe and then quit it by using the
Close button (X) in the Remote Control Status dialog box.

RESOLUTION
==========

A supported fix is now available from Microsoft, but it is only intended to
correct the problem that is described in this article. Only apply it to systems
that are experiencing this specific problem. This fix may receive additional
testing. Therefore, if you are not severely affected by this problem, Microsoft
recommends that you wait for the next Systems Management Server service pack
that contains this fix.

To resolve this problem immediately, contact Microsoft Product Support Services
to obtain the fix. For a complete list of Microsoft Product Support Services
phone numbers and information about support costs, visit the following Microsoft
Web site:

  http://support.microsoft.com/default.aspx?scid=fh;EN-US;CNTACTMS

NOTE: In special cases, charges that are ordinarily incurred for support calls
may be canceled if a Microsoft Support Professional determines that a specific
update will resolve your problem. The usual support costs will apply to
additional support questions and issues that do not qualify for the specific
update in question.

The English version of this fix should have the following file attributes or
later:

  Date      Time     Size    File name    Platform
  ------------------------------------------------
  04/14/99  10:24pm  202,476 Cli_dos.exe  Intel
  07/12/99  08:25pm   12,288 Coexst9x.dll Intel
  03/23/00  07:09pm  293,979 Idisp9x.dll  Intel
  03/23/00  07:25pm    8,464 Idispthk.dll Intel
  03/23/00  07:09pm  127,804 Imp9x.dll    Intel
  03/23/00  07:09pm  149,636 Loc16vc0.dll Intel
  06/11/98  02:33pm  110,256 Mergemap.exe Intel
  03/23/00  07:25pm   84,112 Multpr9x.dll Intel
  03/23/00  07:25pm   38,320 Queue9x.dll  Intel
  06/03/96  06:49am  117,008 Sendcode.exe Intel
  06/26/98  05:29pm      317 Shutdown.ctl 
  03/23/00  07:10pm    8,024 Vuser9x.vxd  Intel
  03/23/00  07:09pm   63,344 Woudat9x.dll Intel
  04/11/00  07:46pm  266,208 Wuser9x.exe  Intel
  03/23/00  07:09pm   15,768 _Idisp9x.dll Intel
  03/23/00  07:25pm   91,584 _Wuser9x.dll Intel
  04/28/99  05:50pm    3,525 Cl_w95.mod   Intel
  05/11/00  05:27pm  248,057 Hotfix.map
  03/23/00  03:26pm  333,008 Sightnt.dll  Intel
  03/23/00  07:24pm   36,800 Wumsg9x.dll  Intel

  06/11/98  02:35pm  330,000 Mergemap.exe Alpha
  07/23/96  04:40am  499,472 Sendcode.exe Alpha
  03/23/00  03:27pm  649,488 Sightnt.dll  Alpha   

NOTE: Due to file dependencies, the most recent hotfix or feature that contains
the above files may also contain additional files.



WORKAROUND
==========

To work around this problem, quit Wuser9x.exe by using the following command:

  wuser9x.exe /x

STATUS
======

Microsoft has confirmed this to be a problem in Systems Management Server
version 1.2.

MORE INFORMATION
================

To install the hotfix, use the appropriate method.

Using the Hotfix Installer
--------------------------

NOTE: This method is only for Intel-based Systems Management Server (SMS) site
server computers.

1. Copy the hotfix folder structure to a share on your network. Q245816.exe is a
  Microsoft Windows Installer file that updates specific files on your site
  server.

2. Log on to your site server using an account with administrative privileges.

3. Run Q245816.exe and follow the instructions in the wizard.

Manual Installation
-------------------

For a manual installation, you must:

- Stop the SMS site services.

- Copy the Windows 95/Windows 98 remote control files to the site server.

- Modify the System.map file to support the new files.

- Restart the SMS site services, and allow the site to propagate the changes to
  the rest of the site.

- Upgrade the clients.

To do this, follow these steps:

1. Stop the SMS_EXECUTIVE, SMS_SITE_CONFIG_MANAGER, and SMS_HIERARCHY_MANAGER
  SMS server services on the site server.

2. Copy the following files to your site server's
  Sms\Site.srv\Maincfg.box\Client.src\X86.bin folder:

  Cli_dos.exe
  Coexst9x.dll
  Idisp9x.dll
  Idispthk.dll
  Imp9x.dll
  Loc16vc0.dll
  Multpr9x.dll
  Queue9x.dll
  Vuser9x.vxd
  Woudat9x.dll
  Wuser9x.exe

3. Copy the following files to your site server's
  Sms\Site.srv\Maincfg.box\Client.src\X86.bin\&lt;Language&gt; folder:

  Cl_w95.mod
  Wumsg9x.dll
  _Idisp9x.dll
  _Wuser9x.dll

4. Copy the following file to your site server's Sms\Site.srv\&lt;Platform&gt;
  folder:

  Sightnt.dll

5. Make a backup copy of the current System.map file.

6. You must remove 16-bit Wuser support for Windows 95/Windows 98. To do this,
  scan the System.map file looking for the Wuser.exe entry in the section
  titled:

  DIRECTORY "SITE.SRV\MAINCFG.BOX\CLIENT.SRC\X86.BIN" PLATFORM "INTEL X86"
  LANGUAGE "" SOURCE "X86\INTNL" FLAGS = 10 UNIT = "INTEL CLIENT"

7. Remove Wuser.exe from the WIN95 CopyList entry. To do this, locate the line
  for Wuser.exe. Change the following line from

  REMOTE=YES, COPYLISTS("WIN16:REMOTE_CONTROL" = "SMS", "WIN95:REMOTE_CONTROL"
  = "SMS"), COMPRESS=NO, FLAGS = 5

to:

  REMOTE=YES, COPYLISTS("WIN16:REMOTE_CONTROL" = "SMS"), COMPRESS=NO, FLAGS = 5

8. Remove Vuser.386 from the WIN95 CopyList entry. To do this, locate the line
  for Vuser.386. Change the following line from

  REMOTE=YES, COPYLISTS("WIN16:REMOTE_CONTROL_386" = "WINDIR",
  "WIN95:REMOTE_CONTROL_386" = "WINDIR"), COMPRESS=NO, FLAGS = 1

to:

  REMOTE=YES, COPYLISTS("WIN16:REMOTE_CONTROL_386" = "WINDIR"), COMPRESS=NO,
  FLAGS = 1

9. You must remove 16-bit Wuser support for Windows 95/98. To do this, scan the
  System.map file, looking for the _wuser.dll entry in the section titled:

  DIRECTORY "SITE.SRV\MAINCFG.BOX\CLIENT.SRC\X86.BIN\00000409" PLATFORM "INTEL
  X86" LANGUAGE "ENGLISH" SOURCE "X86\ENGLISH" FLAGS = 10 UNIT = "INTEL CLIENT"

10. Remove _wuser.dll from the WIN95 CopyList entry. To do this, locate the line
  for _wuser.dll. Change the following line from

  REMOTE=YES, COPYLISTS("WIN16:REMOTE_CONTROL" = "SMS", "WIN95:REMOTE_CONTROL"
  = "SMS"), COMPRESS=NO, FLAGS = 5

to:

  REMOTE=YES, COPYLISTS("WIN16:REMOTE_CONTROL" = "SMS"), COMPRESS=NO, FLAGS = 5

11. Merge the new additions that are located in the enclosed Hotfix.map file.
  The headers for each section in the Hotfix.map file are included for
  reference, but you only need to merge the new lines into the appropriate
  matching section in the System.map file.

  NOTE: Pay attention to these headers because some may look similar but are
  not the same. Look for Wuser.exe on an Intel platform and Wusermsg.dll for
  the same platform, and then merge into those areas.

12. Restart the SMS services on the site server.

13. Wait for the copylist files to be upgraded from the System.map file. This
  should take about 10 minutes on an average site.

14. Run Runsms, Smsls, or Upgrade to install or upgrade the Windows 95/Windows
  98 client.

Additional query words: prodsms winsock

======================================================================
Keywords          : kbsms120 kbsms120bug 
Technology        : kbSMSSearch kbSMS120
Version           : winnt:1.2
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>