<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q291845: Malformed WebDAV Request Can Cause IIS to Exhaust CPU Resources | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q291845: Malformed WebDAV Request Can Cause IIS to Exhaust CPU Resources" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/291/Q291845/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/291/Q291845/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q291845: Malformed WebDAV Request Can Cause IIS to Exhaust CPU Resources","url":"http://jeffpar.github.io/kbarchive/kb/291/Q291845/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q291845-malformed-webdav-request-can-cause-iis-to-exhaust-cpu-resources">Q291845: Malformed WebDAV Request Can Cause IIS to Exhaust CPU Resources</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q291845
Product(s): Internet Information Server
Version(s): 5.0
Operating System(s): 
Keyword(s): kbWin2000PreSP2Fix kbWin2000SP2Fix
Last Modified: 08-MAY-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Services version 5.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

World Wide Web Distributed Authoring and Versioning (WebDAV) is an extension to
the HTTP protocol that allows remote authoring and management of Web content. In
the Windows 2000 implementation of the protocol, Microsoft Internet Information
Services (IIS) 5.0 performs the initial processing of all WebDAV requests, and
then forwards the appropriate commands to the WebDAV process. However, a flaw
exists in the way WebDAV handles a particular type of malformed request. If a
stream of such malformed requests is directed at an affected server, it consumes
all CPU availability on the server.

Mitigating Factors:

- The effect of an attack through this vulnerability is temporary. The server
  automatically resumes normal service as soon as the malformed requests stop
  arriving.

- This vulnerability does not provide an attacker with any capability to carry
  out WebDAV requests.

- This vulnerability does not provide any capability to compromise data on the
  server or gain administrative control over the server.

Microsoft recommends that customers apply the patch described in this article to
any servers running IIS 5.0. Although this includes Web servers, other services
may also require that IIS 5.0 be enabled. For example, Exchange 2000 Server uses
IIS 5.0 to provide Outlook Web Access (OWA) services. Therefore, computers
running Exchange 2000 Server that provide OWA services should implement the
patch to protect their IIS 5.0 services from this vulnerability.

RESOLUTION
==========

To resolve this problem, obtain the latest service pack for Windows 2000. For
additional information, please see the following article in the Microsoft
Knowledge Base:

  Q260910 How to Obtain the Latest Windows 2000 Service Pack

The English version of this fix should have the following file attributes or
later:

  Date        Time    Version      Size     File name
  -----------------------------------------------------
  03/12/2001  10:57a  0.9.3940.20  439,056  Httpext.dll

IMPORTANT: If you previously performed the workaround described in article
Q241520, the following dialog box may be displayed when you install this fix:

  Copy Error Setup cannot copy the file httpext.dll. Ensure that the location
  specified below is correct, or change it and insert 'Windows 2000 System
  Files' in the drive you specify. Copy files from: (drop down box below)
  c:\%windir%\system32\inetsrv

To bypass this dialog box, follow these steps to re-enable WebDAV:

1. Open Windows Explorer.

2. Go to your %SystemRoot%\System32\Inetsrv folder.

3. Right-click your Httpext.dll file, and then click Properties.

4. Click the Security tab.

5. Select Everyone, and then click Remove.

6. Select the Allow inheritable permissions from parent to propagate to this
  object check box, and then click Apply.

7. Click OK to exit the Properties dialog box.


WORKAROUND
==========

For additional information about how to work around this problem, click the
article number below to view the article in the Microsoft Knowledge Base:

  Q241520 How to Disable WebDAV for IIS 5.0

STATUS
======

Microsoft has confirmed this to be a problem in Microsoft Windows 2000. This
problem was first corrected in Windows 2000 Service Pack 2.

MORE INFORMATION
================

For more information on this vulnerability, see the following Microsoft Web
site:

  http://www.microsoft.com/technet/security/bulletin/ms01-016.asp

For additional information about how to install Windows 2000 and Windows 2000
hotfixes at the same time, click the article number below to view the article in
the Microsoft Knowledge Base:

  Q249149 Installing Microsoft Windows 2000 and Windows 2000 Hotfixes

Additional query words: DoS denial of service security_patch DAV distributed authoring and versioning

======================================================================
Keywords          : kbWin2000PreSP2Fix kbWin2000SP2Fix 
Technology        : kbiisSearch kbiis500
Version           : :5.0
Hardware          : x86
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>