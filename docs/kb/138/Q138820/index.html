<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q138820: BUG: Button Image on the Toolbar Appears Incomplete | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q138820: BUG: Button Image on the Toolbar Appears Incomplete" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/138/Q138820/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/138/Q138820/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q138820: BUG: Button Image on the Toolbar Appears Incomplete","url":"http://jeffpar.github.io/kbarchive/kb/138/Q138820/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q138820-bug-button-image-on-the-toolbar-appears-incomplete">Q138820: BUG: Button Image on the Toolbar Appears Incomplete</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q138820
Product(s): Microsoft Visual Basic for Windows
Version(s): 4.00
Operating System(s): 
Keyword(s): kbbuglist kbfixlist
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Standard Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition, 16-bit, for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 16-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 32-bit, for Windows, version 4.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

Some portions of the image on a toolbar button do not appear and as a result the
button image appears incomplete.

CAUSE
=====

By default, the MaskColor property of the ImageList control is set to black.
This causes the black portions of images on toolbar buttons (or any other
control that uses an ImageList) to be masked out and not appear.

RESOLUTION
==========

Use the color dialog box that appears when you change a color property to change
the MaskColor property of the ImageList that is bound to the toolbar to color
other than black. Toolbar buttons that have already been created will not change
color at design time unless they are refreshed by having one of their properties
modified. However, all buttons will appear correctly at run time.

STATUS
======

Microsoft has confirmed this to be an issue in the Microsoft products listed at
the beginning of this article. This problem has been corrected in the Visual
Basic version 4.0a for Windows synchronization release.

MORE INFORMATION
================

Steps to Reproduce Behavior
---------------------------

1. Start a new project in Visual Basic. Form1 is created by default.

2. Double-click the Toolbar button in the toolbox to create a new instance of
  the Toolbar control, called Toolbar1.

3. Double-click the ImageList button in the toolbox to create a new instance of
  the ImageList control, called ImageList1.

4. Right-click the toolbar control to bring up the Properties dialog box. Change
  the ImageList property in the General tab to ImageList1. Click the Buttons
  tab, and click Insert Button to add a button to the toolbar.

5. Right-click the ImageList control to bring up its properties. Click the
  Images tab, and then click Insert Picture to insert a button image. (Look in
  \Vb\Bitmaps\Tlbr_w95 for sample bitmaps.)

6. Right-click Toolbar1, and then click the Buttons Tab. The Image property of
  the first button is set to 0 by default. Change it to a value of 1 to link
  the first button with the first image in ImageList1.

The image you have selected will appear on the toolbar; however, all black
portions of the button will be masked out and will not appear. To fix this,
change the MaskColor property of ImageList1 to a value other than black
(remember that changes will only take effect if the toolbar is refreshed or if
the program is run).

Every image in an ImageList collection has a corresponding mask associated with
it. The mask is a monochrome image derived from the image itself, automatically
generated using the MaskColor property as the specific color of the mask. This
mask is not used directly, but is applied to the original bitmap in graphical
operations such as the Overlay and Draw methods. For example, the MaskColor
property determines which color of an image will be transparent in the Overlay
method.

REFERENCES
==========

Custom Control Reference in the Visual Basic version 4.0 Help file.

Additional query words: 4.00 4.00a ImageList MaskColor vb4all vb4win

======================================================================
Keywords          :  kbbuglist kbfixlist
Technology        : kbVBSearch kbAudDeveloper kbVB400Search kbVB400 kbVB16bitSearch
Version           : 4.00
Issue type        : kbbug

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>