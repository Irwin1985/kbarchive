<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q138817: FIX: ODBC SDK May Overwrite Latest Version of Msvcrt20.dll | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q138817: FIX: ODBC SDK May Overwrite Latest Version of Msvcrt20.dll" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/138/Q138817/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/138/Q138817/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q138817: FIX: ODBC SDK May Overwrite Latest Version of Msvcrt20.dll","url":"http://jeffpar.github.io/kbarchive/kb/138/Q138817/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q138817-fix-odbc-sdk-may-overwrite-latest-version-of-msvcrt20dll">Q138817: FIX: ODBC SDK May Overwrite Latest Version of Msvcrt20.dll</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q138817
Product(s): Microsoft Visual Basic for Windows
Version(s): 4.00
Operating System(s): 
Keyword(s): kbDatabase kbODBCkbbuglist
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Standard Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition, 16-bit, for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 16-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 32-bit, for Windows, version 4.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

If Visual Basic 4.0 is already installed before you install the ODBC SDK, Visual
Basic fails to start and gives this error message:

  The procedure entry point _adjust_fdiv could not be located in the dynamic
  link library Msvcrt20.dll

CAUSE
=====

The ODBC SDK versions 2.10a and earlier fail to check versions on the file
Msvcrt20.dll. It will blindly copy over any previously existing copy of the .dll
file. In this case, the ODBC SDK is copying Msvcrt20.dll version 2.00.000 over
the Msvcrt20.dll version 2.10.000 that comes with Visual Basic 4.0. Because
compiled applications use Msvcrt20.dll (it is a dependency of Vb40032.dll), this
problem may also affect compiled applications on computers that do not have the
Visual Basic 4.0 32-bit development environment installed.

The ODBC SDK also overwrites the Mfc300.dll file, but this file isn't included
with Visual Basic.

RESOLUTION
==========

Extract the newer version of the Msvcrt20.dll from your original Visual Basic
floppy disks or compact disc, and copy it over the old version installed by the
ODBC SDK. The extract.exe program (a new version of which comes with Visual
Basic) can be run using the following line to extract the file to the directory
you specify (replace the path after the '/l' switch):

     extract /e /l c:\temp vb4-1.cab msvcrt20.dll

For more information on Extract.exe, type 'extract /?' at the command prompt.

STATUS
======

Microsoft has confirmed this to be a bug in versions of the ODBC SDK earlier
than 2.10b. This problem was correct in version 2.10b and later.

Additional query words: 4.00 vb4win vb4all fixlist2.10b buglist2.10a

======================================================================
Keywords          : kbDatabase kbODBC kbbuglist
Technology        : kbVBSearch kbAudDeveloper kbVB400Search kbVB400 kbVB16bitSearch
Version           : 4.00
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>