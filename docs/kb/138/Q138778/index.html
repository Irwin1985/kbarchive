<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q138778: PRB: Numeric Value Not Written to Table from Text Box | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q138778: PRB: Numeric Value Not Written to Table from Text Box" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/138/Q138778/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/138/Q138778/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q138778: PRB: Numeric Value Not Written to Table from Text Box","url":"http://jeffpar.github.io/kbarchive/kb/138/Q138778/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q138778-prb-numeric-value-not-written-to-table-from-text-box">Q138778: PRB: Numeric Value Not Written to Table from Text Box</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q138778
Product(s): Microsoft FoxPro
Version(s): WINDOWS:3.0
Operating System(s): 
Keyword(s): 
Last Modified: 10-FEB-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, version 3.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you place the insertion point in the middle of numerical field on a form
and press ENTER, the displayed value becomes the integer value of the digits to
the left of the insertion point. For example, if the displayed field value is
12345.678, and you place the insertion point between the 2 and the 3 and press
ENTER, the new displayed value becomes 12.000. However, unlike the behavior when
directly editing a table in FoxPro 2.6, the value is not written to the table
after you press the ENTER key.

WORKAROUND
==========

A numerical field from a table added to a FoxPro for Windows, version 2.6 screen
displays the truncated results and writes the changes to the table as soon as
you move off of the field. In Visual FoxPro, if you manually change the field,
the ControlSource updates and changes are written to the table. To force Visual
FoxPro to behave as FoxPro 2.6 does, you must either use the REPLACE command or
enable data buffering. Both methods are discussed below.

Using the REPLACE Command to Edit the Table Directly
----------------------------------------------------

1. Add a text box to a form, and set its ControlSource property to a numerical
  field from a table.

2. In the LostFocus event of the text box, add these commands:

     REPLACE &lt;fieldname&gt; WITH This.Value
     This.Refresh

Data buffering
--------------

1. Set the BufferMode property of the form to either Optimistic or Pessimistic
  buffering.

2. Add a text box to a form, and set its ControlSource property to a numerical
  field from a table.

3. In the LostFocus event of the text box, add these commands:

     REPLACE &lt;fieldname&gt; WITH This.Value
     =TABLEUPDATE(.T.)

STATUS
======

Microsoft is researching this behavior and will post new information here in the
Microsoft Knowledge Base as it becomes available.

MORE INFORMATION
================

If you don't want to have Visual FoxPro write the changes to the table or
display the changed value, place the following code in the LostFocus event of
the textbox:

     This.Refresh

Steps to Reproduce Behavior
---------------------------

1. Add a numeric field from a table to a form.

2. Set the ControlSource of the text box to a numeric field from a table.

3. Add a two command buttons, one for Skip and one for Prior. For an example
  showing how to add navigation buttons or a toolbar to a form, please see the
  following article in the Microsoft Knowledge Base:

  Q130683 How to Create a General Purpose Reusable Navigation Toolbar

4. Run the form.

5. Place the insertion point between two numbers in the field, and press ENTER.

6. The value displayed in the field will truncate to the integer value that lies
  to the left of the insertion point.

7. To see the display value revert to previous value, move back onto the field.

8. To see that the new value was not written to table, move the record pointer
  by clicking Skip and then clicking Prior.

Additional query words: VFoxWin

======================================================================
Keywords          :  
Technology        : kbVFPsearch kbAudDeveloper kbVFP300
Version           : WINDOWS:3.0

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>