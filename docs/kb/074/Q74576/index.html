<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q74576: Communication Between EMM386.EXE and Windows | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q74576: Communication Between EMM386.EXE and Windows" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/074/Q74576/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/074/Q74576/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q74576: Communication Between EMM386.EXE and Windows","url":"http://jeffpar.github.io/kbarchive/kb/074/Q74576/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q74576-communication-between-emm386exe-and-windows">Q74576: Communication Between EMM386.EXE and Windows</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q74576
Product(s): Microsoft Disk Operating System
Version(s): MS-DOS:5.0
Operating System(s): 
Keyword(s): 
Last Modified: 19-NOV-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft MS-DOS operating system version 5.0 
-------------------------------------------------------------------------------

SUMMARY
=======

Both EMM386.EXE and Microsoft Windows version 3.0 in 386 enhanced mode use the
upper memory area (UMA) to emulate expanded memory on 80386 or faster
processors. To ensure that no conflicts occur, EMM386.EXE passes mapping
information for the UMA to Windows when Windows starts (when Windows starts, it
queries EMM386.EXE for this mapping information). Windows then sets up its page
tables to duplicate the EMM386.EXE mapping for this region and disables
EMM386.EXE, which ensures that when Windows attempts to load device drivers and
TSRs high, it will not conflict with what EMM386.EXE is using.

MORE INFORMATION
================

The communication between EMM386.EXE and Windows 3.0 has several important
implications:

- Using the NOEMS parameter with EMM386.EXE is functionally equivalent to
  adding EMMEXCLUDE=A000-EFFF to the [386ENH] section of the SYSTEM.INI file.
  No expanded memory will be available to MS-DOS applications running inside
  Windows.

  Note: The MEM command run under Windows 3.0 will return available expanded
  memory. This is LIM 4.0 memory and is not useful to MS-DOS applications
  running from Windows.

- Any hardware that requires an EMMEXCLUDE statement to run Windows (such as a
  network card, or the Stacker acceleration card) will also require that
  EMM386.EXE not use those addresses. Use the X= switch to exclude EMM386.EXE
  from using a specific address range. Multiple X= switches are supported by
  EMM386.EXE.

- If an EMMPAGEFRAME= line is added to the SYSTEM.INI, it should specify the
  same starting address that EMM386.EXE is using to create its page frame. The
  page frame for EMM386.EXE can be set using either the Mx or the FRAME=
  switch.

For more information on the SYSTEM.INI file, see the SYSINI.TXT, SYSINI2.TXT, or
SYSINI3.TXT file located by default in the Windows subdirectory.

For more information about EMM386.EXE, see the version 5.0 "Microsoft MS-DOS
User's Guide."

Additional query words: 5.00 noupd

======================================================================
Keywords          :  
Technology        : kbMSDOSSearch kbMSDOS500
Version           : MS-DOS:5.0

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>