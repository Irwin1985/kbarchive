<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q111737: Recovering Windows 3.1 After Installing WFWG 3.11 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q111737: Recovering Windows 3.1 After Installing WFWG 3.11" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/111/Q111737/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/111/Q111737/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q111737: Recovering Windows 3.1 After Installing WFWG 3.11","url":"http://jeffpar.github.io/kbarchive/kb/111/Q111737/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q111737-recovering-windows-31-after-installing-wfwg-311">Q111737: Recovering Windows 3.1 After Installing WFWG 3.11</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q111737
Product(s): Microsoft Windows 95.x Retail Product
Version(s): WINDOWS:3.1,3.11
Operating System(s): 
Keyword(s): 
Last Modified: 25-SEP-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows versions 3.1, 3.11 
- Microsoft Windows for Workgroups 
-------------------------------------------------------------------------------

Microsoft cannot guarantee this procedure will work in every situation. If
this procedure fails, you must reinstall Windows 3.1 and Windows-based
applications to a new directory.

SUMMARY
=======

After you install Windows for Workgroups version 3.11, it may be possible to
restore your installation of Microsoft Windows 3.1.

MORE INFORMATION
================

This procedure can be used only if you ran Windows for Workgroups Setup once. If
you ran Setup more than once, it is not possible to restore the original Windows
configuration files; therefore, Windows 3.1 must be reinstalled to an empty
directory. Also, any third-party software that replaces Windows virtual device
drivers (VxDs) may need to be reinstalled after you reinstall Windows 3.1.

If you did run Windows for Workgroups Setup one time only, and you want to
restore your Windows 3.1 installation, follow the steps below.

1. Start your machine with MS-DOS.

2. Edit the CONFIG.SYS and AUTOEXEC.BAT files to remove the Windows for
  Workgroups 3.11 IFSHLP.SYS and NET START lines. For example, remove
  "device=c:\windows\ifshlp.sys" from the CONFIG.SYS file and "c:\windows\net
  start" from the AUTOEXEC.BAT file.

3. Copy the WININI.W31 and SYSINI.W31 files from the Windows directory to a
  floppy disk.

4. Run Windows version 3.1 Setup and choose Custom Setup. A message then appears
  stating that Setup has found a previous version of Microsoft Windows on your
  system and recommends that you perform an upgrade. Specify the Windows for
  Workgroups directory as the target directory and press ENTER. When the System
  Information screen appears, change the "Network = Microsoft Windows Network
  (version 3.11)" entry to:

  Network = No Network Installed &lt;or the specific network in use&gt;

5. The Windows 3.1 Setup program detects some newer drivers (for example,
  COMM.DRV) and prompts you to replace them with the Windows 3.1 drivers. Press
  the ESC key to replace each file with the older version of the file.

6. After Setup loads Windows, it begins to copy files to your system. Setup
  again finds newer versions than those provided with Windows 3.1. Setup
  prompts you to keep or replace each file. Replace each file by choosing Yes
  when prompted.

  Setup finds version conflicts for the following files:

      SYSEDIT.EXE   DDEML.DLL    OLECLI.DLL  MAIN.CPL     TOOLHELP.DLL
      PRINTMAN.EXE  WINFILE.EXE  SHELL.DLL   COMMDLG.DLL  CLIPBRD.EXE
      WINOA386.MOD

7. From the floppy disk used in step 3, copy the WININI.W31 file to the Windows
  directory as WIN.INI and the SYSINI.W31 file to the Windows directory as
  SYSTEM.INI. For example, if your Windows directory is C:\WINDOWS and the
  floppy disk is in drive A, type the following two commands at the MS-DOS
  command prompt and press ENTER after each line:

  copy a:winini.w31 c:\windows\win.ini
  copy a:sysini.w31 c:\windows\system.ini

8. Reboot your computer and start Windows 3.1 by typing "win" (without the
  quotation marks) at the MS-DOS command prompt and then pressing ENTER.

9. Remove the program icons that were added by the Windows for Workgroups Setup
  program. To do so:

  a. Delete the following icon from the Main group:

  Clipbook Viewer

  b. Delete the Network group.

  c. Delete the Hearts icon from the Games group.

10. Remove the Windows for Workgroups 3.11 files below from the Windows
  directory and Windows SYSTEM subdirectory.

  Files in the Windows directory to delete:

   AWCAS.DLL       AWCLASS1.DLL     AWCLASS2.DLL   AWFAXIO.DLL
   AWFAXPROT.DLL   AWT30.DLL        CARDS.DLL      CLIPSRV.EXE
   &lt;DEPCA.DOS&gt;     DLLSCHED.DLL     EFAXPUMP.DLL   EFAXRUN.DLL
   FAXCODEC.DLL    FAXCOVER.DLL     FAXMGR.EXE     FAXEPT.DLL
   FAXVIEW.EXE     IFKERNEL.EXE     IFSHLP.SYS     IMPEXP.DLL
   KEYVIEW.EXE     LINEARIZ.DLL     LOGONOFF.EXE   MSFAX.HLP
   MSHEARTS.EXE    MSHEARTS.HLP     MSMAIL.EXE     MSMAIL.HLP
   MSMAIL.INI      MSMAIL.MMF       MSREMIND.EXE   MSSCHED.DLL
   NCDINFO.INI     NDDENB.DLL       NDISHLP.SYS    NET.EXE
   NET.MSG         NETDDE.EXE       NETFAX.DLL     NETH.MSG
   NETWATCH.EXE    NETWATCH.HLP     RINGIN.WAV     RINGOUT.WAV

  NOTE: The file DEPCA.DOS in the list above is a network interface card (NIC)
  driver for a DEC Etherworks Turbo/TP Network Adapter. The NIC driver for
  your particular network card may be different.

  Files in the Windows SYSTEM subdirectory to delete:

   AB.DLL          CMC.DLL          COMMCTRL.DLL   &lt;DECLAN.386&gt;
   DEMILAYR.DLL    EFAXDRV.DRV      FAX.CPL        FAXNSP.DLL
   FAXSTUB.DLL     FRAMEWRK.DLL     IFSMGR.386     IOS.386
   LM21DRV.UPD     LMSCRIPT.EXE     LMSCRIPT.PIF   LPT.386
   MAILMGR.DLL     MAILSPL.EXE      MAPI.DLL       MSSFS.DLL
   NCDW.DLL        NDDEAPI.DLL      NDIS.386       NDIS2SUP.386
   NETBEUI.386     NETWORK.INF      NWLINK.386     NWNBLINK.386
   PABNSP.DLL      RMM.D32          SCONFIG.DLL    SENDFILE.DLL
   SERIAL.386      STORE.DLL        UNIDRV.DLL     UNIDRV.HLP
   VCACHE.386      VCOMM.386        VFAT.386       VFORMS.DLL
   VNETSUP.386     VPMTD.386        VREDIR.386     VSERVER.386
   VSHARE.386      VXDLDR.386       WFWAUDIT.386   WFWNET.DRV
   WFWSETUP.DLL    WINNET.INF

  NOTE: The file DECLAN.386 in the list above is the 386 enhanced mode version
  of the network interface card (NIC) referenced in the section above. The NIC
  driver for your particular network card may be different.

11. Quit and then restart Windows.

12. Correct the Windows Setup icon command line.

  a. From the Program Manager Main group, select Windows Setup either by using
     the keyboard or by clicking the icon once (do not double-click the Setup
     icon).

  b. From the File menu, choose Properties.

  c. Change the Command Line entry from WINSETUP.EXE to SETUP.EXE.

  d. Choose OK.

After you follow these steps, Windows 3.1 should be successfully reinstalled.
However, if Windows 3.1 does not perform as expected (for example, you receive
error messages or the system stops responding [hangs]), you must reinstall
Windows 3.1 and all Windows-based software to a new directory.

Additional query words: 3.10 3.1 3.11 uninstall un-install deinstall remove recover

======================================================================
Keywords          :  
Technology        : kbAudDeveloper kbWin3xSearch kbWFWSearch kbZNotKeyword3 kbWin310 kbWin311
Version           : WINDOWS:3.1,3.11

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>