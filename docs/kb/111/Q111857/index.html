<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q111857: SMTP: Missing Attachment Name in Client when Using PMDF Mailer | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q111857: SMTP: Missing Attachment Name in Client when Using PMDF Mailer" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/111/Q111857/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/111/Q111857/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q111857: SMTP: Missing Attachment Name in Client when Using PMDF Mailer","url":"http://jeffpar.github.io/kbarchive/kb/111/Q111857/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q111857-smtp-missing-attachment-name-in-client-when-using-pmdf-mailer">Q111857: SMTP: Missing Attachment Name in Client when Using PMDF Mailer</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q111857
Product(s): Microsoft Mail For PC Networks
Version(s): 
Operating System(s): 
Keyword(s): 
Last Modified: 30-JUL-2001

SYMPTOMS
========

Upon opening an attachment of a message from SMTP, the attachment name may not
be found if the TCP/IP mail routing host used a PMDF mailer. The attachment
itself is not lost, and is viewable.

CAUSE
=====

The problem is in the RFC 822 header fields, and the order in which they appear.
When using the PMDF mailer on the TCP/IP mail routing host, the
"X-MS-Attachment" header line is re-ordered to appear before the "Encoding"
header line. The SMTP gateway uses the "Encoding" header to build up a link list
to describe the attachments and then fills in the file attributes later when it
parses the "X-MS-Attachment" lines. If these two lines appear in the wrong
order, the link list does not exist when the "X-MS-Attachment" header lines are
being parsed. The gateway then ignores these lines, losing the names of any
attachments.

Looking at a log file generated by starting the SMTP gateway with the "-cd" and
"-lacsy" switches, the incorrect header fields appear as:

13:22:41 - Sending message to Microsoft Mail
13:22:42 - Header: Return-Path: &lt;root@company.com&gt;
13:22:42 - Header: Received: from company.com by smtp-gateway.company.com
13:22:42 - Header: id &lt;2C431991@smtp-gateway.company.com&gt;; Tue, 13 Jul 93
13:22:41 PDT
13:22:42 - Header: Date: Tue, 13 Jul 1993 13:22:00 -0700 (PDT)
13:22:42 - Header: From: Root &lt;root@company.com&gt;
13:22:42 - Header: Subject: Testing word attachment thru SMTPgate
13:22:42 - Header: To: "ROOT (COMPANY)" &lt;root@company.oom&gt;
13:22:42 - Header: X-Mailer: Microsoft Mail V3.0
13:22:42 - Header: X-MS-Attachment: smtptest.doc 1024 07-13-1993 13:20
13:22:42 - Header: Encoding: 2 TEXT, 29 UUENCODE
13:22:42 - Header:

A correct set of headers should look like this:

13:22:41 - Sending message to Microsoft Mail
13:22:42 - Header: Return-Path: &lt;root@company.com&gt;
13:22:42 - Header: Received: from company.com by smtp-gateway.company.com
13:22:42 - Header: id &lt;2C431991@smtp-gateway.company.com&gt;; Tue, 13 Jul 93
13:22:41 PDT
13:22:42 - Header: Date: Tue, 13 Jul 1993 13:22:00 -0700 (PDT)
13:22:42 - Header: From: Root &lt;root@company.com&gt;
13:22:42 - Header: Subject: Testing word attachment thru SMTPgate
13:22:42 - Header: To: "ROOT (COMPANY)" &lt;root@company.oom&gt;
13:22:42 - Header: X-Mailer: Microsoft Mail V3.0
13:22:42 - Header: Encoding: 2 TEXT, 29 UUENCODE
13:22:42 - Header: X-MS-Attachment: smtptest.doc 1024 07-13-1993 13:20
13:22:42 - Header:

RESOLUTION
==========

Obtain the latest version of PMDF, from Innosoft. The latest version no longer
re-orders the headers.

Additional query words: 3.00 attachment pmdf SMTP

======================================================================
Keywords          :  

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>