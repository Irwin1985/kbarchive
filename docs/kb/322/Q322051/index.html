<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q322051: Programs May Not Connect to Server with Mismatched Security DLLs | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q322051: Programs May Not Connect to Server with Mismatched Security DLLs" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/322/Q322051/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/322/Q322051/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q322051: Programs May Not Connect to Server with Mismatched Security DLLs","url":"http://jeffpar.github.io/kbarchive/kb/322/Q322051/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q322051-programs-may-not-connect-to-server-with-mismatched-security-dlls">Q322051: Programs May Not Connect to Server with Mismatched Security DLLs</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q322051
Product(s): Microsoft Windows NT
Version(s): 4.0,4.0 SP6a
Operating System(s): 
Keyword(s): kbWinNT400nospFix
Last Modified: 03-JUN-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows NT Server versions 4.0, 4.0 SP6a 
-------------------------------------------------------------------------------

SYMPTOMS
========

After you install the Microsoft Windows 2000 Security Rollup Package (SRP) or
you use NTLM version 2 to connect to a Windows NT 4.0-based server with the SRP
installed, your programs may not connect to the server.

CAUSE
=====

Installing the SRP on Windows NT 4.0 with the 56-bit version of Service Pack 6a
(SP6a) and Microsoft Internet Explorer 6 can cause the following mismatched
dynamic-link libraries (DLLs) to be installed:

  Schannel.dll
  Ntlmssps.dll

This causes the Windows NT 4.0-based server to negotiate a 128-bit connection.
However, the 56-bit security DLLs cannot decrypt the packets. The Windows 2000
SRP forces NTLM version 2 connections with the Windows NT 4.0-based server.

RESOLUTION
==========

A supported fix is now available from Microsoft, but it is only intended to
correct the problem described in this article and should be applied only to
systems experiencing this specific problem.

To resolve this problem, contact Microsoft Product Support Services to obtain the
fix. For a complete list of Microsoft Product Support Services phone numbers and
information on support costs, please go to the following address on the World
Wide Web:

  http://support.microsoft.com/default.aspx?scid=fh;EN-US;CNTACTMS

NOTE: In special cases, charges that are normally incurred for support calls may
be canceled, if a Microsoft Support Professional determines that a specific
update will resolve your problem. Normal support costs will apply to additional
support questions and issues that do not qualify for the specific update in
question.

The English version of this fix has the file attributes (or later) that are
listed in the following table. The dates and times for these files are listed in
coordinated universal time (UTC). When you view the file information, it is
converted to local time. To find the difference between UTC and local time, use
the Time Zone tab in the Date and Time tool in Control Panel.

  Date         Time   Size    File name     Platform
  --------------------------------------------------------
  16-Jul-2001  12:05  36,112  Ntlmssps.dll  I386 - 128-bit
  23-Sep-1999  11:04  59,152  Security.dll  I386 - 128-bit
  16-Jul-2001  12:05  36,112  Ntlmssps.dll  I386 - 56-bit
  18-Nov-1999  12:04  59,152  Security.dll  I386 - 56-bit

NOTE: Because of file dependencies, this hotfix requires Microsoft Windows NT 4.0
Service Pack 6a.



WORKAROUND
==========

To work around this problem, install the hotfix that is mentioned in the
"Resolution" section. This upgrades the computer to 128-bit security.

If you must use the 56-bit versions of the DLLs in Windows NT 4.0, you can
manually replace the Schannel.dll and Ntlmssps.dll files with the 56-bit
versions from the SRP:

1. Extract the files from the SRP. Use this command "q299444i -x".

2. Rename the current Schannel.dll and Ntlmssps.dll files in the
  %SystemRoot%\System32 folder.

3. Copy the SRP versions of the Schannel.dll and Ntlmssps.dll files to the
  %SystemRoot%\System32 folder.

STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products that are
listed at the beginning of this article.

MORE INFORMATION
================

This problem may occur with Microsoft Exchange 5.5 administrative programs
connecting to Exchange 5.5-based servers. This causes the following error
message:

  DS_E_COMMUNICATION_PROBLEMS


For additional information, click the article number below to view the article in
the Microsoft Knowledge Base:

  Q311401 Windows 2000 Security Rollup Package 1 (SRP1), January 2002


For additional information about how to install multiple hotfixes with only one
reboot, click the article number below to view the article in the Microsoft
Knowledge Base:

  Q296861 Use QChain.exe to Install Multiple Hotfixes with One Reboot

Additional query words:

======================================================================
Keywords          : kbWinNT400nospFix 
Technology        : kbWinNTsearch kbWinNT400search kbWinNTSsearch kbWinNTS400sp6 kbWinNTS400search kbWinNTS400
Version           : :4.0,4.0 SP6a
Hardware          : ALPHA x86
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>