<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q201378: HOWTO: Remove a Virus From a File in Visual SourceSafe | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q201378: HOWTO: Remove a Virus From a File in Visual SourceSafe" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/201/Q201378/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/201/Q201378/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q201378: HOWTO: Remove a Virus From a File in Visual SourceSafe","url":"http://jeffpar.github.io/kbarchive/kb/201/Q201378/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q201378-howto-remove-a-virus-from-a-file-in-visual-sourcesafe">Q201378: HOWTO: Remove a Virus From a File in Visual SourceSafe</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q201378
Product(s): Microsoft SourceSafe
Version(s): WINDOWS:5.0,6.0
Operating System(s): 
Keyword(s): kbSSafe500 kbSSafe600 kbSSExplorer
Last Modified: 01-MAY-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual SourceSafe for Windows, versions 5.0, 6.0 
-------------------------------------------------------------------------------

SUMMARY
=======

Your standard virus checker can be applied to the Visual SourceSafe data
directory, and in most cases it finds viruses if they exist. Since Visual
SourceSafe uses Reverse Deltas to recreate previous versions only, the last
checked-in copy exists in its entirety. This could cause problems if a virus
exists in an older version. The virus may not be recognizable to the virus
checker since the complete "signature" of the virus may not be read.

Depending on where in the history of the file the virus was introduced, some or
all of the history may need to be removed. This ensures that no one gets an old,
infected copy.

MORE INFORMATION
================

The following provides a few scenarios of versions of a Visual SourceSafe file
infected with a virus and recommended methods on how to clean them.

1. If your case is:

Version 6-Clean
Version 5-Clean
Version 4-Clean
Version 3-Infected
Version 2-Infected
Version 1-Infected

Use the Archive utility to remove versions 1-3. Be sure to store and/or name the
archive file appropriately so that no one attempts to restore it.

2. If your case is:

Version 6-Infected
Version 5-Infected
Version 4-Infected
Version 3-Infected
Version 2-Clean
Version 1-Clean

You can use the rollback functionality from the Show History dialog box to
destroy versions 3-6. Then check out (latest version is now 2), and copy over a
cleaned version of 6, and then check it back in.

3. If your case is:

Version 6-Clean
Version 5-Clean
Version 4-Infected
Version 3-Infected
Version 2-Clean
Version 1-Clean

The best solution is to destroy and re-add the file back to Visual SourceSafe.
But if you want to preserve the clean versions, you need to take a few extra
steps. These versions do not have the same Time/Date stamps as they had
originally and would be numbered versions 1,2, 3, and 4.

First, do a Get on versions 5 and 6 to preserve the contents, and then follow the
method described in Case #2. In the last part of that method, check out version
2 and replace version 5 first, check it in, and then check it out again. Replace
version 6, check it in, etc. This could be a time-consuming task if many more
clean versions exist after the last infected version.

REFERENCES
==========

Search "archiving" from the SSAdmin online help for more information regarding
the Archive utility.

Additional query words: kbDSupport

======================================================================
Keywords          : kbSSafe500 kbSSafe600 kbSSExplorer 
Technology        : kbSSafeSearch kbAudDeveloper kbSSafe600 kbSSafe500
Version           : WINDOWS:5.0,6.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>