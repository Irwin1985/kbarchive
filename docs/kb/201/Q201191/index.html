<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q201191: PRB: Registering ATL Server Causes 0x80040154 Error | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q201191: PRB: Registering ATL Server Causes 0x80040154 Error" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/201/Q201191/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/201/Q201191/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q201191: PRB: Registering ATL Server Causes 0x80040154 Error","url":"http://jeffpar.github.io/kbarchive/kb/201/Q201191/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q201191-prb-registering-atl-server-causes-0x80040154-error">Q201191: PRB: Registering ATL Server Causes 0x80040154 Error</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q201191
Product(s): Microsoft C Compiler
Version(s): 2.0,2.1,3.0,5.0,6.0
Operating System(s): 
Keyword(s): kbActiveX kbATL200 kbATL210 kbCOMt kbCtrlCreate kbInprocSvr kbRegistry kbVC500 kbVC600
Last Modified: 26-JUL-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- The Microsoft Active Template Library (ATL), versions 2.0, 2.1, 3.0, included with:
   - Microsoft Visual C++, 32-bit Enterprise Edition, versions 5.0, 6.0 
   - Microsoft Visual C++, 32-bit Professional Edition, versions 5.0, 6.0 
   - Microsoft Visual C++, 32-bit Learning Edition, version 6.0 
   - Microsoft Visual C++.NET (2002) 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you register an ATL server, you might get error 0x80040154 (Class not
registered). For DLLs, REGSVR32.exe returns this error. For .exes, the call to
_Module::RegisterServer(CComModule::RegisterServer) in _tWinMain() returns this
error.

CAUSE
=====

ATL70.dll is not installed, or it is not registered.

NOTE: For Visual Studio 6.0 and earlier, the ATL runtime is contained in ATL.dll.
If you are using Visual Studio 6.0 or earlier, use ATL.dll instead of the later
Visual Studio .NET version.

RESOLUTION
==========

Install ATL70.dll (or ATL.dll for earlier versions of Visual Studio) in the
Windows\System or Winnt\System32 directory, and then register it by using
Regsvr32.exe. There are UNICODE and ANSI versions of ATL70.dll and ATL.dll.
Install the appropriate version on the target operating system (that is, UNICODE
for Microsoft Windows NT, and ANSI for Microsoft Windows 95 or Microsoft Windows
98).

NOTE: The following steps apply only to Visual Studio 6.0 and earlier. Visual
Studio .NET does not have a MinDependency build target.

As an alternative, do not use ATL.dll. When you rebuild your ATL server with a
build target of ReleaseMinDependency, the code in ATL.dll is statically linked
to your project.

Even for a 'Release MinDependency' ATL.dll may need to be shipped.

For additional information, click the article number below to view the article in
the Microsoft Knowledge Base:

  Q244955 PRB: MinDependency Project May Need to Include Atl.dll

STATUS
======

This behavior is by design.

MORE INFORMATION
================

ATL has a registrar component that is used during registration. This component
resides in ATL.dll. During registration, the error 0x80040154 is returned from
CoCreateInstance() when it fails to create the registrar component.

Location of ATL.DLL in the Visual C++ 5.0 CD::

OS\SYSTEM (UNICODE version)
OS\SYSTEM\ANSI (ANSI version)

Location of ATL.DLL in the Visual C++ 6.0 CD::

DevStudio\VC\Redist (UNICODE version)
DevStudio\VC\Redist\Ansi (ANSI version)

Location of ATL70.DLL in the Visual C++ .NET CD::

Win\System (UNICODE version)
Win\System\ansi (ANSI version)

REFERENCES
==========

MSDN Library: Registrar, ATL Registry Component; Regsvr32, using

(c) Microsoft Corporation 1999, All Rights Reserved. Contributions by Samson
Tanrena, Microsoft Corporation.


Additional query words: REGDB_E_CLASSNOTREG

======================================================================
Keywords          : kbActiveX kbATL200 kbATL210 kbCOMt kbCtrlCreate kbInprocSvr kbRegistry kbVC500 kbVC600 kbATL300 kbFAQ 
Technology        : kbVCsearch kbAudDeveloper kbATLsearch
Version           : :2.0,2.1,3.0,5.0,6.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>