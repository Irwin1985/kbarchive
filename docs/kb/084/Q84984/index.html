<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q84984: DOC: List of Functions That Are Valid in Metafiles | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q84984: DOC: List of Functions That Are Valid in Metafiles" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/084/Q84984/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/084/Q84984/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q84984: DOC: List of Functions That Are Valid in Metafiles","url":"http://jeffpar.github.io/kbarchive/kb/084/Q84984/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q84984-doc-list-of-functions-that-are-valid-in-metafiles">Q84984: DOC: List of Functions That Are Valid in Metafiles</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q84984
Product(s): Microsoft Windows Software Development Kit
Version(s): WINDOWS:3.1
Operating System(s): 
Keyword(s): kbdocfix kb16bitonly kbSDKWin16
Last Modified: 26-JUN-1999

3.00 3.10
WINDOWS
kbprg kbdocerr

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows Software Development Kit (SDK) 3.1 
-------------------------------------------------------------------------------

SUMMARY
=======

Pages 2-41 and 2-42 of the "Microsoft Windows Software Development Kit (SDK)
Reference Volume 1" for version 3.0 list the subset of Windows GDI functions
that an application can use in a metafile under Windows 3.0. The list printed in
the manual is incorrect.

Page 107 of the "Microsoft Windows Software Development Kit: Programmer's
Reference, Volume 1: Overview," lists the functions that are valid in a metafile
for Windows 3.1. This list is incomplete.

This article provides a corrected list of functions that an application can use
in a metafile under Windows 3.1.

MORE INFORMATION
================


The following list of functions that are valid in a Windows 3.1 metafile is taken
from page 107 of the "Windows SDK: Programmer's Reference, Volume 1: Overview":

AnimatePalette           OffsetViewportOrg   SetBkMode
Arc                      OffsetWindowOrg     SetDIBitsToDevice
BitBlt                   PatBlt              SetMapMode
Chord                    Pie                 SetMapperFlags
CreateBrushIndirect      Polygon             SetPixel
CreateDIBPatternBrush    Polyline            SetPolyFillMode
CreateFontIndirect       PolyPolygon         SetROP2
CreatePatternBrush       RealizePalette      SetStretchBltMode
Ellipse                  RestoreDC           SetTextColor
Escape                   RoundRect           SetTextJustification
ExcludeClipRect          SaveDC              SetViewportExt
ExtTextOut               ScaleViewportExt    SetViewportOrg
FloodFill                ScaleWindowExt      SetWindowExt
IntersectClipRect        SelectClipRgn       SetWindowOrg
LineTo                   SelectObject        StretchBlt
MoveTo                   SelectPalette       StretchDIBits
OffsetClipRgn            SetBkColor          TextOut

The following table lists additional functions that are valid in a metafile under
Windows 3.1:

CreateDIBitmap           CreateSolidBrush    Rectangle
CreateFont               DeleteObject        ResizePalette
CreateHatchBrush         ExtFloodFill        SetPaletteEntries
CreatePalette            FillRgn             SetTextAlign
CreatePen                InvertRgn           SetTextCharacterExtra
CreatePenIndirect        PaintRgn

Although the following functions might function correctly in a metafile, they
should not be used in a metafile:

AbortDoc                 EndPage             StartPage
EndDoc                   StartDoc            ResetDC

Windows has a number of functions that are not supported in metafiles directly
because they are used to put an object into a metafile. The region functions are
a common example of this function category. An application can create an
arbitrary region, either directly or by combining existing regions. When an
application selects the handle to the region into a metafile DC (display
context), Windows records a CREATEREGION record into the metafile.

An application can select a bitmap into a memory DC that is compatible with the
display (not directly into the metafile), and then then call the BitBlt function
to move the bitmap from the memory DC into the metafile DC. Windows saves the
bitmap image in the metafile as a Device-Independent Bitmap(DIB).

For more information, please refer to the online documentation for the Windows
SDK or pages 106-109 of the "Windows SDK: Programmer's Reference, Volume 1:
Overview" for version 3.1 manual.

* As a general rule, a metafile should be as device-independent as possible.
Therefore, an application should not record into a metafile a GDI function that
requires device units. Such functions include BitBlt, FillRgn, SetViewportExt,
and SetViewportOrg.

Additional query words: 3.00 3.10 docerr

======================================================================
Keywords          : kbdocfix kb16bitonly kbSDKWin16 
Technology        : kbAudDeveloper kbWin3xSearch kbSDKSearch kbWinSDKSearch kbWinSDK310
Version           : WINDOWS:3.1

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>