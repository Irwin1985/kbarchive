<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q299984: Using ASP to Retrieve Authentication Information About Web Users | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q299984: Using ASP to Retrieve Authentication Information About Web Users" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/299/Q299984/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/299/Q299984/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q299984: Using ASP to Retrieve Authentication Information About Web Users","url":"http://jeffpar.github.io/kbarchive/kb/299/Q299984/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q299984-using-asp-to-retrieve-authentication-information-about-web-users">Q299984: Using ASP to Retrieve Authentication Information About Web Users</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q299984
Product(s): Internet Information Server
Version(s): 4.0,5.0
Operating System(s): 
Keyword(s): kbAudDeveloper kbHOWTOmaster
Last Modified: 09-APR-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Server version 4.0 
- Microsoft Internet Information Services version 5.0 
-------------------------------------------------------------------------------


IN THIS TASK
------------

- SUMMARY

   - Requirements
- The Code
- Making the Code More Useful

SUMMARY
=======

This step-by-step guide explains the correct ASP syntax for retrieving user
authentication information from a Web site visitor. This information can only be
captured if the site uses Basic Authentication, Windows NT Challenge Response
(NTLM), or Windows Integrated Authentication.

Requirements
------------

- A Windows-based Web server running IIS 4.0 or IIS 5.0

- A text or ASP editor such as Notepad or Microsoft Visual InterDev.

The Code
--------

To capture the visitor's domain and login, paste the following code into your ASP
page. If the page also contains HTML, paste this code above the HTML tag.

  &lt;%
  Dim strUser
  strUser = Request.ServerVariables("LOGON_USER")
  Response.Write strUser
  %&gt;

This code will capture the user's domain and login, and then display it in the
browser.

Making the Code More Useful
---------------------------

Now that you have a method for capturing the user's login information, you may
want to store it somewhere. The steps in this section demonstrate how to create
a text file and write the information to it. Note that this method is only one
of many that use Request.ServerVariables.

1. Right-click Start, and then click Explore to open Windows Explorer.

2. In Windows Explorer, click File, point to New, and then click Folder.

3. This will create a new folder with the name area highlighted. Type "ASP"
  (without the quotation marks), and then press ENTER to name the new folder
  "ASP."

4. Paste the following code into your ASP page. If the page also contains HTML,
  paste this code above the HTML tag.

  &lt;%
  Dim objFSO, strUser, objFile
  strUser = Request.ServerVariables("LOGON_USER")
  set objFSO = Server.CreateObject("scripting.FileSystemObject")
  set objFile = objFSO.CreateTextFile("C:\asp\test.txt", true)
  objFile.WriteLine strUser
  objFile.Close
  Response.Write strUser
  %&gt;

5. This code will write the user's login information to a text file that is
  automatically created in the ASP folder (the folder you created in step 3).


Additional query words:

======================================================================
Keywords          : kbAudDeveloper kbHOWTOmaster 
Technology        : kbiisSearch kbiis500 kbiis400
Version           : :4.0,5.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>