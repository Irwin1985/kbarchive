<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q234262: SMS: Linking Query to a Collection Membership Rule May Not Work | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q234262: SMS: Linking Query to a Collection Membership Rule May Not Work" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/234/Q234262/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/234/Q234262/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q234262: SMS: Linking Query to a Collection Membership Rule May Not Work","url":"http://jeffpar.github.io/kbarchive/kb/234/Q234262/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q234262-sms-linking-query-to-a-collection-membership-rule-may-not-work">Q234262: SMS: Linking Query to a Collection Membership Rule May Not Work</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q234262
Product(s): Microsoft Systems Management Server
Version(s): winnt:2.0
Operating System(s): 
Keyword(s): kbsms200 kbsms200bug kbQuery kbsms200sp2fix
Last Modified: 25-JUN-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server version 2.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

A Systems Management Server (SMS) 2.0 query used as a Collection Membership rule
may return invalid results for that collection, or may disappear altogether from
the collection's Membership Rules window.

CAUSE
=====

This behavior can occur if the query string contains a carriage return/line feed
(CR/LF) character. This results in the query being removed from the collection
rules when it is evaluated by SMS.

RESOLUTION
==========

To resolve this problem, obtain the latest service pack for Systems Management
Server version 2.0. For additional information, please see the following article
in the Microsoft Knowledge Base:

  Q236325 How to Obtain the Latest Systems Management Server 2.0 Service Pack

WORKAROUND
==========

To work around this behavior, you can type the query string directly into the
Query Statement window with no CR/LF character. For readability, you can format
the query using CTRL+ENTER to move to the next line. Regular CR/LF characters
are not permitted.

When you are using copy and paste functions to move existing query statements
from an external source into the Query Language window, make sure that the query
is on a single line when you copy it. When you paste it into the Query Language
window, it is formatted to fit within the window.

STATUS
======

Microsoft has confirmed this to be a problem in Systems Management Server
version 2.0. This problem was first corrected in Systems Management Server
version 2.0 Service Pack 2.

MORE INFORMATION
================

To verify that a query is free of CR/LF characters:

1. Open the query string in Notepad or past it into Notepad.

2. On the Edit menu, make sure that the Word Wrap command is not selected (there
  should be no check mark).

3. Format the query so that it appears in its entirety on the first line of the
  Notepad document.

4. Select the entire query statement.

5. On the Edit menu, click Copy.

6. In the SMS Administrator console, create new Query properties from the
  Queries node.

7. Right-click the Queries node, point to New, and then click Query.

8. In the Name box, type the appropriate query name.

9. On the General tab, click Edit Query Statement.

10. In the Query Statement properties, click Show Query Language.

11. Delete any existing text in the Query Statement window.

12. Right-click in the Query Statement window, and then click Paste.

13. Click OK.

14. Click OK.

After you follow these steps, you can add the query to the collection as a
Collection Membership rule

Additional query words: prodsms newline newlines

======================================================================
Keywords          : kbsms200 kbsms200bug kbQuery kbsms200sp2fix 
Technology        : kbSMSSearch kbSMS200
Version           : winnt:2.0
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>