<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q234271: INFO: Installing a VeriSign SGC Certificate on IIS 4.0 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q234271: INFO: Installing a VeriSign SGC Certificate on IIS 4.0" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/234/Q234271/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/234/Q234271/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q234271: INFO: Installing a VeriSign SGC Certificate on IIS 4.0","url":"http://jeffpar.github.io/kbarchive/kb/234/Q234271/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q234271-info-installing-a-verisign-sgc-certificate-on-iis-40">Q234271: INFO: Installing a VeriSign SGC Certificate on IIS 4.0</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q234271
Product(s): Internet Information Server
Version(s): 4.0
Operating System(s): 
Keyword(s): 
Last Modified: 11-JUN-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Server version 4.0 
-------------------------------------------------------------------------------

IMPORTANT: This article contains information about modifying the registry. Before you modify the registry, make sure to back it up and make sure that you understand how to restore the registry if a problem occurs. For information about how to back up, restore, and edit the registry, click the following article number to view the article in the Microsoft Knowledge Base:

  Q256986 Description of the Microsoft Windows Registry

SUMMARY
=======

This article describes how to install a VeriSign Server Gated Crypto (SGC)
certificate on a computer running Microsoft Internet Information Server (IIS)
version 4.0. VeriSign uses the term "Global ID" to refer to their SGC
certificates.

MORE INFORMATION
================

The process for configuring non-US versions of IIS 4.0 (for example, the English
international 40-bit version) to use a VeriSign SGC certificate is as follows.

Prerequisites

Note: Bypass the Prerequisites section if Windows NT 4.0 Service Pack 4 has been
applied to the IIS 4.0 computer.

1. Ensure that you have at least Windows NT 4.0 Service Pack 3 applied on the
  IIS computer.

2. Make sure that you obtain the latest Schannel patch and Sgcinst.exe files
  from ftp://ftp.microsoft.com/ and that you view the Readme file prior to
  implementation on a live environment. For additional information, please see
  the following article in the Microsoft Knowledge Base:

  Q148427 Generic SSL (PCT/TLS) Updates for IIS and Microsoft Internet Products

  You can download the current fix from the following location:

  ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT40/hotfixes-postSP3/ssl-fix

3. Check the EnableSGC registry value in the following registry key:

  HKEY_LOCAL_MACHINE\system\CurrentControlSet\Control\SecurityProviders\SCHAN

  NEL is set to 1. If this value is different or not created, use Registry
  Editor to modify or add the DWord value.

WARNING: If you use Registry Editor incorrectly, you may cause serious problems
that may require you to reinstall your operating system. Microsoft cannot
guarantee that you can solve problems that result from using Registry Editor
incorrectly. Use Registry Editor at your own risk.

Obtaining the SGC Certificate

At this stage, the IIS computer is now configured with the necessary file
revisions to accept the SGC certificate. Go to the VeriSign Web site and request
a SGC digital ID. When VeriSign approves your certificate request, you will
receive your certificate in the mail.

NOTE: Some e-mail systems may corrupt the valid certificate. Please check with
you vender. At present there are no known issues with Microsoft Exchange
Server.

Sample Certificate

  

  -----BEGIN CERTIFICATE-----
  MIIBqDCCARECAQAwaTELMAkGA1UEBhMCVVMxDjAMBgNVBAgTBVRleGFzMRMwEQYD
  VQQHEwpMYXNDb2xpbmFzMRIwEAYDVQQKEwlNaWNyb3NvZnQxDjAMBgNVBAsTBUl0
  ZWFtMREwDwYDVQQDFAhOVFZPT0RPTzCBnjANBgkqhkiG9w0BAQEFAAOBjAAwgYgC
  gYBxmmAWKbLJHg5TuVyjgzWW0JsY5Shaqd7BDWtqhzy4HfRTW22f31rlm8NeSXHn
  EhLiwsGgNzWHJ8no1QIYzAgpDR79oqxvgrY4WS3PXT7OLwIDAQABoAAwDQYJKoZI
  hvcNAQEEBQADgYEAVcyI4jtnnV6kMiByiq4Xg99yL0U7bIpEwAf3MIZHS7wuNqfY
  acfhbRj6VFHT8ObprKGPmqXJvwrBmPrEuCs4Ik6PidAAeEfoaa3naIbM73tTvKN+
  WD30lAfGBr8SZixLep4pMIN/wO0eu6f30cBuoPtDnDulNT8AuQHjkJIc8Qc=
  -----END CERTIFICATE-----

Configuring and Installing the Certificate

The certificate will be sent in the body of an e-mail message. Copy the contents
of the mail message into a text file using a plain text editor (which does not
insert specific format information, such as Notepad.exe). Ensure that the very
first line is "--Begin Certificate--" and the last line being "--End
Certificate."

Formatting of the Certificate

Notes:

- Do not use Microsoft Word. Microsoft Word specifically formats documents.
  Microsoft Notepad.exe does not apply any specific formatting.

- Make sure that you do not have the Word Wrap feature set on your text
  processor and that there are no leading or trailing spaces on EACH line in
  the certificate.

- Make sure that the "Begin Certificate" and "End Certificate" lines are
  separate from the main body of the message (certificate). Save this file as a
  text file.

1. Run the Sgcinst.exe utility that you obtained from the Microsoft FTP site
  against the raw certificate. The command should be similar to the following:

  C:\sgcinst.exe -i -o sgccert.txt rawcert.txt

2. Install the new outputted file (for example Sgccert.txt) as the Certificate
  in Key Manager.

The IIS 4.0 computer should now negotiate 128-bit secure sessions.

Additional query words: SGCInst Certificate

======================================================================
Keywords          :  
Technology        : kbiisSearch kbiis400
Version           : :4.0
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>