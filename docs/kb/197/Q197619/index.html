<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q197619: Runtime Error ‘800a0046’ Using the Send Method of CDONTS.NewMail | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q197619: Runtime Error ‘800a0046’ Using the Send Method of CDONTS.NewMail" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/197/Q197619/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/197/Q197619/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q197619: Runtime Error ‘800a0046’ Using the Send Method of CDONTS.NewMail","url":"http://jeffpar.github.io/kbarchive/kb/197/Q197619/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q197619-runtime-error-800a0046-using-the-send-method-of-cdontsnewmail">Q197619: Runtime Error ‘800a0046’ Using the Send Method of CDONTS.NewMail</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q197619
Product(s): Internet Information Server
Version(s): 4.0
Operating System(s): 
Keyword(s): 
Last Modified: 15-OCT-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Server 4.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you try to send mail using the CDONTS.NewMail object from the SMTP service
included in the Windows NT Option Pack (NTOP) and Active Server Pages (ASP), you
may receive the following error message:

  Microsoft VBScript runtime error '800a0046'
  Permission denied
  /filename.asp, line xxx

where xxx is the line number using the send method of the NewMail object.

CAUSE
=====

This behavior can occur if the anonymous user account is not granted at least
CHANGE permissions to the SMTP mail server folders.

RESOLUTION
==========

To resolve this error, follow these steps:

1. Open the Windows NT Explorer and browse to your mail folders. By default,
  this is the X:\InetPub\MailRoot folder, where X: is the drive that you
  specified during the installation of NTOP.

2. Right-click the Pickup folder, and then click Properties.

3. On the Security tab, click Permissions.

4. If the IIS user accounts are listed, IUSR_&lt;computer&gt; and
  IWAM_&lt;computer&gt; are the defaults, skip to step 13.

5. Click Add.

6. Select your computer in the List Names From: drop-down menu.

7. Click Show Users.

8. Highlight the IUSR_&lt;computer&gt; Internet guest account and the
  IWAM_&lt;computer&gt; impersonation account, then click Add.

9. Click Change in the Type Of Access drop-down menu.

10. Click OK to close the "Add Users And Groups" dialog.

11. Click OK to close the Directory Permissions dialog.

12. Click OK to close the Directory Properties dialog.

13. Repeat steps 2 through 12 for each folder under the MailRoot folder.


Additional query words:

======================================================================
Keywords          :  
Technology        : kbiisSearch kbiis400
Version           : :4.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>