<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q225108: SNA 4.0 SP2 May Cause Trap in Function RamWrite or CheckInboundQ | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q225108: SNA 4.0 SP2 May Cause Trap in Function RamWrite or CheckInboundQ" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/225/Q225108/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/225/Q225108/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q225108: SNA 4.0 SP2 May Cause Trap in Function RamWrite or CheckInboundQ","url":"http://jeffpar.github.io/kbarchive/kb/225/Q225108/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q225108-sna-40-sp2-may-cause-trap-in-function-ramwrite-or-checkinboundq">Q225108: SNA 4.0 SP2 May Cause Trap in Function RamWrite or CheckInboundQ</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q225108
Product(s): Microsoft SNA Server
Version(s): WINDOWS:4.0SP2
Operating System(s): 
Keyword(s): kbsna400sp3fixkbfaq
Last Modified: 08-MAY-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft SNA Server, version 4.0SP2 
-------------------------------------------------------------------------------

SYMPTOMS
========

An application exception (trap) may occur at some point after installing Service
Pack 2 for SNA Server 4.0. The function reporting the problem has been seen in
either function RamWrite or function CheckInboundQ.

If you have Dr. Watson (Drwtsn32.exe) configured as the default debugger, a
Drwtsn32.log file will be created in the [NTROOT] directory.

In addition to the Dr. Watson, a Snadump.log file will be created in the
[SNAROOT\traces] directory. Both an event 4097 and 624 will get created in the
application log of the Event Viewer with this occurs.

Drwtsn32.log example showing an exception in function RamWrite:

Application exception occurred:
       App: exe\snalink.dbg (pid=pid #)
       When: 3/16/1999 @ 14:45:28.559
       Exception number: c0000005 (access violation)
[..]
[..]
State Dump for Thread Id [Thread Id]

eax=85a3a2a8 ebx=6726acf0 ecx=b2c0b7e8 edx=00000001 esi=9706fb1c edi=00000002
eip=6722d085 esp=00bcfcbc ebp=00bcfcdc iopl=0         nv up ei pl zr na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000             efl=00000246

function: RamWrite
       6722d062 895004           mov     [eax+0x4],edx          ds:86ca8cae=8b045089
       6722d065 8b0b             mov     ecx,[ebx]              ds:6726acf0=01010054
       6722d067 8b35c8ac2667     mov     esi,[BmD (6726acc8)]   ds:6726acc8=01010000
       6722d06d 8b4128           mov     eax,[ecx+0x28]         ds:b3e7a1ee=3328418b
       6722d070 33c9             xor     ecx,ecx
       6722d072 894df8           mov     [ebp-0x8],ecx          ss:01e3e6e2=????????
       6722d075 894d10           mov     [ebp+0x10],ecx         ss:01e3e6e2=????????
       6722d078 8d0cc0           lea     ecx,[eax+eax*8]        ds:85a3a2a8=????????
       6722d07b 8945f4           mov     [ebp-0xc],eax          ss:01e3e6e2=????????
       6722d07e 8db4cedc3b0000   lea     esi,[esi+ecx*8+0x3bdc] ds:b2c0f3c4=????????
FAULT -&gt;6722d085 395610           cmp     [esi+0x10],edx         ds:982de522=????????

DRWTSN32.LOG example showing an exception in function CheckInboundQ:

Application exception occurred:
       App: exe\mngagent.dbg (pid=pid #)
       When: 11/3/1998 @ 7:28:50.734
       Exception number: c0000005 (access violation)
[..]
[..]
State Dump for Thread Id [Thread Id]

eax=00000000 ebx=00000000 ecx=033fffb0 edx=033fffa8 esi=77f1c67a edi=77f674e0
eip=67226860 esp=033fff5c ebp=033fff64 iopl=0         nv up ei pl zr na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=0038  gs=0000             efl=00000246

function: CheckInboundQ
       67226850 55               push    ebp
       67226851 8bec             mov     ebp,esp
       67226853 51               push    ecx
       67226854 a1d85c2667       mov  eax,[BmD+0x10 (67265cd8)] ds:67265cd8=00000000
       67226859 56               push    esi
       6722685a 8945fc           mov     [ebp-0x4],eax          ss:0460e96a=????????
       6722685d 8b45fc           mov     eax,[ebp-0x4]          ss:0460e96a=????????
FAULT -&gt;67226860 f0ff00           lock    inc dword ptr [eax]    ds:00000000=????????

NOTE: For this particular problem, the access violations can appear in a number
of different SNA components (for example, Snaservr.exe, Snabase.exe,
Snalink.exe, Snaprint.exe, and so on). This will be indicated by the Pid # in
the Drwtsn32.log file.

CAUSE
=====

This problem was due to a regression in the Snadmod.dll introduced in Service
Pack 2.


RESOLUTION
==========

To resolve this problem, obtain the latest service pack for SNA Server version
4.0. For additional information, please see the following article in the
Microsoft Knowledge Base:

  Q215838 How to Obtain the Latest SNA Server Version 4.0 Service Pack


STATUS
======

Microsoft has confirmed this to be a problem in SNA Server 4.0 SP2. This problem
was first corrected in SNA Server version 4.0 Service Pack 3.

Additional query words:

======================================================================
Keywords          : kbsna400sp3fix kbfaq
Technology        : kbAudDeveloper kbSNAServSearch
Version           : WINDOWS:4.0SP2
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>