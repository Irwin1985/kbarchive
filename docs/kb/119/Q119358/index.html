<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q119358: Mac Hyp: Calling MS Mail XFCN from Microsoft FoxPro | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q119358: Mac Hyp: Calling MS Mail XFCN from Microsoft FoxPro" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/119/Q119358/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/119/Q119358/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q119358: Mac Hyp: Calling MS Mail XFCN from Microsoft FoxPro","url":"http://jeffpar.github.io/kbarchive/kb/119/Q119358/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q119358-mac-hyp-calling-ms-mail-xfcn-from-microsoft-foxpro">Q119358: Mac Hyp: Calling MS Mail XFCN from Microsoft FoxPro</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q119358
Product(s): Microsoft Mail For Appletalk Networks
Version(s): 3.0
Operating System(s): 
Keyword(s): 
Last Modified: 10-NOV-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Mail Software Development Kit (SDK) for HyperCard, version 3.0 
-------------------------------------------------------------------------------

SUMMARY
=======

With Microsoft FoxPro for Macintosh version 2.5, it is possible for developers
to make calls to HyperCard External Functions (XFCNs) and External Commands
(XCMDs). Version 3.x of Microsoft Mail for AppleTalk Networks includes a MS Mail
XFCN that provides HyperCard developers access to AppleTalk Mail. Therefore,
FoxPro developers can create Mail-enabled programs by calling the MS Mail
HyperCard XFCN from FoxPro.

This article defines how to call the MS Mail XFCN from FoxPro.

MORE INFORMATION
================

There are two steps to using the MS Mail XFCN with FoxPro:

- Creating a Resource file.

- Writing a Program file.

Creating a Resource File
------------------------

To call an XFCN from Microsoft FoxPro, it is necessary to first create a Resource
file which contains the XFCN and other important resources. This requires a
resource editor like ResEdit. To create the Resource file using ResEdit, do the
following:

1. Make a copy of the Mail Interface Documentation stack, which is included in
  the HyperCard SDK folder on the Extras disk with AppleTalk Mail.

2. Open the copy of the Mail Interface Documentation stack using ResEdit.

3. Double-click the XFCN resource.

4. Select the "msmail" XFCN, ID 200.

5. From the Edit menu, choose Copy.

6. From the File menu, select New. Name the file "MailRes" and click New.

7. From the Edit menu, choose Paste. A new XFCN resource in the MailRes window
  should be created.

8. Switch back to the Mail Interface Documentation window and select the STR#
  resource.

9. From the Edit menu, choose Copy.

10. Activate the MailRes window and select Paste from the Edit menu. A new STR#
  resource will be created.

11. From the File menu, choose Save to save the MailRes file.

12. Quit ResEdit.

Writing the Program File
------------------------

To create the Microsoft FoxPro program file which will call the XFCN, do the
following:

1. Open Microsoft FoxPro.

2. From the File menu, select New.

3. From the list of File Types, select Program and click New.

4. Type the following code in the new Program file:

     *Set the file which contains the XFCN resources
     set xcmdfile to "MailRes"

     *Load the msmail XFCN
     Load msmail function

     *Following are mail calls to create and send a message
     CALL msmail with "getServerName" to serverName
     CALL msmail with "getUserName","TRUE" to myName
     CALL msmail with "createMessage" to theMess
     CALL msmail with "addRecipients", theMess, myName
     CALL msmail with "addSubject", theMess, "Test from FoxPro"
     CALL msmail with "sendMessage", theMess

     *Display server and user name
     ? serverName
     ? myName

     return

5. From the File menu, choose Save to save the Program file.

Testing the Program
-------------------

Before testing the program, be sure that:

1. You are signed into Mail.

2. The FoxPro ".prg" file and the resource file, "MailRes" reside in the same
  folder.

  To test the program, select Do from the Program menu. Locate the ".prg" file
  just created and click the Do button.

Additional query words: 3.00

======================================================================
Keywords          :  
Technology        : kbHWMAC kbOSMAC kbAudDeveloper kbMailSearch kbSDKSearch kbSDKMailHypercard300
Version           : :3.0

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>