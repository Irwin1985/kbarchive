<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q121949: INFO: MFC OLE Classes Do Not Support &quot;Embed in self&quot; | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q121949: INFO: MFC OLE Classes Do Not Support &quot;Embed in self&quot;" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/121/Q121949/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/121/Q121949/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q121949: INFO: MFC OLE Classes Do Not Support &quot;Embed in self&quot;","url":"http://jeffpar.github.io/kbarchive/kb/121/Q121949/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q121949-info-mfc-ole-classes-do-not-support-embed-in-self">Q121949: INFO: MFC OLE Classes Do Not Support "Embed in self"</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q121949
Product(s): Microsoft C Compiler
Version(s): 1.51,2.0,4.0,4.1,5.0,6.0
Operating System(s): 
Keyword(s): kbole kbActiveX kbAutomation kbCOMt kbLocalSvr kbMFC kbVC150 kbVC151 kbVC200 kbVC400 kb
Last Modified: 11-JUN-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- The Microsoft Foundation Classes (MFC), used with:
   - Microsoft Visual C++ for Windows, 16-bit edition, version 1.51 
   - Microsoft Visual C++, 32-bit Editions, versions 2.0, 4.0, 4.1, 5.0, 6.0 
   - Microsoft Visual C++.NET (2002) 
-------------------------------------------------------------------------------


SUMMARY
=======

The MFC OLE classes in the versions listed above do not include the ability for
a container/server to embed items of its own type within an instance of itself.

Users attempting to embed an OLE item from the container/server into itself will
receive the "Failed to create object. Check system registry" dialog box. Further
debugging will show that QueryInterface failed to return the IViewObject
interface for the embedded item.

MORE INFORMATION
================

While OLE makes "embed in self" possible, it requires the use of the API call
OleCreateEmbeddingHelper to connect the OLE2 or OLE32 DLL as the default
in-process handler. The MFC OLE classes do not make use of this, and the
architecture of an MFC application would make it extremely difficult to
integrate this support.

MFC applications rely on handle maps and global tracking of such things as the
toolbar and status bar of the application. An OLE item from this same
application, if activated for visual editing, would attempt to negotiate space
for a second toolbar and status bar within the same frame window. The MFC
framework would also attempt to add these objects to its handle map, even though
they are already there. Altering this would require substantial unsupported
changes to the MFC source code. See article Q120682 for information on how to
exclude the current server object from its COleInsertDialog

Additional query words: OLE embed kbvc150 kbvc151 kbvc200 kbvc400 kbvc410 kbvc500 kbvc600 kbvc600

======================================================================
Keywords          : kbole kbActiveX kbAutomation kbCOMt kbLocalSvr kbMFC kbVC150 kbVC151 kbVC200 kbVC400 kbVC410 kbVC420 kbVC500 kbVC600 kbGrpDSMFCATL 
Technology        : kbAudDeveloper kbMFC
Version           : :1.51,2.0,4.0,4.1,5.0,6.0
Hardware          : x86
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>