<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q292542: HOWTO: IIS5: Setting Up Index Server 2.0 as a Generic Clustered | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q292542: HOWTO: IIS5: Setting Up Index Server 2.0 as a Generic Clustered" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/292/Q292542/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/292/Q292542/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q292542: HOWTO: IIS5: Setting Up Index Server 2.0 as a Generic Clustered","url":"http://jeffpar.github.io/kbarchive/kb/292/Q292542/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q292542-howto-iis5-setting-up-index-server-20-as-a-generic-clustered">Q292542: HOWTO: IIS5: Setting Up Index Server 2.0 as a Generic Clustered</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q292542
Product(s): Internet Information Server
Version(s): 2000,2000 SP1,2000 SP2,5.0
Operating System(s): 
Keyword(s): 
Last Modified: 29-JUN-2001

This article provides information about a configuration that 
is not supported by Microsoft Technical Support. This article 
is provided for informational purposes only; Microsoft makes 
no guarantee that this configuration will function properly.
-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Services version 5.0 
- Microsoft Windows versions 2000, 2000 SP1, 2000 SP2 Advanced Server 
- Indexing Service 
-------------------------------------------------------------------------------

CAUTION: This is not a Microsoft Approved Configuration.
This configuration is an optional workaround to overcome known limitations with Indexing Service and Window 2000 Cluster Services.
Configuring Indexing Service in this manner is done at your own risk.
These configurations are not supported beyond Best Efforts.

SUMMARY
=======

After you start Indexing Service and begin creating a Custom Catalog for your
Web site, when you move the Web Instance and Disk Resource to the second node,
the Custom Web Site Catalog has been stopped. This is by design. To move the
Disk Resource from Node A to Node B, the file locks that are caused by indexing
the disk must be released. This is done by stopping the catalog. However, after
you move the IIS server instance and Disk Resource back to Node A, the catalog
remains offline until you manually start it.

The Index Server Catalogs are not dynamic and do not automatically restart when
the cluster instances return. There are three methods to configure Indexing
Service to dynamically restart the catalogs in a clustered environment. This
article describes all three configurations.

NOTE: The steps in this article should only be performed after you have
successfully clustered IIS and are able to move your IIS Resource Group between
nodes without errors.

MORE INFORMATION
================

Configuration One: Using a Batch File to Restart Indexing Service:

To configure a batch file (that runs a command to restart the Index Service) as a
Generic Application in Cluster Administrator, do the following:

1. Create the batch file to stop and restart Indexing Service as follows:

  a. Right-click your Desktop, click New, and then click Text Document.

  b. Name the document Index.Bat.

  c. Right-click Index.Bat, and then choose Edit.

  d. Type "net stop cisvc net start cisvc" (without the quotation marks).

  e. Save and close Index.Bat.

  f. Move Index.Bat to the Inetpub directory.

2. Open the Cluster Administrator.

3. Right-click the Web Resource Group, click New, and then click Resource.

4. Name the new resource Index Batch.

5. Select Generic Application as the resource type, and then click Next.

6. Select both Nodes as Possible Owners, and then click Next.

7. In Dependencies, select Disk, Network Name, and IIS Server Instance, and then
  click Next.

8. In Parameters, enter the following:

  a. In Command Line:, type "cmd /k &lt;Drive&gt;:\inetpub\index.bat" (without
     the quotation marks).

  b. In Current Directory:, type &lt;Drive&gt;:\inetpub\.

  c. Click to clear the Allow application to interact with desktop check box.

  d. Click to select the Use Network Name for Computer Name check box.

  e. Click Finish.

9. Open the Index Server snap-in.

10. Click the Index Server snap-in, so you can see the catalog status in the
  right-hand pane.

11. In the Cluster Administrator, bring the new Index.bat Instance online. Note
  that Index Server will stop and restart.

12. Right-click the Web Resource Group and move it to the opposite node. (Note
  that the Customer Web Catalog has stopped.)

13. Move the group back. (Note that the services are restarted and the catalog
  is online.)

Configuration Two: Using a Cluster Generic Service to Allow the Cluster Service to Control the Indexing Service:

In this configuration, set up Indexing Service as a Generic Cluster Service in
Cluster Administrator. The Indexing Service will be configured with two
independent local catalogs, which means that you will need to allow Indexing
Service to index the Web site content on Node A, and then move the IIS Resources
to Node 2, and let the Indexing Service on Node B index the Web site content.

To set up Indexing Service as a Generic Cluster Service with two independent
catalogs, do the following:

1. On node A, open the Cluster Administrator and verify that the IIS Cluster
  Instances are owned by Node A. If not, move the IIS Cluster Group to Node A.
  (Minimize the Cluster Administrator.)

2. Open the Indexing Service MMC snap-in on Node A (or the Computer Management
  MMC snap-in in the Administrative Tools).

3. Create a new catalog:

  a. Right-click the Indexing Service snap-in, click to expand New, and then
     click Catalog. (The Add Catalog dialog box will be displayed.)

  b. Give the catalog a name and choose the path (a local path) where the
     catalog will reside. Click OK.

  c. You will receive a Warning that states:

  The catalog will remain off-line until Indexing Service is restarted.

  d. Right-click the New Catalog, and then click Properties.

  e. In the &lt;your catalog name&gt; properties, click the Tracking tab.

  f. In the WWW Server drop-down list, select the site that you want this
     catalog to index, and then click OK.

  g. Stop and restart the Indexing Service by right-clicking the Indexing
     Service snap-in, clicking Stop, and then clicking Start.

  h. Wait for the Indexing Service to index the Web site, and then stop the
     Indexing Service.

4. Open the Cluster Administrator and move the Web Group to Node B.

5. Repeat step 3 on Node B. (When the catalog has completed indexing the site
  and you have stopped the Indexing Service, move to the next step.)

6. Open the Cluster Administrator.

7. Right-click the Web Resource Group, click New, and then click Resource.

8. Name the New Resource "Indexing Service" (without the quotation marks).

9. Select Generic Service as the Resource Type, and then click Next.

10. Select both Nodes as Possible Owners, and then click Next.

11. In Dependencies, click Disk, click Network Name, click IIS Server Instance,
  and then click Next.

12. In Generic Service Parameters, type "CISVC" (without the quotation marks) in
  the Service Name field, leave the Start Parameter blank, click to check the
  Use Network Name for Computer Name check box, and then click Next.

13. Leave the Registry Replication dialog box blank, and then click Finish.

14. Bring the new Indexing Cluster Service online.

15. Test fail over by moving the Web Group between both nodes and verify that
  the Indexing Service is coming online and the catalog is functioning
  correctly:

  a. Open Indexing Service on the node that does not own the Web Group, and
     where the Indexing Service is stopped.

  b. Open the Cluster Administrator, right-click the Web Group, and then click
     Move Group.

  c. In the Indexing Services snap-in, verify that it comes online when the
     Indexing Cluster Service comes online in the Cluster Administrator.
     (Repeat these steps on the opposite node.)

You now have a Clustered Indexing Service Instance with two independent catalogs
that are indexing the same Web site content.

Configuration Three: Using a Cluster Generic Service to Allow the Cluster Service to Control the Indexing Service with a Shared Catalog:

In this configuration, set up Indexing Service as a Generic Cluster Service in
the Cluster Administrator. The Indexing Service will be configured with one
shared catalog (on the same shared disk that the IIS Instance content resides
on). This means you will only need to allow Indexing Services to index the Web
site content on Node A. When the Index Server Instance moves to Node B, the
catalog from Node 1 will be available and a re-index will not be needed. This
makes for fast recovery when a Cluster Member fails. However, there is a risk of
catalog corruption that would then affect both Indexing Services.

NOTE: To reduce the chance of catalog corruption, you must have the catalog
content on the Web Groups Shared Disk and the Indexing Service Instance in the
Web Group. Also, the Indexing Service Cluster Instance must be dependent on all
three: The Disk Resource, Network Name, and IIS Server Instance.

To set up Indexing Service as a Generic Cluster Service with a single shared
catalog, do the following:

1. On Node A, open the Cluster Administrator and verify that the IIS Cluster
  Instances are owned by Node A. If not, move the IIS Cluster Group to Node A.
  (Minimize the Cluster Administrator.)

2. Open the Indexing Service MMC snap-in on Node A (or the Computer Management
  MMC snap-in in Administrative Tools).

3. Create a new catalog:

  a. Right-click the Indexing Service snap-in, click to expand New, and then
     click Catalog. (The Add Catalog dialog box will be displayed.)

  b. Give the catalog a name and choose the path (a local path) where the
     catalog will reside (the Shared Disk Resource where your IIS Web Content
     Resides). Click OK.

  c. You will receive a Warning that states:

  The catalog will remain off-line until Indexing Service is restarted.

  d. Right-click the New Catalog, and then click Properties.

  e. In the &lt;your catalog name&gt; properties, click the Tracking tab.

  f. In the WWW Server drop-down list, select the site that you want this
     catalog to index, and then click OK.

  g. Stop and restart the Indexing Service by right-clicking the Indexing
     Service snap-in, clicking Stop, and then clicking Start.

  h. Wait for the Indexing Service to index the Web site, and then stop the
     Indexing Service.

4. Open the Cluster Administrator and move the Web Group to Node B. (This will
  allow Node B to connect to the Disk Resource when setting up the catalog on
  this node.)

5. Repeat step 3 on Node B. (When the catalog has completed indexing the site
  and you have stopped the Indexing Service, move to the next step.)

6. Open the Cluster Administrator.

7. Right-click the Web Resource Group, click New, and then click Resource.

8. Name the New Resource "Indexing Service" (without the quotation marks).

9. Select Generic Service as the Resource Type, and then click Next.

10. Select both Nodes as Possible Owners, and then click Next.

11. In Dependencies, click Disk, click Network Name, click IIS Server Instance,
  and then click Next.

12. In Generic Service Parameters, type "CISVC" (without the quotation marks) in
  the Service Name field, leave the Start Parameter blank, click to check the
  Use Network Name for Computer Name check box, and then click Next.

13. Leave the Registry Replication dialog box blank, and then click Finish.

14. Bring the new Indexing Cluster Service online.

15. Test fail over by moving the Web Group between both nodes and verify that
  the Indexing Service is coming online and the catalog is functioning
  correctly:

  a. Open Indexing Service on the node that does not own the Web Group, and
     stop the Indexing Service.

  b. Open the Cluster Administrator, right-click the Web Group, and then click
     Move Group.

  c. In the Indexing Services snap-in, verify that it comes online when the
     Indexing Cluster Service comes online in the Cluster Administrator.
     (Repeat these steps on the opposite node.)

You now have a Clustered Indexing Service Instance with a single shared catalog
indexing the Web Site content.

Additional query words: iis5 failover offline random

======================================================================
Keywords          :  
Technology        : kbwin2000AdvServSearch kbwin2000ServSearch kbwin2000Search kbiisSearch
Version           : :2000,2000 SP1,2000 SP2,5.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>