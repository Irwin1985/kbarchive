<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q271846: Event 5170 Occurs If Backup Server Is Unavailable During Upgrade | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q271846: Event 5170 Occurs If Backup Server Is Unavailable During Upgrade" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/271/Q271846/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/271/Q271846/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q271846: Event 5170 Occurs If Backup Server Is Unavailable During Upgrade","url":"http://jeffpar.github.io/kbarchive/kb/271/Q271846/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q271846-event-5170-occurs-if-backup-server-is-unavailable-during-upgrade">Q271846: Event 5170 Occurs If Backup Server Is Unavailable During Upgrade</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q271846
Product(s): Microsoft SNA Server
Version(s): 
Operating System(s): 
Keyword(s): 
Last Modified: 22-OCT-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Host Integration Server 2000 
-------------------------------------------------------------------------------

SYMPTOMS
========

If a backup Host Integration Server (HIS) computer cannot be contacted when the
configuration file is upgraded on the primary HIS computer, the SNA Manage Agent
records event ID 5170 in the Application event log. This warning message
indicates that some registry settings for the Print Server service or the Shared
Folders Gateway service on the backup server may not have been correctly
migrated to the configuration file.

CAUSE
=====

The description for event ID 5170 is as follows:

  The Server Sna2 was not available while the com.cfg configuration was
  migrated. If you had any special registry entries for Print Server or Shared
  Folders Gateway please update the configuration manually.

When the primary Host Integration Server is updated by the Setup program, the
primary server?s Snaadmin.dll file searches for each backup server?s registry
entries. For the Print Server service, the registry key is:

  HKEY_LOCAL_MACHINE\System\CurrentControlSet\SnaPrint\Parameters

For the Shared Folders Gateway service, the registry key is:

  HKEY_LOCAL_MACHINE\System\CurrentControlSet\SFGW\Parameters

The following SnaPrint registry entries may not have been migrated to the new
Com.cfg file:

  HonorCharsUnder0x40
  FlushFF
  UseProportionalFontFix
  NoSpaceAfterFF
  DelayPrintStart
  DoAllLU3FFs
  BypassGDIForLU3
  DontResetForEveryLU3PrintScreen
  AlwaysDoNL
  SetFixedTabs
  ActivationRetryLimit
  ActivationRetryIntervalBR/&gt;

The following Shared Folders Gateway registry entry may not have been migrated
correctly:

  S36/RemoteLUAlias

RESOLUTION
==========

To manually update these entries, change the Print Server properties for the
appropriate server. You do not need to modify the registry.

MORE INFORMATION
================

The following table explains the relation between the registry key and the Print
Server property that it modifies:

+------------------------------------------------------------------+
| Registry Entry                  | Print Server Property          | 
+------------------------------------------------------------------+
| HonorCharsUnder0x40             | Ignore Characters 3F and Under | 
+------------------------------------------------------------------+
| FlushFF                         | Flush Final FF                 | 
+------------------------------------------------------------------+
| UseProportionalFontFix          | Use Proportional Font Change   | 
+------------------------------------------------------------------+
| NoSpaceAfterFF                  | No Space After FF              | 
+------------------------------------------------------------------+
| DelayPrintStart                 | Delay Print Start              | 
+------------------------------------------------------------------+
| DoAllLU3FFs                     | Do All FF                      | 
+------------------------------------------------------------------+
| BypassGDIForLU3                 | Support Embedded Printer Codes | 
+------------------------------------------------------------------+
| DontResetForEveryLU3PrintScreen | Support Embedded Printer Codes | 
+------------------------------------------------------------------+
| AlwaysDoNL                      | Always Do NL                   | 
+------------------------------------------------------------------+
| SetFixedTabs                    | Use Fixed Tabs                 | 
+------------------------------------------------------------------+

Additional query words:

======================================================================
Keywords          :  
Technology        : kbAudDeveloper kbHostIntegServ2000
Version           : :

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>