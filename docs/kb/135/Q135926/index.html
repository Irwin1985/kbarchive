<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q135926: SMTP: SMTPPUT 201: Failure Submitting Message to Mail Database | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q135926: SMTP: SMTPPUT 201: Failure Submitting Message to Mail Database" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/135/Q135926/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/135/Q135926/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q135926: SMTP: SMTPPUT 201: Failure Submitting Message to Mail Database","url":"http://jeffpar.github.io/kbarchive/kb/135/Q135926/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q135926-smtp-smtpput-201-failure-submitting-message-to-mail-database">Q135926: SMTP: SMTPPUT 201: Failure Submitting Message to Mail Database</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q135926
Product(s): Microsoft Mail For PC Networks
Version(s): MS-DOS:3.0
Operating System(s): 
Keyword(s): 
Last Modified: 26-FEB-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Mail Gateway to SMTP, version 3.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

The File Format Application Programming Interface (FFAPI) access component
Smtpput.exe that is provided for the SMTP gateway will return the following 201
error code when the program is unable to successfully deliver a message to a
postoffice:

  SMTPPUT returned 201
  201 - 1 - 140 - Failure submitting message to mail database

  [tx] 552 Error in local delivery

CAUSE
=====

The 201 error code is generated by the FFAPI access component Smtpput.exe. The
error is returned to the gateway when Smtpput.exe is unable to insert the
message into the postoffice database.

The 201 error code is caused by the following conditions:

- Network file contention.

- Insufficient disk space.

- Postoffice directory structure incomplete or corrupt.

- Insufficient access rights granted to gateway machine.

- Insufficient file handles.

- Network problems accessing the postoffice files.

- Alias address in SMTP gateway larger than 10 characters for version 3.0.8.

- Corrupt or incorrect format of the Microsoft Mail File Format(MMFF) file.

RESOLUTION
==========

Network File Contention
-----------------------

SMTPPUT.EXE component must access certain files to create a message on a
postoffice. Gateways that service postoffices that receive high volumes of
message transfers and are serviced by the External Mail program should consider
disabling mailer (-md).

The files accessed by Smtpput.exe with mailer disabled are Access.glb,
Access2.glb, Master.glb, C850sort.glb, Group.glb, Network.glb, Control.glb,
Inqueue3.key, and Inqueue3.mbg. These files may be locked by other processes
temporarily while in use.

NOTE: The 201 error has been reproduced by locking the Inqueue3.mbg file.

Postoffices located on Novell servers that operate under high-traffic conditions
are recommended to set the postoffice as shareable with a few exceptions. There
are certain conditions that dictate that the Control.glb, Tid.glb, Flag.glb, and
Master.glb should only be accessed by one process at a time; thus, they should
not be shareable.

For additional information, please see the Microsoft Mail Gateway to SMTP
"Administrator's Guide" and/or the following article in the Microsoft Knowledge
Base:

  Q99204 Doc Err: Setting Attributes for High Traffic Network

The most common problem is the Inqueue3.mbg is being locked by another external
or gateway. This problem can be compounded if the other external or gateway is
operating on a slow machine or over a slow link. The option -v20 or CompatV20
utilized by the External Mail program will add additional file locking
functionality, increasing the amount of network overhead and possibly causing
additional network file contention. Additional network file contention can be
created by improperly running the External Mail program from a network drive
(see page 233 of the "Administrator's Guide").

Insufficient Disk Space
-----------------------

Insufficient disk space will prevent the client from enlarging or creating
postoffice files. Novell NetWare file servers can produce a insufficient disk
space response to the program when the files have become ownerless or the purge
file has used all the available disk space.

Postoffice Directory Structure
------------------------------

The postoffice directory structure consists of 19 main subdirectories.

For additional information, please see the following article in the Microsoft
Knowledge Base:

  Q77926 Description of Mail Database Subdirectories

Insufficient Access Rights
--------------------------

The gateway components should be given full network access rights for the
postoffice.

For additional information, please see the Microsoft Mail Gateway to SMTP
"Administrator's Guide" and/or the following articles in the Microsoft Knowledge
Base:

  Q103380 File Scan Rights Required for Novell NetWare

  Q117152 MTA Not Report LAN Man User-Level Security Problems

  Q121798 Err Msg: You Do Not Have the Proper Access...

Insufficient File Handles
-------------------------

Increase the number of file handles to 50 in the Config.sys file of the
workstation running the gateway.

Network Problems
----------------

The Smtpput.exe utilizes the network components to effectively perform the file
commands that create and manipulate each file. Network problems that interfere
with the operation of these commands can cause the 201 error to occur.

SMTP Alias Address Larger Than 10 Characters
--------------------------------------------

The SMTP gateway version 3.0.9 resolves an issue that can cause a 201 error to be
logged. The Readme.txt file included with version 3.0.9 of the SMTP gateway
discusses the problem when an alias name is larger than 10 character.

MMFF file problems
------------------

Ensure that the MMFF file TO_NC.API submitted by the gateway follows either the
Basic or Extended Message Format for the Smtpput.exe program to properly convert
(definition begins on page 50 in the FFAPI SDK).

MORE INFORMATION
================

The error displayed may consist of three numbers separated by a hyphen (-); for
example,

  (201 - 1 - 140).

The error code number 201 signifies that the error occurred when you tried to
insert the message into the database. The second number, 1, can signify the
number of messages sent per socket connection. It will rarely exceed 2. The last
number refers to the line number of the message indicated by the second number.
It is only valid if the problem was created by a corrupted or incorrectly
formatted MMFF file.

Additional query words: 3.00

======================================================================
Keywords          :  
Technology        : kbMailSearch kbMailGateSearch kbZNotKeyword3 kbMailGateSMTP300
Version           : MS-DOS:3.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>