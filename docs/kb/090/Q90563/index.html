<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q90563: Using the AdvancedSetUpDialog() Configuration Call | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q90563: Using the AdvancedSetUpDialog() Configuration Call" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/090/Q90563/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/090/Q90563/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q90563: Using the AdvancedSetUpDialog() Configuration Call","url":"http://jeffpar.github.io/kbarchive/kb/090/Q90563/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q90563-using-the-advancedsetupdialog-configuration-call">Q90563: Using the AdvancedSetUpDialog() Configuration Call</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q90563
Product(s): Microsoft Windows Device Driver Kit
Version(s): 3.1
Operating System(s): 
Keyword(s): 
Last Modified: 19-FEB-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows Device Development Kit (DDK) for Windows, version 3.1 
-------------------------------------------------------------------------------

SUMMARY
=======

Windows printer drivers are expected to export the ExtDeviceMode() function,
which displays a configuration dialog box for the printer. This dialog box
generally prompts the user for characteristics of the printout, such as
orientation, paper size, and paper source. This box is displayed whenever an
application or DLL calls into the ExtDeviceMode() function; for example, when
the Configure button in the printer control panel application is clicked.

However, with the introduction of the common dialog box DLL, this top-level
configuration dialog box has been generalized and is now being provided by the
print common dialog box. Thus, those applications that configure the printer via
the common print dialog box will raise a different top-level configuration
dialog box than those applications that call ExtDeviceMode() directly for this
purpose.

MORE INFORMATION
================

To still allow the user to configure driver-specific characteristics, Windows
version 3.1 printer drivers can export the AdvancedSetUpDialog() procedure that,
when invoked, raises another dialog box to prompt the user for additional print
configuration information. If the common print dialog box detects the presence
of this function in the driver, it activates a button labeled Options that, when
clicked, calls the AdvancedSetUpDialog() function. The dialog box that is raised
upon invocation of the ExtDeviceMode() function, however, frequently has the
same Options button that, in turn, calls AdvancedSetUpDialog().

This approach bears the problem that a printer driver may want to know whether
the AdvancedSetUpDialog() function has been called from the Options button of
the common print dialog box or the top-level ExtDeviceMode() configuration
dialog box. For example, if the printer driver offers a feature that is included
in the ExtDeviceMode() dialog box, then this feature should also be available in
the AdvancedSetUpDialog() box in case the top-level configuration box has been
bypassed by the common print dialog box; however, IF the advanced dialog box has
been selected through the ExtDeviceMode() dialog box, the feature should not be
available in the advanced dialog box to avoid redundancy.

To work around this problem, the dialog box procedure for the top-level dialog
box procedure should set a global flag that the advanced dialog box can test
upon to determine whether it has been called from the driver's top- level
configuration dialog box. In addition, the first parameter passed to
AdvancedSetUpDialog()--the window handle that serves as the parent for the
dialog box--can be used to determine where the AdvancedSetUpDialog() function
was called from.

Microsoft recommends that applications use the common print dialog box wherever
possible when setting up a printer, and that printer drivers do not duplicate
functionality in the AdvancedSetUpDialog() and ExtDeviceMode() dialog boxes to
prompt the user for printer-specific characteristics.

REFERENCES
==========

The AdvancedSetUpDialog() function is documented on pages 134-135 in the
Microsoft Windows version 3.1 "Device Driver Adaptation Guide."

Additional query words: 3.10

======================================================================
Keywords          :  
Technology        : kbAudDeveloper kbWin3xSearch kbWinDDKSearch kbWinDDK310
Version           : :3.1

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>