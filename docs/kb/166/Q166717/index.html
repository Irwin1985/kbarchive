<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q166717: DOC: Instructions for Statically Linking to Registrar Code | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q166717: DOC: Instructions for Statically Linking to Registrar Code" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/166/Q166717/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/166/Q166717/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q166717: DOC: Instructions for Statically Linking to Registrar Code","url":"http://jeffpar.github.io/kbarchive/kb/166/Q166717/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q166717-doc-instructions-for-statically-linking-to-registrar-code">Q166717: DOC: Instructions for Statically Linking to Registrar Code</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q166717
Product(s): Microsoft C Compiler
Version(s): 2.0,2.1
Operating System(s): 
Keyword(s): kberrmsg kbdocfix kbdocerr kbATL kbATL200 kbATL210 kbDTL kbRegistry kbVC420 kbVC500 kbG
Last Modified: 26-JUN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- The Microsoft Active Template Library (ATL), versions 2.0, 2.1 
-------------------------------------------------------------------------------

SUMMARY
=======

The Microsoft Active Template Library (ATL) Help article entitled "Setting Up a
Static Link to the Registrar Code" says the following:

  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
  At the top of stdafx.h, add the following #define statement: #define
  _ATL_STATIC_REGISTRY
  &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;

This causes a series of compiler errors and warnings when you build for "Win32
Release MinSize":

  

  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
  C:\Program Files\DevStudio\VC\ATL\include\atlimpl.cpp(1010) : error
   C2259:
  'CRegObject' : cannot instantiate abstract class due to following
  members:
  C:\Program Files\DevStudio\VC\ATL\include\atlimpl.cpp(1010) : warning
  C4259: 'long __stdcall IUnknown::QueryInterface(const struct _GUID
   &amp;,void
  ** )' : pure virtual function was not defined
  ...
  &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;

Go into Project/Settings and click on the C++ tab. Under "Preprocessor
definitions," replace _ATL_DLL with _ATL_STATIC_REGISTRY.

If the project was built using the "ATL COM AppWizard," you can also just pick
"Win32 Release MinDependency," which already has the correct preprocessor
definitions set for statically linking to the Registrar code.

MORE INFORMATION
================

ATL 2.x accesses the system registry through the ATL Registry Component
(Registrar). You can dynamically link to the Registrar but you will have to
distribute Atl.dll with your application. If you don't want to distribute
Atl.dll, you can statically link to the Registrar but this increases the size of
your executable by approximately 5K. The ATL library allows you to set this
option via preprocessor definitions. _ATL_DLL means you want to dynamically link
with the Registrar. _ATL_STATIC_REGISTRY means you want to statically link with
the registrar.

For components built with VC++ 6.0, Atl.dll may need to be shipped even with
_ATL_STATIC_REGISTRY (Min Dependency build) defined.

For additional information, click the article number below to view the article in
the Microsoft Knowledge Base:

  Q244955 PRB: MinDependency Project May Need to Include Atl.dll

Additional query words:

======================================================================
Keywords          : kberrmsg kbdocfix kbdocerr kbATL kbATL200 kbATL210 kbDTL kbRegistry kbVC420 kbVC500 kbGrpDSMFCATL 
Technology        : kbAudDeveloper kbATLsearch kbATL200 kbATL210
Version           : :2.0,2.1

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>