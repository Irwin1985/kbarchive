<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q140987: Errors Removing TCP/IP Registry Keys Using Insight Manager | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q140987: Errors Removing TCP/IP Registry Keys Using Insight Manager" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/140/Q140987/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/140/Q140987/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q140987: Errors Removing TCP/IP Registry Keys Using Insight Manager","url":"http://jeffpar.github.io/kbarchive/kb/140/Q140987/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q140987-errors-removing-tcpip-registry-keys-using-insight-manager">Q140987: Errors Removing TCP/IP Registry Keys Using Insight Manager</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q140987
Product(s): Microsoft Windows NT
Version(s): 3.50 3.51
Operating System(s): 
Keyword(s): 
Last Modified: 08-AUG-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows NT Workstation versions 3.5, 3.51 
- Microsoft Windows NT Server versions 3.5, 3.51 
-------------------------------------------------------------------------------

SUMMARY
=======

On Compaq file servers that are using versions of Windows NT Server that are
installed using the SmartStart compact disc, a user may have difficulties
reinstalling TCP/IP or other TCP/IP related services.

Insight Manager is a systems management tool that provides performance and
configuration management for Compaq servers and desktop clients. However,
Insight Manager can complicate the process that is used to remove all traces of
TCP/IP from the Windows NT registry. This article helps to identify those
Insight Manager entries and prepare Windows NT Server for a trouble-free,
reinstallation of TCP/IP and related components.

MORE INFORMATION
================

There are many reasons why a Windows NT Server operator may need to remove and
readd TCP/IP and/or the related components. Because of service dependencies that
exist when these components are removed, the next time the system is booted and
the operator tries to readd these components, the installation fails
nevertheless with one or more of the following error messages:

- Registry Service Subkey Already Exists.

- Registry Subkey Already Exists.

- Unable to remove name space provider

This error occurs whether the options to add them are grayed out, or whether the
individual check boxes for TCP/IP, Simple TCP/IP Tools, FTP Server, SNMP, WINS
Server, DHCP Server appear.

If the installed TCP/IP components are from Microsoft installation media and you
want to properly remove all references to the TCP/IP tools, please see the
following articles in the Microsoft Knowledge Base for instructions:

  ARTICLE-ID: Q122398
  TITLE : TCP/IP Internetworking Components Not Available

  ARTICLE-ID: Q102973
  TITLE : REG: TCP/IP Transport Entries, PART 1

  ARTICLE-ID: Q102974
  TITLE : REG: TCP/IP Transport Entries, PART 2

NOTE: Q102973 and Q102974 go into greater detail regarding the TCP/IP entries in
the registry.

After you remove the registry entries, reinstall the TCP/IP components that are
needed.

If Windows NT Server was installed from the Compaq SmartStart compact disc along
with the TCP/IP components, Compaq Insight Manager may also have been
installed.

If Insight Manager is installed and the operator has tried removing and readding
TCP/IP components, they may have been able to get past the TCP/IP installation
check boxes, but Setup always detects another TCP/IP component that is already
installed and will prompt with "Registry Service Subkey Already Exists." causing
the TCP/IP installation to fail. To successfully reinstall the TCP/IP
components, any Insight Manager entries will need to be deleted from the
registry.

WARNING: Using Registry Editor incorrectly can cause serious, system- wide
problems that may require you to reinstall Windows NT to correct them. Microsoft
cannot guarantee that any problems resulting from the use of Registry Editor can
be solved. Use this tool at your own risk. Insight Manager is a Compaq product.
If you have questions regarding this product and the changes that it makes to
the Registry, please contact Compaq Technical Support.

1. Stop the Compaq Insight Manager Service from the Services Control Panel.

2. From File Manager, delete the %SYSTEMROOT%\SYSTEM32\CPQMGMT subdirectory.

3. Run Registry Editor (REGEDT32.EXE) and under the HKEY_LOCAL_MACHINE\SYSTEM
  subtree delete the following keys:

  \COMPAQ

  \COMPAQPERMANENT

4. Quit Registry Editor and reboot the server.

5. Run Control Panel and choose Network and then Add Software.

6. Choose "TCP/IP and Related Components" from the list of software and select
  the check boxes next to the components that need to be added (TCP/IP, Simple
  TCP/IP, etc.) and click OK.

7. Insert the Windows NT floppy disk or compact disc when prompted.

  The install should complete successfully after copying the appropriate files
  and making necessary registry changes.

8. Reboot the server.

9. (Optional) If the system requires Insight Manager to be running on the
  server, then go ahead and complete its installation per Compaq instructions
  (typically, this means that the SNMP service under TCP/IP must be installed
  in step 5 and 6).

The Compaq products discussed here are manufactured by Compaq Computer Corp., a
vendor independent of Microsoft; we make no warranty, implied or otherwise,
regarding these products' performance or reliability.

Additional query words: prodnt

======================================================================
Keywords          :  
Technology        : kbWinNTsearch kbWinNTWsearch kbWinNT351search kbWinNT350search kbWinNTW350 kbWinNTW350search kbWinNTW351search kbWinNTW351 kbWinNTSsearch kbWinNTS351 kbWinNTS350 kbWinNTS351search kbWinNTS350search
Version           : 3.50 3.51

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>