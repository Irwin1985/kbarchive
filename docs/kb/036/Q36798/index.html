<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q36798: Microsoft System Journal M macros Fail | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q36798: Microsoft System Journal M macros Fail" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/036/Q36798/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/036/Q36798/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q36798: Microsoft System Journal M macros Fail","url":"http://jeffpar.github.io/kbarchive/kb/036/Q36798/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q36798-microsoft-system-journal-m-macros-fail">Q36798: Microsoft System Journal M macros Fail</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q36798
Product(s): See article
Version(s): 1.00 1.01 | 1.00 1.01
Operating System(s): MS-DOS | OS/2
Keyword(s): ENDUSER | | mspl13_basic
Last Modified: 20-OCT-1988

In the September 1988 issue of the "MS System Journal," the article
entitled "Customizing the Features of the M Editor Using Macros and C
Extensions" contains erroneous examples.

Both of the macros below fail in Version 1.00. Only the Bigprint macro
fails in Version 1.01.

The following is an example:

Macro 1)

;print selected text macro
print1:= copy arg "&lt;clipboard&gt;" setfile
print2:= arg arg "TEMP.DAT" setfile setfile
print3:= arg "PRINT TEMP.DAT" shell
print4:= arg "DEL TEMP.DAT" shell
printa:=print1 print2 print3 print4
Printa:alt+P

The above macro is supposed to print selected text. In M Version 1.00
it works correctly the first time it is called from inside a file.
However, it fails on subsequent calls to the macro prior to exiting
the file. It does work correctly in the unreleased Version 1.01
referenced in the article.

The following macro is supposed to print the entire file. Instead, it
prints only the line on which the cursor sits when the macro is
called. As mentioned above, this fails in both Versions 1.00 and the
unreleased Version 1.01 referred to in the article on Pages 59-72.

The following is an example:

Macro 2)

;bigprint macro to print entire file
select1:= arg ppage
select2:= arg arg "endoffile" mark
select3:= arg mpage
select4:= arg "endoffile"
selectall:= select1 select2 select3 select4
bigprint:=meta +&gt;nometa cancel selectall meta :&gt;nometa meta printa

bigprint:Alt+z
;end of bigfoot macro.
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>