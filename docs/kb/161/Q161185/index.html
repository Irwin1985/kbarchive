<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q161185: FIX: Report Calling Custom Method Returns Incorrect Info | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q161185: FIX: Report Calling Custom Method Returns Incorrect Info" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/161/Q161185/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/161/Q161185/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q161185: FIX: Report Calling Custom Method Returns Incorrect Info","url":"http://jeffpar.github.io/kbarchive/kb/161/Q161185/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q161185-fix-report-calling-custom-method-returns-incorrect-info">Q161185: FIX: Report Calling Custom Method Returns Incorrect Info</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q161185
Product(s): Microsoft FoxPro
Version(s): WINDOWS:5.0
Operating System(s): 
Keyword(s): kbprogramming kbvfp kbvfp500aFIX kbvfp500bugkbbuglist kbfixlist
Last Modified: 11-DEC-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, version 5.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

A report that calls a function defined in a custom class prints the information
incorrectly. However, in preview mode, values from the custom class appear
correctly.

RESOLUTION
==========

Place the Date() function directly in the Expression box of the text box or use
a user-defined function (UDF) to return the desired value.

STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products listed at
the beginning of this article. This problem has been fixed in Visual FoxPro
5.0a.

MORE INFORMATION
================

The example below defines a custom class that returns a character string and the
system date. If the report is previewed, the date appears correctly. Printing
the report, however, causes the date value to appear as a logical value (.T.).
The behavior does not occur in Visual FoxPro 3.0b.

Steps to Reproduce Behavior
---------------------------

1. Create a report called Ztest.frx. Place the Customer table from the Testdata
  database, located in the \Vfp5\Samples\Data\ folder, in the DataEnvironment.

2. Place two text boxes in the report. In the Expression box of the first text
  box, type "oTest.cUser" (without the quotation marks). In the Expression box
  of the second text box, type "oTest.dToday()" (without the quotation marks).
  Close and save the report.

3. Create a program containing the following code:

     oTest = CREATEOBJECT("Test")
     ? oTest.cUser
     ? oTest.dToday()
     * REPORT FORM ztest RECORD 3 TO PRINTER
     REPORT FORM ztest PREVIEW

     DEFINE CLASS test AS CUSTOM
        cUser = "Testing"
        FUNCTION dToday
        RETURN DATE()
        ENDFUNCTION
     ENDDEFINE

4. Run the program and note that the date appears correctly. Close the Preview
  window.

5. Open the program and remove the asterisk (*) from the first REPORT FORM
  command, and place and asterisk in front of the second REPORT FORM command.
  The asterisk character comments out individual lines of code.

6. Run the program and note that the printed report displays ".T." where the
  date should be.

NOTE: Printing the report from the Preview Toolbar in Step 4 also illustrates the
problem.

Additional query words:

======================================================================
Keywords          : kbprogramming kbvfp kbvfp500aFIX kbvfp500bug kbbuglist kbfixlist
Technology        : kbVFPsearch kbAudDeveloper kbVFP500
Version           : WINDOWS:5.0
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>