<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q161051: Windows NT Shares Inaccessible with Net Use in Login Script | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q161051: Windows NT Shares Inaccessible with Net Use in Login Script" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/161/Q161051/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/161/Q161051/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q161051: Windows NT Shares Inaccessible with Net Use in Login Script","url":"http://jeffpar.github.io/kbarchive/kb/161/Q161051/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q161051-windows-nt-shares-inaccessible-with-net-use-in-login-script">Q161051: Windows NT Shares Inaccessible with Net Use in Login Script</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q161051
Product(s): Microsoft Windows 95.x Retail Product
Version(s): 2,2.1
Operating System(s): 
Keyword(s): kbnetwork osr2 win95kbfixlist
Last Modified: 13-MAR-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows 95 
- Microsoft Windows 95 OEM Service Release, versions 2, 2.1 
-------------------------------------------------------------------------------

SYMPTOMS
========

When NET USE commands are used in a Windows NT login script to connect to
Windows NT servers in various domains, you may not be able to access those
drives.

A network drive may appear in Windows Explorer, but when you click the drive, an
error message such as "No files found" or "Access denied" may appear. If you
disconnect the network drive and then reconnect to the same resource, you can
then access the files on the drive.

Also, the following error message may occur when a login script with NET USE
commands is being used:

  Profile error 4: The file cannot be created. The volume may not support long
  file names. Some of your profile settings may not be available. Do you want
  to see this message in future?

Also, when you try to map a drive through a login script with NET USE commands,
you may intermittently be prompted for your password.

CAUSE
=====

This symptom can occur if all of the following conditions exists:

- The Windows NT domains are organized into a Multiple Master domain model, in
  which there are at least two Master (account) domains trusted by the Resource
  domains.

- User accounts with the same user name, but different passwords, exist in more
  than one of the Master domains.

- The NET USE command in the login script is attempting to map a drive to a
  share on a server that is a member of a Resource domain.

RESOLUTION
==========

To work around this issue, ensure that user account names are unique across all
Master Domains.

This issue is resolved by the following updated file for Windows 95 and OSR2, and
later versions of this file:

  MSNET32.DLL  version 4.00.952  dated 5/23/96  60,416 bytes

STATUS
======

This issue is resolved in Microsoft Windows 98.

MORE INFORMATION
================

This problem occurs when different user accounts exist in different Master
domains, but with the same user name. For example:

   Domain    User name   Password   Full name
   --------------------------------------------
   MASTER1   JOHNSMIT    abcdefg    John Smith
   MASTER2   JOHNSMIT    tuvwxyz    John Smiter

Under these conditions, the logon domain name is not included in the user account
information sent by Windows 95 when the NET USE command is issued. Therefore,
the user name is not necessarily resolved to the correct user account in the
correct domain. The NET USE command may finish without errors, but the command
is processed for the wrong user account. If the passwords are different, the
password is incorrect for that account, and access is denied.


Additional query words:

======================================================================
Keywords          : kbnetwork osr2 win95 kbfixlist
Technology        : kbWin95search kbOPKSearch kbZNotKeyword3 kbWin95OPKOSR2 kbWin95OPKOSR210
Version           : :2,2.1
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>