<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q26677: &quot;Out of Memory,&quot; &quot;Error R6005,&quot; with CHAIN/RUN in DOS 2.x | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q26677: &quot;Out of Memory,&quot; &quot;Error R6005,&quot; with CHAIN/RUN in DOS 2.x" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/026/Q26677/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/026/Q26677/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q26677: &quot;Out of Memory,&quot; &quot;Error R6005,&quot; with CHAIN/RUN in DOS 2.x","url":"http://jeffpar.github.io/kbarchive/kb/026/Q26677/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q26677-out-of-memory-error-r6005-with-chainrun-in-dos-2x">Q26677: "Out of Memory," "Error R6005," with CHAIN/RUN in DOS 2.x</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q26677
Product(s): See article
Version(s): 3.00 4.00 4.00b 4.50
Operating System(s): MS-DOS
Keyword(s): ENDUSER | buglist3.00 buglist4.00 buglist4.00b buglist4.50 B_BasicCom | mspl13_basic
Last Modified: 4-SEP-1990

Below are some DOS versions 2.x-specific problems with the CHAIN
and/or RUN statements that can be avoided by running the program under
DOS version 3.00 or later. The symptoms differ in three different
cases, depending on whether you have the following:

1. QuickBASIC version 4.00.

2. QuickBASIC version 4.00b or 4.50, or Microsoft BASIC Compiler
   version 6.00 or 6.00b, which CHAIN correctly in DOS versions 2.x
   when compiled with the BRUN library (unlike version 4.00). However,
   as in version 4.00, CHAIN or RUN still fails in these versions when
   compiled with the BCOM library.

3. QuickBASIC version 3.00.

Microsoft has confirmed this to be a problem in QuickBASIC versions
3.00, 4.00, 4.00b, and 4.50, and in Microsoft BASIC Compiler version
6.00 or 6.00b for MS-DOS and OS/2 (buglist6.00, buglist6.00b). This
problem was corrected in Microsoft BASIC Professional Development
System (PDS) versions 7.00 and 7.10 (fixlist7.00, fixlist7.10).

Note that to avoid another cause of a DOS or BASIC error message when
executing CHAIN or RUN, you must put the DOS 2.10 COMMAND.COM (command
interpreter) on each disk (or floppy) where you use BASIC or
QuickBASIC .EXE programs under DOS 2.10.

Programs compiled in Microsoft BASIC Professional Development System
(PDS) versions 7.00 and 7.10 let you work around CHAIN problems under
DOS versions 2.x. According to the 7.00 and 7.10 README.DOC file, you
must CHAIN as follows:

   Under DOS 2.1, CHAIN &lt;filespec$&gt; will not work unless &lt;filespec$&gt;
   provides a path. Also under DOS 2.1, if the run-time module is in
   the root directory, the root directory must be listed in the PATH
   environment variable.

Also, you must put the DOS 2.10 COMMAND.COM (command interpreter) on
each disk (or floppy) where you use .EXE programs under DOS 2.10, or
else you will get a DOS or BASIC error message.

Another workaround under MS-DOS version 2.10 for programs compiled in
BASIC PDS 7.00 and 7.10 is, instead of CHAIN or RUN, to LINK with
overlays and use OVLDOS21.OBJ for DOS 2.10 support. However,
converting from using CHAIN or RUN to using link overlays requires
redesigning your program.

Note: QuickBASIC versions 4.00 and later require DOS version 2.10,
2.11, or later.

The CHAIN statement gives run-time errors such as "Out of Memory,"
"Error R6005," or MS-DOS "EXEC failure" in QuickBASIC version 4.00
programs (compiled with the BRUN40.LIB or BCOM40.LIB library) under
DOS versions 2.x. These problems don't occur in DOS versions 3.00 or
later.

The following are workarounds for the QuickBASIC version 4.00 CHAIN
problem under DOS versions 2.x when you compile with the BRUNxx.LIB
library:

1. Using the RUN statement instead of the CHAIN statement works around
   the problem in version 4.00 when you compile with the BRUN library
   (but not if you compile with the BCOM library).

2. When compiled with the BRUN library option in QuickBASIC version
   4.00b or 4.50, or Microsoft BASIC Compiler version 6.00 or 6.00b for
   MS-DOS and MS OS/2, CHAIN works properly under DOS versions 2.x
   (but not if you compile with the BCOM library).

For programs compiled with the BCOM library (BC /O option), the CHAIN
and RUN statements fail on the SECOND CHAIN or RUN attempt on DOS
versions 2.x, when compiled in QuickBASIC version 4.00, 4.00b, or
4.50, or in Microsoft BASIC Compiler version 6.00 or 6.00b.

The following error messages can occur: "Out of Memory," "Error
R6005," or MS-DOS "Not enough memory to exec."

When compiled with BRUN30.LIB from QuickBASIC version 3.00, the
programs run properly. However, programs compiled with BCOM30.LIB from
QuickBASIC version 3.00 incorrectly produce the message "Out of memory
during CHAIN" when the first program CHAINs to the second.

The following two sample programs demonstrate the above problems:

   ' Prog1
   PRINT "hello"
   a$ = INKEY$
   IF a$ &lt;&gt; "" THEN END
   CHAIN "prog2"

   ' Prog2
   PRINT "program 2"
   a$ = INKEY$
   IF a$ &lt;&gt; "" THEN END
   CHAIN "prog1"

The above programs compiled in QuickBASIC version 4.00 with BRUN40.LIB
produce the message "Out of memory during CHAIN" when the first
program CHAINs to the second. This error does not occur in QuickBASIC
version 4.00b or 4.50 or in Microsoft BASIC Compiler version 6.00 or
6.00b compiled with BRUNxx.LIB.

You can successfully RUN or CHAIN from the first program to the second
if you compile with BCOMxx.LIB (BC /O). However, the message "Runtime
Error R6005" or "EXEC Failure" displays when the second program tries
to RUN or CHAIN back to the first. This problem occurs in programs
compiled with BCOMxx.LIB in QuickBASIC 4.00, 4.00b, and 4.50 and BASIC
compiler 6.00 and 6.00b.
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>