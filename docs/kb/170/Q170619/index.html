<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q170619: Windows 95 ServiceProvider Priority Values Not Applied | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q170619: Windows 95 ServiceProvider Priority Values Not Applied" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/170/Q170619/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/170/Q170619/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q170619: Windows 95 ServiceProvider Priority Values Not Applied","url":"http://jeffpar.github.io/kbarchive/kb/170/Q170619/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q170619-windows-95-serviceprovider-priority-values-not-applied">Q170619: Windows 95 ServiceProvider Priority Values Not Applied</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q170619
Product(s): Microsoft Windows 95.x Retail Product
Version(s): 1,2,2.1
Operating System(s): 
Keyword(s): kbnetwork osr1 osr2 win95kbfixlist
Last Modified: 25-MAR-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows 95 
- Microsoft Windows 95 OEM Service Release, versions 1, 2, 2.1 
-------------------------------------------------------------------------------

IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, you should first make a backup copy of the
registry files (System.dat and User.dat). Both are hidden files in the
Windows folder.

SYMPTOMS
========

When you configure the ServiceProvider Priority values in the registry to modify
the DNS search order, the search order may not seem to be changed.

CAUSE
=====

A ServiceProvider registry key exists (with associated registry values) at the
following registry location:

  HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\VxD\MSTCP\ 
  ServiceProvider

However, the Winsock code incorrectly references the ServiceProvider registry key
at the following location:

  HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\MSTCP\ 
  ServiceProvider

RESOLUTION
==========

To workaround this issue, use the following steps: WARNING: Using Registry
Editor incorrectly can cause serious problems that may require you to reinstall
Windows 95. Microsoft cannot guarantee that problems resulting from the
incorrect use of Registry Editor can be solved. Use Registry Editor at your own
risk.

NOTE: For information about how to edit the registry, view the Changing Keys And
Values online Help topic in Registry Editor (Regedit.exe). Note that you should
make a backup copy of the registry files (System.dat and User.dat) before you
edit the registry.

Create the registry key being referenced by Winsock. To do so, use the following
steps:

1. Use Regedit.exe to open the following location:

     HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services

2. On the Edit menu, point to New, and then click Key. Name the new key MSTCP.

3. Click the new MSTCP key, point to New on the Edit menu, and then click Key.
  Name the new key ServiceProvider. The registry path should look like this:

     HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\MSTCP\ 
     ServiceProvider

4. Click the new ServiceProvider key, point to New on the Edit menu, and then
  click Binary Value. Create the following new binary values:

   - DnsPriority
   - LocalPriority
   - HostsPriority
   - NetbtPriority.

5. Set the priority values as appropriate.


STATUS
======

This problem no longer occurs in Windows 98. To resolve this problem, install
the current version of Windows. For information about the current version of
Windows, visit http://www.microsoft.com/windows.

MORE INFORMATION
================

For additional information, see the following articles in the Microsoft
Knowledge Base:

  Q158474 Windows TCP/IP Registry Entries

  Q139270 How to Change Name Resolution Order on Windows 95 and Windows NT


Additional query words:

======================================================================
Keywords          : kbnetwork osr1 osr2 win95 kbfixlist
Technology        : kbWin95search kbOPKSearch kbZNotKeyword3 kbWin95OPKOSR2 kbWin95OPKOSR1 kbWin95OPKOSR210
Version           : :1,2,2.1
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>