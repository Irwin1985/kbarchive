<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q188905: FIX: Sharing a File from Command Line Causes Corruption | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q188905: FIX: Sharing a File from Command Line Causes Corruption" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/188/Q188905/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/188/Q188905/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q188905: FIX: Sharing a File from Command Line Causes Corruption","url":"http://jeffpar.github.io/kbarchive/kb/188/Q188905/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q188905-fix-sharing-a-file-from-command-line-causes-corruption">Q188905: FIX: Sharing a File from Command Line Causes Corruption</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q188905
Product(s): Microsoft SourceSafe
Version(s): WINDOWS:5.0
Operating System(s): 
Keyword(s): kbSSafe500bug kbSSafe600fix kbAnalyze kbSSafeAnalyze
Last Modified: 31-JUL-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual SourceSafe for Windows, version 5.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

After running Analyze.exe with the -f switch, you may find the following message
in the Analyze.log file:

  The project &lt;Project Name&gt; contains a child that does not recognize
  this project as a parent. The child will be added to the project.

CAUSE
=====

A file is shared to a project that contains a shared and deleted copy of the
same file.

RESOLUTION
==========

Avoid sharing a file from the command line when the file contains a deleted link
to the target project. If you want to share the file, either recover the file or
purge the shared file and share it again.



STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products listed at
the beginning of this article. This problem has been corrected in Visual
SourceSafe 6.0.

MORE INFORMATION
================

Assume that you have a file named $/Proj1/File1 and a project named $/Proj2.
File1 is shared from Proj1 to Proj2, then deleted (not destroyed) from Proj2. If
you try to share the file again from the SourceSafe explorer, the following
error occurs:

  A deleted link to File1.txt already exists ...

Sharing the file from the command does not create an error, but Analyze displays
the following error:

  The project Proj2 contains a child that does not recognize this project as a
  parent. The child will be added to the project.


Steps to Reproduce Behavior
---------------------------

1. Create two projects and name them $/Proj1 and $/Proj2.

2. Add a file named File1.txt to $/Proj1 .

3. Right-click project Proj2 and then from the Context menu, choose Share.

4. In the Share dialog box, select the file File1 under $/Proj1.

5. Click Share, and then click OK.

6. Delete the file, File1.txt from $/Proj2.

7. Repeat steps 3-5.

8. The following error message appears:

  A deleted link to File1.txt already exists.

9. From the command prompt, run the following commands:

  ss cp $/proj2
  ss share $/proj1/File1.txt

  The files share and no error occurs.

Additional query words:

======================================================================
Keywords          : kbSSafe500bug kbSSafe600fix kbAnalyze kbSSafeAnalyze 
Technology        : kbSSafeSearch kbAudDeveloper kbSSafe500
Version           : WINDOWS:5.0
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>