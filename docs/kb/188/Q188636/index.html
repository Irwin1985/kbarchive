<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q188636: XADM: Error Generating OAB from Large Containers | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q188636: XADM: Error Generating OAB from Large Containers" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/188/Q188636/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/188/Q188636/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q188636: XADM: Error Generating OAB from Large Containers","url":"http://jeffpar.github.io/kbarchive/kb/188/Q188636/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q188636-xadm-error-generating-oab-from-large-containers">Q188636: XADM: Error Generating OAB from Large Containers</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q188636
Product(s): Microsoft Exchange
Version(s): WINDOWS:4.0,5.0,5.5
Operating System(s): 
Keyword(s): 
Last Modified: 21-APR-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, versions 4.0, 5.0, 5.5 
-------------------------------------------------------------------------------

SYMPTOMS
========

When attempting to generate the Offline Address Book (OAB) using the Global
Address List or certain large containers, the following error message is
generated:

  An error occurred while generating the offline Address Book. To
  view details, see the application event log in the Windows NT
  Event Viewer on the offline Address Book server.

  Microsoft Exchange Administrator
  ID no. c1031662

The Event Viewer will log the following event:

  Event ID 5004
  Generation of the offline Address Book is complete. Result: An
  error occurred.

CAUSE
=====

The above error is generated when the mailboxes or custom recipients in the
containers have unique SMTP domains in their SMTP addresses.

For example, consider a recipient container called "Foreign Recipients" that
contains custom recipients. Each of the custom recipients has an SMTP address
that has the following format:

  Invalid_Name@&lt;Alias&gt;.Unused

Where &lt;Alias&gt; is the Alias of the custom recipient.

The above SMTP addresses may be generated by importing the custom recipients with
predefined SMTP addresses instead of allowing the Exchange Server proxy
generator to generate the SMTP address.

The idea behind generating SMTP addresses with the above format may be to prevent
external users from being able to mail to the custom recipients.

When the Offline Address Book is being generated, if the number of SMTP domains
in the SMTP addresses being added to the OAB is very large, the above error
message is generated.

WORKAROUND
==========

Change the SMTP addresses so that each recipient does not have a unique SMTP
domain name. Normally, all recipients should have the same domain name in their
SMTP addresses.

This can be done by exporting out the directory information for the affected
recipients to a .csv file, using the Exchange Server Administrator program. On
the Tools menu, click Directory Export. Then modify the SMTP address in the
E-Mail Addresses column of the .csv file. Import the modified file back into the
Exchange directory store.

======================================================================
Keywords          :  
Technology        : kbExchangeSearch kbExchange500 kbExchange550 kbExchange400 kbZNotKeyword2
Version           : WINDOWS:4.0,5.0,5.5
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>