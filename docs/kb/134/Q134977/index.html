<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q134977: FIX: Error Occurs When Remove Object That Has Pending Code | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q134977: FIX: Error Occurs When Remove Object That Has Pending Code" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/134/Q134977/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/134/Q134977/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q134977: FIX: Error Occurs When Remove Object That Has Pending Code","url":"http://jeffpar.github.io/kbarchive/kb/134/Q134977/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q134977-fix-error-occurs-when-remove-object-that-has-pending-code">Q134977: FIX: Error Occurs When Remove Object That Has Pending Code</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q134977
Product(s): Microsoft FoxPro
Version(s): WINDOWS:3.0
Operating System(s): 
Keyword(s): kbbuglist kbfixlist
Last Modified: 24-MAR-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, version 3.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When a new form or a form that has been recently modified is instantiated for
the first time by using the DO FORM &lt;formname&gt; command or by any other
means, the user sees an error message and Visual FoxPro closes.

- In Windows for Workgroups version 3.11, the error is a Win32S error.

- In Windows NT, the error is an Application error.

- In Windows 95, the error is an illegal operation error similar to this one:

  This program has performed an illegal operation and will be shut down. If the
  problem persists, contact the program vendor.

  The details presented in Windows 95 are similar to this:

  Visual FoxPro caused an invalid page fault in module VFP.EXE at
  0137:0040dbc5."

CAUSE
=====

In one of the methods of one (or more) of the objects, the developer has placed
at least one command in the code call stack. (The code call stack is a list of
pointers to Visual FoxPro commands that will run when a specified event takes
place.) The code placed in the call stack is triggered by a specific event. In
this case, the specific event takes place during the form load procedure.

That triggered code, or other code in a method of one of the other objects on the
form, removes the object and its methods from the form. Therefore, when the
pointer in the call stack triggers the code, the problem occurs because the
owning object, along with the code, has been removed.

WORKAROUND
==========

There may be times when the developer needs to have an object rendered invisible
to the user. Rather than issuing a REMOVEOBJECT, the developer can set the
object's visible property to false (.F.).

STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products listed at
the beginning of this article. This problem was corrected in Visual FoxPro 3.0b
for Windows.

MORE INFORMATION
================

Steps to Reproduce Problem
--------------------------

1. In the Command window of Visual FoxPro, issue this command:

     MODIFY FORM TEST

2. In the Form Designer, place a command button on Form1.

3. In the Refresh method of the command button, enter this line of code:

     THISFORM.REMOVEOBJECT(This.Name)

4. Save the form definition as TEST, and close the Form Designer.

5. In the Command window, issue this command:

     DO FORM TEST

Additional query words: 3.00 VFoxWin fixlist3.00b buglist3.00

======================================================================
Keywords          :  kbbuglist kbfixlist
Technology        : kbVFPsearch kbAudDeveloper kbVFP300
Version           : WINDOWS:3.0
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>