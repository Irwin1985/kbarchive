<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q134245: FIX: Multi-Select List Box Does Not Retain Selected Items | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q134245: FIX: Multi-Select List Box Does Not Retain Selected Items" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/134/Q134245/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/134/Q134245/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q134245: FIX: Multi-Select List Box Does Not Retain Selected Items","url":"http://jeffpar.github.io/kbarchive/kb/134/Q134245/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q134245-fix-multi-select-list-box-does-not-retain-selected-items">Q134245: FIX: Multi-Select List Box Does Not Retain Selected Items</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q134245
Product(s): Microsoft FoxPro
Version(s): 3.00 3.00b
Operating System(s): 
Keyword(s): kbvfp kbvfp300bBUG kbvfp500fixkbbuglist kbfixlist
Last Modified: 24-MAR-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b 
-------------------------------------------------------------------------------

SYMPTOMS
========

A List Box that has the Multi-Select property set to True does not always retain
the selected items.

WORKAROUND
==========

Listed below are two workarounds:

- Create a mover-type list box to move the items from one list to another.

  -or-

- Populate the list box using the AddItem method, and set the RowSourceType to
  None, instead of basing the list box on fields.

For more information about the behavior of list boxes when set to None, please
see the following article in the Microsoft Knowledge Base:

  Q136588 PRB: List Boxes and Combo Boxes Lose Item Properties

Steps Populate the List Box Using AddItem Method
------------------------------------------------

The following steps can be used to fix the sample listed later in this article,
under the "Steps to Reproduce Problem" section, assuming that the customer table
from Testdata.dbc has first been added to the data environment.

1. Change the following properties of the list box:

        RowSourceType=none - 1
        RowSource=(empty)

2. Place the following in the Init Method of the list box:

        SCAN
        THIS.ADDITEM(cust_id, RECNO(), 1)
        THIS.LIST(RECNO(), 2)=address
        ENDSCAN

3. In the RightClick Method of the list box add the following:

        FOR i= 1 to THIS.LISTCOUNT
          IF THIS.SELECTED(i)
          ? THIS.LIST(i)
          ENDIF
        ENDFOR

STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products listed at
the beginning of this article. This problem has been fixed in Visual FoxPro 5.0
for Windows.

MORE INFORMATION
================

Steps to Reproduce Problem
--------------------------

1. Create a form, and place a list box on it.

2. Set the list box properties as follows:

     ColumnCount = 2
     ColumnWidths=50,200
     Multi-Select = .T.
     RowSource=customer.customer_id,address
     RowSourceType=6-Fields

3. Run the form, and select the first item. Hold down the SHIFT key, and use the
  elevator bar to go to the bottom of the list and select the last item.

4. Scroll from the bottom of the list to the top to verify that all of the items
  are still selected. You will see that some of the items are no longer
  selected. The items that are no longer selected are not always the same
  items; they may vary from trial to trial.

Additional query words: multiselect

======================================================================
Keywords          : kbvfp kbvfp300bBUG kbvfp500fix kbbuglist kbfixlist
Technology        : kbVFPsearch kbAudDeveloper kbVFP300 kbVFP300b
Version           : 3.00 3.00b
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>