<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q134308: FIX: Upper Format Truncates Right/Center-Alligned Report Field | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q134308: FIX: Upper Format Truncates Right/Center-Alligned Report Field" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/134/Q134308/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/134/Q134308/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q134308: FIX: Upper Format Truncates Right/Center-Alligned Report Field","url":"http://jeffpar.github.io/kbarchive/kb/134/Q134308/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q134308-fix-upper-format-truncates-rightcenter-alligned-report-field">Q134308: FIX: Upper Format Truncates Right/Center-Alligned Report Field</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q134308
Product(s): Microsoft FoxPro
Version(s): WINDOWS:3.0,3.0b
Operating System(s): 
Keyword(s): kbvfp kbvfp300bBUG kbvfp500fixkbbuglist kbfixlist
Last Modified: 24-MAR-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b 
-------------------------------------------------------------------------------

SYMPTOMS
========

When using a report designed with a field, variable, or expression formatted as
uppercase and justified (alligned) either to the right or center of the area on
the page for that field, you may encounter a probem. Upon clicking the OK button
to open and close the report expression dialog box repeatedly (usually done
after previewing or printing the report), you may see that the field, variable,
or expression has been reduced to a single character; all the characters to the
right of the first character have been truncated. The field, variable, or
expression now appears as a single uppercase character alligned to the right or
to the center. The format picture code character string of "@!J" (without the
quotes) is transposed and enlarged to the string "@J&lt;space&gt;!"

Each time the Report Expression dialog box is reentered the number of spaces
between the justification code (J for right, I for center) and the uppercase
code (!) is increased by one if the OK button is used to close the dialog box.

WORKAROUND
==========

One way to restore the field to the desired format is to delete the format
picture codes from the Format text box in the Report Expression dialog box. Then
click the three-dot button at the right to move to the Format dialog. Restore
the formats by selecting the To Upper Case check box, and the appropriate
justification check box.

Another way to work around the problem is to delete the space(s) that appear in
the format picture codes string between the justification character (a J or an
I) and the exclamation point that indicates uppercase. This is the string that
appears in the Format text box in the Report Expression dialog box.

STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products listed at
the beginning of this article. This problem has been fixed in Visual FoxPro 5.0
for Windows.

MORE INFORMATION
================

Steps to Reproduce Problem
--------------------------

1. Set the default directory to Samples\Data.

2. Open the Testdata database by using the MODIFY DATABASE TESTDATA command,

3. Open the Customer table by using the USE CUSTOMER command.

4. Create a new report consisting of the Company, Contact, and Title fields. To
  do this, on the File menu, click New. Then click Report, and click New File.
  Then open the data environment of the report and add the Customer table to
  it. Drag the selected fields to the Detail band of the Report Designer.

5. Double-click the Contact field to open the Report Expression dialog box.

6. Click the three-dot button located to the right of the Format text box.

7. Select the To Upper Case check box under Editing Options.

8. Clear the Left justify check box, and select the Right justify check box.

9. Click OK to return to the Report Expression dialog box. Note the format
  picture codes. Now click OK to exit the Report Expression dialog box.

10. On the View menu, click Preview. Note that the Contact field appears is in
  uppercase and right-justified (right-alligned).

11. On the Preview toolbar, click the open door icon to return to the Report
  Designer.

12. Double-click the Contact field to open the Report Expression dialog box.
  Here you will observe, in the Format edit box that the picture code
  characters are in a sequence different from that originally seen.

13. Click OK to return to the Report Designer, and on the View menu, click
  Preview to preview the report again. Note that the Contact field is now a
  single uppercase letter positioned at the right of the field's area on the
  report.

14. Return to the Report Designer. Double-click the Contact field. Note the
  spacing between characters in the Format text box.

15. Click OK. Then double-click the Contact field again, and note that the
  spaces in the Format text box have increased by one.

Additional query words: 3.00 3.00b picture function

======================================================================
Keywords          : kbvfp kbvfp300bBUG kbvfp500fix kbbuglist kbfixlist
Technology        : kbVFPsearch kbAudDeveloper kbVFP300 kbVFP300b
Version           : WINDOWS:3.0,3.0b
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>