<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q194910: FIX: Cannot Set ImageList for ImageCombo at Design on MDIForm | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q194910: FIX: Cannot Set ImageList for ImageCombo at Design on MDIForm" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/194/Q194910/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/194/Q194910/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q194910: FIX: Cannot Set ImageList for ImageCombo at Design on MDIForm","url":"http://jeffpar.github.io/kbarchive/kb/194/Q194910/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q194910-fix-cannot-set-imagelist-for-imagecombo-at-design-on-mdiform">Q194910: FIX: Cannot Set ImageList for ImageCombo at Design on MDIForm</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q194910
Product(s): Microsoft Visual Basic for Windows
Version(s): WINDOWS:6.0
Operating System(s): 
Keyword(s): kbservicepack kbCtrl kbVBp kbVBp600bug kbGrpDSVB kbVS600sp3fix
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Learning Edition for Windows, version 6.0 
- Microsoft Visual Basic Professional Edition for Windows, version 6.0 
- Microsoft Visual Basic Enterprise Edition for Windows, version 6.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

An ImageCombo control on an MDIForm initially appears empty. Even when an item
is selected from the drop-down list it does not display any images.

CAUSE
=====

When on an MDIForm, the ImageCombo does not initially bind to its ImageList nor
does it display its text. So the image(s) does not appear if the ImageList
property of the ImageCombo was set at design-time.

RESOLUTION
==========

To make the image(s) appear, set the ImageList property of the ImageCombo at
run-time when on an MDIForm. To make the text display, set the focus to the
ImageCombo. Note that making the ImageCombo's TabIndex = 0 will not work.

STATUS
======

Microsoft has confirmed this to be a bug in the Microsoft products listed at the
beginning of this article.

This bug was corrected in Visual Studio 6.0 Service Pack 3.

For more information about Visual Studio 6.0 Service Packs, please see the
following articles in the Microsoft Knowledge Base:

Q194022 INFO: Visual Studio 6.0 Service Packs, What, Where, Why

Q194295 HOWTO: Tell That Visual Studio 6.0 Service Packs Are Installed

MORE INFORMATION
================


Steps To Reproduce
------------------

1. Create a Standard EXE project in Visual Basic. Form1 is created by default.

2. Select Components from the Project menu, select Microsoft Windows Common
  Controls 6.0," and click OK.

3. Add an MDIForm, MDIForm1, to the project.

4. Choose Properties from the Project menu and make MDIForm1 the Startup Object.

5. Place a PictureBox onto MDIForm1.

6. Place an ImageList control and an ImageCombo into the PictureBox.

7. Alternate-click on ImageList and select Properties. Select the tab and insert
  an image into the ImageList.

8. From the Custom Properties of the ImageCombo, set the ImageList property to
  ImageList1.

9. Place the following into the MDIForm's module:

        Private Sub MDIForm_Load()
           ImageCombo1.ComboItems.Add , "Key1", "Test", 1, 1
           ImageCombo1.SelectedItem = ImageCombo1.ComboItems(1)
        End Sub

10. Run the project and note that the ImageCombo is initially blank.

11. Try to pick the item from the list. Note that at no time does the image
  appear, but the Text appears after the list has been dropped.

12. Close the project.

13. Change the code above (from step 9) to the following:

        Private Sub MDIForm_Load()
           ImageCombo1.ImageList = ImageList1   ' set ImageList at run-time
           ImageCombo1.ComboItems.Add , "Key1", "Test", 1, 1
           ImageCombo1.SelectedItem = ImageCombo1.ComboItems(1)
           Me.Show  ' Show now rather than after this event finishes
           ImageCombo1.SetFocus  ' This makes the Text appear
        End Sub

14. From the properties window of the ImageCombo, set ImageList to &lt;None&gt;.

15. Run the project and note that the image and text now immediately appear in
  the ImageCombo.

Additional query words:

======================================================================
Keywords          : kbservicepack kbCtrl kbVBp kbVBp600bug kbGrpDSVB kbVS600sp3fix 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB600Search kbVBA600 kbVB600
Version           : WINDOWS:6.0
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>