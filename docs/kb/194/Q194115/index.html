<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q194115: HOWTO: Use ADSI in VB to Enumerate the Computers in an NT Domain | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q194115: HOWTO: Use ADSI in VB to Enumerate the Computers in an NT Domain" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/194/Q194115/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/194/Q194115/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q194115: HOWTO: Use ADSI in VB to Enumerate the Computers in an NT Domain","url":"http://jeffpar.github.io/kbarchive/kb/194/Q194115/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q194115-howto-use-adsi-in-vb-to-enumerate-the-computers-in-an-nt-domain">Q194115: HOWTO: Use ADSI in VB to Enumerate the Computers in an NT Domain</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q194115
Product(s): Microsoft Visual Basic for Windows
Version(s): 2.0,2.5,5.0,6.0
Operating System(s): 
Keyword(s): kbADSI kbVBp500 kbVBp600
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Learning Edition for Windows, versions 5.0, 6.0 
- Microsoft Visual Basic Professional Edition for Windows, versions 5.0, 6.0 
- Microsoft Visual Basic Enterprise Edition for Windows, versions 5.0, 6.0 
- Microsoft Active Directory Service Interfaces, versions 2.0, 2.5 
-------------------------------------------------------------------------------

SUMMARY
=======

You can use the Microsoft Active Directory Service Interfaces (ADSI) to easily
enumerate the computers in an NT Domain. Simply create an IADsDomain object (the
domain) and an IADsComputer object (a computer),and then perform a loop for each
computer object in the domain object. The domain object is a container of the
computer objects.

MORE INFORMATION
================

An ADSI container object contains other objects. A container object controls the
objects within it, providing methods to create, filter, retrieve, copy, move and
delete the objects. A container object is different from a Collection, which is
a more limited set of items and methods. Container objects are used to represent
the hierarchical structures in the Active Directory Services.

One example of the differences between a Container and a Collection is in
enumeration of member objects. The syntax for enumerating the objects in a
container, for example, is:

     For Each Object In ContainerObject

An example of this is found in the code example:

     For Each Computer In TheDomain

The syntax for enumerating the objects in a Collection is:

     For Each Object In Collection.Objects

An example of this is enumerating the Controls collection of a form:

     For Each ctl In Form1.Controls

The IADsDomain object is a ADS container object that represents a domain on a
network.

The IADsComputer object represents the information about a computer on a network.
In some directory services, such as Windows NT, the computer object can also be
a container object, containing the services that the computer provides.

Step-by-Step Example
--------------------

To use the ADSI 2.0 object model, your system must have the ADSI run-time
installed. The run-time and Help file are available at"

  http://www.microsoft.com/backoffice/downloads.htm

Once you have installed the ADSI run-time, you will have the Active DS Type
Library (ActiveDS.tlb) available. The Active DS Type Library provides the ADSI
object model.

1. Create a Standard EXE project in Visual Basic. Form1 is created by default.

2. Set a reference to the Active DS Type Library by selecting Project,
  References, and then selecting Active DS Type Library.

  NOTE: You may not see the Active DS Type Library in the list of available
  References. To add the Library to the list:

  a. Click Browse.

  b. Go to the Windows\System folder or WinNT\System32 folder.

  c. Select the file ActiveDS.tlb.

  d. From now on, the Active DS Type Library is among the list of available
     References.

3. Add a ListBox and CommandButton to Form1.

4. Add the following code to Form1's Code Window.

  Private Sub Command1_Click()

       Dim TheDomain As IADsDomain
       Dim Computer As IADsComputer
       Dim strDomain As String
       Dim iMousePointer As Integer

       'Accept the Domain name
       strDomain = InputBox("Domain Name: ")

       'Use the WinNT Directory Services
       strDomain = "WinNT://" &amp; strDomain

       'Initialize the User Interface
       List1.Clear
       iMousePointer = Me.MousePointer
       Me.MousePointer = vbHourglass

       'Create the Domain object
       Set TheDomain = GetObject(strDomain)

      'Search for Computers in the Domain
       TheDomain.Filter = Array("Computer")

       For Each Computer In TheDomain
         List1.AddItem Computer.Name
       Next Computer

      'Clean up
       Me.MousePointer = iMousePointer
       Set Computer = Nothing
       Set TheDomain = Nothing

  End Sub 'Command1_Click

5. Run the test project by doing the following:

  a. Click CommandButton.

  b. When prompted, enter the Domain name. Depending on the number of computers
     in the domain, the enumeration may take a while.

REFERENCES
==========

In the Visual Basic Online Help Index, search for "collection."

In the ADSI Help file (ADSI.HLP) Index, search for "IADSDomain" and
"IADSComputer."

In the ADSI Help file Contents, choose Guide - Introduction to Active Directory
Service Interfaces - Code Examples - Automation examples and ADsPaths examples
for more Visual Basic code examples.

For an example of enumerating File Shares in a container, please see the
following article in the Microsoft Knowledge Base:

  Q169398 HOWTO: Manipulate File Shares with ADSI (VB Sample)

Additional query words:

======================================================================
Keywords          : kbADSI kbVBp500 kbVBp600 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbADSISearch kbZNotKeyword2 kbVB500Search kbVB600Search kbVBA500 kbVBA600 kbVB500 kbVB600 kbADSI200 kbADSI250
Version           : :2.0,2.5,5.0,6.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>