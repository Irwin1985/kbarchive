<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q298559: How to Load Balance Web Traffic Between Two IIS Servers | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q298559: How to Load Balance Web Traffic Between Two IIS Servers" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/298/Q298559/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/298/Q298559/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q298559: How to Load Balance Web Traffic Between Two IIS Servers","url":"http://jeffpar.github.io/kbarchive/kb/298/Q298559/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q298559-how-to-load-balance-web-traffic-between-two-iis-servers">Q298559: How to Load Balance Web Traffic Between Two IIS Servers</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q298559
Product(s): Internet Information Server
Version(s): 4.0
Operating System(s): 
Keyword(s): kbfaq
Last Modified: 26-MAY-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Server 4.0 
-------------------------------------------------------------------------------

SUMMARY
=======

This article describes how to set up certificates for secure communication
between servers and Web clients when the servers are load balanced.

MORE INFORMATION
================

To install certificates on load balanced Web servers, install the same key on
all the servers that are being load balanced. To do this, follow these steps:

1. Install the certificate on the first Web site.

For additional information, click the article number below to view the article in
the Microsoft Knowledge Base:

  Q228991 How to Create and Install an SSL Certificate in IIS 4.0

2. Export the key to the other server in the load balance. To do this, follow
  these steps:

  a. Open the Microsoft Management Console (MMC) for IIS and expand the
     Internet Information Server folder.

  b. Click the plus sign (+) sign next to the computer name.

  c. The default Web site is available now. Right-click the Default Web Site
     icon, click Properties, and then click the Directory Security tab.

  d. In Secure Communications, click the Edit button.

     NOTE: If the button reads Key Manager instead of Edit, you do not have an
     encryption certificate for the WWW service installed.

  e. In the second Secure Communications window, click Key Manager.

  f. In Key Manager, under Local Computer, select WWW.

  g. On the Key menu, click Export Key.

  h. Click Backup File and note the location where the file is stored. Copy the
     backup file to the other server that is being load balanced and note the
     location where it is copied.

3. Import the key onto the other Web servers that are being load balanced. To do
  this, follow these steps:

  a. Open the Microsoft Management Console (MMC) for IIS and expand the
     Internet Information Server folder.

  b. Click the plus sign (+) sign next to the computer name.

  c. The default Web site is available now. Right-click the Default Web Site
     icon, click Properties, and then click the Directory Security tab.

  d. In Secure Communications, click the Key Manager button.

     NOTE: If the button reads Edit instead of Key Manager, you already have an
     encryption certificate for the WWW service installed. You must delete this
     key before you proceed.

  e. In Key Manager, select WWW.

  f. On the Key menu, click Import Key.

  g. Click Backup File and browse to the location where the file was copied.

  h. Commit the changes and ensure that port 443 is entered in the SSL field on
     the Web Site tab within the default Web site.

You can now load balance SSL Web traffic between the server on which the
certificate was originally installed along with the server where the certificate
was imported to.

REFERENCES
==========

For more information, see the following article in the Microsoft Knowledge
Base:

  Q219277 Load Balancing HTTP with WLBS

Additional query words: iis 5, load balance, certificates, SSL

======================================================================
Keywords          :  kbfaq
Technology        : kbiisSearch kbiis400
Version           : :4.0
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>