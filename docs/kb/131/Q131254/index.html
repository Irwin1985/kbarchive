<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q131254: How to Manipulate DateTime Fields in a Grid | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q131254: How to Manipulate DateTime Fields in a Grid" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/131/Q131254/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/131/Q131254/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q131254: How to Manipulate DateTime Fields in a Grid","url":"http://jeffpar.github.io/kbarchive/kb/131/Q131254/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q131254-how-to-manipulate-datetime-fields-in-a-grid">Q131254: How to Manipulate DateTime Fields in a Grid</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q131254
Product(s): Microsoft FoxPro
Version(s): 3.00
Operating System(s): 
Keyword(s): 
Last Modified: 24-AUG-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, version 3.0 
-------------------------------------------------------------------------------

SUMMARY
=======

Microsoft Visual FoxPro introduces a new data type (DateTime) that allows a date
and time value to be stored in a single field. By default, Visual FoxPro
displays the data stored in a DateTime field in a "MM/DD/YY HH:MM:SS XM" format.
This article shows by example how to display just the date or just the time
portion of a DateTime field in a Visual FoxPro Grid.

MORE INFORMATION
================

Visual FoxPro does not offer a command or function to automatically retrieve
just the Date or just the Time portion of a DateTime field. The code provided
below creates two new methods (GetTime and GetDate) that can be called by the
Grid Column ControlSource property to display just the date or just the time of
a DateTime field.

Step-by-Step Example
--------------------

The following example assumes that a table already exists with a DateTime field
named tDateTime.

1. Create a new form by using this command:

     CREATE FORM newform

2. Add the proper table to the Data Environment by choosing Data Environment
  from the Form menu.

3. Add a Grid to the form by dragging the Grid control from the Form Controls
  toolbar to the form.

4. Change the ColumnCount property of the Grid to 2 (any number greater than
  zero will work).

5. From the Form menu, choose New Method. Name the new method GetTime.

6. Create a second new method named GetDate.

7. From the Properties sheet, select the Form1 object, and then select the
  Methods tab. Open the GetTime method.

8. Place the following code in the GetTime method:

     PARAMETERS tField
     justtime = SUBSTR(TTOC(tField),10)
     RETURN justtime

  The tDateTime field will be passed to the GetTime method from the Grid Column.
  The TTOC() function converts the field to character so that SUBSTR() can
  retrieve just the time portion of the field and return it to the grid.

9. Place the following code in the GetDate method:

     PARAMETERS tField
     justdate = SUBSTR(TTOC(tField),1,8)
     RETURN justdate

  The tDateTime field will be passed to the GetDate method from the Grid Column.
  The TTOC() function converts the field to character so that SUBSTR() can
  retrieve just the date portion of the field and return it to the grid.

10. Using the Properties sheet, select the Header1 object, and change the
  caption property to Just Time.

11. Select the Header2 object, and change the caption property to Just Date.

12. Change the ControlSource property of Column1 to:

      thisform.gettime(tDateTime)

13. Change the ControlSource property of Column2 to:

      thisform.getdate(tDateTime)

14. Save and run the form. The time portion of the tDateTime field displays in
  Column1 and the date portion displays in Column2. Note that the fields are
  read-only.

Additional query words: VFoxWin

======================================================================
Keywords          :  
Technology        : kbVFPsearch kbAudDeveloper kbVFP300
Version           : 3.00

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>