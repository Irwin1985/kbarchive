<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q131081: How to Set Object’s BackColor to Button Face’s BackColor | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q131081: How to Set Object’s BackColor to Button Face’s BackColor" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/131/Q131081/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/131/Q131081/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q131081: How to Set Object’s BackColor to Button Face’s BackColor","url":"http://jeffpar.github.io/kbarchive/kb/131/Q131081/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q131081-how-to-set-objects-backcolor-to-button-faces-backcolor">Q131081: How to Set Object’s BackColor to Button Face’s BackColor</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q131081
Product(s): Microsoft FoxPro
Version(s): WINDOWS:3.0
Operating System(s): 
Keyword(s): kbcode
Last Modified: 15-FEB-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, version 3.0 
-------------------------------------------------------------------------------

SUMMARY
=======

This article shows by example how to set the BackColor of an object to the
current button-face color. You can use this in a program to change the BackColor
of the form or form page color to match that of the button face or 3D color.

MORE INFORMATION
================

Step-by-Step Example Using Code
-------------------------------

The following program displays a form that contains one command button (Button1).
The code in the Click procedure sets the BackColor of the form to the current
BackColor of the button face.

1. From the File menu, choose New. Select the Program option, and choose the New
  File button to bring up the Modify Program window.

2. Enter the following code:

     oMyForm = CREATEOBJECT("MyForm")
     oMyForm.show
     READ EVENTS

     DEFINE CLASS MyForm AS FORM

        ADD OBJECT Button1 AS COMMANDBUTTON WITH ;
           caption="QUIT"

        PROCEDURE Click
           Local cColor cRGB
           m.cRGB = RGBSCHEME(1,2)
           m.cColor = 'RGB(' + SUBSTR(m.cRGB, AT(',', m.cRGB, 3) +1)
           This.BackColor = EVAL(cColor)
        ENDPROC

        PROCEDURE button1.Click
           CLEAR EVENTS
        ENDPROC
     ENDDEFINE

3. Save the Program, and run it. When the form displays, click an area of the
  form to see the BackColor of the form change to the BackColor of the button.

Step-by-Step Example Using the Form Designer
--------------------------------------------

To add this functionality to a Form by using the Visual FoxPro Form Designer,
follow these steps:

1. Add a command button to the form by using the Form Control Toolbar.

2. Using the secondary (right) mouse button, click the new command button
  object. Select Properties from the menu that appears.

3. Select the Layout tab in the Properties dialog box. Change the Caption
  property to QUIT.

4. Select the Methods tab in the Properties dialog box, and double-click the
  Click event to open the Code window for the Click Procedure of the command
  button. In the Code window for the Click event, type:

     THISFORM.RELEASE

  NOTE: This code differs from that used in the code example. The command
  THISFORM.RELEASE is used instead of CLEAR EVENTS because the READ EVENTS is
  not used to keep the form in memory when DO FORM &lt;formname&gt; is used.

5. Using the primary (left) mouse button, double-click the Form to open the Code
  window for the different events available for the Form.

6. Select Click from the Procedure list, and add the following code to this
  Click event:

     Local cColor cRGB
     m.cRGB = RGBSCHEME(1,2)
     m.cColor = 'RGB(' + SUBSTR(m.cRGB, AT(',', m.cRGB, 3) +1)
     This.BackColor = EVAL(cColor)

7. Save the Form, and run it.

Additional query words: VFoxWin

======================================================================
Keywords          : kbcode 
Technology        : kbVFPsearch kbAudDeveloper kbVFP300
Version           : WINDOWS:3.0

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>