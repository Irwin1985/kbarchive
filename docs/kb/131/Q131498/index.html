<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q131498: DLL with PROGRAM Statement Fails to Load | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q131498: DLL with PROGRAM Statement Fails to Load" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/131/Q131498/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/131/Q131498/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q131498: DLL with PROGRAM Statement Fails to Load","url":"http://jeffpar.github.io/kbarchive/kb/131/Q131498/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q131498-dll-with-program-statement-fails-to-load">Q131498: DLL with PROGRAM Statement Fails to Load</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q131498
Product(s): Microsoft Fortran Compiler
Version(s): 5.1
Operating System(s): 
Keyword(s): 
Last Modified: 02-NOV-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft FORTRAN Compiler for MS-DOS, version 5.1 
-------------------------------------------------------------------------------

SYMPTOMS
========

If a FORTRAN DLL contains a PROGRAM statement or other main section of code,
programs calling the DLL fail to load it; they return an error. The error
returned depends on the program.

- Visual Basic version 3.0 and Microsoft Word version 6.0 give an "Out of
  memory" error when attempting to call a function or subroutine in the DLL.

- Microsoft Excel version 5.0 reports "Run time error '48' Error in loading
  DLL" when attempting to call a function or subroutine in the DLL.

- A Windows-based application built in C that uses LoadLibrary() to load the
  DLL returns 0 (System was out of memory, executable file was corrupt, or
  relocations were invalid).

- An application that loads the DLL by linking with the DLL import library
  terminates the application upon loading the DLL. The Visual C++ debugger
  displays the message "Process 0xXXXX Terminated Normally (240)" if the
  program is being debugged. If the program is being executed, the program
  doesn't appear to execute but reports no warnings, errors, or messages. The
  program does not load and no window is displayed.

- A Windows-based application built in FORTRAN gives no warnings, errors, or
  messages. The program does not load and no window is displayed.

CAUSE
=====

A DLL should not have a PROGRAM statement.

STATUS
======

This behavior is by design.

MORE INFORMATION
================

Sample Code to Demonstrate Behavior
-----------------------------------

  C  Compile options needed: /Gw /Aw
  C
  C  DLL functions and subroutines
        SUBROUTINE SubroutineOne()
        ...
        END

        INTEGER*4 FUNCTION FunctionOne()
        ...
        END

  C  The code below is not needed for a DLL
        PROGRAM MainProgram
        ...
        END

Additional query words: 1.00 1.50 1.51 1.52 5.10

======================================================================
Keywords          :  
Technology        : kbAudDeveloper kbFortranSearch kbZNotKeyword3 kbFORTRAN510DOS
Version           : :5.1

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>