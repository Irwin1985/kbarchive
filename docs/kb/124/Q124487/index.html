<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q124487: PC Adm: How to Strand Attachment if It’s too Large for System | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q124487: PC Adm: How to Strand Attachment if It’s too Large for System" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/124/Q124487/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/124/Q124487/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q124487: PC Adm: How to Strand Attachment if It’s too Large for System","url":"http://jeffpar.github.io/kbarchive/kb/124/Q124487/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q124487-pc-adm-how-to-strand-attachment-if-its-too-large-for-system">Q124487: PC Adm: How to Strand Attachment if It’s too Large for System</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q124487
Product(s): Microsoft Mail For PC Networks
Version(s): WINDOWS:3.2,3.2a
Operating System(s): 
Keyword(s): 
Last Modified: 29-OCT-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Mail for Windows, versions 3.2, 3.2a 
-------------------------------------------------------------------------------

SUMMARY
=======

Sometimes a user will try to send a very large mail message (or a message with a
large attachment) from Microsoft Mail for Windows. This can cause some network
servers to run out of disk space or it can drastically slow network performance.

MORE INFORMATION
================

Only one copy of the message and attachment is kept on the postoffice (in the
MAILDATA directory). When a message is sent to a user, a record goes into that
user's mailbag (.MBG) file. The .MBG file in turn points to the message (.MAI)
file on the postoffice. If there is an attachment, it is contained in an .ATT
file, and the .MAI file contains a pointer that points to the .ATT file. Once
the user reads his or her mail from the Windows client, all the messages and
attachments get moved from the user's .MBG file into his or her personal Mail
message file (.MMF).

RESOLUTION
==========

If any users have not yet read mail containing the large attachment, a Mail
administrator can prevent those users from reading the message by "stranding"
the .ATT file on the postoffice. This procedure will remove the pointer to the
.ATT file, so that Mail will not be able to download it to those users' .MMF
files.

To prevent the mail message or attachment from interfering with any users who
have not yet viewed the message from Microsoft Mail for Windows:

1. Find a user who has not viewed this message in Microsoft Mail for Windows.

2. Log in as that user from the MS-DOS workstation.

  Make a note of the message text that is listed under the subject of the mail
  message with the large attachment.

3. Use the LISTUSER.EXE utility to get the hexadecimal ID (hexid) number of that
  user's .MBG file.

4. Use DEBUG.EXE on the .MBG file and look for the message text from the subject
  line noted in step 2. From the C:\MAILDATA\MBG directory, type the
  following:

  "debug 00000003.mbg" (without the quotation marks)

  This command will return a hyphen (-) sign. Type the following and then press
  ENTER.

  "d" (without the quotation marks)

  Keep typing "d" (without the quotation marks) until you see the message text.
  After the message text you will see an eight-digit hexadecimal number. This
  is the number of the .MAI file that points to the .ATT file. Type the
  following to exit DEBUG, and then press ENTER:

  "q" (without the quotation marks)

5. Go to the MAILDATA\MAI subdirectory. There are 16 subdirectories in the
  MAILDATA\MAI directory. The hexadecimal number you obtained in step 4
  corresponds to a &lt;hexid&gt;.MAI file in one of the 16 subdirectories. For
  example, If the hexid number is 00000017, look in the MA7 subdirectory for
  00000017.MAI. You can use Windows File Manager to search the MA*
  subdirectories for the location of the 00000017.MAI file.

6. Rename the 00000017.MAI file to some other name, such as BADMSG.OLD.

7. Have the user log in to the Windows client. From the View menu, choose New
  Messages. Double-click the message. The message will display the following
  error:

  ==== MAIL SYSTEM ERROR ====
  Mail could not read the entire message from the postoffice.
  Some parts of the message may be missing. Ask the sender
  to resend the message.

  This error is expected. Anyone who has not yet read the offending message will
  receive this error, which means that the large attachment will no longer be
  circulating around the system.

NOTE: You can use the External Mail program MaxLanMailSize option to restrict the
sizes of messages users can send to an external postoffice on the same LAN. For
more information about how to use the MaxLanMailSize option, please see page 252
of the Microsoft Mail "Administrator's Guide."

For more information about the LISTUSER.EXE utility, please see the following
article in the Microsoft Knowledge Base:

  Q99419 PC DB: Database Maintenance Utilities (Complete)


Additional query words: 3.00 3.20 attachment orphan large

======================================================================
Keywords          :  
Technology        : kbMailSearch kbZNotKeyword3 kbMail320 kbMail320a
Version           : WINDOWS:3.2,3.2a

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>