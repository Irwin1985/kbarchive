<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q124897: FIX: Cursor Library Returns Duplicate Row in Asynchronous Mode | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q124897: FIX: Cursor Library Returns Duplicate Row in Asynchronous Mode" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/124/Q124897/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/124/Q124897/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q124897: FIX: Cursor Library Returns Duplicate Row in Asynchronous Mode","url":"http://jeffpar.github.io/kbarchive/kb/124/Q124897/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q124897-fix-cursor-library-returns-duplicate-row-in-asynchronous-mode">Q124897: FIX: Cursor Library Returns Duplicate Row in Asynchronous Mode</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q124897
Product(s): Open Database Connectivity (ODBC)
Version(s): WINDOWS:2.0
Operating System(s): 
Keyword(s): 
Last Modified: 12-JUN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Open Database Connectivity, version 2.0 
-------------------------------------------------------------------------------


SYMPTOMS
========

When the ODBC Cursor Library is used to set up a static cursor with a driver
whose asynchronous mode is enabled, it returns duplicate rows under certain
circumstances. These duplicate rows are returned every time an asynchronous
operation with the driver returns SQL_STILL_EXECUTING. The number of duplicate
rows retrieved on subsequent fetches (MoveNext's in MFC) is variable. Certain
conditions can cause as many as 500 consecutive repetitions of the same record.

This behavior has typically been observed in MFC applications using the ODBC
database classes to build snapshots (which cause the ODBC Cursor Library's
static cursor implementation to be used).

WORKAROUND
==========

Users of MFC database classes can avert this behavior by:

1. Setting synchronous mode on by calling the SetSynchronousMode() method of
  CDatabase

2. Using forwardOnly recordsets

Users of the ODBC API and the Cursor Library can work around the behavior by:

1. Calling SQLSetStmtOption (hstmt, SQL_ASYNC_ENABLE, SQL_ASYNC_ENABLE_OFF).

2. Using forward-only cursors in the Cursor Library.

STATUS
======

Microsoft has confirmed this to be a problem in ODBC Cursor Library version
2.00.1510. This problem has been fixed in the 32-bit version of the ODBC 2.5
Cursor Library (ODBCCR32.DLL, 2.50.3006). The 16-bit cursor library has not been
changed. If you are using the 16 bit SQL Server driver, this should not be a
problem because you can use the server side cursors in SQL Server version 6.0
and eliminate the need for the cursor library. If you are using the Access
driver, you need to use the 32-bit driver and the new 32-bit cursor library.


MORE INFORMATION
================

You can get ODBC 2.50 components from:

- anonymous-FTP: FTP.MICROSOFT.COM:\BUSSYS\SQL_ODBC\ODBC-PUBLIC\ODBC25.EXE

- The Microsoft Developer Network (MSDN) Level II CD: ODBC210B\X86\ODBC25

They are also available on the SQL Server version 6.0 CD, under
ODBC_SDK\ODBC25\REDIST.

Additional query words: 2.00.1510 MFC VISUAL C++ MSVC Windows NT

======================================================================
Keywords          :  
Technology        : kbAudDeveloper kbODBCSearch kbODBC200
Version           : WINDOWS:2.0
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>