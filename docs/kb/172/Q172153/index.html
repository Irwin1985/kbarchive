<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q172153: Moving a WINS Database from Windows NT 3.51 to Windows NT 4.0 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q172153: Moving a WINS Database from Windows NT 3.51 to Windows NT 4.0" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/172/Q172153/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/172/Q172153/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q172153: Moving a WINS Database from Windows NT 3.51 to Windows NT 4.0","url":"http://jeffpar.github.io/kbarchive/kb/172/Q172153/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q172153-moving-a-wins-database-from-windows-nt-351-to-windows-nt-40">Q172153: Moving a WINS Database from Windows NT 3.51 to Windows NT 4.0</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q172153
Product(s): Microsoft Windows NT
Version(s): WinNT:3.51,4.0
Operating System(s): 
Keyword(s): kbnetwork
Last Modified: 09-AUG-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows NT Server versions 3.51, 4.0 
-------------------------------------------------------------------------------

SUMMARY
=======

This article explains how to move your Windows Internet Name Service (WINS)
database from an existing server running Windows NT 3.51 to a new server running
Windows NT 4.0.

MORE INFORMATION
================

To move your WINS database from Windows NT 3.51 to Windows NT 4.0, use the
following steps:

1. Install WINS on the destination server.

2. Stop the WINS service on both the destination and source servers:

  a. In Control Panel, double-click Services.

  b. Click Windows Internet Name Service and click Stop.

  c. Click Yes on the confirmation dialog box and click Close.

NOTE: Repeat the above steps for each of the two servers.

3. On the destination server, delete all the files in the
  %Systemroot%\System32\Wins folder.

  NOTE: Do NOT delete the Wins folder itself.

4. Copy the following files from the %Systemroot%\System32\Wins folder on the
  source server to the %Systemroot%\System32\Wins folder on the destination
  server:

  Jet.log
  System.mdb
  Wins.mdb

5. Restart WINS on the destination server.

6. Click OK on the pop-up window, which displays the following message:

  WINS can not come up because the existent database needs conversion to NT SUR
  format. WINS has initiated the conversion via a process (jetconv). Once the
  conversion is complete, WINS will get started automatically. Do not reboot or
  kill the jetconv process. The conversion may take anywhere from a few minutes
  to around an hour (depending on the size of the databases). Please terminate
  WINS now by clicking on OK. This is required for the database conversion to
  succeed.

  NOTE: THE WINS SERVICE WILL START AUTOMATICALLY AFTER THE CONVERSION IS
  SUCCESSFULLY COMPLETED. CHECK THE APPLICATION LOG TO SEE THE STATUS OF THE
  CONVERSION FOR THE WINS DB.

7. Click OK on the next pop-up window, which displays the following message:

  Could not start the Windows Internet Name service on \\&lt;server&gt;. Error:
  0001 Incorrect Function.

  where &lt;server&gt; is the name of your Windows NT 4.0 server.

8. Click close.

The Jetconv.exe utility will start and attempt to convert the Windows NT 3.51
database to the newer Windows NT 4.0 format. After the conversion has
successfully completed, the WINS service will automatically restart.

The original Windows NT 3.51 files that you copied to the destination server are
backed up by the conversion utility and placed in the
%Systemroot%\System32\Wins\351db folder. You can delete the System.mdb file from
the Wins folder on the new WINS server after the conversion is complete. This
file is no longer used in Windows NT 4.0.

Progress can be monitored by looking at the application log in Event Viewer. An
application event ID 1000, with Source JET, will appear if the conversion
completes successfully. If the method described here fails, the Upg351db.exe
utility can also be used to convert the database manually. This file can be
found on the Windows NT 4.0 server under %Systemroot%\System32 folder.

For additional information, please see the following article in the Microsoft
Knowledge Base:

  Q158473 Upgrading the DHCP Database to Windows NT Server 4.0

Additional query words: migrate relocate
======================================================================
Keywords          : kbnetwork 
Technology        : kbWinNTsearch kbWinNT351search kbWinNT400search kbWinNTSsearch kbWinNTS400search kbWinNTS400 kbWinNTS351 kbWinNTS351search
Version           : WinNT:3.51,4.0
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>