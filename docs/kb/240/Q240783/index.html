<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q240783: SMS Installer Does Not Repackage Large MULTI-SZ Registry Values | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q240783: SMS Installer Does Not Repackage Large MULTI-SZ Registry Values" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/240/Q240783/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/240/Q240783/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q240783: SMS Installer Does Not Repackage Large MULTI-SZ Registry Values","url":"http://jeffpar.github.io/kbarchive/kb/240/Q240783/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q240783-sms-installer-does-not-repackage-large-multi-sz-registry-values">Q240783: SMS Installer Does Not Repackage Large MULTI-SZ Registry Values</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q240783
Product(s): Microsoft Systems Management Server
Version(s): WINDOWS:2.0
Operating System(s): 
Keyword(s): kbsms200bug kbsms200fix kbsms200sp2fix
Last Modified: 25-JUN-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server Installer version 2.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you repackage a Setup program that creates or modifies a large (larger than
64 KB) MULTI-SZ registry value with SMS Installer versions earlier than
2.0.91.1, SMS Installer may be unable to open the resulting script, may be
unable to compile the script, may improperly create the specified MULTI-SZ
registry value, or may stop responding (hang) upon opening the script.

Additionally, repackaging such a program with earlier (version 1.x.xx) versions
of SMS Installer may work without error messages. This occurs because SMS
Installer 1.xx.xx does not repackage changes to MULTI-SZ registry values.

CAUSE
=====

The buffer that SMS Installer uses to hold registry values is not large enough
to contain the MULTI-SZ registry value.

Note that various programs that include McAfee VirusScan make use of large
MULTI-SZ registry values. One registry value in particular that can contain a
large amount of data and is frequently modified during program installation is:

  SOFTWARE\Microsoft\Windows NT\CurrentVersion\Perflib\009

RESOLUTION
==========

To resolve this problem, obtain the latest service pack for Systems Management
Server version 2.0. For additional information, please see the following article
in the Microsoft Knowledge Base:

  Q236325 How to Obtain the Latest Systems Management Server 2.0 Service Pack



WORKAROUND
==========

To work around this problem if MULTI-SZ registry values can be ignored, use an
earlier version of SMS Installer.

STATUS
======

Microsoft has confirmed this to be a problem in Systems Management Server
version 2.0. This problem was first corrected in Systems Management Server
version 2.0 Service Pack 2.

MORE INFORMATION
================

Note that even with the hotfix mentioned in this article, you may be unable to
open an SMS Installer script generated by repackaging a large MULTI-SZ registry
modification if the script is created with a previous version of SMS Installer.
This occurs because the hotfix actually works during the repackage process to
break up large keys into smaller fragments. As a result, it is necessary to
repeat any problem repackage operations with the hotfixed SMS Installer.

To install the hotfixed SMS Installer, run the appropriate .exe file based on
your processor platform.

The third-party products discussed in this article are manufactured by vendors
independent of Microsoft; we make no warranty, implied or otherwise, regarding
these products' performance or reliability.

Additional query words: prodsms

======================================================================
Keywords          : kbsms200bug kbsms200fix kbsms200sp2fix 
Technology        : kbSMSSearch kbSMSI200
Version           : WINDOWS:2.0
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>