<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q139196: FIX: Clicking Scroll Bar in Grid Writes Data to Wrong Record | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q139196: FIX: Clicking Scroll Bar in Grid Writes Data to Wrong Record" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/139/Q139196/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/139/Q139196/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q139196: FIX: Clicking Scroll Bar in Grid Writes Data to Wrong Record","url":"http://jeffpar.github.io/kbarchive/kb/139/Q139196/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q139196-fix-clicking-scroll-bar-in-grid-writes-data-to-wrong-record">Q139196: FIX: Clicking Scroll Bar in Grid Writes Data to Wrong Record</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q139196
Product(s): Microsoft FoxPro
Version(s): WINDOWS:3.0,3.00b;
Operating System(s): 
Keyword(s): kbvfp
Last Modified: 24-AUG-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b 
-------------------------------------------------------------------------------

SYMPTOMS
========

If you create an edit box in a grid column, enter data in that edit box, and
then click the scroll bar of the grid without exiting the edit box, any of the
following may occur:

- Data may be written to the wrong record.

- Data may be lost.

- Record locking errors may occur.

- Data may be truncated.


CAUSE
=====

The edit box does not close automatically when it loses the focus to the scroll
bar. In some cases, it acts as if it were never open. In other cases, it acts as
if it were open on the record to which the record pointer moved. Odd behavior
may occur if the control source of the edit box is set to either a character
field or a memo field. These behaviors do not occur if you click another cell in
the grid or click an object outside the grid.

WORKAROUND
==========

Trap for the MouseDown event while in the edit box. This can be done by placing
the following code in the MouseDown event of the grid, which fires before the
Scroll event fires:

     IF this.activecolumn = 2    &amp;&amp; or whatever column the edit box is in
        keyboard '{TAB}'         &amp;&amp; or SHIFT-TAB
     ENDIF

This forces the edit box to close properly before the scroll can be run.

STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products listed at
the beginning of this article. This problem has been fixed in Visual FoxPro 5.0
for Windows.

MORE INFORMATION
================

Steps to Reproduce Problem
--------------------------

1. Create a table called Test, and give it a memo field and a text field.

2. Append a few blank records to the table.

3. Create a new form, and add the table to the form's data environment.

4. Drag the table from the data environment onto the form to create a grid.

5. In the grid, set column one's ControlSource property to the text field of the
  table, and set column two's ControlSource property to the memo field of the
  table.

6. Create an edit box for column two, and make the edit box the active control.

7. Run the form, and edit or add data to the edit box. Then click the scroll bar
  without using the TAB key to move out of the edit box. At this point, the
  data may be written to the wrong record, or it may not be written to any
  record. Scroll through the edit box controls to see where the data was
  written. You may receive a record locking error when you click the record
  that seems to have received the data. These behaviors do not occur in every
  single instance nor do all of them occur together.

Additional query words: kbVFp300bug kbVFp300abug kbVFp500fix kbDSupport scrollbar

======================================================================
Keywords          : kbvfp 
Technology        : kbVFPsearch kbAudDeveloper kbVFP300 kbVFP300b
Version           : WINDOWS:3.0,3.00b;
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>