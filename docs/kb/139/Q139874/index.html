<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q139874: How to Disable a Button &amp; Move the Focus to a Specified Object | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q139874: How to Disable a Button &amp; Move the Focus to a Specified Object" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/139/Q139874/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/139/Q139874/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q139874: How to Disable a Button &amp; Move the Focus to a Specified Object","url":"http://jeffpar.github.io/kbarchive/kb/139/Q139874/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q139874-how-to-disable-a-button--move-the-focus-to-a-specified-object">Q139874: How to Disable a Button &amp; Move the Focus to a Specified Object</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q139874
Product(s): Microsoft FoxPro
Version(s): 3.00
Operating System(s): 
Keyword(s): kbcode
Last Modified: 25-AUG-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, version 3.0 
-------------------------------------------------------------------------------

SUMMARY
=======

When using a command button to set the focus to another object, you may
sometimes want to disable the command button and move the focus to another
object until another event occurs or a value is entered in a field. This article
shows by example how to do it.

MORE INFORMATION
================

The most obvious solution, doesn't work. You can't use the SetFocus method
followed by "Enabled=.F." in the Click event of a command button. When the Click
event of the command button is activated, the command button becomes disabled,
but the focus is not moved to the specified control. The focus moves to the next
object in the Tab Order instead of to the specified object.

This occurs because the Default event processing occurs after user-defined code
is run. When the default event procedure for the Click event is run, it
discovers that the control is no longer enabled and defaults to setting the
focus to the next object in the Tab order, so the user-specified SetFocus method
is nullified.

To move the focus to the object specified in the Click event of the command
button, you need to use the NoDefault clause. This results in the focus being
moved to the correct object.

Step-by-Step Example
--------------------

1. Create a form, and add three command buttons to the form. Label the buttons
  Button 1, Button 2, and Button 3.

2. In the Click event of Button 1, add this code:

     ThisForm.Command3.SetFocus
     ThisForm.Command1.Enabled=.F.

3. Run the form.

4. Click Button 1, and you will see it become disabled. However, the focus is
  set to Button 2 (the next item in the tab order). Close the form.

5. Modify the form to add NoDefault to the first line of the Button 1 Click
  event:

     NoDefault
     ThisForm.Command3.SetFocus
     ThisForm.Command1.Enabled=.F.

6. Rerun the form, and click Button 1. The focus should now be on Button 3.

REFERENCES
==========

For additional information on the use of the NODEFAULT command, please see the
following article in the Microsoft Knowledge Base:

  Q131095 How to Control the Occurrence of a Default Event

For additional information on SetFocus behavior, please see the following article
in the Microsoft Knowledge Base:

  Q130525 PRB: SetFocus Doesn't Work When Called in the Valid Event

Additional query words: VFoxWin got disable commandbutton

======================================================================
Keywords          : kbcode 
Technology        : kbVFPsearch kbAudDeveloper kbVFP300
Version           : 3.00

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>