<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q276347: XFOR: Messages Moved to the Badmail Folder with SMTP Service | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q276347: XFOR: Messages Moved to the Badmail Folder with SMTP Service" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/276/Q276347/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/276/Q276347/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q276347: XFOR: Messages Moved to the Badmail Folder with SMTP Service","url":"http://jeffpar.github.io/kbarchive/kb/276/Q276347/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q276347-xfor-messages-moved-to-the-badmail-folder-with-smtp-service">Q276347: XFOR: Messages Moved to the Badmail Folder with SMTP Service</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q276347
Product(s): Internet Information Server
Version(s): 4.0,5.0
Operating System(s): 
Keyword(s): 
Last Modified: 19-JUN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Server versions 4.0, 5.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When the Simple Mail Transfer Protocol (SMTP) virtual server is configured to
forward messages to a specific mail host, messages that are queued for outbound
mail delivery are sent immediately to the Badmail folder. Because the SMTP
service cannot deliver to the message originators, non-delivery reports (NDRs)
are also sent to the Badmail folder.

CAUSE
=====

This problem can occur if the DNS server that you have configured under
Transmission Control Protocol and Internet Protocol (TCP/IP) properties does not
support TCP queries.

RESOLUTION
==========

To problem this behavior, use the appropriate method in this section.

Resolution for Internet Information Service (IIS) 5.0
-----------------------------------------------------

1. Start the Internet Services Manager.

2. Right-click the server that has the SMTP virtual server configured, and then
  click Properties.

3. Click the Delivery tab, and then click Advanced.

4. In the smart host entry, make sure that you are not using the fully qualified
  domain name (FQDN) of the remote SMTP server.

  The FQDN should not be used if the queried DNS server does not support TCP
  queries. Instead, type an Internet protocol (IP) address surrounded by
  brackets, for example:

  [192.168.2.25]

  The brackets cause messages to be forwarded directly to the IP address and
  prevent a reverse DNS lookup from being performed.

5. Click OK, click OK, and then restart the SMTP virtual server.

Resolution for Internet Information Server (IIS) 4.0
----------------------------------------------------

1. Start the Internet Services Manager.

2. Click the server that has the SMTP site configured, and then click
  Properties.

  NOTE: This server is the same as the SMTP virtual server.

3. Click the Delivery tab.

4. In the smart host entry, make sure that you are not using the FQDN of the
  remote SMTP server.

  The FQDN should not be used if the queried DNS server does not support TCP
  queries. Instead, type an IP address surrounded by brackets.

5. Click OK, and then restart the SMTP site.

Alternatively, you can change the currently configured DNS server to one that
responds to TCP queries.

1. In the TCP/IP settings of network properties, click the properties of the
  local area connection that you are using.

2. Click Internet Protocol (TCP/IP), and then click Properties.

3. Add a preferred DNS server that responds to TCP queries.

STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products that are
listed at the beginning of this article.

MORE INFORMATION
================

Most programs use User Datagram Protocol (UDP) queries to resolve host names.
When the contents of the query are larger than the maximum packet size, the
program must use TCP.

The SMTP service is unique because the SMTP service uses TCP queries by default.
If the DNS server does not support TCP queries, the query attempt resets.
Therefore, the lookup for mail delivery does not respond and the messages are
sent to the Badmail folder.

Request for Comments (RFC) 883 and the later RFCs recommned that DNS servers
should be able to accept both TCP virtual circuits and UDP.

Additional query words: NDR badmail smtp iis mailhost

======================================================================
Keywords          :  
Technology        : kbiisSearch kbiis500 kbiis400
Version           : :4.0,5.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>