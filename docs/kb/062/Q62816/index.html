<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q62816: Passed Parameters Incorrectly PRINTed from SUB in Library | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q62816: Passed Parameters Incorrectly PRINTed from SUB in Library" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/062/Q62816/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/062/Q62816/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q62816: Passed Parameters Incorrectly PRINTed from SUB in Library","url":"http://jeffpar.github.io/kbarchive/kb/062/Q62816/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q62816-passed-parameters-incorrectly-printed-from-sub-in-library">Q62816: Passed Parameters Incorrectly PRINTed from SUB in Library</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q62816
Product(s): See article
Version(s): 4.50
Operating System(s): MS-DOS
Keyword(s): ENDUSER | SR# S900515-50 buglist4.50 | mspl13_basic
Last Modified: 20-JUN-1990

This article demonstrates a case where PRINTing integer and
floating-point numbers from a SUBprogram that is either in a library
or in a separate module gives unpredictable results. The problem
occurs if the variables are passed to the SUB through the argument
list and if several of the variables are separated by commas when
PRINTed in one PRINT statement.

Microsoft has confirmed this to be a problem in QuickBASIC version
4.50 and in Microsoft BASIC Compiler versions 6.00 and 6.00b
(buglist6.00, buglist6.00b). This problem was corrected in Microsoft
BASIC Professional Development System (PDS) version 7.00
(fixlist7.00).

There are several ways to work around this problem. This problem does
not occur if you use the /X switch on the compile line. The problem
also does not occur if the SUB is part of the module from where it is
CALLed or if the variables are passed through COMMON SHARED
statements. The problem also does not occur if the variables are
PRINTed on separate lines, or are separated by semicolons instead of
commas.

The following code shows the problem:

From within QB.EXE 4.50, make a module or library from the following
code:

    DECLARE SUB printsub (a%, b%, c%, d%)
    SUB printsub (a%, b%, c%, d%)
    PRINT "1: ", a%, b%, c%, d%
    PRINT "2: ", a%, b%, c%, d%
    PRINT "3: ", a%, b%, c%, d%
    END SUB

If you made a Quick library from the above SUBprogram, load the
library into QuickBASIC version 4.50 as follows:

   QB /L libname

Then, from within QB.EXE 4.50, run the following main program:

' Program: TEST.BAS
    DECLARE SUB printsub (a%, b%, c%, d%)
    CLS
    CALL printsub(9, 16, 4, 70)   'the values do not matter

Output
------

   1:             9             16            4             70
   2:             9             21317         4             70
   3:             9             21317         4             70

To work around this problem, compile with the /X option, as follows:

   BC /X TEST.BAS ;
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>