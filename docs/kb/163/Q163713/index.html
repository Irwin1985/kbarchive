<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q163713: XADM: Recovering a Single Mailbox from the Online Backup | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q163713: XADM: Recovering a Single Mailbox from the Online Backup" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/163/Q163713/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/163/Q163713/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q163713: XADM: Recovering a Single Mailbox from the Online Backup","url":"http://jeffpar.github.io/kbarchive/kb/163/Q163713/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q163713-xadm-recovering-a-single-mailbox-from-the-online-backup">Q163713: XADM: Recovering a Single Mailbox from the Online Backup</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q163713
Product(s): Microsoft Exchange
Version(s): 4.0,5.0,5.5
Operating System(s): 
Keyword(s): kbusage
Last Modified: 24-JUL-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, versions 4.0, 5.0, 5.5 
- Microsoft Exchange MS-DOS client, version 4.0 
- Microsoft Exchange Windows 3.x client, version 4.0 
- Microsoft Exchange Windows NT client, version 4.0 
- Microsoft Exchange Windows 95/98 client, version 4.0 
-------------------------------------------------------------------------------


SUMMARY
=======

Mailboxes can be recovered onto a recovery server, in a lab, with Online backup
without disturbing the server in production.

MORE INFORMATION
================

To recover the mailbox, you need a Recovery Server (one that is in Lab
environment and not in production) with enough storage capacity as to install
Microsoft Exchange Server and to restore the entire private information store
database. The following outlines the procedure for single mailbox recovery from
the online backup.

1. Log on to a computer running Windows NT Server with the Administrator
  account.

2. Install Microsoft Exchange Server computer on Windows NT. During the
  installation, select "Create a new site", and give the same Site and
  Organization name as the backup.

3. Apply Windows NT and Exchange updates (both Service Packs and Hotfixes) to
  this recovery server to bring it to the same level as the original server on
  which the backup was made.

  NOTE: If you do not update to matching service pack or hotfix levels, it can
  slow down this recovery process greatly, or even prevent its success.

4. Restore the information store from the backup.

   - Please make sure to redirect your restore to the Recovery Server.

   - Before restoring the information store, Circular Logging should match what
     was used when the Online Backup was performed.

   - Before you restore the information store, make sure all your mdbdata
     folders on all possible drives are empty.

  For example, if the tape was backed up with Circular Logging disabled in the
  Server properties/Advanced tab on the production server, then the recovery
  server should have Circular Logging disabled as well.

5. Start the Microsoft Exchange Administrator program and run the DS/IS
  consistency adjustment tool. Select All Inconsistencies before you click the
  Adjust button.

  NOTE TO EXCHANGE SERVER 5.5 USERS: Also check the top check box, which reads
  "Synchronize with the directory, and create new directory entries for
  mailboxes that do not have a corresponding directory entry".

6. Open the property page of the mailbox to be recovered.

7. From General/Primary Windows NT Account, click "Select an existing Windows NT
  account", click OK, and then add "Administrator" account.

8. Close the mailbox property page.

9. Use Microsoft Exchange Client to create the PST, and then copy the contents
  of the mailbox to the PST.

10. Add this PST to the user's profile on the production server. As an
  alternative, the user can add the PST to his hard disk.

Microsoft Exchange Server, version 4.0
--------------------------------------

The above procedure works when all mailboxes are in default Recipients container.
If you want to recover a mailbox in other container, that container has to be
manually created prior to running DS/IS consistency adjustment.

For additional information about recovering a mailbox from a second level
container, please see the following article in the Microsoft Knowledge Base:

  Q154491 XADM: DS/IS Fails to Re-create Mailboxes in Subcontainers

IMPORTANT: The same version of Windows NT and Exchange Server, including service
packs, must be installed on both the server you are restoring from and the
server you are restoring to. Also note that the location of the databases and
logfiles needs to be the same on both servers.

Additional query words:

======================================================================
Keywords          : kbusage 
Technology        : kbExchangeSearch kbExchange500 kbExchange550 kbExchange400 kbExchangeClientSearch kbZNotKeyword kbZNotKeyword2 kbZNotKeyword3 kbExchange400DOS kbExchange400NT kbExchange400Win95
Version           : :4.0,5.0,5.5

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>