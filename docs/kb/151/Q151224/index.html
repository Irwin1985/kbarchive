<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q151224: Inconsistent CRC or Checksum Values on Large Applications | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q151224: Inconsistent CRC or Checksum Values on Large Applications" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/151/Q151224/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/151/Q151224/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q151224: Inconsistent CRC or Checksum Values on Large Applications","url":"http://jeffpar.github.io/kbarchive/kb/151/Q151224/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q151224-inconsistent-crc-or-checksum-values-on-large-applications">Q151224: Inconsistent CRC or Checksum Values on Large Applications</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q151224
Product(s): Microsoft Systems Management Server
Version(s): 1.1,1.2
Operating System(s): 
Keyword(s): kbusage kbdocerr kbsmsAdmin smsadmin smshowto smsdocerr
Last Modified: 13-FEB-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server versions 1.1, 1.2 
-------------------------------------------------------------------------------

SUMMARY
=======

Large application executable files can return different cyclic redundancy check
(CRC) values due to unique product identification stamping that occurs when the
application is installed. To avoid this inconsistent result, you must provide an
offset that starts the CRC calculation past this unique data. This also applies
to the calculation of Checksum values.

WORKAROUND
==========

To calculate a CRC or Checksum with the SMS Administrator, do the following:

1. Create a new package and click the Inventory button.

2. Select "Add AND..." or "Add OR...".

3. In the File Properties window, click the ellipse button (...) to the right of
  File Name.

4. Browse to and select the file you want to calculate the CRC or Checksum of.

5. Choose "Checksum" or "CRC" from the Properties Available list and click
  Add&gt;.

6. Enter a value in the At Byte field. This is the data offset, or byte
  position, within the file where the algorithm will begin calculating the sum.

7. Enter a value for the Length field. This is the total number of bytes that
  are summed.

8. Click the Retrieve button. The value displayed in the CRC-16 (or Checksum)
  field is your result.

The values calculated here can be used to customize your Audit.rul file. For more
information on Software auditing, see Chapter 6, page 217 of the "SMS
Administrator's Guide."

NOTE: This documentation mentions the Filetokn.exe utility which was not included
with SMS 1.1. Use the steps listed above to perform the same functions.


Generally, an offset of 10,000 and a length of 10,000 to 50,000 will return a
consistent value for most large executable files. Don't forget to consider that
the larger the values for the length, the longer it will take to calculate. To
really be certain that the value you calculate does not contain any unique data,
calculate the CRC or Checksum on the executable file installed from two
installations of the same application.

MORE INFORMATION
================

Large applications like Microsoft Word or even applications from other software
developers will often contain a unique product ID stamp at the beginning and/or
end of the file data.

For example, Microsoft Word 7.0 uses WINWORD.EXE which is 3,845,120 bytes in
size. This file contains unique data within the first 225 bytes of the file and
also in the last 245K of the file. In order to retrieve a consistent CRC or
Checksum value, use an offset or "At Byte" of at least 250 and a length of one
to 3,500,000. This will return the same value for every installation of
Microsoft Word 7.0.

Additional query words: CRC Checksum FILETOKN.EXE value prodsms

======================================================================
Keywords          : kbusage kbdocerr kbsmsAdmin smsadmin smshowto smsdocerr 
Technology        : kbSMSSearch kbSMS110 kbSMS120
Version           : :1.1,1.2

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>