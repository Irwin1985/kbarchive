<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q250392: Using the Viabackup Tool in Microsoft Metadirectory Services | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q250392: Using the Viabackup Tool in Microsoft Metadirectory Services" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/250/Q250392/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/250/Q250392/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q250392: Using the Viabackup Tool in Microsoft Metadirectory Services","url":"http://jeffpar.github.io/kbarchive/kb/250/Q250392/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q250392-using-the-viabackup-tool-in-microsoft-metadirectory-services">Q250392: Using the Viabackup Tool in Microsoft Metadirectory Services</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q250392
Product(s): Microsoft Windows NT
Version(s): 2.1
Operating System(s): 
Keyword(s): kbenv
Last Modified: 15-MAR-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Metadirectory Services, version 2.1 
-------------------------------------------------------------------------------

SUMMARY
=======

You can use the Viabackup tool (Viabackup.exe) to back up the X500db database
when your Microsoft Metadirectory Services (MMS) server is running and the
database file is open. Viabackup blocks write operations to the Zoomserv folder
while it is making backup copies. You can run Viabackup from a command prompt or
as a scheduled event.

You can view the current command-line option by running Viabackup.exe with a /?
or -? command-line switch.

- The -path command-line switch.
  Specifies the path to which the copied files should be placed or restored. If
  no path is specified, the files are copied to a Viabackup subfolder of the
  Windows Temporary folder. For example:

  viabackup.exe -path d:\mms\backups

- The -restore command-line switch.
  Restores the database from a set of backup files. If no path option is
  specified, the files are copied to a Viabackup subfolder of the Windows
  Temporary folder. For example:

  viabackup.exe -restore -path d:\mms\backups

- The -force command-line switch.
  Backs up or restores all files, regardless of the time stamp. Typically,
  Viabackup.exe performs an incremental backup (or restore) replacing only
  those files that are different from those in the source (either in the Backup
  folder or the Zoomserv folder). For example:

  viabackup.exe -path d:\mms\backups -force

MORE INFORMATION
================

Creating an Online Backup of MMS Server Data
--------------------------------------------

1. At a command prompt, change to the Zoomserv\Bin folder.

2. Type the following command:

  viabackup -path d:\backupfolder

  NOTE: The path you specify is the drive letter and a folder where you want to
  store the backup (make sure you have enough storage space).

After you back up the files, the next backup you perform is an incremental
backup. If you want to do another full backup, use the -force command-line
switch.

Restoring from Backup
---------------------

NOTE: You must stop MMS before restoring from backup.

1. Stop MMS by typing the following command at a command prompt:

  net stop "zoomit server"

2. Change to the Zoomserv\Bin folder, and then type the following command:

  viabackup -path d:\backupfolder -restore

3. After the files are restored, start MMS by typing the following command:

  net start "zoomit server"

Note that the "viabackup -restore" command restores to the currently configured
zoomserv folder. If you are restoring to a clean drive, you first need to run
the "setupsvc -path f:\zoomserv" command.

Additional query words: via zoomit timestamp

======================================================================
Keywords          : kbenv 
Technology        : kbMMSSearch kbMMS210
Version           : :2.1
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>