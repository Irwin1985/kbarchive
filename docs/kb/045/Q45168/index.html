<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q45168: Finding Address of Run-Time Error Line Using .LST or LINK /LI | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q45168: Finding Address of Run-Time Error Line Using .LST or LINK /LI" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/045/Q45168/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/045/Q45168/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q45168: Finding Address of Run-Time Error Line Using .LST or LINK /LI","url":"http://jeffpar.github.io/kbarchive/kb/045/Q45168/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q45168-finding-address-of-run-time-error-line-using-lst-or-link-li">Q45168: Finding Address of Run-Time Error Line Using .LST or LINK /LI</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q45168
Product(s): See article
Version(s): 4.00 4.00b 4.50
Operating System(s): MS-DOS
Keyword(s): ENDUSER | SR# S890511-147 docerr B_BasicCom | mspl13_basic
Last Modified: 29-JAN-1991

This article describes how to find the line in the source code that
gives an "ERROR nn AT ADDRESS segment:offset" message from an .EXE
program at run time.

When you compile with the BC /a/Zi or /a/Zd option, the LINK /LI
(Linenumber) option creates a .MAP file that includes (at the bottom)
the relative address of every line in the source program. (A
documentation correction for the /LI option is shown farther below.)

However, instead of using LINK /LI, it is easier to use the .LST
listing file generated by the BC.EXE compiler to find the source line
at the address given in the run-time error message.

This information applies to Microsoft QuickBASIC versions 4.00, 4.00b,
and 4.50, to Microsoft BASIC Compiler versions 6.00 and 6.00b for
MS-DOS, and to Microsoft BASIC Professional Development System (PDS)
versions 7.00 and 7.10 for MS-DOS.

Use .LST File Instead of .MAP File to Find Error Address
--------------------------------------------------------

A .MAP file generated with the LINK /LI option is not the most
convenient way to find the line in the source code that gives an
"ERROR nn AT ADDRESS segment:offset" error message from an .EXE
program at run time. Instead of using the .MAP file, you only need the
.LST file for each module, which conveniently displays the code
offsets next to the lines in your source file. The offset given in the
error message is the approximate area of your code where the error
occurs. (However, some errors aren't reported until the code has run
past the actual problem area).

To create an .LST file, you need to compile from the BC.EXE command
line. When BC.EXE prompts you for a source listing ("Source listing
[NUL.LST]:"), give it a name. Alternatively, you can specify the .LST
file as the third argument. You can end the BC.EXE command line with a
semicolon to suppress prompting, as follows:

   BC TEST.BAS,,TEST.LST/A;

The BC /A option includes an assembler translation of the program in
the .LST file, which can help when debugging.

Documentation Error for LINK /LI
--------------------------------

The LINK /LI (Linenumbers) option is incorrectly documented as follows
in the manuals listed further below:

   This option has effect only if you are linking object files
   compiled with the /M option.  [** Incorrect **]

There is no /M compiler option, only a LINK /M option. This sentence
should be changed to read as follows:

   This option has effect only if you are linking object files
   compiled with the /a/Zi or /a/Zd options.

This correction applies to the following manuals:

1. Page 367 of the "Microsoft QuickBASIC: Programming in BASIC" manual
   for version 4.50

2. Page 225 of the "Microsoft QuickBASIC Version 4.00: Learning and
   Using Microsoft QuickBASIC" manual for versions 4.00 and 4.00b

3. Page 225 of the "Microsoft BASIC Compiler: Learning and Using
   Microsoft QuickBASIC" manual for versions 6.00 and 6.00b for MS-DOS
   and MS OS/2

The BASIC PDS manuals correctly document the /LI option.
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>