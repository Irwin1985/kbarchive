<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q290569: PRB: #exec with IIS Buffering Displays HTTP Headers in Browser | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q290569: PRB: #exec with IIS Buffering Displays HTTP Headers in Browser" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/290/Q290569/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/290/Q290569/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q290569: PRB: #exec with IIS Buffering Displays HTTP Headers in Browser","url":"http://jeffpar.github.io/kbarchive/kb/290/Q290569/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q290569-prb-exec-with-iis-buffering-displays-http-headers-in-browser">Q290569: PRB: #exec with IIS Buffering Displays HTTP Headers in Browser</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q290569
Product(s): Internet Information Server
Version(s): 1.0,4.0,4.0 (Spanish version),5.0,6.0
Operating System(s): 
Keyword(s): 
Last Modified: 22-JUN-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Services version 5.0 
- Microsoft Internet Information Server versions 4.0, 4.0 (Spanish version) 
- Microsoft Visual InterDev, versions 1.0, 6.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you utilize the Server Side Include (SSI) #exec directive to call an Active
Server Pages (ASP) page, and buffering is enabled, the content is processed and
loaded but the ASP page also displays the HTTP headers.

The syntax is as follows:

  #EXEC CGI = "/YOUR.ASP"

CAUSE
=====

The HTTP headers appear with the #exec command when it calls an ASP page that
has buffering enabled. Because the buffering stores all data that is created
when the ASP is processed, and #exec calls everything from the buffer, the ASP
page includes the HTTP headers. If buffering is not enabled, the request is
processed as it would be in response to any other client (that is, without
displaying the HTTP headers).

RESOLUTION
==========

There are three ways to work around this problem:

- Turn off buffering in IIS.

To do this, follow these steps:
  1. In the IIS Microsoft Management Console (MMC), right-click the Web site
     and click Properties.

  2. Click the Home Directory tab and click Configuration.

  3. Click the App Option tab and clear Enable Buffering.

- Turn off buffering on the called pages.

To do this, set Response.Buffer to False at the top of the pages that #exec
calls. This causes buffering to be turned off on these pages, but still allows
buffering for the site.  - Flush the buffer before it responds to #exec.

To do this, place the Response.Flush command at the top of the pages that #exec
calls.

MORE INFORMATION
================

Buffering refers to when script commands are processed and stored before content
is sent to the client. You can enable buffering in IIS either through IIS
management tools or by using the Response.Buffer = true command on the page.

When buffering is enabled in IIS, buffering is set on all pages. In IIS version
4.0 buffering is turned off by default; in IIS version 5.0, buffering is turned
on by default.

Additional query words:

======================================================================
Keywords          :  
Technology        : kbVisIDsearch kbiisSearch kbAudDeveloper kbiis500 kbiis400 kbHLangSpanish kbVisID100 kbVisID600
Version           : :1.0,4.0,4.0 (Spanish version),5.0,6.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>