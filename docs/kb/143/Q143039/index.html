<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q143039: Calling Visual Basic 4.0 OLE Server from Microsoft Access 2.0 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q143039: Calling Visual Basic 4.0 OLE Server from Microsoft Access 2.0" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/143/Q143039/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/143/Q143039/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q143039: Calling Visual Basic 4.0 OLE Server from Microsoft Access 2.0","url":"http://jeffpar.github.io/kbarchive/kb/143/Q143039/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q143039-calling-visual-basic-40-ole-server-from-microsoft-access-20">Q143039: Calling Visual Basic 4.0 OLE Server from Microsoft Access 2.0</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q143039
Product(s): Microsoft Visual Basic for Windows
Version(s): WINDOWS:4.0
Operating System(s): 
Keyword(s): 
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Standard Edition for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition for Windows, version 4.0 
-------------------------------------------------------------------------------

SUMMARY
=======

Visual Basic 4.0 allows you to not only build OLE Servers but build applications
which can use them. Microsoft Access 2.0 is an OLE Automation Client
application, therefore it can be used to call methods and properties from OLE
servers created with Visual Basic 4.0. This article will describe the process of
using OLE servers created by Visual Basic 4.0 with Access 2.0. The example will
be using the OLE server example created in the Microsoft Knowledge Base article
Q129801, "How to Create and Use a Minimal OLE Automation Server."

MORE INFORMATION
================

Prior to following this example, make sure you have built the OLE Server
discussed in Q129801, and have built an EXE file.

Steps to Use a Visual Basic 4.0 OLE Server with Access 2.0
----------------------------------------------------------

1. Start Access 2.0, from the File menu select New Database and accept the
  default database, Db1.mdb.

2. From the Access 2.0 database window, select the Module Tab.

3. Now select the New button at the top of the database window to build a new
  Access Basic module.

4. Type the following code in the module.

     Function CallServer () As Integer

       Dim MyObj As Object

       Set MyObj = CreateObject("Project1.Class1")

       MsgBox MyObj.MyString
       MsgBox MyObj.MyFunction

     End Function

5. Save this function, by selecting the File menu and choosing the Save item.
  Accept the default to save the module as Module1. You may now close the code
  window.

6. From the Access database window, now select the Macro Tab. Then select the
  new button. We will now be able to write a macro which calls our Access Basic
  code.

7. From the macro design screen, select Run code from the combo box under the
  Action column.

8. Now a textbox will appear at the bottom of this screen labeled as Function
  Name. Click on the text box, and a button with three dots will appear. Click
  on this button.

9. The Expression Builder dialog now appears. Double click on the functions
  folder in the lower-left corner of the dialog box.

10. You will see a sub folder of the functions folder labeled DB1, standing for
  the name of our database. Double-click this folder.

11. Select the paste button. The CallServer() function will be pasted in as the
  parameter to the RunCode Macro. Select OK from the Expression Builder dialog
  box to close the dialog box.

12. Save this macro, by selecting the File menu and choosing the Save item.
  Accept the default to save the macro as Macro1. You may now close the macro
  window.

13. Select the macro in the Database window.

14. Select the run button to run the macro. When this function executes, you
  will get two message boxes. The first one will say, "Life is like a box of
  chocolates." The second one will say, "You never know what you're gonna
  get."

Additional query words: 4.00 vb4win text box

======================================================================
Keywords          :  
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB400Search kbVB400
Version           : WINDOWS:4.0

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>