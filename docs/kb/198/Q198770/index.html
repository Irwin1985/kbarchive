<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q198770: SMS: Floppy Drive Spins During Hardware Inventory Scans | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q198770: SMS: Floppy Drive Spins During Hardware Inventory Scans" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/198/Q198770/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/198/Q198770/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q198770: SMS: Floppy Drive Spins During Hardware Inventory Scans","url":"http://jeffpar.github.io/kbarchive/kb/198/Q198770/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q198770-sms-floppy-drive-spins-during-hardware-inventory-scans">Q198770: SMS: Floppy Drive Spins During Hardware Inventory Scans</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q198770
Product(s): Microsoft Systems Management Server
Version(s): winnt:2.0,2.0 SP1
Operating System(s): 
Keyword(s): kbsms200
Last Modified: 06-AUG-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server versions 2.0, 2.0 SP1 
-------------------------------------------------------------------------------


SUMMARY
=======

In Microsoft Systems Management Server version 2.0, normal hardware scans may
cause constant scanning of the drive A diskette. An Event ID 115 may also be
observed on Microsoft Windows NT clients.

MORE INFORMATION
================

During a hardware inventory of a client, the constant scanning of drive A is not
a problem if the inventory is set to run when the computer is not in use. The
hardware inventory is performed using file Hinv32.exe on 32-bit clients.
Hinv32.exe enumerates all instances specified in the local Managed Object Format
(MOF) file.

This information is specified in the client's MOF file and is called SMS_DEF.MOF.
This file can be found at &lt;X&gt;:\%windir%\MS\SMS\Clicomp\Hinv.

To disable the constant scanning of drive A during a hardware inventory, use
either of the following options:

- Modify the SMS_DEF.MOF file on the primary site system in the file
  &lt;X&gt;:\SMS\Inboxes\Clifiles.src\Hinv. To do so, follow these steps:

  a. Open the file in Microsoft WordPad or Notepad.

  b. Locate the following entry in the MOF file:

  [SMS_Report (TRUE),SMS_Group_Name ("Logical Disk"),
  ResID(2100),ResDLL("SMS_RXPL.dll"),SMS_Class_ID("MICROSOFT|LOGICAL_DISK|1.0")]class
  Win32_LogicalDisk : SMS_Class_Template

  c. Change the line [SMS_Report (TRUE) to [SMS_Report (FALSE).

     NOTE: Disabling the individual settings in this class is not sufficient.

  d. Run the MOF Compiler and allow it to transfer copies to clients.

CAUTION: When the MOF Compiler is run, misplaced white space in the SMS_DEF.MOF
file may cause the MOF file to compile unsuccessfully. Avoid adding white space
while editing in WordPad or Notepad.

- Change the MOF Manager utility that comes with the Systems Management Server
  product. To do so, follow these steps:

  a. Open the MOF Manager utility, and then click the Open icon (the icon is a
     drive with an arrow pointed to a blue document).

  b. Navigate to the file &lt;X&gt;:\SMS\Inboxes\Clifiles.src\Hinv\SMS_DEF.MOF.

  c. Scroll through the Class List on the left, and then double-click
     Win32_LogicalDisk.

  d. In the area preceding the Class List, locate Group Name: Logical Disk,
     change the Report option button selection to No, and then click Save.

  e. Run the MOF Compiler and allow it to transfer copies to clients.

Installing the MOF Manager with the Initial Systems Management Server 2.0 Release CD-ROM
----------------------------------------------------------------------------------------

Specify the directory in which to install the MOF Manager utility, locate the
file Support\Reskit\Bin\&lt;platform&gt;\Mofman\Setup.exe, and then run Setup.

Service Pack 1 Source Files::

If you are using the files from the Service Pack 1 release and have already run
Support.exe and extracted the files, there is no need to run Setup. The MOF
Manager executable file is in the following location:

  SMS 2.0 Supportability Tools\Bin\&lt;platform&gt;\Discovery and Inventory
  Tools\Mofman.exe

Service Pack Two Source Files::

If you are using the files from the Service Pack 2 release and have already run
the Support.exe and extracted the files, there is no need to run Setup. The MOF
Manager executable file is in the following location:

  SMS 2.0 Supportability Tools\Bin\&lt;platform&gt;\Discovery and Inventory
  Tools\Mofman.exe

After you complete the installation, the MOF Manager is ready to run.

NOTE: Running a version of the MOF Manager earlier than Service Pack 2 may cause
MOF compilation failures when Systems Management Server attempts to process the
MOF file.

After you save the edits to the MOF, the file is automatically transferred to
each client access point (CAP). Client Component Installation Manager (CCIM)
transfers it to the client during its regular maintenance cycle and places it in
the following location:

  %Windir%\MS\SMS\Sitefile\&lt;site code&gt;\Hinv

The next time the hardware inventory agent on the client runs, it detects the
newer version in this location (immediately above) and copies it to the
following location to be compiled:

  %Windir%\MS\SMS\Clicomp\Hinv

To expedite your testing, copy the SMS_DEF.MOF file to
&lt;X&gt;:\%Windir%\MS\SMS\Clicomp\Hinv. Then, in Control Panel, run the Systems
Management utility. Display the contents under the Components tab, highlight
Hardware Inventory Agent, and then click Start Component. This action forces a
hardware inventory of the client using the new modified MOF. If drive A does not
constantly scan, the change has been successfully executed.

Additional query words: prodsms hw32

======================================================================
Keywords          : kbsms200 
Technology        : kbSMSSearch kbSMS200 kbSMS200SP1
Version           : winnt:2.0,2.0 SP1
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>