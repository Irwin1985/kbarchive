<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q198075: PRB: Installing VB App Causes Error Determining Free Disk Space | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q198075: PRB: Installing VB App Causes Error Determining Free Disk Space" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/198/Q198075/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/198/Q198075/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q198075: PRB: Installing VB App Causes Error Determining Free Disk Space","url":"http://jeffpar.github.io/kbarchive/kb/198/Q198075/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q198075-prb-installing-vb-app-causes-error-determining-free-disk-space">Q198075: PRB: Installing VB App Causes Error Determining Free Disk Space</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q198075
Product(s): Microsoft Visual Basic for Windows
Version(s): WINDOWS:5.0
Operating System(s): 
Keyword(s): kbcode kbwizard kbAppSetup kbVBp kbVBp500 kbGrpDSVB
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Learning Edition for Windows, version 5.0 
- Microsoft Visual Basic Professional Edition for Windows, version 5.0 
- Microsoft Visual Basic Enterprise Edition for Windows, version 5.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When installing an application built with the Visual Basic 5.0 Setup Wizard on a
Windows NT computer, the following error may occur:

  Invalid procedure call or argument
  Error determining disk space free for drive \:

After pressing the OK button to dismiss the error message, the following error
message displays:

  Invalid procedure call or argument
  Error determining allocation unit for drive \:

Immediately after dismissing this error message, the following dialog box
appears:

  There is not enough free disk space on one or more drives.

The dialog box displays the "\:" as a drive letter, the remaining valid local
drives on the system, Space Required, Space Available, and Space Needed.

There are three buttons on the dialog box labeled "Change Drive", "Install Now",
and "Exit Setup". Pressing "Change Drive" does not alleviate the problem and the
same errors occur in a similar manner as stated previously. Pressing "Install
Now" may or may not continue with the installation.

CAUSE
=====

The problem is due to code within the Visual Basic 5.0 Setup Toolkit project
(Setup1.vbp) that determines the drive letter to install by using the value of
TMP or TEMP environment variables. The error messages occur when these
environment variables are not defined.

Setup1.vbp can be located in the setupkit\setup1 directory under the Visual Basic
5.0 installation directory.

RESOLUTION
==========

Use the System applet in the Control Panel to define the TMP and TEMP "User"
environment variables for the currently logged in user.

Step-By-Step Example
--------------------

1. Click the Start button, and then point to Settings. Open the Control Panel
  and launch the System applet.

2. Select the Environment Tab.

3. Type "TMP" into the Variable text box and "%SystemDrive%\TEMP" into the Value
  text box. Do not enter the quotes.

4. Add the TEMP environment variable by following step 3 again but using "TEMP"
  for the Variable and "%SystemDrive%\TEMP".

NOTE: If your Windows NT System Drive is the "C" drive, step 3 and 4 would set
TMP and TEMP to C:\temp.

5. Try to install the Visual Basic 5.0 application again.

The preceding error should not occur again.

MORE INFORMATION
================

A more descriptive error message can be generated by making a modification to
the Setup1.vbp project found in the &lt;VB5&gt;\setupkit\setup1 directory, and
then recompiling the project.

NOTE: Microsoft Technical Support does not support the modification of the setup
process, the Setup Toolkit, or any of the setup files. Support is provided for
the Setup Wizard on an "as is" basis only.

The code found in the "InitDiskInfo" subroutine in the Setup1.bas file should be
replaced with the following code. This code produces an error message that
explains that the "TEMP" and/or "TMP" variables should be defined.

     '-----------------------------------------------------------
     ' FUNCTION: InitDiskInfo
     '
     ' Called before calculating disk space to initialize
     ' values used/determined when calculating disk space
     ' required.
     '-----------------------------------------------------------
     '
     Sub InitDiskInfo()
        '
        'Initialize "table" of drives used and disk space array
        '
        gstrDrivesUsed = gstrNULL
        Erase gsDiskSpace

        mlTotalToCopy = 0

        '
        'Get drive/directory for temporary files
        '
        mstrConcatDrive = UCase$(Environ$(gstrTMP_DIR))
        If mstrConcatDrive = gstrNULL Then
           mstrConcatDrive = UCase$(Environ$(gstrTEMP_DIR))

           If mstrConcatDrive = gstrNULL Then
              Dim iRet As Integer
              iRet = MsgError(Error$ &amp; LS$ &amp; "Unable to determine the " &amp; _
                            "temporary directory. " &amp; vbCrLf &amp; _
                            "Please make sure the 'TEMP' and/or 'TMP' " &amp; _
                            "environment variables are defined.", _
                            MB_OK Or MB_ICONSTOP, gstrTitle, MSGERR_ERROR)

              ExitSetup frmSetup1, gintRET_FATAL
           End If
        End If
        AddDirSep mstrConcatDrive

Additional query words:

======================================================================
Keywords          : kbcode kbwizard kbAppSetup kbVBp kbVBp500 kbGrpDSVB 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB500Search kbVBA500 kbVB500
Version           : WINDOWS:5.0
Issue type        : kbprb
Solution Type     : kbpending

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>