<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q198536: HOWTO: #include the Localized MFC Resources in an EXE or DLL | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q198536: HOWTO: #include the Localized MFC Resources in an EXE or DLL" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/198/Q198536/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/198/Q198536/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q198536: HOWTO: #include the Localized MFC Resources in an EXE or DLL","url":"http://jeffpar.github.io/kbarchive/kb/198/Q198536/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q198536-howto-include-the-localized-mfc-resources-in-an-exe-or-dll">Q198536: HOWTO: #include the Localized MFC Resources in an EXE or DLL</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q198536
Product(s): Microsoft C Compiler
Version(s): 4.0,4.1,4.2,5.0,6.0
Operating System(s): 
Keyword(s): kbIntl kbMFC kbResource kbVC400 kbVC500 kbVC600 kbLocalization kbDSupport kbIntlDev kbG
Last Modified: 10-JUN-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- The Microsoft Foundation Classes (MFC), used with:
   - Microsoft Visual C++, 32-bit Editions, versions 4.0, 4.1 
   - Microsoft Visual C++, 32-bit Enterprise Edition, versions 4.2, 5.0, 6.0 
   - Microsoft Visual C++, 32-bit Professional Edition, versions 4.2, 5.0, 6.0 
   - Microsoft Visual C++, 32-bit Learning Edition, version 6.0 
-------------------------------------------------------------------------------

SUMMARY
=======

MFC provides resource files localized for certain locales, in the MFC\SRC\L.*
and MFC\Include\L.* directories. This article describes how to modify the
project settings and resource file to use these localized MFC resources.

NOTE: The information in this article does not apply to resources for ActiveX
controls.

MORE INFORMATION
================

Steps to include the localized resources:

1. On the Project menu, click Project Settings. In the Project Settings dialog
  box, select the Resource property page. Remove the _AFXDLL preprocessor
  definition. Click OK on the property sheet.

2. Open the string table using the Resource Editor and remove all the non
  application-specific strings generated by AppWizard. For example, if this
  application is an AppWizard-generated application, remove all the entries for
  the IDs from ID_FILE_NEW to the end of the string table. Strings for
  IDR_MAINFRAME, IDR_MYPROJTYPE, AFX_IDS_APP_TITLE, and AFX_IDS_IDLEMESSAGE are
  application-specific, and therefore localized strings are not provided by the
  MFC resource files.

3. On the View menu, click Resource Includes. In the Compile-time directives
  window, do the following:

  a. Set the primary language ID and the sub-language ID appropriately in the
     LANGUAGE statement. The appropriate values can be found in the
     ...\vc\include\winnt.h file. Note that the values specified in the
     LANGUAGE statement must be base-10. The values in Winnt.h are base-16.

Example: LANUGAGE 11, 1  // Specifies standard French

  b. Make sure that the code page specified in the #pragma code_page statement
     is correct. For ANSI English and most European languages the code page is
     1252; for Japanese it is 932.

  c. Modify the existing statements that include resources used by the MFC
     framework. These resources are located in the appropriate localized
     ..\vc\mfc\include directory. For example, change the following

           #include "afxres.rc"
           #include "afxprint.rc"
           #include "afxolecl.rc"
           #include "afxolesv.rc"

     to the following:

           #include "l.fra/afxres.rc"
           #include "l.fra/afxprint.rc"
           #include "l.fra/afxolecl.rc"
           #include "l.fra/afxolesv.rc"

     (A project will use the Afxolecl.rc and Afxolesv.rc files only if they are
     OLE client and/or server applications.)

  d. The Indicate.rc and Prompts.rc files contain the key-state indicators and
     menu-prompt strings that are displayed on the status bar by MFC. These
     files are located in the ..\vc\mfc\src directory. To include these files,
     #include them and explicitly specify their location. For example:

           #include "c:\VC\mfc\src\l.fra\prompts.rc"
           #include "c:\VC\mfc\src\l.fra\indicate.rc"

  e. Click OK to close the Resource Includes dialog box.

4. Build the application or DLL.

REFERENCES
==========

Technical Note 23 "Standard MFC Resources"

For additional information, please see the following article in the Microsoft
Knowledge Base:

Q200555 Localizing Stock ActiveX Property Pages With MFC Rescues


(c) Microsoft Corporation 1998, All Rights Reserved. Contributions by Isaac
Varon, Microsoft Corporation.


Additional query words:

======================================================================
Keywords          : kbIntl kbMFC kbResource kbVC400 kbVC500 kbVC600 kbLocalization kbDSupport kbIntlDev kbGrpDSMFCATL 
Technology        : kbAudDeveloper kbMFC
Version           : :4.0,4.1,4.2,5.0,6.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>