<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q157954: BUG: ROUND() Function Not Rounding Properly After Calculations | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q157954: BUG: ROUND() Function Not Rounding Properly After Calculations" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/157/Q157954/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/157/Q157954/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q157954: BUG: ROUND() Function Not Rounding Properly After Calculations","url":"http://jeffpar.github.io/kbarchive/kb/157/Q157954/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q157954-bug-round-function-not-rounding-properly-after-calculations">Q157954: BUG: ROUND() Function Not Rounding Properly After Calculations</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q157954
Product(s): Microsoft FoxPro
Version(s): 3.0,3.0b,5.0,6.0
Operating System(s): 
Keyword(s): kb3rdparty kbvfp300 kbvfp500 kbvfp600 kbGrpDSFox
Last Modified: 30-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, versions 3.0, 3.0b, 5.0, 6.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

Using the ROUND() function after performing mathematical calculations on certain
numeric values does not produce the correct result. The resulting number is not
rounded correctly to the proper decimal place.

CAUSE
=====

For some numeric values, the precision limit within FoxPro decreases after
performing mathematical calculations.

RESOLUTION
==========

Use the Currency data type when more accurate rounding of numeric values is
necessary. However, using the Currency data type does not fix all rounding
problems.

The following code example provides a workaround by converting the numeric
contents of mpay to a string. Then the VAL() function converts the string back
to a numeric data type for use in the ROUND() function.

     CLEAR
     mrate = 86.173125
     mhours = 24.0000
     mpay = mhours * mrate
     ? mpay
     test=STR(mpay,LEN(STR(mpay)),LEN(STR(mpay)))
     ? ROUND(mpay, 2)
     ? ROUND(VAL(test),2)

The code first returns the value of mpay. Next the incorrectly rounded value,
followed by the correctly rounded value, appears. The above code may produce the
correct result with every occurrence of rounding errors in Visual FoxPro.

The discrepancy of the ROUND() function's behavior is often related to a decrease
in precision as Visual FoxPro performs calculations on several numbers. For
instance, by placing the value of the variable mpay, 2068.1550000000, directly
into the ROUND() function, the correct result appears. Type the following in the
Command window:

  " ? ROUND(2068.1550000000,2) " (without the quotation marks)

The correct value appears.

STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products listed at
the beginning of this article.

MORE INFORMATION
================

The following code examples illustrate possible rounding problems that may be
encountered in Visual FoxPro.

Steps to Reproduce Behavior
---------------------------

1. Create a program that contains the following lines of code:

        mrate = 86.173125
        mhours = 24.0000
        mpay = mhours * mrate
        ? mpay
        ? ROUND(mpay, 2)

2. Close the program and run it.

3. The ROUND()function returns 2068.15. This is incorrect. The value is not
  rounded correctly to the second decimal place. The correct value should be
  2068.16.

Additional query words: kbdsd VFoxWin

======================================================================
Keywords          : kb3rdparty kbvfp300 kbvfp500 kbvfp600 kbGrpDSFox 
Technology        : kbVFPsearch kbAudDeveloper kbVFP300 kbVFP300b kbVFP500 kbVFP600
Version           : :3.0,3.0b,5.0,6.0
Issue type        : kbbug

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>