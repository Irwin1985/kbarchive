<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q41146: QB 4.50 SHELL Forces Linefeed If Cursor Is on Line 25 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q41146: QB 4.50 SHELL Forces Linefeed If Cursor Is on Line 25" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/041/Q41146/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/041/Q41146/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q41146: QB 4.50 SHELL Forces Linefeed If Cursor Is on Line 25","url":"http://jeffpar.github.io/kbarchive/kb/041/Q41146/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q41146-qb-450-shell-forces-linefeed-if-cursor-is-on-line-25">Q41146: QB 4.50 SHELL Forces Linefeed If Cursor Is on Line 25</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q41146
Product(s): See article
Version(s): 4.50
Operating System(s): MS-DOS
Keyword(s): ENDUSER | SR# S890203-69 buglist4.50 | mspl13_basic
Last Modified: 15-MAY-1989

The first program below demonstrates that a SHELL statement in
QuickBASIC Version 4.50 programs causes the screen to scroll up
(linefeed) one line if the cursor is LOCATEd on line 25. (The problem
occurs in programs run in both the QB.EXE editor and .EXE programs.)

If the cursor is not LOCATEd on line 25 at the time SHELL executes,
then SHELL does not cause a linefeed.

Microsoft has confirmed this to be a problem in Version 4.50. We are
researching this problem and will post new information as it becomes
available. This problem does not occur in earlier versions.

The following program redirects output of a directory to a file and
scrolls the screen up one line after the SHELL statement:

CLS
WIDTH 80,25  ' Must use WIDTH or VIEW PRINT 1 to 25 to use line 25.
LOCATE 1,1
PRINT "LINE 1. This scrolls off the screen after SHELL."
LOCATE 2,1
PRINT "LINE 2. This line scrolls up one line."
LOCATE 25,1
PRINT "LINE 25: NOW DOING A SHELL";
SHELL " DIR c:\ &gt; TEST.TXT"

The following program can be used as a workaround to prevent the
linefeed caused by SHELL:

CLS
WIDTH 80, 25
LOCATE 1, 1
PRINT "LINE 1 now stays on the screen without scrolling."
LOCATE 2, 1
PRINT "LINE 2 remains as the second line."
LOCATE 25, 1
PRINT "LINE 25 : DOING A SHELL AFTER CURSOR IS MOVED TO LINE 23";
xpos% = POS(0)       ' Saves the cursor position, which is
ypos% = CSRLIN       ' currently on line 25.
LOCATE 23, 1
SHELL "DIR c:\ &gt; TEST.TXT"
LOCATE ypos%, xpos%  'returns cursor to line 25 in remembered column.
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>