<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q32969: Problem Passing Array in COMMON Also in SUB Argument in .QLB | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q32969: Problem Passing Array in COMMON Also in SUB Argument in .QLB" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/032/Q32969/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/032/Q32969/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q32969: Problem Passing Array in COMMON Also in SUB Argument in .QLB","url":"http://jeffpar.github.io/kbarchive/kb/032/Q32969/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q32969-problem-passing-array-in-common-also-in-sub-argument-in-qlb">Q32969: Problem Passing Array in COMMON Also in SUB Argument in .QLB</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q32969
Product(s): See article
Version(s): 4.00 4.00b 4.50
Operating System(s): MS-DOS
Keyword(s): ENDUSER | buglist4.00 buglist4.00b buglist4.50 | mspl13_basic
Last Modified: 8-DEC-1989

If a string array is specified in a COMMON statement and also in the
argument list of a subprogram in a Quick library, garbage characters
will be displayed on the screen when that array is printed from the
subprogram. Under QuickBASIC Versions 4.00 and 4.00b, this problem
occurs only within the QB.EXE editor; the .EXE file runs without
encountering any problems. Under QuickBASIC Version 4.50, the problem
occurs both in the QB.EXE and the .EXE unless the library is created
using the debug option (/D). When the /D switch is used to build the
library, the program works correctly.

Under QuickBASIC Versions 4.00, 4.00b, and 4.50, if the subprogram is
not part of a Quick library, the program executes correctly from
inside the QuickBASIC editor.

Microsoft has confirmed this to be a problem in the QB.EXE editor in
Microsoft QuickBASIC Versions 4.00, 4.00b, and 4.50, and in the
Microsoft BASIC Compiler Versions 6.00 and 6.00b (buglist6.00,
buglist6.00b) for MS-DOS and MS OS/2. This problem has been corrected
in the Microsoft BASIC Compiler Version 7.00 (fixlist7.00).

To work around this problem, do one of the following:

1. Use the /D (debug) option when creating the Quick library.

2. Compile the program as an executable file to run.

3. Do not use a Quick library. (A separately loaded source file can be
   substituted in the QB.EXE editor.)

The following code examples demonstrate the problem:

The main program is as follows:

     DECLARE SUB qstnaire (question$())
     DEFINT I-N
     DIM question$(5)
     COMMON question$()
     CLS
     INPUT question$(1)
     CALL qstnaire(question$())
     END

The subprogram in the Quick library is as follows:

     DEFINT I-N
     SUB qstnaire (question$()) STATIC
     PRINT question$(i);
     END SUB
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>