<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q101539: PC Forms: Using Visual Basic OLE 2.0 Control | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q101539: PC Forms: Using Visual Basic OLE 2.0 Control" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/101/Q101539/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/101/Q101539/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q101539: PC Forms: Using Visual Basic OLE 2.0 Control","url":"http://jeffpar.github.io/kbarchive/kb/101/Q101539/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q101539-pc-forms-using-visual-basic-ole-20-control">Q101539: PC Forms: Using Visual Basic OLE 2.0 Control</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q101539
Product(s): Microsoft Mail For PC Networks
Version(s): WINDOWS:1.0,3.0,3.2
Operating System(s): 
Keyword(s): 
Last Modified: 13-NOV-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Electronic Forms Designer, version 1.0, used with:
   - Microsoft Mail for PC Networks, versions 3.0, 3.2 
-------------------------------------------------------------------------------

SUMMARY
=======

Microsoft Electronic Forms Designer was designed to be used with version 2.0 or
later of Microsoft Visual Basic Professional edition. An OLE (Object Linking and
Embedding) 1.0 control that allows applications to exchange data is included
with Visual Basic 2.0. The E-Forms Designer was developed to interface with
version 1.0 of the OLE control.

However, version 3.0 of Microsoft Visual Basic includes support for OLE 2.0 with
a new OLE control (MSOLE2.VBX). This new implementation of OLE is not supported
by the Electronic Forms Designer unless the following modifications are made to
the EFORM.BAS and CONSTANT.BAS files.

Modify Functions in EFORM.BAS
-----------------------------

The OLE 1.0 control type is defined as "OleClient." With OLE 2.0, the control
type is "OLE." Perform the following steps to update the code in the
ReadTaggedControls and WriteTaggedControls functions defined in EFORM.BAS:

1. Open your E-Form project in Visual Basic.

2. From the Project window, select EFORM.BAS. Click the View Code button to
  display the code.

3. From the Procedures drop-down list box, select the ReadTaggedControls
  function.

4. Scroll to the code that enumerates the OLE control. In the following line of
  code

        ElseIf TypeOf ctrl Is OleClient Then

  change "OleClient" to "OLE".

5. From the Procedures drop-down list box, select the WriteTaggedControls
  function.

6. Repeat step 4 to modify the type declaration.

7. From the File menu, choose Save Project.

Modify Definitions in CONSTANT.BAS
----------------------------------

In addition to a change to the type definition, OLE 2.0 changed a number of
settings for the Action and OLEType properties, as well as the Updated Event.
These settings are defined in the CONSTANT.BAS file. To update the settings, do
the following:

1. Open your E-Form project in Visual Basic.

2. From the Project window, select CONSTANT.BAS. Click the View Code button to
  display the code.

3. Scroll to the section commented "'OLE Client Control."

4. Modify the section titled "'Action" as listed below:

        'Action
        Global Const OLE_CREATE_NEW = 0
        Global Const OLE_CREATE_FROM_FILE = 1
        Global Const OLE_COPY = 4
        Global Const OLE_PASTE = 5
        Global Const OLE_UPDATE = 6
        Global Const OLE_ACTIVATE = 7
        Global Const OLE_CLOSE = 9
        Global Const OLE_DELETE = 10
        Global Const OLE_SAVE_TO_FILE = 11
        Global Const OLE_READ_FROM_FILE = 12
        Global Const OLE_INSERT_OBJ_DLG = 14
        Global Const OLE_PASTE_SPECIAL_DLG = 15
        Global Const OLE_FETCH_VERBS = 17
        Global Const OLE_SAVE_OLE1 = 18

5. Update the section titled "'ServerType" to "'OLEType" and make the following
  changes:

        'OLEType
        Global Const OLE_LINKED = 0
        Global Const OLE_EMBEDDED = 1
        Global Const OLE_NONE = 2

6. Change "'Update Event Constants" to "'Updated Event Constants" and make the
  following change:

        'Updated Event Constants
        Global Const OLE_CHANGED = 0
        Global Const OLE_SAVED = 1
        Global Const OLE_CLOSED = 2
        Global Const OLE_RENAMED = 3

7. From the File menu, choose Save Project.

Additional query words: 1.00

======================================================================
Keywords          :  
Technology        : kbZNotKeyword2 kbMailSearch kbZNotKeyword3
Version           : WINDOWS:1.0,3.0,3.2

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>