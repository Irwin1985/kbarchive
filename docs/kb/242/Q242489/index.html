<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q242489: SMS: Run-Time Error When Advertising MFC-Based Package (English | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q242489: SMS: Run-Time Error When Advertising MFC-Based Package (English" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/242/Q242489/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/242/Q242489/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q242489: SMS: Run-Time Error When Advertising MFC-Based Package (English","url":"http://jeffpar.github.io/kbarchive/kb/242/Q242489/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q242489-sms-run-time-error-when-advertising-mfc-based-package-english">Q242489: SMS: Run-Time Error When Advertising MFC-Based Package (English</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q242489
Product(s): Microsoft Systems Management Server
Version(s): winnt:2.0,2.0 SP1
Operating System(s): 
Keyword(s): kbClient kbConfig kbsms200fix kbAdvertisement kbAppMan kbPackage kbSoftwareDist
Last Modified: 06-AUG-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server versions 2.0, 2.0 SP1 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you distribute software to a Systems Management Server (SMS) client, the
following error message may be displayed when the advertisement runs:

  Runtime ERROR!
  Program \\server\smspkgd$\opl00003\mfctest.exe
  abnormal program termination

You may also see the following entry in the Smsapm32.log file:

  SCHED DATA : Attempting to execute
  \\SMSD4L8PDCUS\SMSPKGC$\RS100006\mfctest.exe' (SERVICE context)
  SCHED DATA : Command line "\\SMSD4L8PDCUS\SMSPKGC$\RS100006\mfctest.exe" CWD
  "\\SMSD4L8PDCUS\SMSPKGC$\RS100006\"

  SCHED DATA : Return code = 0x3; The system cannot find the path specified.~~;
  Program '\\SMSD4L8PDCUS\SMSPKGC$\RS100006\mfctest.exe' terminated with exit
  code = 3.

On the client, the program (the .exe file) may have a status of "Started" in Task
Manager, even though it is no longer active.

CAUSE
=====

This behavior can occur if the Setup file that is used by the advertised program
uses the Msvcrt.dll run-time library file from Microsoft Visual C++ and if one
of the following options is enabled on the Environment tab in the program
properties:

- Run with administrative rights

- Use Windows NT client software installation account

RESOLUTION
==========

A supported fix is now available from Microsoft, but it is only intended to
correct the problem that is described in this article. Only apply it to systems
that are experiencing this specific problem. This fix may receive additional
testing. Therefore, if you are not severely affected by this problem, Microsoft
recommends that you wait for the next Systems Management Server service pack
that contains this fix.

To resolve this problem immediately, contact Microsoft Product Support Services
to obtain the fix. For a complete list of Microsoft Product Support Services
phone numbers and information about support costs, visit the following Microsoft
Web site:

  http://support.microsoft.com/default.aspx?scid=fh;EN-US;CNTACTMS

NOTE: In special cases, charges that are ordinarily incurred for support calls
may be canceled if a Microsoft Support Professional determines that a specific
update will resolve your problem. The usual support costs will apply to
additional support questions and issues that do not qualify for the specific
update in question.

The English-language version of this fix should have the following file
attributes or later:

  Date      Time     Version    Size     File name      Platform
  --------------------------------------------------------------
  11/30/99  10:01PM  1380.1082  367,795  Apasetup.exe   i386
  12/02/99  12:29AM                  67  Compver.ini    i386
  11/23/99  06:23PM  1380.1082  209,264  Smsapm32.exe   i386
  11/30/99  09:59PM  1380.1082   75,120  Progrm32.dll   i386
  11/30/99  10:01PM  1380.1082  630,116  Apasetup.exe   Alpha
  12/02/99  12:29AM                 67   Compver.ini    Alpha
  11/23/99  06:24PM  1380.1082  279,824  Smsapm32.exe   Alpha
  11/30/99  10:00PM  1380.1082  122,640  Progrm32.dll   Alpha

NOTE: Due to file dependencies, the most recent hotfix or feature that contains
the above files may also contain additional files.



WORKAROUND
==========

This behavior does not occur if either the "Run with administrative rights" or
"Use Windows NT client software installation account" option is not enabled.

STATUS
======

Microsoft has confirmed this to be a problem in Systems Management Server
version 2.0.

MORE INFORMATION
================

To install the hotfix, use either of the following methods.

Using the Hotfix Installer
--------------------------

NOTE: This method works on i386 platforms only.

1. Copy the hotfix folder structure to a share on your network. The Q242489.exe
  file is a Microsoft Windows Installer file that updates specific files on
  your site server.

2. Log on to your site server using an account with administrative privileges.

3. On the site server, close the SMS Administrator console.

4. Start Q242489.exe and follow the directions in the wizard. You can run the
  program in Quiet mode by using the /s switch.

Manual Installation
-------------------

1. Stop the SMS_EXECUTIVE and SMS_SITE_COMPONENT_MANAGER services on the site
  server.

2. Copy the updated Apasetup.exe file to the
  &lt;Sms_root_folder&gt;\Inboxes\Clicomp.src\Smsapm32\&lt;Platform&gt; folder.

3. Copy the updated Compver.ini file to the
  &lt;Sms_root_folder&gt;\Inboxes\Clicomp.src\Smsapm32 folder.

4. Copy the Smsapm32.exe file to the
  &lt;Sms_root_folder&gt;\Bin\&lt;Platform&gt; folder.

5. Start the SMS_SITE_COMPONENT_MANAGER and SMS_EXECUTIVE services. When the
  Client Access Points (CAPs) and Logon Points have been updated, the clients
  can be updated.

For additional information, click the article number below to view the article in
the Microsoft Knowledge Base:

  Q253197 Run-Time Error When Advertising MFC-Based Package (ICP Version)

Additional query words: prodsms

======================================================================
Keywords          : kbClient kbConfig kbsms200fix kbAdvertisement kbAppMan kbPackage kbSoftwareDist 
Technology        : kbSMSSearch kbSMS200 kbSMS200SP1
Version           : winnt:2.0,2.0 SP1
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>