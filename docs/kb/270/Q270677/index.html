<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q270677: XADM: Event Service Does Not Start and Error 0x80040154 Appears | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q270677: XADM: Event Service Does Not Start and Error 0x80040154 Appears" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/270/Q270677/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/270/Q270677/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q270677: XADM: Event Service Does Not Start and Error 0x80040154 Appears","url":"http://jeffpar.github.io/kbarchive/kb/270/Q270677/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q270677-xadm-event-service-does-not-start-and-error-0x80040154-appears">Q270677: XADM: Event Service Does Not Start and Error 0x80040154 Appears</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q270677
Product(s): Microsoft Exchange
Version(s): winnt:5.5
Operating System(s): 
Keyword(s): exc55
Last Modified: 06-AUG-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, version 5.5 
-------------------------------------------------------------------------------

SYMPTOMS
========

The Exchange 5.5 Event Service fails to start.

The following Event ID appears in the application event log:

  Event ID: 5
  Source: MSExchangeES
  Type: Error
  Description: An unexpected MAPI error occurred 0x80040154

CAUSE
=====

Error 0x80040154 signifies that there is an unregistered .dll file.

RESOLUTION
==========

To resolve this issue, reregister the Event Service .dll files using regsvr32;
to do so, follow these steps:

1. Go to the command prompt, and change directories to the Exchsrvr\bin
  subdirectory.

2. Enter the following command

  regsvr32 &lt;Filename&gt;.dll

  where &lt;Filename&gt; is the name of the .dll file (such as "Scripto.dll").

3. Run the command on the following .dll files:

  Scripto.dll
  Ss.dll
  Esconf.dll

WORKAROUND
==========

When the Event Service fails to start and the error "0x80040154" appears,
reinstalling the Microsoft Outlook client on the Exchange server allows the
service to start.

To reinstall the Outlook client on an Exchange server, follow these steps:

1. Stop all the Exchange services, and then set the Exchange System Attendant to
  Disabled.

2. Stop and disable all third party services such as monitoring agents, backup
  programs, and antivirus programs.

3. Stop the SNMP service.

4. Close all programs.

5. Restart the server.

6. Reinstall the Outlook client on the server.

7. Change the Exchange System Attendant startup back to Automatic.

8. Start the Exchange Services manually except for the Exchange Event Service.

9. Start the Exchange Event Service manually.

Additional query words:

======================================================================
Keywords          : exc55 
Component         : Admin
Technology        : kbExchangeSearch kbExchange550 kbZNotKeyword2
Version           : winnt:5.5
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>