<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q321561: Phantom Connection Count When Keep-Alive Conns Switch HostHeader | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q321561: Phantom Connection Count When Keep-Alive Conns Switch HostHeader" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/321/Q321561/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/321/Q321561/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q321561: Phantom Connection Count When Keep-Alive Conns Switch HostHeader","url":"http://jeffpar.github.io/kbarchive/kb/321/Q321561/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q321561-phantom-connection-count-when-keep-alive-conns-switch-hostheader">Q321561: Phantom Connection Count When Keep-Alive Conns Switch HostHeader</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q321561
Product(s): Internet Information Server
Version(s): 4.0,5.0
Operating System(s): 
Keyword(s): kbCOMIS kbWin2000sp3fix
Last Modified: 15-AUG-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Server version 4.0 
- Microsoft Internet Information Services version 5.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

After you install the fix from the following Microsoft Knowledge Base article

  Q319733 MS02-018: April 2002 Cumulative Patch for Internet Information
  Services

a Web site may return the following error message:

  HTTP 403.9: Access Forbidden

CAUSE
=====

If a single site is mapped to multiple Domain Name System (DNS) names and
multiple users switch between different DNS names in that site, the connection
count is distorted when a keep-alive connection connects to different host
headers that are mapped to a single site. A phantom connection count is
enumerated each time a connection switches host headers.

RESOLUTION
==========

IIS 4.0:

A supported fix is now available from Microsoft, but it is only intended to
correct the problem that is described in this article. Apply it only to
computers that are experiencing this specific problem.

To resolve this problem immediately, download the fix by clicking the download
link later in this article or contact Microsoft Product Support Services to
obtain the fix. For a complete list of Microsoft Product Support Services phone
numbers and information about support costs, visit the following Microsoft Web
site:

  http://support.microsoft.com/default.aspx?scid=fh;EN-US;CNTACTMS

NOTE: In special cases, charges that are ordinarily incurred for support calls
may be canceled if a Microsoft Support Professional determines that a specific
update will resolve your problem. The usual support costs will apply to
additional support questions and issues that do not qualify for the specific
update in question.

The English version of this fix has the file attributes (or later) that are
listed in the following table. The dates and times for these files are listed in
coordinated universal time (UTC). When you view the file information, it is
converted to local time. To find the difference between UTC and local time, use
the Time Zone tab in the Date and Time tool in Control Panel.

  Date         Time   Version       Size  File name
  ----------------------------------------------------
  30-Apr-2002  07:31  4.2.776.1  214,544  Adsiis.dll       
  30-Apr-2002  07:32  4.2.776.1  330,672  Asp.dll          
  30-Apr-2002  07:32  4.2.776.1   34,384  Clusiis4.dll     
  30-Apr-2002  07:31  4.2.776.1   55,392  Httpodbc.dll     
  30-Apr-2002  07:31  4.2.776.1   98,912  Iischema.dll     
  30-Apr-2002  07:30  4.2.776.1   63,984  Iislog.dll       
  30-Apr-2002  07:30  4.2.776.1  185,792  Infocomm.dll     
  30-Apr-2002  07:30  4.2.776.1   29,520  Iscomlog.dll     
  30-Apr-2002  07:31  4.2.776.1   38,256  Ssinc.dll        
  30-Apr-2002  07:31  4.2.776.1   25,360  Sspifilt.dll     
  30-Apr-2002  07:31  4.2.776.1  231,104  W3svc.dll        
  30-Apr-2002  07:30  4.2.776.1   88,032  Wam.dll



IIS 5.0:

To resolve this problem, obtain the latest service pack for Windows 2000. For
additional information, click the following article number to view the article
in the Microsoft Knowledge Base:

  Q260910 How to Obtain the Latest Windows 2000 Service Pack

The English version of this fix has the file attributes (or later) that are
listed in the following table. The dates and times for these files are listed in
coordinated universal time (UTC). When you view the file information, it is
converted to local time. To find the difference between UTC and local time, use
the Time Zone tab in the Date and Time tool in Control Panel.

  Date         Time   Version        Size     Filename
  ------------------------------------------------------
  19-Apr-2002  23:08  5.0.2195.5624  348,944  W3svc.dll       


WORKAROUND
==========

To work around this problem if you have already applied MS02-018 to your Web
server, follow these steps:

1. Click Start, point to Programs, point to Administrative Tools, and then click
  Internet Services Manager.

2. Right-click the Web site, and then click Properties.

3. On the Web Site tab, click to select Unlimited Connections.

NOTE: Make sure that you consider any licensing implications that may be involved
when you change this property.


STATUS
======

Microsoft has confirmed that this is a problem in IIS 4.0 and 5.0. This problem
was first corrected in Windows 2000 Service Pack 3.

MORE INFORMATION
================

For additional information, click the article number below to view the article
in the Microsoft Knowledge Base:

  Q272235 Internet Connector License Types for Windows 2000

Additional query words: kbIISCom

======================================================================
Keywords          : kbCOMIS kbWin2000sp3fix 
Technology        : kbiisSearch kbiis500 kbiis400
Version           : :4.0,5.0
Hardware          : x86
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>