<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q251054: XADM: High Dsmain.exe CPU Usage When Populating Address Book Vie | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q251054: XADM: High Dsmain.exe CPU Usage When Populating Address Book Vie" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/251/Q251054/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/251/Q251054/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q251054: XADM: High Dsmain.exe CPU Usage When Populating Address Book Vie","url":"http://jeffpar.github.io/kbarchive/kb/251/Q251054/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q251054-xadm-high-dsmainexe-cpu-usage-when-populating-address-book-vie">Q251054: XADM: High Dsmain.exe CPU Usage When Populating Address Book Vie</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q251054
Product(s): Microsoft Exchange
Version(s): winnt:5.0,5.5
Operating System(s): 
Keyword(s): exc5 exc55
Last Modified: 26-JUL-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, versions 5.0, 5.5 
-------------------------------------------------------------------------------

SYMPTOMS
========

If you create an Address Book view with multilevel containers or if it is
grouped on an single attribute that has thousands of different sort criteria,
the directory service (or Dsamain.exe) CPU usage on many if not all the servers
in your site may be extremely high. When the Dsamain process attempts to build
the new Address Book view based upon your defined criteria and in turn,
replicates these changes across your Exchange Server organization, high
Dsamain.exe CPU symptoms may also be experienced at those sites. Because of the
high CPU usage, you may experience slow connections, slow client logon times, or
there may be slow connections to your Exchange Server computers when you are
using the Exchange Server Administrator program. The global address list may not
be visible in the Administrator program or from the Microsoft Outlook or
Microsoft Exchange client.

CAUSE
=====

This behavior can occur because the View Consistency Checker (VCC) process,
which is responsible for populating the Address Book view, runs every five
minutes.

MORE INFORMATION
================

- If you want the Address Book view that is being replicated, take no action
  and allow the replication to finish.

- If you do not want the Address Book view that is being replicated:

  1. Follow the steps outlined in the following Microsoft Knowledge Base
     article:

  Q255673 XADM: Unwanted Replication of Address Book Views

  2. Make sure that only one administrator makes changes to the Address Book
     view. Anyone in the organization who has Modify permissions to a
     site-naming context can make changes to the Address Book view. If you make
     sure that only one administrator can make changes to the Address Book
     view, you ensure that the changes that you make are not deleted by more
     current changes that are replicating throughout your organization.


  3. In the Exchange Server Administrator program, set the first grouping of
     the Address Book view that you want to remove to a custom attribute that
     is not being used. Do this at every level in the Address Book view to make
     the Address Book view appear to the VCC as if it has no containers, so
     that the VCC stops populating the Address Book view throughout the
     organization.

  4. Immediately make multiple modifications to the Administrative Note on the
     General tab of the Address Book view to increase the Object-Version number
     on the Address Book view. Click Apply each time that you make a change.

  5. Allow the Address Book view changes to replicate throughout every site in
     the organization. This takes some time, depending on the size of the
     organization, the speed of the links, and the replication schedule times.
     Replication must be working correctly throughout the entire organization
     for the view to be completely deleted.

For additional information about making changes to and deleting Address Book
views, click the article numbers below to view the articles in the Microsoft
Knowledge Base:

  Q180141 XADM: Recurring Address Book Views in Exchange Server

  Q255673 XADM: Unwanted Replication of Address Book Views

For additional information about the behavior described in this article, click
the article numbers below to view the articles in the Microsoft Knowledge Base:

  Q248398 XADM: Restricting Permission to Address Book Views

  Q267425 XADM: Hiding Address Book Views from Exchange Server Administrator
  and Clients During Address Book View Storms

Additional query words: Scheduling Search Control abv mapi hierarchy dsa recalculation

======================================================================
Keywords          : exc5 exc55 
Technology        : kbExchangeSearch kbExchange500 kbExchange550 kbZNotKeyword2
Version           : winnt:5.0,5.5
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>