<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q251245: &quot;Invalid Name&quot; Error Message When You Log On to MMS with Compass | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q251245: &quot;Invalid Name&quot; Error Message When You Log On to MMS with Compass" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/251/Q251245/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/251/Q251245/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q251245: &quot;Invalid Name&quot; Error Message When You Log On to MMS with Compass","url":"http://jeffpar.github.io/kbarchive/kb/251/Q251245/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q251245-invalid-name-error-message-when-you-log-on-to-mms-with-compass">Q251245: "Invalid Name" Error Message When You Log On to MMS with Compass</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q251245
Product(s): Microsoft Windows NT
Version(s): 2.1
Operating System(s): 
Keyword(s): kbenv kberrmsg kbtool
Last Modified: 06-AUG-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Metadirectory Services 2.1 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you log on to the Microsoft Metadirectory Services (MMS) server through the
Compass client, you may receive the following error message:

  Invalid Name

CAUSE
=====

This behavior occurs if the user name is not found in the MMS database. The name
may not be found in the database for any of the following reasons:

- The logon name is misspelled.

- The user does not exist in the database.

- The hashing function in the database is not working correctly.

- The database is damaged.

When you log on to MMS, you are identified in one of the following ways:

- Simple Mail Transfer Protocol (SMTP) e-mail address (for example,
  &lt;Username&gt;@microsoft.com)

- Distinguished name (for example,
  cn=&lt;Username&gt;,ou=Administration,dc=Microsoft International,dc=COM).

NOTE: Case is not significant, regardless of which method is used.

RESOLUTION
==========

To resolve the problem, use the following troubleshooting steps:

1. Determine if a specific user can log on to the MMS server using their SMTP
  e-mail address. If the problem is isolated to only one user, refer to the
  "Logon Name (SMTP E-Mail Address) Is Invalid" section of this article. If the
  problem is not isolated to just one user, continue to step 2.

2. Determine if a specific user can log on to the MMS server using their
  distinguished name. If not, refer to the "User Does Not Exist in the
  Database" section of this article.

3. Determine if any users can log on anonymously to the MMS server. If not,
  refer to the "Problems with the X500.db Database File" section of this
  article. (For more information about anonymous logon, refer to the "More
  Information" section of this article.)

4. Determine if any users can log on (authenticated) to the MMS server (using
  either their distinguished name or SMTP e-mail address). If not, refer to the
  "Hashing Function in the Database Is Not Working Properly" section of this
  article. (For more information about authenticated logon, refer to the "More
  Information" section of this article.)

Logon Name (SMTP E-Mail Address) Is Invalid
-------------------------------------------

To verify that the logon name is correct, use the following steps:

1. Log on to Compass anonymously or as another user (this works unless the
  default Access Controls have been changed).

2. In the Action panel, click Search.

3. In the Search box, type the user's name, and then press ENTER.

4. The default search method is for Match Attribute is Any, or any hashed
  attribute. At least one match should be displayed in the panel beneath the
  Search dialog box. Click the correct match and then double-click the user's
  name to display the user properties.

5. On the General tab, click to select the Email check box. The name must be
  identical to the name you are typing to log on to Compass.

  NOTE: To confirm that you use the exact string, it is recommended that you
  copy the value from the Email box and paste it into the logon dialog box.

User Does Not Exist in the Database
-----------------------------------

To verify that the user exists in the database, use the following steps:

1. Attempt to log on anonymously through Compass.

2. Click Known Universe.

3. In the left-hand panel, click Search.

4. Type "administrator" (without the quotation marks), and then press ENTER.

5. If no Administrator entries are displayed below the Search dialog box, refer
  to the "Problems with the X500.db Database File" section of this article.

6. If you find the Administrator entry, double-click the icon to display the
  entry's properties.

If you are unable to search anonymously,there may be a security restriction in
place. If you are unable to log on as an administrator to check security access
controls, contact Microsoft Product Support Services.


Problems with the X500.db Database File
---------------------------------------

If the database is deleted or renamed, the Zoomit Server service creates a new
database when the service starts. To verify the size of the X500.db file, use
the following steps:

1. Go to the Zoomserv\Data\Db folder.

2. Locate the x500.db file.

3. Right-click the file, and then click Properties.

4. On the General tab, note the size of the file.

  NOTE: File sizes vary. A zero-byte file indicates a severe problem (there is
  no data in the Asn.1 database and the entire database must be recovered from
  backup).

5. If the size of the file is normal, refer to the "Hashing Function in the
  Database Is Not Working Properly" section of this article.

Hashing Function in the Database Is Not Working Properly
--------------------------------------------------------

Make sure you have ruled out all preceding scenarios. In this situation, you are
unable to log on to the database as any user, although the X500.db file size is
greater than 0 bytes. If you confirm this, use either of the following methods
to attempt to resolve the issue:

- Run Viahashtool.exe with the server online and regenerate only the hash
  tables (for additional information, refer to the "More Information" section
  of this article).

- Run Viacompact.exe with the server offline and regenerate the entire
  database. (For additional information about the Viacompact tool, refer to the
  "More Information" section of this article.)

  NOTE: This is the most radical and costly option because the process can take
  many hours. In addition, the server must remain offline for the entire
  process and the process cannot be stopped.

If you are still unable to resolve the invalid name issue, contact Microsoft
Product Support Services.

MORE INFORMATION
================

How to Perform Anonymous Logon in MMS
-------------------------------------

1. Click Start, point to Programs, and then click Zoomit Directory Services V2.

2. Click Zoomit Compass.

3. Click Advanced.

4. Click Anonymous in the "Type of Login" area.

5. If you receive a Servers dialog box, click the appropriate server, and then
  click OK.

How to Perform Authenticated Logon in MMS
-----------------------------------------

1. Click Start, point to Programs, and then click Zoomit Directory Services V2.

2. Click Zoomit Compass.

3. Click Advanced.

4. Click Based on Identity in the "Type of Login" area.

5. In the Name box, type either the user's SMTP e-mail address or the user's MMS
  distinguished name.

6. In the Password box, type the user's password.

7. If you receive a Servers dialog box, click the appropriate server, and then
  click OK.

How to Regenerate Hash Tables
-----------------------------

To regenerate hash tables, use the following steps:

1. Click Start, click Run, type "cmd" (without the quotation marks), and then
  press ENTER.

2. Go to the Zoomserv\Bin folder.

3. Type the following command, and then press ENTER:

  viahashtool -regenerate

4. When Viahashtool has finished, stop the Zoomit Server service.

5. Delete the Zoomserv\Data\Db\Hash*.db and Hashwild.db files.

6. Rename the Zoomserv\Data\Db\Hash*.temp and Hashwild.temp files to Hash.db and
  Hashwild.db, respectively.

7. Restart the Zoomit Server service.

How to Run Viacompact
---------------------

1. Stop the Zoomit Server service.

2. Click Start, point to Programs, and then click Zoomit Directory Services V2.

3. Click Zoomit Via Compact Utility.

4. Click Start to run the tool.

5. After the tool is finished running, check for any error messages, and then
  try to log on to the MMS server through Compass.

For additional information, click the article number below to view the article in
the Microsoft Knowledge Base:

  Q250484 Using the VIA Compact Utility in Microsoft Metadirectory Services


Additional query words: corrupt corrupted dn

======================================================================
Keywords          : kbenv kberrmsg kbtool 
Technology        : kbMMSSearch kbMMS210
Version           : :2.1
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>