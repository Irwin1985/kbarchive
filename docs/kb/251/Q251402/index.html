<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q251402: PRB: Windows Hook Stops Responding in a 16-Bit Application | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q251402: PRB: Windows Hook Stops Responding in a 16-Bit Application" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/251/Q251402/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/251/Q251402/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q251402: PRB: Windows Hook Stops Responding in a 16-Bit Application","url":"http://jeffpar.github.io/kbarchive/kb/251/Q251402/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q251402-prb-windows-hook-stops-responding-in-a-16-bit-application">Q251402: PRB: Windows Hook Stops Responding in a 16-Bit Application</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q251402
Product(s): Microsoft Windows Software Development Kit
Version(s): WINDOWS:4.0,95
Operating System(s): 
Keyword(s): kbHook kbGrpDSUser kbOSWin95 kbOSWin98 kbDSupport
Last Modified: 15-DEC-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows Software Development Kit (SDK) 4.0, on platform(s):
   - Microsoft Windows 98 
   - Microsoft Windows 95 
-------------------------------------------------------------------------------

SYMPTOMS
========

A global Windows hook, for example a mouse hook, stops responding (crashes) when
triggered by a 16-bit application.

CAUSE
=====

The problem occurs when the hook dynamic-link library (DLL) is built by using
the Visual C++ 6.0 Service Pack 2 (SP2) development environment. The problem
also occurs when the hook project is using the multithreaded DLL C run-time
library (/MD) option.

The Libcmt.lib file that is replaced by SP2 has a bug that can cause this type of
behavior. The versions of Libcmt.lib from SP1 and SP3 do not exhibit this
behavior.

RESOLUTION
==========

To prevent this problem, do not use Libcmt.lib from Visual C++ version 6.0 SP2.
Either install Visual C++ 6.0 SP1 or Visual C++ 6.0 SP3, or use Libcmt.lib from
a Visual C++ 6.0 SP1 or SP3 installation and rebuild the DLL.

If you are using the /MD or multithreaded DLL C run-time library option, you must
switch to the static multithreaded option (/MT).

STATUS
======

This problem is caused by a regression bug in the Visual C++ version 6.0 SP2
development environment.

MORE INFORMATION
================

Steps to Reproduce Behavior
---------------------------

1. Build a system-wide keyboard/mouse hook by using Visual C++ 6.0 SP2.

2. Install the system-wide hook.

3. Start any 16-bit application.

4. When mouse (in the case of a mouse hook) or keyboard (in the case of a
  keyboard hook) input occurs on the 16-bit application, the program stops
  responding (crashes).

Alternatively:

1. Build a system-wide keyboard/mouse hook by using the /MD compiler switch.

2. Install the system-wide hook.

3. Start any 16-bit application.

4. When mouse (in the case of a mouse hook) or keyboard (in the case of a
  keyboard hook) input occurs on the 16-bit application, the program stops
  responding (crashes).

Additional query words:

======================================================================
Keywords          : kbHook kbGrpDSUser kbOSWin95 kbOSWin98 kbDSupport 
Technology        : kbAudDeveloper kbSDKSearch kbWinSDKSearch
Version           : WINDOWS:4.0,95
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>