<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q200802: SMS: Cannot Connect to SQL Server If Default Protocol Is Changed | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q200802: SMS: Cannot Connect to SQL Server If Default Protocol Is Changed" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/200/Q200802/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/200/Q200802/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q200802: SMS: Cannot Connect to SQL Server If Default Protocol Is Changed","url":"http://jeffpar.github.io/kbarchive/kb/200/Q200802/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q200802-sms-cannot-connect-to-sql-server-if-default-protocol-is-changed">Q200802: SMS: Cannot Connect to SQL Server If Default Protocol Is Changed</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q200802
Product(s): Microsoft Systems Management Server
Version(s): winnt:1.1,1.2,2.0
Operating System(s): 
Keyword(s): kbDatabase kbSQLServ kbsms200
Last Modified: 20-MAR-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server versions 2.0, 1.1, 1.2 
-------------------------------------------------------------------------------

SUMMARY
=======

SQL Server Named Pipes network support is required for Systems Management Server
(SMS) to communicate with the SQL Server that stores the Systems Management
Server database. SMS utilities and services use Named Pipes by default, and may
have problems connecting to the Systems Management Server database if SQL Server
is configured incorrectly.

It is important to understand that the client Net-Library (and interprocess
communication [IPC]) that establishes a connection must match the server
Net-library (and IPC) that accepts the connection. Both the Client computer and
the Server computer must be running the same network protocol.

For example, if Named Pipes network support is not installed, the Systems
Management Server Administrator program may fail to start and produce the
following error message:

  "Unable to Connect to SQL Server."

MORE INFORMATION
================

SQL Server Instance Used for SMS Site Database Must Support Named Pipes
-----------------------------------------------------------------------

When you change the default network protocol in the SQL Client Configuration
Utility, one of the following error messages appears in the SQL Server
Administrator or Systems Management Server Administrator program:

Microsoft SQL Enterprise Manager

  Unable to Connect to Server (reason:[DB-Library] Unable to connect: SQL
  Server is unavailable or does not exist. General network error. Check your
  documentation). Register anyway?

Microsoft SMS Administrator

  Couldn't connect to server &lt;Server Name&gt; This may be because the
  specified server could not be located or because the specified database or
  user information is incorrect.

Setup may fail, with the following error message in the Smssetup.log when
upgrading from Systems Management Server 1.0 or 1.1 to version 1.2:

  &lt;mm-dd-yyyy hh:mm:ss&gt; Registering connects for XXXXXX (server name) sa
  (default value) SMS (default value) &lt;mm-dd-yyyy hh:mm:ss&gt; Registered
  the types &lt;mm-dd-yyyy hh:mm:ss&gt; Upgrade thread: Failed to register SQL
  connection types.

Additionally, SMS 2.0 setup displays the following error message:

  System Management Server Setup Wizard Setup cannot complete the specified SMS
  installation on this computer for the following reasons: Cannot connect to
  SQL server &lt;Server Name&gt; using specified SQL Login ID and password.
  Please make sure they are valid.

Solution
--------

To correct this problem, use the following steps:

1. Run the SQL Client Configuration utility.

2. Select the Net Library tab.

3. Select Named Pipes in the Default Network drop-down combo box.

  NOTE: By default, SQL Server is configured for Named Pipes.

4. Click Done.

Additionally, you need to check the SQL setup using these steps:

1. Run SQL Server Setup and click Continue twice.

2. Select Change Network Support, and then choose Continue.

3. Select the network protocol(s) you want SQL Server to use. In this case,
  Named Pipes. Click OK.

4. The Named Pipe name dialog box appears. Click Continue.

5. Select the Exit to Windows NT button.

This provides the needed match for the Client Net-Library to the Server
Net-library.

Additional query words: prodsms smssql

======================================================================
Keywords          : kbDatabase kbSQLServ kbsms200 
Technology        : kbSMSSearch kbSMS110 kbSMS120 kbSMS200
Version           : winnt:1.1,1.2,2.0
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>