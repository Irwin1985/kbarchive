<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q200567: Answer File Parameters for WinNT 4.0 System Preparation Tool | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q200567: Answer File Parameters for WinNT 4.0 System Preparation Tool" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/200/Q200567/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/200/Q200567/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q200567: Answer File Parameters for WinNT 4.0 System Preparation Tool","url":"http://jeffpar.github.io/kbarchive/kb/200/Q200567/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q200567-answer-file-parameters-for-winnt-40-system-preparation-tool">Q200567: Answer File Parameters for WinNT 4.0 System Preparation Tool</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q200567
Product(s): Microsoft Windows NT
Version(s): winnt:4.0
Operating System(s): 
Keyword(s): 
Last Modified: 06-AUG-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows NT Server version 4.0 
- Microsoft Windows NT Workstation version 4.0 
-------------------------------------------------------------------------------

SUMMARY
=======

The System Preparation Tool (Sysprep) for Windows NT 4.0 prepares the Windows NT
system for duplication. Upon placing the duplicated hard drives in the target
computers and turning on the systems, a mini-setup wizard will run that will let
you change or enter user specific information. This information includes items
such as ComputerName, Username, and other items. There may be situations where
automation of this wizard may be desired so answer file parameters for
mini-wizard have been created.

To automate the mini-setup wizard for the System Preparation Tool, create a text
file with the parameters supplied in the next section, and place it in the same
directory as the Sysprep files. On a command line, type the following command:

  "Sysprep %answer-file% %optional parameters" (without the quotation marks)

Optional paramters for the sysprep tool are as follows:

-defeat = Bypasses the Compliance checking for Select and OEM media. This switch
is to be used when the image is built using Non-Select or OEM media. Use this
switch if you receive the following error message:

  The use of this tool is prohibited on this product.

NOTE: Although the "-defeat" switch can be used when installing the retail
version, a Select or Open agreement with Microsoft is still required to use the
Sysprep.exe tool.

-reboot = Automatically restarts the system after Sysprep.exe has run.

-quiet = Suppresses any prompts that Sysprep.exe might cause.

NOTE: This switch does not effect the execution of the mini-setup wizard.

-NoSidgen = Does not run-generate a unique SID on the box. Useful where install
has been performed manually on each system but mini-wizard interaction is
wanted.

MORE INFORMATION
================

Supported Answer file Parameters
--------------------------------

  OemSkipEula
  Value: YES | NO
  This key disables the display of the end user license agreement (EULA) when
  set to YES. Default is NO.

  ProductID
  Value: xxx-xxxxxxx
  Specifies whether the ProductID screen should be displayed or not. By default,
  the Product ID key is displayed.


  FullName
  Value: &lt;string&gt;
  Used to specify the name of the user. If not specified or the string is empty,
  the "User name and Organization" page will be displayed.

  OrgName
  Value: &lt;string&gt;
  This key specifies the organization or company name of the user. If not
  specified or the string is empty, the "User name and Organization" page will
  be displayed unless the FullName key has been specified with a valid string.

  ComputerName
  Value: &lt;string&gt; | "Auto"
  This key specifies the computer name. If it is not specified or is an empty
  string, the "Computer Name" page is displayed. The string must be a minimum
  of 1 non-white space character and a maximum of 15 non-white space
  characters.

  If this value is set to "Auto", setup will auto-generate a unique computer
  name based on a random number. This provides a mechanism to install multiple
  computers each having a unique computer name.

  AdminPassword
  Value: &lt;string&gt;
  This key specifies the password for the Administrator account. If it not
  specified or is empty, the "Administrator Password" page is displayed. The
  string must be a minimum of 1 non-white space character and a maximum of 15
  non-white space characters. To specify a blank or NULL password, use "*".

  OEMBannerText
  Values: &lt;text string&gt;
  This key specifies a string to be displayed in the upper left corner of the
  computer screen. The text must contain the "Windows NT" sub-string or else it
  will be ignored. Multiple lines can be specified by using the * character as
  a separator.

  OEMLogoBitmapFile
  Values: &lt;file name&gt; [, &lt;resource id&gt;]
  This key specifies a bitmap to be displayed in the upper right corner of the
  screen. If this line has only one field, it is assumed to be a .bmp file
  located in the directory where the System Preparation tool resides. However,
  if two fields are specified, the first field is the name of a DLL and the
  second is a base 10 number that represents the resource ID of the bitmap in
  the DLL. The DLL specified should be located in the directory that contains
  Sysprep.exe.

  OEMBackgroundBitmapFile
  Values: file name [,&lt;resource id&gt;]
  This key specifies a background bitmap to be displayed. If this line has only
  one field, it is assumed to a be .bmp file located in the directory where
  Sysprep.exe resides. However, if two fields are specified, the first field is
  the name of a DLL and the second is a base 10 number that represents the
  resource ID of the bitmap in the DLL. The DLL specified should be located in
  the directory that contains Sysprep.exe.

  OEMSkipWelcome
  Values: 0 | 1
  If this key is set to 1, the Welcome page is skipped. If the key is set to 0,
  the Welcome page is displayed.

  OEMNoWaitAfterGUIMode
  Values: 0 | 1
  If this key is set to 1, then, when the wizard is finished, the computer
  automatically restarts and the Finished Page of the wizard is not displayed.
  If the key is set to 0, the Finished page of the wizard is displayed and the
  computer does not automatically restart.

  NoSidGen
  Value: YES | NO
  NOTE: This key must not be used if you plan to duplicate the system.

To automate Sysprep, create a text file that has the following header as the
first line.

  [NT4Preinstall]

NOTE: This line must exist or the mini-wizard will ignore the answer file
parameters.

Enter any of the above parameters and save the file using any name. When running
Sysprep, refer to the answer file using the following command:

Sysprep.exe %answerfile%.txt &lt;other optional params&gt;

The following is an example of a correctly formatted answer file for use with the
System Preparation Tool.

Sample Answer File:

  [NT4Preinstall]

  OemSkipEula=yes
  ProductID=111-1111111
  FullName="Your Name"
  Orgname="Your Company"
  ComputerName="Computer"
  AdminPassword="password"
  OembannerText="Banner Text Goes Here"
  OEMLogoBitmapFile="logo.bmp"
  OEMBackgroundBitmapFile="backgrnd.bmp"
  OemSkipWelcome=1
  OemNoWaitAfterGuiMode=1
  NoSidGen=No


REFERENCES
==========

For more information, please consult the Sysprep.doc that was supplied with the
utility. For information on obtaining this tool or other information about
Sysprep, please try one of the following:

- Send an e-mail request to: winreq@microsoft.com. Include "Microsoft Deploy
  Tool License Agreement Request" in the subject line.

- Send a fax request to: "Microsoft Deploy Tool License Agreement Request" at
  (206) 285-4403.

- Leave voice mail with your request by calling 1-800-394-9621 in the U.S. and
  Canada or 001-1-206-378-5544 outside of the U.S. and Canada.

Additional query words: Sysprep Cloning Sysclone

======================================================================
Keywords          :  
Technology        : kbWinNTsearch kbWinNTWsearch kbWinNTW400 kbWinNTW400search kbWinNT400search kbWinNTSsearch kbWinNTS400search kbWinNTS400
Version           : winnt:4.0
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>