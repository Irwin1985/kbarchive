<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q200972: SMS: Custom Collection Examples | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q200972: SMS: Custom Collection Examples" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/200/Q200972/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/200/Q200972/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q200972: SMS: Custom Collection Examples","url":"http://jeffpar.github.io/kbarchive/kb/200/Q200972/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q200972-sms-custom-collection-examples">Q200972: SMS: Custom Collection Examples</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q200972
Product(s): Microsoft Systems Management Server
Version(s): 2.0
Operating System(s): 
Keyword(s): kbsms200 kbCollections kbQuery
Last Modified: 22-MAY-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server version 2.0 
-------------------------------------------------------------------------------

SUMMARY
=======

In Systems Management Server version 2.0, you can build collections based on the
resource class. This article describes how to create two sample queries to:

- Find domain controllers

- Find all computers in a particular subnet

MORE INFORMATION
================

Steps to Create a Query to Find All Domain Controllers at a Site
----------------------------------------------------------------

NOTE: This procedure assumes the domain controller is a client and hardware
inventory is turned on.

1. In the SMS Administrator console, right-click Queries, point to New, and
  click Query on the shortcut menu.

2. Type TEST1 for the Name.

3. In the Object Type box, enter System Resource if it is not already entered.

4. Click Edit Query Statement, then click the icon with the yellow rays.

5. Click the Select button on the Result Properties page.

6. Select Computer System in the Attribute class box and select Name in the
  Attribute box. Then click OK.

7. On the Result Properties page, select Ascending in the Sort box. Click OK.

8. Click the icon with the yellow rays. Repeat steps 5 through 7 but replace
  Name with Roles in the Attribute box (step 6) and replace Ascending with
  Unsorted in the Sort box (step 7).

9. Select the Criteria tab under TEST1 Query Statement Properties. Click the
  icon with the yellow rays. On the Criterion Properties page, enter the
  following:

   - Criterion Type: simple value

   - Where: Choose Select...

      - Attribute class: Computer System

      - Attribute: Roles

   - Operator: is like

   - Value: %Domain_Controller%

Click OK.

10. Click OK. On the Query Properties page, limit the collection to All Windows
  NT Server Systems.

11. Click OK to save the query.

Steps to Create a Query to Find All Computers in a Subnet
---------------------------------------------------------

1. In the SMS Administrator console, right-click the Queries node, point to New,
  and click Query on the shortcut menu.

2. Type TEST2 in the Name box.

3. In the Object Type box, enter System Resource if it is not already entered.

4. Click Edit Query Statement and then click the icon with the yellow rays.

5. On the Result Properties page, click the Select button.

6. Select System Resource in the Attribute class box and select Name in the
  Attribute box. Then click OK.

7. On the Result Properties page, select Ascending in the Sort box. Click OK.

8. Click the icon with the yellow rays. Repeat steps 5 through 7 but replace
  Name with IP Addresses in the Attribute box (step 6) and replace Ascending
  with Unsorted in the Sort box (step 7).

9. Repeat step 8 but replace Name with IP Subnets.

10. Select the Criteria tab under TEST2 Query Statement Properties. Click the
  icon with the yellow rays. On the Criterion Properties page, select the
  following:

   - Criterion Type: simple value

   - Where: Choose Select...

      - Attribute class: System Resources

      - Attribute: IP Subnets

   - Operator: is equal to

   - Value: click the Value button and select the subnet you want.

Click OK

11. Click OK. On the TEST2 Query Properties page, select Not Collection Limited
  (or choose a selection that will further limit the search, such as Win98 on
  subnet x).

12. Click OK to save the query.

Collections can be created based on the queries noted earlier: Collections/New
&lt;enter name&gt;/Membership Rules/Query Rule properties/Name (TEST1 or TEST2
in the example above).

Additional query words: prodsms sms20 Query Collections smsui

======================================================================
Keywords          : kbsms200 kbCollections kbQuery 
Technology        : kbSMSSearch kbSMS200
Version           : :2.0
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>