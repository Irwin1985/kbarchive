<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q200095: PRB: Problems with Help Compiler 3.5 and Certain RTF Formats | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q200095: PRB: Problems with Help Compiler 3.5 and Certain RTF Formats" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/200/Q200095/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/200/Q200095/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q200095: PRB: Problems with Help Compiler 3.5 and Certain RTF Formats","url":"http://jeffpar.github.io/kbarchive/kb/200/Q200095/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q200095-prb-problems-with-help-compiler-35-and-certain-rtf-formats">Q200095: PRB: Problems with Help Compiler 3.5 and Certain RTF Formats</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q200095
Product(s): Microsoft C Compiler
Version(s): MACINTOSH:4.0,4.0b
Operating System(s): 
Keyword(s): kbHWMAC kbVC kbDSupport
Last Modified: 06-FEB-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual C++, Macintosh Cross-Development Addon, versions 4.0, 4.0b 
-------------------------------------------------------------------------------

SYMPTOMS
========

When compiling a Help project using Hc35.exe targeted for the Macintosh
platform, the following error may occur:

On Windows NT:

  An OS/2 program caused a protection violation.

On Windows 95:

  Error 4639: Error in file 'xxxx.rtf' at byte offset 0xXXXX

-or-

  Error 4860: topic...: Font xxxx in file 'xxxx.rtf' not in RTF Font Table

CAUSE
=====

Hc35.exe is not compatible with the RTF (Rich Text Format) files generated by
Microsoft Word 6.0 and later.

RESOLUTION
==========

Save the RTF file using Microsoft Word 2.0, or use Hc31.exe.

STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products that are
listed at the beginning of this article.

MORE INFORMATION
================

When compiling the Help project for the Macintosh target, Hc35.exe is used to
generate the Help file. However, Hc35.exe fails to read RTF files generated by
Microsoft Word 6.0 and later (ROBOHELP is also known to generate Word 6.0 RTF
files). Under Windows NT, Hc35.exe usually generates a protection violation
because it doesn't understand the font table in these RTF files. If the OS/2
subsystem isn't installed properly, no error message may appear and the Help
compiler will just hang. For small Help files under Windows 95, the Help
compiler may successfully compile these Help files, but some errors may still
occur.

The best workaround is to save the RTF file using Microsoft Word 2.0 or Microsoft
Word for the Macintosh.

Another feasible workaround is to use Hc31.exe. To properly generate a Help file
for the Macintosh using Hc31.exe, the bitmaps must be converted so that it
displays properly (the display is too small). Perform the following steps:

1. Copy all bitmaps into a separate directory, changing the file extension to
  .mac.

2. Run MRBC (Multi-Resolution Bitmap Compiler) on each bitmap separately (do not
  use wild cards; otherwise, all the bitmaps will be combined) with the /s
  switch. If you are familiar with batch files, you can use this statement:

  for   %%f   in   (*.mac)   do   mrbc   /s   %%f

  This will generate .mrb files.

3. Rename all the files to the original name. Now you have two sets of files for
  the different platforms in different directories. You can specify which
  directories the Help compiler can obtain the bitmaps from by using the BMROOT
  keyword in the Help project.

4. Transfer the Help file to the Macintosh as you normally would:

  "MFILE COPY /t HELP /c MSH2 MYHELP.HLP
  ":MyMac:Local:MyHelp"" (without the quotation marks)

REFERENCES
==========

Books Online: Creating Macintosh Help Files

For additional information, please see the following article in the Microsoft
Knowledge Base:

  Q75010 Rich Text Format Subset Supported by Windows Help

(c) Microsoft Corporation 1999, All Rights Reserved. Contributions by Adam Kim,
Microsoft Corporation.


Additional query words: hc31 hc35 Macintosh Help Word RTF Font Table

======================================================================
Keywords          : kbHWMAC kbVC kbDSupport 
Technology        : kbVCsearch kbHWMAC kbOSMAC kbAudDeveloper kbVCXDev400Mac kbVCXDev400bMac
Version           : MACINTOSH:4.0,4.0b
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>