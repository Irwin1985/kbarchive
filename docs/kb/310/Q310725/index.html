<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q310725: HOW TO: Run the IIS Lockdown Wizard Unattended in IIS | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q310725: HOW TO: Run the IIS Lockdown Wizard Unattended in IIS" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/310/Q310725/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/310/Q310725/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q310725: HOW TO: Run the IIS Lockdown Wizard Unattended in IIS","url":"http://jeffpar.github.io/kbarchive/kb/310/Q310725/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q310725-how-to-run-the-iis-lockdown-wizard-unattended-in-iis">Q310725: HOW TO: Run the IIS Lockdown Wizard Unattended in IIS</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q310725
Product(s): Internet Information Server
Version(s): 4.0,5.0
Operating System(s): 
Keyword(s): kbAudITPro kbHOWTOmaster
Last Modified: 19-APR-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Server version 4.0 
- Microsoft Internet Information Services version 5.0 
-------------------------------------------------------------------------------


IN THIS TASK
------------

- SUMMARY

   - Description of the Technique
- Configure the IIS Lockdown Wizard to Run Unattended

- REFERENCES

SUMMARY
=======

This step-by-step article describes how to configure the Internet Information
Services (IIS) Lockdown Wizard to run unattended.

Description of the Technique
----------------------------

The latest version of the Internet Information Services (IIS) Lockdown Wizard
provides administrators with the ability to run the wizard programmatically,
allowing configuration across many servers through unattended, automated
scripts.

To configure the IIS Lockdown Wizard for unattended use, you must edit the
Iislockd.ini file. This file contains the [Info] section, which defines the
following basic configuration information that is used by the IIS Lockdown
Wizard:

  [Info]
  ServerTypesNT4=sbs4.5, exchange5.5, frontpage, proxy, staticweb, dynamicweb , other, iis_uninstalled
  ServerTypes=sbs2000, exchange5.5, exchange2k, sharepoint_portal, frontpage, biztalk, commerce, proxy, staticweb, dynamicweb, other, iis_uninstalled
  UnattendedServerType=frontpage
  Unattended=FALSE
  Undo=FALSE

The following list explains the configuration information:

- ServerTypesNT4 - Lists the available server type templates that are available
  for use with Microsoft Windows NT 4.0 servers.
- ServerTypes - Lists the available server type templates that are available
  for use with Microsoft Windows 2000.
- UnattendedServerType - Designates which server type template to use when you
  perform an unattended installation.
- Unattended - Designates whether or not to run the wizard unattended.
- Undo - When this option is set to TRUE, the wizard undoes previous changes
  made by the wizard.

The remaining portion of the Iislockd.ini file contains the various server type
templates that are listed for the ServerTypeNT4 and ServerTypes variables in the
[Info] section.

Configure the IIS Lockdown Wizard to Run Unattended
---------------------------------------------------

1. Open the Iislockd.ini file in a text editor.

2. In the [Info] section, configure UnattendedServerType by entering the name of
  the desired server template. For example, if you want to apply the dynamicweb
  template, the setting resembles the following:

  UnattendedServerType=dynamicweb

3. Change the Unattended setting to TRUE, as follows:

  Unattended=TRUE

NOTE: If you want to run Iislockd.exe unattended to undo a previous run of the
wizard, ensure that both Unattended and Undo are set to TRUE, as follows:

  Unattended=TRUE
  Undo=TRUE

4. Configure the server type template that is designated in step 2. The template
  configuration is denoted with square brackets around the server type name
  (for example, [dynamicweb]). This section contains the various feature
  settings for that specific server type. To turn these feature settings on or
  off, set them to TRUE or FALSE.

5. Save the changes to the Iislockd.ini file.

6. Run Iislockd.exe from the command line or by using a script.

Note the following:

- The parameter for AdvancedSetup is not used and is ignored during an
  unattended installation.
- The UninstallServices parameter only works on Windows 2000.

REFERENCES
==========

For additional information on using a custom server type template during an
unattended configuration of the IIS Lockdown Wizard, click the article number
below to view the article in the Microsoft Knowledge Base:

  Q311350 HOW TO: Create a Custom Server Type for Use with the IIS Lockdown
  Wizard

Additional query words: iis lockdown unattended urlscan

======================================================================
Keywords          : kbAudITPro kbHOWTOmaster 
Technology        : kbiisSearch kbiis500 kbiis400
Version           : :4.0,5.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>