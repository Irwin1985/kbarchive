<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q154032: XADM: Error 1105 - EcBadVersion Occurs When Restoring Offline St | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q154032: XADM: Error 1105 - EcBadVersion Occurs When Restoring Offline St" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/154/Q154032/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/154/Q154032/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q154032: XADM: Error 1105 - EcBadVersion Occurs When Restoring Offline St","url":"http://jeffpar.github.io/kbarchive/kb/154/Q154032/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q154032-xadm-error-1105---ecbadversion-occurs-when-restoring-offline-st">Q154032: XADM: Error 1105 - EcBadVersion Occurs When Restoring Offline St</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q154032
Product(s): Microsoft Exchange
Version(s): winnt:4.0
Operating System(s): 
Keyword(s): 
Last Modified: 01-APR-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, version 4.0 
-------------------------------------------------------------------------------

SUMMARY
=======

When you restore an offline store from a Microsoft Exchange Server 4.0 computer,
with or without Microsoft Exchange Server Service Pack 1 (SP1) installed, onto a
Microsoft Exchange Server 4.0 computer with Microsoft Exchange Service Pack 2
(SP2) installed, you will receive the following error:

  1087 The information store was restored from an offline backup. Run ISINTEG
  -patch before starting the information store.

  1005 Unable to start the Microsoft Exchange Information store. Error 1011

When you run ISINTEG -patch, you will receive an EcBadVersion error.

If the store was recovered from an online backup, the following events will be
logged:

  Unable to recover the database because error 0x00000451 occurred after a
  restore operation.

  Unable to initialize the Microsoft Exchange Information Store service. Error
  1105.

MORE INFORMATION
================

This is because a new version of Mdbrest.dll was provided with SP2. To
workaround this problem, follow these steps:

1. Rename Mdbrest.dll in the Exchsrvr\bin directory to Mdbrest.new.

2. Copy Mdbrest.dll from a Microsoft Exchange Server version 4.0 with or without
  SP1 (there was no change to this file in SP1) to the Exchsrvr\bin directory.

3. If the store was recovered from an off-line backup you must run ISINTEG
  -PATCH. This will update the store.

4. Delete Mdbrest.dll and rename Mdbrest.new to Mdbrest.dll.

5. Start the Microsoft Exchange Information Store.


Additional query words:

======================================================================
Keywords          :  
Technology        : kbExchangeSearch kbExchange400 kbZNotKeyword2
Version           : winnt:4.0

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>