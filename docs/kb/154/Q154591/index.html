<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q154591: FIX: Wrong Version of MSVCRT40.DLL(Forwarder DLL) in Windows 95 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q154591: FIX: Wrong Version of MSVCRT40.DLL(Forwarder DLL) in Windows 95" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/154/Q154591/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/154/Q154591/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q154591: FIX: Wrong Version of MSVCRT40.DLL(Forwarder DLL) in Windows 95","url":"http://jeffpar.github.io/kbarchive/kb/154/Q154591/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q154591-fix-wrong-version-of-msvcrt40dllforwarder-dll-in-windows-95">Q154591: FIX: Wrong Version of MSVCRT40.DLL(Forwarder DLL) in Windows 95</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q154591
Product(s): Microsoft C Compiler
Version(s): winnt:4.2
Operating System(s): 
Keyword(s): kbVC420bug kbVC500fix
Last Modified: 04-AUG-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual C++, 32-bit Enterprise Edition, version 4.2 
- Microsoft Visual C++, 32-bit Professional Edition, version 4.2 
-------------------------------------------------------------------------------

SYMPTOMS
========

The wrong version of MSVCRT40.DLL, known as the Forwarder DLL, may be copied to
the Windows 95 System directory while installing Visual C++ version 4.2. The
size, date, and version number of this DLL are:

  MSVCRT40.DLL 65,024 Bytes 6/14/96 Version 4.2000.6164

This behavior may cause some applications built with Visual C++ Version 4.0 and
4.1 to break.

CAUSE
=====

If Visual C++ is installed on Windows 95 with a CD-ROM install, then the
MSVCRT40.DLL is copied to the Windows 95 System directory. This DLL may also be
present if a beta version of Visual C++ 4.2 was previously installed.


RESOLUTION
==========

Copy the correct version of the DLL provided in the Visual C++ 4.2 CD-ROM
MSDEV\REDIST\ANSI directory. The size, date, and version number of this DLL
are:

  MSVCRT40.DLL 326,656 Bytes 2/19/96 Version 4.10.6038

STATUS
======

Microsoft has confirmed this to be a bug in the Microsoft products listed at the
beginning of this article. This bug was corrected in Visual C++ version 5.0.

MORE INFORMATION
================

The REDISTRB.WRI file in the MSDEV\REDIST directory of the Visual C++ 4.2 CD-ROM
mentions that the C Run-Time Forwarder DLL MSVCRT40.DLL should not be
redistributed. The redistributable DLLs are the Shared DLL version of the Visual
C++ 4.1 C Run-Time DLL MSVCRT40.DLL available in the MSDEV\REDIST\ANSI
directory, MSVCRT.DLL the Shared DLL version of C Run- Time, and MSVCIRT.DLL the
Shared DLL version of the iostream functions.

The Forwarder DLL, MSVCRT40.DLL, is supplied with the Windows NT 4.0 Operating
System. This DLL will be necessary for upward compatibility of applications
built with Visual C++ version 4.0 and 4.1 to run in Windows NT 4.0 and later
versions of Windows Operating Systems.

Note that applications built in Visual C++ 4.2 and 5.0 with the /MD compiler
switch only use the MSVCRT.DLL or MSVCRT.DLL and MSVCIRT.DLL depending on the
header files included.

The Visual C++ 5.0 CD-ROM, contains only the MSVCRT40.DLL, Version 4.10.6038, in
both the ...\VC\REDIST\ and the ...\VC\REDIST\ANSI\ directories.

The Visual C++ 6.0 CD-ROM contains the non-Forwarder version of the MSVCRT40.DLL
in the ...\OS\System directory. The new version number is 4.21.0000, the size is
the same at 326,656 bytes.

The Visual C++ 6.0 Service Pack 3 and 4 contains the non-Forwarder version of the
MSVCRT40.DLL in the ...\OS\System directory. The version number is 4.22.0.0, the
size is the same at 326,656 bytes.

The Windows NT 4.0 operating system Forwarder version of the MSVCRT40.DLL is
version number 4.2000.0.6172. This DLL comes with the operating system and it
cannot be redistributed. Do not replace this DLL with any other version. To view
the version of the MSVCRT40.DLL, click Properties in Microsoft Windows Explorer.
Verify that "4.20 - OS use only. DO NOT DISTRIBUTE" is the version.

Windows 2000 operating system Forwarder version of the MSVCRT40.DLL is version
number 4.2000.0.6201. This DLL comes with the operating system and it cannot be
redistributed. Do not replace this DLL with any other version.

REFERENCES
==========

The following article in the Microsoft Knowledge Base describes what happens
when you replace the proper version of the MSVCRT40.DLL provided in Windows NT
4.0:

  Q168006 TN3270 Fails with Access Violation in ntdll!RtlFreeHeap

Additional query words: MSVCIRT.DLL MSVCRT.DLl

======================================================================
Keywords          : kbVC420bug kbVC500fix 
Technology        : kbVCsearch kbAudDeveloper kbVC420 kbVC32bitSearch
Version           : winnt:4.2
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>