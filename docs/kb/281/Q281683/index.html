<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q281683: XADM: &quot;A Fatal Error (0x8004011d) Occurred&quot; Event ID 11 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q281683: XADM: &quot;A Fatal Error (0x8004011d) Occurred&quot; Event ID 11" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/281/Q281683/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/281/Q281683/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q281683: XADM: &quot;A Fatal Error (0x8004011d) Occurred&quot; Event ID 11","url":"http://jeffpar.github.io/kbarchive/kb/281/Q281683/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q281683-xadm-a-fatal-error-0x8004011d-occurred-event-id-11">Q281683: XADM: "A Fatal Error (0x8004011d) Occurred" Event ID 11</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q281683
Product(s): Microsoft Exchange
Version(s): 5.5
Operating System(s): 
Keyword(s): kberrmsg
Last Modified: 05-JUN-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, version 5.5 
- Microsoft Exchange 2000 Server 
-------------------------------------------------------------------------------

SUMMARY
=======

In a mixed Microsoft Exchange 2000 Server and Microsoft Exchange Server 5.5
environment, the following event ID message may logged in the Application log by
the Microsoft Exchange Event service on the Exchange Server 5.5 computer:

  Event ID: 11
  Source: MSExchangeES
  Type: Error
  Category: General
  Description:
  A fatal error (0x8004011d) occurred in an IExchangeEventSink while processing
  message [Subject = "test message"].

This event occurs after an Exchange 2000 user modifies an event script on an
Exchange Server 5.5 public folder. If an Exchange Server 5.5 user modifies the
same script, the script functions correctly.

MORE INFORMATION
================

The value 8004011d from the Description box of this event ID message maps to the
MAPI error MAPI_E_FAILONEPROVIDER. This error code indicates that the provider
could not log on. However, this is not a fatal error. In this scenario, the
credentials are not correct and the user is not prompted with a dialog box
because this error runs in the context of a service instead of interactively.

When the Event service is triggered to run the event script, the Event service
tries to impersonate the user who most recently modified that event script. When
an Exchange 2000 user has been the most recent to modify the script, the Event
service tries to log on as that user. However, because the Exchange Server 5.5
service account does not have access rights to the Exchange 2000 user's mailbox
the log on attempt is denied. The script cannot run and the event ID message
indicated in the "Summary" section is logged.

In Exchange Server 5.5 the service account has inherited permissions to every
mailbox. Therefore, when an Exchange Server 5.5 user is the last user to modify
the event script, the Event service has the correct permissions with which to
log on in that user's context. However, in Exchange 2000, there is no service
account that has permissions to all mailboxes.

To resolve this behavior, grant the Exchange Server 5.5 service account rights to
the user who is modifying the scripts. This permits the Event service the
ability to log on as the Exchange 2000 user to run the script.

Additional query words: exch2kp2w 0x8004011d user modifies script

======================================================================
Keywords          : kberrmsg 
Technology        : kbExchangeSearch kbExchange550 kbZNotKeyword2 kbExchange2000Search kbExchange2000Serv
Version           : :5.5
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>