<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q281335: How to Isolate DLL into a Separate Process Using Component Srvcs | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q281335: How to Isolate DLL into a Separate Process Using Component Srvcs" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/281/Q281335/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/281/Q281335/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q281335: How to Isolate DLL into a Separate Process Using Component Srvcs","url":"http://jeffpar.github.io/kbarchive/kb/281/Q281335/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q281335-how-to-isolate-dll-into-a-separate-process-using-component-srvcs">Q281335: How to Isolate DLL into a Separate Process Using Component Srvcs</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q281335
Product(s): Internet Information Server
Version(s): 5.0
Operating System(s): 
Keyword(s): kbDSupport
Last Modified: 24-DEC-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Services version 5.0 
-------------------------------------------------------------------------------

SUMMARY
=======

When you troubleshoot Internet Information Server (IIS), it is a common practice
to isolate Web applications by running them in a separate memory space, which is
referred to as Out-of-Process (OOP). However, sometimes if a component is used
on multiple ASP pages, and in multiple Web applications, it can be difficult to
isolate the module (DLL) that contains the object from the rest of the Web site.
Sometimes you must isolate a COM DLL into a separate process to determine if it
contributes to problems that affect Web server performance. Component Services
(COM+) 1.0, in Microsoft Windows 2000, provides the ability to isolate a COM DLL
into a separate process.

MORE INFORMATION
================

The steps that follow provide a procedure for isolating a DLL. After the DLL is
isolated, any process that uses the isolated DLL makes RPC calls to the
Dllhost.exe process that contains the isolated DLL, rather than loading the DLL
within its own process space.

How to Isolate a COM DLL in Windows 2000

1. On the Taskbar click Start, point to Programs, point to Administrative Tools,
  and then click Component Services.

2. Expand the Computers folder, expand My Computer, and then select the COM+
  Applications folder.

3. Right-click the COM+ Applications folder, click New, and then click
  Application. This creates a new Application.

4. Click Next.

5. Click Create Empty Application.

6. Assign a Name to the application (that is, the same name as the COM DLL). Do
  not include any periods.

7. Select Server Application.

8. Click Next.

9. Set the Security Context required by the DLL by:

   - Selecting either the Interactive (Logged on) user.

     -or-

   - Specify credentials to impersonate This user.

10. Click Next.

11. Click Finish.

12. To add the DLL to the new COM+ Application, right-click the Components
  folder that is inside the new COM+ Application.

13. Click New | Component.

14. Click Next.

15. Select Install new component(s).

16. Browse to the folder that contains the DLL to isolate.

17. Select the DLL to isolate.

18. Click Open.

NOTE: You must select a COM or COM+ DLL, otherwise this error message occurs:

  One or more files do not contain components or type libraries. These files
  can not be installed.

19. Click Next.

20. Click Finish.

21. Reset the IISADMIN service to ensure that the DLL was not in use by the
  InetInfo.exe process. To do this:

  1. On the Taskbar click Start, and then click Run.

  2. In the Run dialog box type:

     "iisreset" (without the quotation marks)

  3. Click OK.

After the DLL is called you should see your new component spinning in the
window.

REFERENCES
----------

For more information about configuring your COM+ Application, see the Platform
SDK Web site at:

  http://msdn.microsoft.com/library/psdk/cossdk/pgcreatingapplications_creatingapplications_45tf.htm

For additional information about isolating a COM DLL in Microsoft Windows NT 4.0,
click the article number below to view the article in the Microsoft Knowledge
Base:

  Q281434 How to isolate a DLL into a separate process using Microsoft
  Transaction Server (MTS)

  Q290884 HOWTO: Determine Which Application Is Running Within a COM+ or
  Transaction Server Package

Additional query words:

======================================================================
Keywords          : kbDSupport 
Technology        : kbiisSearch kbiis500
Version           : :5.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>