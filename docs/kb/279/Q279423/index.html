<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q279423: XADM: How to Use the DSAdiag Utility | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q279423: XADM: How to Use the DSAdiag Utility" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/279/Q279423/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/279/Q279423/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q279423: XADM: How to Use the DSAdiag Utility","url":"http://jeffpar.github.io/kbarchive/kb/279/Q279423/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q279423-xadm-how-to-use-the-dsadiag-utility">Q279423: XADM: How to Use the DSAdiag Utility</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q279423
Product(s): Microsoft Exchange
Version(s): 
Operating System(s): 
Keyword(s): 
Last Modified: 21-MAR-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange 2000 Server 
-------------------------------------------------------------------------------

SUMMARY
=======

This article describes the DSAdiag utility (DSAdiag.exe), which can be very
useful when diagnosing directory access problems with Exchange 2000 Server.

MORE INFORMATION
================

Exchange 2000 uses the DSAccess API to communicate with Active Directory.
DSAdiag.exe is a utility that lists the domain controllers, global catalog
servers, and the configuration domain controller that the DSAccess API attempts
to contact on behalf of Exchange 2000. The status of the connection is displayed
in the output (Up, Down, Fast, Slow, In Synch). If DSAccess is having trouble
communicating to a particular domain controller or global catalog server, it
fails over to a different Active Directory server.

When you use DSAdiag.exe, you can manually force server discovery. DSAdiag.exe
must be copied into the \Program Files\Exchsrvr\Bin folder. Open a command
prompt and change the folders to \Bin. When you type "dsadiag" (without the
quotation marks) and press ENTER, two options are displayed:

- DSAdiag 1: This option displays the domain controller, global catalog server,
  and the configuration domain controller list.

- DSAdiag 2: This option forces Topology Rediscovery, which rediscovers the
  topology of the domain controller, global catalog server, and the
  configuration domain controller.

For example, if a global catalog server has been taken down for maintenance and
brought back online again, and DSAccess has not realized that the server is
available once more, you can use the DSAdiag 2 option to force the server to
rediscover the available servers. DSAdiag enumerates the list of Active
Directory servers that the DSAccess API reports, it does not issue its own
Lightweight Directory Access Protocol (LDAP) requests to the Active Directory
servers.

The following text is an example of the output that you receive when you use the
DSAdiag 1 option:

D:\Program Files\Exchsrvr\BIN&gt;dsadiag 1
.......

Working DC's:

UP FAST DOWN InSync    Name

X  X         X         &lt;hostname.domain.com&gt;

Working GC's:

UP FAST DOWN InSync    Name

X  X         X         &lt;hostname.domain.com&gt;

Config DC:
                      &lt;hostname.domain.com&gt;
Done

In the United States and Canada you may contact Microsoft Product Support
Services at (800)936-5800 for this utility.


For additional information about DSAccess, click the article number below to view
the article in the Microsoft Knowledge Base:

  Q247262 XCON: How DSAccess Detects DCs, Global Catalogs, Config DCs in a
  Domain


Additional query words: xmrp dsaccess api, directory service DC GC GCS config

======================================================================
Keywords          :  
Component         : DSAccessAPI
Technology        : kbExchangeSearch kbExchange2000Search kbExchange2000Serv
Version           : :
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>