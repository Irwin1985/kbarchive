<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q244988: How to Completely Remove IIS4 and NTOP from a Server | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q244988: How to Completely Remove IIS4 and NTOP from a Server" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/244/Q244988/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/244/Q244988/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q244988: How to Completely Remove IIS4 and NTOP from a Server","url":"http://jeffpar.github.io/kbarchive/kb/244/Q244988/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q244988-how-to-completely-remove-iis4-and-ntop-from-a-server">Q244988: How to Completely Remove IIS4 and NTOP from a Server</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q244988
Product(s): Microsoft Windows NT
Version(s): winnt:4.0
Operating System(s): 
Keyword(s): 
Last Modified: 08-AUG-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows NT Server version 4.0 
- Microsoft Internet Information Server 4.0 
-------------------------------------------------------------------------------

SUMMARY
=======

This article describes how to completely remove Microsoft Internet Information
Server 4.0 (IIS4) and Microsoft Windows NT 4.0 Option Pack (NTOP) from a
Microsoft Windows NT Server 4.0-based computer.

MORE INFORMATION
================

To completely remove Internet Information Server 4.0 (IIS4) and the Windows NT
4.0 Option Pack (NTOP) from a Windows NT Server 4.0-based computer:

1. If SQL is installed and you are just removing the IIS4 and NTOP components,
  back up your SQL databases.

2. Stop and reset the startup type for IIS services and all other nonessential
  services, including but not limited to third-party products, all Exchange
  services, and SQL services:

  a. Click Start, point to Settings, click Control Panel, and then double-click
     Services.

  b. For each service to be stopped, click the service, click Stop, click Yes
     to confirm stopping the service, click Startup, click Manual, and then
     click OK.

  c. After you have set the services to Manual, click Close.

3. Restart the server.

  NOTE: Restarting the server is required to clear the .dll files loaded by
  services from memory. These .dll files would remain in memory if the services
  were only stopped and the server not restarted.

4. Before removing IIS, remove FrontPage Server Extensions if they are in use:

  a. Click Start, point to Programs, and then click Windows NT 4.0 Option Pack.

  b. Click Microsoft Internet Information Server, and then click FrontPage
     Server Administrator.

  c. Click Uninstall.

  d. Click OK to start uninstalling FrontPage extensions.

5. Remove the Windows NT Option Pack:

  a. Click Start, point to Programs, click Windows NT4.0 Option Pack, and then
     click Windows NT 4.0 Option Pack Setup.

  b. Click Next, click Remove All, and then follow the instructions on the
     screen to finish.

6. Delete the IUSR_computer and IWAM_computer accounts from within Windows NT
  User Manager:

  a. Start User Manager for Domains.

  b. Select the IUSR_computer and IWAM_computer accounts.

  c. On the User menu, click Delete.

7. Run the DCOMCNFG utility and set the Default Impersonation Level to Identify:

  a. Click Start, and then click Run.

  b. In the Open box, type "dcomcnfg" (without the quotation marks), and then
     click OK.

  c. Click the Default Properties tab.

  d. In the Default Impersonation Level box, click Identify.

  e. Click OK.

8. Restart the computer.

9. Run RDISK, and create a new Emergency Repair Disk (ERD), complete with the
  registry.

  NOTE: Run RDISK with the /s parameter to back up the Security database. It is
  possible that this can exceed the size of a single floppy disk, so you may
  have to back up to a share on the computer.

10. Reinstall the latest Windows NT Service Pack.

11. Restart the computer.

12. Run RDISK again and create a new ERD, complete with the registry.

  NOTE: The /s parameter should not be necessary.

13. Clear out the event logs in Windows NT by either saving them or deleting
  them:

  a. Open Event Viewer.

  b. On the Log menu, click either System, Security, or Application, to display
     the selected log.

  c. Delete the log, or save it to a file.

14. Install the Windows NT 4.0 Option Pack, making a note of any errors that may
  occur during the installation.

15. Download and install the latest version of the Microsoft Data Access
  Components.

  NOTE: These are available on the following Microsoft Web site:

  http://www.microsoft.com/data/download.htm

16. If SQL is installed and you are just removing IIS4 and NTOP, run the SQL
  Setup program and choose the Update option.

  NOTE: This will reinstall the shared ODBC components needed to allow SQL
  Executive and the utilities to run. This step is necessary only if you are
  not reinstalling the NTOP.

17. Reset the startup type of the services previously stopped to Automatic, and
  then start the services one program grouping at a time, to make sure that
  they start correctly.

18. If SQL is installed and you are just removing IIS4 and NTOP, run the SQL
  admin and restore the databases from the backup you created in step 1.

For more information about the DCOM impersonation level, please see the following
article in the Microsoft Knowledge Base:

  Q180119 "CreateIISPackage or DeleteIISPackage..." During NTOP Setup

Additional query words: nt 4.0 iis 4

======================================================================
Keywords          :  
Technology        : kbWinNTsearch kbWinNT400search kbWinNTSsearch kbWinNTS400search kbWinNTS400 kbiisSearch kbiis400
Version           : winnt:4.0
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>