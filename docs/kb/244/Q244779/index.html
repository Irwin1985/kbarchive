<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q244779: HOWTO: Refresh a Parameterized DataReport | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q244779: HOWTO: Refresh a Parameterized DataReport" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/244/Q244779/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/244/Q244779/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q244779: HOWTO: Refresh a Parameterized DataReport","url":"http://jeffpar.github.io/kbarchive/kb/244/Q244779/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q244779-howto-refresh-a-parameterized-datareport">Q244779: HOWTO: Refresh a Parameterized DataReport</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q244779
Product(s): Microsoft Visual Basic for Windows
Version(s): WINDOWS:6.0
Operating System(s): 
Keyword(s): kbDatabase kbDesigner kbOLEDB kbReportWriter kbDataEnv kbGrpDSVBDB kbDSupport
Last Modified: 23-AUG-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Professional Edition for Windows, version 6.0 
- Microsoft Visual Basic Enterprise Edition for Windows, version 6.0 
-------------------------------------------------------------------------------

SUMMARY
=======

This article demonstrates basing a DataReport on a parameterized DataEnvironment
and refreshing the report when the parameter value changes.

MORE INFORMATION
================

1. Open a new Standard EXE Project in Microsoft Visual Basic. Form1 is created
  by default.

2. Add a DataEnvironment (DataEnvironment1) and a DataReport (DataReport1) to
  the project.

3. Add a Connection (Connection1) to the DataEnvironment pointing to NWIND.MDB
  (or Northwind.MDB) through the Microsoft Jet 4.0 OLE DB Provider.

4. Add a Command (Command1) to Connection1, with the following properties:

  CommandType: adCommandText
  CommandText: Select * From Employees Where HireDate &lt; ?

In the Parameters tab:

  Name: pDate
  Direction: Input
  Data Type: adDBTimeStamp
  Host Data Type: Date (VT_DATE)

5. In the DataReport, set the following properties:

  DataSource: DataEnvironment1
  DataMember: Command1

6. Drag the following fields from the DataEnvironment into the Detail section of
  the DataReport:

  EmployeeID
  FirstName
  LastName
  HireDate

7. Add a TextBox (Text1) and a CommandButton (Command1) to the form. Add the
  following code:

  Option Explicit

  Private Sub Command1_Click()
    Load DataEnvironment1
    With DataEnvironment1
      If .rsCommand1.State &lt;&gt; 0 Then .rsCommand1.Close
      .Command1 CDate(Text1.Text)
    End With
    DataReport1.Refresh
    If DataReport1.Visible = False Then DataReport1.Show
  End Sub

8. Save the project and run it. Enter the following dates in the TextBox and
  click the CommandButton after each one:

  1/1/95
  1/1/94
  1/1/93
  1/1/92

  You can see the report refresh showing only those employees hired prior to the
  date entered.

Additional query words:

======================================================================
Keywords          : kbDatabase kbDesigner kbOLEDB kbReportWriter kbDataEnv kbGrpDSVBDB kbDSupport 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB600Search kbVB600
Version           : WINDOWS:6.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>