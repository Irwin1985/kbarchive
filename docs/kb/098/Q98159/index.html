<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q98159: SMTP: Err Msg: ERROR Translating Message to SMTP… | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q98159: SMTP: Err Msg: ERROR Translating Message to SMTP…" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/098/Q98159/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/098/Q98159/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q98159: SMTP: Err Msg: ERROR Translating Message to SMTP…","url":"http://jeffpar.github.io/kbarchive/kb/098/Q98159/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q98159-smtp-err-msg-error-translating-message-to-smtp">Q98159: SMTP: Err Msg: ERROR Translating Message to SMTP…</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q98159
Product(s): Microsoft Mail For PC Networks
Version(s): MS-DOS:3.0
Operating System(s): 
Keyword(s): 
Last Modified: 28-OCT-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Mail Gateway to SMTP, version 3.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

After the Microsoft Mail Gateway to SMTP starts and initializes, it checks for
outgoing mail from the SMTP outgoing queue. If it detects outgoing mail, it
opens a session with the smarthost and begins to process the outgoing messages.

If the gateway comes to a message in the queue that it cannot process, this error
message may occur:

  ERROR translating message to SMTP: protocol error

CAUSE
=====

This error can result from a damaged message in the SMTP gateway queue. When
there is a damaged message in the queue, the gateway stops processing the
outgoing messages and switches to the idle state waiting for TCP/IP connections.
It then repeats the same process during its next scheduled connection attempt
time.

RESOLUTION
==========

The problem message in the SMTP queue should either be deleted or returned to
the sender. You may want to first rename the temporary files used by the SMTP
gateway that are found in the MAILDATA\SMTP directory. Any file with extension
.API in the SMTP directory should be changed to an extension of .OLD with the
following command:

  ren *.api *.old

Deleting or returning of messages is done from within the ADMIN.EXE program:

1. Start ADMIN.EXE with an account that has Admin privileges.

2. From the Admin menu, choose Queue.

3. In the dialog box, type "SMTP" (without the quotation marks) and press the
  ENTER key.

4. Return the problem message (probably the first or last message in the SMTP
  queue).

5. The user who sent the message needs to resend the returned message or be
  notified that it was deleted.

NOTE: If there is a file called FROM_NC.API or OUTBAD.API in the SMTP directory
of the Mail Postoffice, you can view this file and decipher who the sender of
the problem message is. The sender's name is preceded with a FROM: and contains
the full 10/10/10 Microsoft Mail address. Once you have this information, you
follow the steps above to remove the message from the SMTP outgoing queue. It is
suggested to use Debug since many MS-DOS editors show the file as one big line
of text.

Example
-------

Assume there is a file stranded in the M:\MAILDATA\SMTP directory called
OUTBAD.API. Use the following steps to find the sender of the problem message:

1. Type the following:

  " DEBUG M:\MAILDATA\SMTP\OUTBAD.API " (without the quotation marks)

2. At the hyphen (-) prompt, type the letter "D" (without the quotation marks)
  and press the ENTER key.

3. A mix of HEX values and ASCII text is displayed on the screen, repeatedly
  press D, ENTER until the word FROM: shows up in the ASCII column.

4. Note the information following the FROM: because this is the sender of the
  problem message.

  NOTE: There may be multiple messages in the .API file, where each one has its
  own FROM: information. If the old .API files are renamed prior to the startup
  of the gateway as mentioned above, a new file containing only the problem
  message should be created.

5. Use this name when following the steps above to return or delete the message
  out of the SMTP queue.

NOTE: The "protocol error" message can be a vague error message and may refer to
a number of other issues. The resolution in this article has been proven to work
in many situations where this error occurred.

Additional query words:

======================================================================
Keywords          :  
Technology        : kbMailSearch kbMailGateSearch kbZNotKeyword3 kbMailGateSMTP300
Version           : MS-DOS:3.0

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>