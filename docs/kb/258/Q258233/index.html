<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q258233: PRB: Problem Reloading a UserControl File with an Add-In | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q258233: PRB: Problem Reloading a UserControl File with an Add-In" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/258/Q258233/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/258/Q258233/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q258233: PRB: Problem Reloading a UserControl File with an Add-In","url":"http://jeffpar.github.io/kbarchive/kb/258/Q258233/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q258233-prb-problem-reloading-a-usercontrol-file-with-an-add-in">Q258233: PRB: Problem Reloading a UserControl File with an Add-In</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q258233
Product(s): Microsoft Visual Basic for Windows
Version(s): 5.0,6.0
Operating System(s): 
Keyword(s): kbAddIn kbVBp500 kbVBp600 kbGrpDSVB kbDSupport
Last Modified: 10-JUL-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Enterprise Edition for Windows, versions 5.0, 6.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

You have a Visual Basic add-in component that calls the VBComponent.Reload
method of the Visual Basic Add-In model to reload a UserControl (.ctl) file. If
an instance of the UserControl is currently sited on a container (form or
control) that is part of the project, you get the following error message when
the Reload method is called:

  Run-time error '5':Invalid procedure call or argument.

CAUSE
=====

This behavior is by design. The Reload method needs to unload (remove) and then
load (add) the .ctl file. Because an instance of the control is on a container,
the removal of the control from the project is not allowed. This is analogous to
the situation in which you site a UserControl on a form, and then try to remove
the .ctl file manually, in which case you get the following error message:

  Can't remove control or reference; in use.

MORE INFORMATION
================

Steps to Reproduce the Behavior
-------------------------------

1. Create a Visual Basic 6.0 Add-In project with a default form (frmAddIn) and a
  default designer (Connect).

2. Replace the code in the OKButton_Click event handler on frmAddIn with the
  following:

  VBInstance.ActiveVBProject.VBComponents.Item("usercontrol1").Reload
  MsgBox "UserControl has been reloaded."

3. Compile the add-in project (MyAddIn.dll).

4. Create a new standard EXE project. Form1 is created automatically.

5. Add a UserControl (UserControl1) to the project and save the project.

6. On the Add-Ins menu, select Add-In Manager.... Select My Add-In, and check
  the Loaded/Unloaded check box under Load Behavior on the Add-In Manager
  dialog box. Click OK.

7. On the Add-Ins menu, select My Add-in, and the dialog box (frmAddin) of the
  MyAddIn project appears.

8. Click OK, and note that a message box appears indicating that the control has
  been reloaded.

9. Add an instance of the control to Form1 and click OK on the dialog box again.
  Note that the following error message appears:

  Run-time error '5': Invalid procedure call or argument.

Additional query words: MyAddIn 5 can t run time

======================================================================
Keywords          : kbAddIn kbVBp500 kbVBp600 kbGrpDSVB kbDSupport 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB500Search kbVB600Search kbVB500 kbVB600
Version           : :5.0,6.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>