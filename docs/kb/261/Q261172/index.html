<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q261172: PRB: fnevObjectDeleted Returns Short Term Entry ID from Exchange | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q261172: PRB: fnevObjectDeleted Returns Short Term Entry ID from Exchange" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/261/Q261172/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/261/Q261172/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q261172: PRB: fnevObjectDeleted Returns Short Term Entry ID from Exchange","url":"http://jeffpar.github.io/kbarchive/kb/261/Q261172/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q261172-prb-fnevobjectdeleted-returns-short-term-entry-id-from-exchange">Q261172: PRB: fnevObjectDeleted Returns Short Term Entry ID from Exchange</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q261172
Product(s): Microsoft Exchange
Version(s): 5.5
Operating System(s): 
Keyword(s): kbEDK kbExchange kbMAPI kbMsg kbGrpDSMsg kbDSupport
Last Modified: 09-FEB-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, version 5.5 
- Microsoft Exchange 2000 Server 
-------------------------------------------------------------------------------

SYMPTOMS
========

An Extended Messaging Application Programming Interface (MAPI) program
implements the IMAPIAdviseSink interface to be notified on changes in a folder
on an Exchange Server. When an fnevObjectDeleted notification event is received,
the entry ID contained in the accompanying OBJECT_NOTIFICATION structure is a
short term entry ID instead of a long term entry ID.

CAUSE
=====

All entry IDs that are returned by the Exchange providers in notifications are
short term, because short term entry IDs are quicker to compute than long term
entry IDs.

RESOLUTION
==========

This is only a problem if you are storing the long term entry IDs of items in
another database and need information from the delete event to determine which
item to remove. Because the item has already been deleted, it cannot be opened
to obtain the long term entry ID. At this point, there is no way, other than
rescanning the folder, to identify the deleted item.

If the notification is table-based instead of folder-based, a TABLE_NOTIFICATION
structure is returned. This structure contains enough information to identify
which row of the table was deleted. For most client applications, this is
sufficient to maintain a list of items that are currently in a container.

In general, however, MAPI notification is not a recommended method of
synchronizing databases with Exchange. Notifications are not guaranteed by
Exchange and may be dropped under high loads.

REFERENCES
==========

For more information on the Exchange notification queue, see "The Queue of
Notifications" at the following Microsoft Developer Network (MSDN) Web site:

  http://msdn.microsoft.com/library/default.asp?URL=/library/psdk/exchserv/infostor_0jcj.htm
  (http://msdn.microsoft.com/library/default.asp?URL=/library/psdk/exchserv/infostor_0jcj.htm)

Exchange 2000 supports Store Event Sinks, which can be used to track saves and
deletes to any folder in an Exchange 2000 store. For more information, see "Web
Storage System Events" at the following MSDN Web site:

  http://msdn.microsoft.com/library/default.asp?URL=/library/psdk/exchsv2k/_exch2k_ole_db_server_events_overview.htm
  (http://msdn.microsoft.com/library/default.asp?URL=/library/psdk/exchsv2k/_exch2k_ole_db_server_events_overview.htm)

For a sample that uses folder notification to keep track of the contents of a
folder, click the article number below to view the article in the Microsoft
Knowledge Base:

  Q230770 SAMPLE: FrmVwr.exe Extended MAPI Form Viewer

Additional query words:

======================================================================
Keywords          : kbEDK kbExchange kbMAPI kbMsg kbGrpDSMsg kbDSupport 
Technology        : kbExchangeSearch kbExchange550 kbZNotKeyword2 kbExchange2000Search kbExchange2000Serv
Version           : :5.5
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>