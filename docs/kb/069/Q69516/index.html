<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q69516: MS-DOS 5.0 UMBs, Enhanced Mode Windows, and LIM 4.0 Support | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q69516: MS-DOS 5.0 UMBs, Enhanced Mode Windows, and LIM 4.0 Support" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/069/Q69516/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/069/Q69516/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q69516: MS-DOS 5.0 UMBs, Enhanced Mode Windows, and LIM 4.0 Support","url":"http://jeffpar.github.io/kbarchive/kb/069/Q69516/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q69516-ms-dos-50-umbs-enhanced-mode-windows-and-lim-40-support">Q69516: MS-DOS 5.0 UMBs, Enhanced Mode Windows, and LIM 4.0 Support</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q69516
Product(s): Microsoft Disk Operating System
Version(s): MS-DOS:5.0; WINDOWS:3.0
Operating System(s): 
Keyword(s): 
Last Modified: 03-DEC-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft MS-DOS operating system version 5.0 
- Microsoft Windows 3.0 
-------------------------------------------------------------------------------

SUMMARY
=======

If you use the upper memory block UMB support included with MS-DOS version 5.0
and you try to run an LIM 4.0-aware application under enhanced mode Windows
version 3.0, Windows may not detect any expanded memory, even if you set up a
PIF file telling Windows to allocate expanded memory for it.

This problem occurs if you are running EMM386.EXE with the NOEMS option. When
this switch is used, EMM386 fills all available addresses between 640K and 1 MB
with UMBs. Because all expanded memory managers operate by swapping pages of
memory into unused addresses in this range, when all the available space is
filled, there is no room for the pages and no expanded memory is available.

WORKAROUND
==========

There are two ways to work around this:

- You can use the RAM option instead of the NOEMS option. You can allocate as
  little as 16K (one page) of expanded memory. Windows is then able to give
  expanded memory to applications that can access LIM 4.0 memory.

- You can use the X=xxxx-yyyy parameter on EMM386 to exclude enough space for a
  page frame. Reserving a 16K page of memory is enough for Windows to allocate
  expanded memory.

With the NOEMS option on, EMM386 Windows creates a page frame below 640K through
handle 0000h. This is a special handle that is normally available only to the
operating system. This handle has a set of pages allocated to it when EMM386
installs. The pages that are automatically allocated to handle 0000h are those
that backfill conventional memory. Typically, this backfill occurs between
addresses 40000h (256K) and 9FFFFh (640K).

An application that is aware of handle 0000h is able to make use of expanded
memory through the handle. However, most applications are not written to take
advantage of handle 0000h because the LIM 4.0 specifications specify that this
handle is reserved for the operating system. Any applications that use handle
0000h are incompatible with future versions of Microsoft operating systems and
environments.

Additional query words: 4.00 5.00 UMA noupd

======================================================================
Keywords          :  
Technology        : kbWin3xSearch kbZNotKeyword3 kbWin300 kbMSDOSSearch kbMSDOS500
Version           : MS-DOS:5.0; WINDOWS:3.0

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>