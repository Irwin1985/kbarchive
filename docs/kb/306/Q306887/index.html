<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q306887: Perfproc.dll Logs Event 2002 Errors in Win 2K Application Log | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q306887: Perfproc.dll Logs Event 2002 Errors in Win 2K Application Log" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/306/Q306887/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/306/Q306887/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q306887: Perfproc.dll Logs Event 2002 Errors in Win 2K Application Log","url":"http://jeffpar.github.io/kbarchive/kb/306/Q306887/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q306887-perfprocdll-logs-event-2002-errors-in-win-2k-application-log">Q306887: Perfproc.dll Logs Event 2002 Errors in Win 2K Application Log</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q306887
Product(s): Microsoft Windows NT
Version(s): 2000,2000 SP1,2000 SP2
Operating System(s): 
Keyword(s): kbbetapublic kbSysAdmin kbWin2000PreSP3Fix kbCommServ2000PreSP1fix kbCommServ2000SP1fix
Last Modified: 15-AUG-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows versions 2000, 2000 SP1, 2000 SP2 Professional 
- Microsoft Windows versions 2000, 2000 SP1, 2000 SP2 Server 
- Microsoft Windows versions 2000, 2000 SP1, 2000 SP2 Advanced Server 
-------------------------------------------------------------------------------

SYMPTOMS
========

The Windows 2000 Application event log may be populated with several event 2002
Perfproc errors that have the following (or similar) description:

  Unable to open the job object Winlogon Job 0-13f0822 for query access. The
  calling process may not have permission to open this Job. The status returned
  is data DWORD 0. For more information, see Help and Support Center at
  http://go.microsoft.com/fwlink/events.asp.

CAUSE
=====

Perfproc.dll logs the 2002 event error when it cannot open a job object. Refer
to the "More Information" section for additional information.

RESOLUTION
==========

To resolve this problem, obtain the latest service pack for Windows 2000. For
additional information, click the following article number to view the article
in the Microsoft Knowledge Base:

  Q260910 How to Obtain the Latest Windows 2000 Service Pack

Perfproc.dll was modified to call OpenJobObject using the full path in the object
name space from the \BaseNamedObjects path.

The English version of this fix should have the following file attributes or
later:

  Date        Time     Version       Size    File name
  ----------------------------------------------------
  12-Feb-2002 04:48PM  5.0.2195.3990 28,944  Perfproc.dll


STATUS
======

Microsoft has confirmed that this is a problem in the Microsoft products that
are listed at the beginning of this article. This problem was first corrected in
Windows 2000 Service Pack 3.

MORE INFORMATION
================

A job object allows groups of processes to be managed as a unit. In this case,
Perfproc cannot open the Winlogon job object because no user is logged on to the
console and a process that is running as a service or in a terminal server
session requests process performance data (which is implemented in
Perfproc.dll). The open process fails on the Winlogon job object because
Perfproc.dll calls OpenJobObject with the job name instead of with the full path
to the job. When OpenJobObject is called with a job name instead of the full
path to the job in the object name space, it looks for the job under the running
processes session sub-tree which will fail if there is no user logged on to the
console.

For additional information about how to obtain a hotfix for Windows 2000
Datacenter Server, click the article number below to view the article in the
Microsoft Knowledge Base:

  Q265173 The Datacenter Program and Windows 2000 Datacenter Server Product

For additional information about how to install multiple hotfixes with only one
reboot, click the article number below to view the article in the Microsoft
Knowledge Base:

  Q296861 Use QChain.exe to Install Multiple Hotfixes with One Reboot

Additional query words: kbMgmtAdmin

======================================================================
Keywords          : kbbetapublic kbSysAdmin kbWin2000PreSP3Fix kbCommServ2000PreSP1fix kbCommServ2000SP1fix kbWin2000sp3fix 
Technology        : kbwin2000AdvServ kbwin2000AdvServSearch kbwin2000Serv kbwin2000ServSearch kbwin2000Search kbwin2000ProSearch kbwin2000Pro kbWinAdvServSearch kbWin2000AdvServSP2 kbWin2000AdvServSP1 kbWin2000ProSP2 kbWin2000ProSP1 kbwin2000ServSP1 kbwin2000ServSP2
Version           : :2000,2000 SP1,2000 SP2
Hardware          : x86
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>