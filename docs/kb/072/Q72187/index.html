<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q72187: Error Removing SUBSTed Directories | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q72187: Error Removing SUBSTed Directories" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/072/Q72187/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/072/Q72187/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q72187: Error Removing SUBSTed Directories","url":"http://jeffpar.github.io/kbarchive/kb/072/Q72187/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q72187-error-removing-substed-directories">Q72187: Error Removing SUBSTed Directories</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q72187
Product(s): Microsoft Disk Operating System
Version(s): MS-DOS:4.x,5.0
Operating System(s): 
Keyword(s): 
Last Modified: 17-DEC-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft MS-DOS operating system versions 4.0, 4.01, 5.0 
-------------------------------------------------------------------------------

SUMMARY
=======

When attempting to delete a directory that has been made into a virtual drive,
using the SUBST command from MS-DOS Shell that came with MS-DOS versions 4.0,
4.01, 4.01a, and 5.0, you get the following message:

  System integrity violated. You should exit.

If the directory has been SUBSTed, the message itself is an error in Shell, and
you can continue working within the shell without having to exit.

MORE INFORMATION
================

If the error occurs when deleting a directory, do the following:

1. If you know for sure that the directory has been SUBSTed, the error can be
  ignored. However, the directory still needs to be unSUBSTed before it can be
  deleted. See step 2c.

2. If you are not sure if the directory has been SUBSTed, do the following:

  a. Exit Shell immediately.

  b. Type "SUBST" (without the quotation marks) at the command line. This will
     list all the SUBSTed directories.

  c. If the directory in question is present, it first has to be unSUBSTed
     before it can be deleted. Type "SUBST &lt;DRIVE&gt;:/D" (without the
     quotation marks) at the command line to unSUBST. You can now return to
     Shell and delete the directory.

  d. If the directory in question is not in the SUBST list, system integrity
     has indeed been violated, and you should immediately reboot your system.

This error occurs because the C-runtime sets _dos_errno to EBUSY, which Shell
cannot interpret. It, therefore, maps that error number to the message "System
Integrity Violated...".

There is an analogous error when trying to remove a SUBSTed directory from the
command line. The message is the following

  Attempt to remove current directory - &lt;directory&gt;

even though the directory is not your current directory. It is, however, the
current directory for the SUBSTed drive.

Additional query words: 4.00 4.01 4.01a 5.00

======================================================================
Keywords          :  
Technology        : kbMSDOSSearch kbMSDOS400 kbMSDOS500 kbMSDOS401
Version           : MS-DOS:4.x,5.0

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>