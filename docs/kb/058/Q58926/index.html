<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q58926: Array Storage DGROUP vs. Far Heap Differs in .EXE vs. QB.EXE | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q58926: Array Storage DGROUP vs. Far Heap Differs in .EXE vs. QB.EXE" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/058/Q58926/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/058/Q58926/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q58926: Array Storage DGROUP vs. Far Heap Differs in .EXE vs. QB.EXE","url":"http://jeffpar.github.io/kbarchive/kb/058/Q58926/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q58926-array-storage-dgroup-vs-far-heap-differs-in-exe-vs-qbexe">Q58926: Array Storage DGROUP vs. Far Heap Differs in .EXE vs. QB.EXE</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q58926
Product(s): See article
Version(s): 4.00 4.00b 4.50
Operating System(s): MS-DOS
Keyword(s): ENDUSER | SR# S900112-152 B_BasicCom | mspl13_basic
Last Modified: 27-FEB-1990

Arrays can be stored in different places depending on array type and
on whether the program is run from an .EXE file or the QB.EXE
environment. All nonarray (scalar) variables are always stored in
DGROUP.

In the QuickBASIC QB.EXE environment, a static array of numeric type
or fixed-length-string type must be in a COMMON or COMMON SHARED
statement to be allocated in the DGROUP memory area; otherwise it will
be stored in the far heap.

In an executable file (.EXE), all types of static arrays are always
stored in the DGROUP area (which can be referenced with a near
address).

Dynamic or static arrays of variable-length strings are always stored
in DGROUP in both QB.EXE and .EXE programs.

This information applies to Microsoft QuickBASIC Versions 4.00, 4.00b,
and 4.50 for MS-DOS, and to Microsoft BASIC Compiler Versions 6.00 and
6.00b for MS-DOS and MS OS/2.

For a complete description of variable storage allocation, please read
Pages 32 and 33 of the "Microsoft QuickBASIC 4.0: BASIC Language
Reference," or Pages 32 and 33 of the "Microsoft BASIC Compiler 6.0:
BASIC Language Reference."

DGROUP is also known as the default data segment, or the near data
storage area.

In summary, array storage in QB.EXE adheres to the following three
rules:

1. All $STATIC arrays in COMMON or COMMON SHARED are stored in DGROUP.

2. All arrays of type variable-length string are stored in DGROUP.

3. All other arrays are stored in far addresses.

Array storage in .EXE programs adheres to the following three rules:

1. All $STATIC arrays are stored in DGROUP.

2. All $DYNAMIC arrays of variable-length strings are stored in
   DGROUP.

3. All other $DYNAMIC arrays are stored as far objects in the far heap.

Program Example
---------------

The program below illustrates the preceding information.

DIM ar1(100) AS INTEGER      ' REM $STATIC is the default for arrays
DIM ar2(100) AS INTEGER      ' REM $STATIC is the default for arrays
COMMON SHARED ar2() AS INTEGER
' Must be in COMMON in QB.EXE environment to be placed in DGROUP.
s$ = "hello"    ' this is put into the DGROUP
REM $DYNAMIC
DIM ar3(100) AS INTEGER
PRINT VARSEG(s$), VARSEG(ar1(0)), VARSEG(ar2(0)), VARSEG(ar3(0))
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>