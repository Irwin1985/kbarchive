<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q191096: PRB: Multiple &quot;System Files Are Out of Date&quot; Errors | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q191096: PRB: Multiple &quot;System Files Are Out of Date&quot; Errors" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/191/Q191096/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/191/Q191096/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q191096: PRB: Multiple &quot;System Files Are Out of Date&quot; Errors","url":"http://jeffpar.github.io/kbarchive/kb/191/Q191096/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q191096-prb-multiple-system-files-are-out-of-date-errors">Q191096: PRB: Multiple "System Files Are Out of Date" Errors</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q191096
Product(s): Microsoft Visual Basic for Windows
Version(s): 5.0,6.0
Operating System(s): 
Keyword(s): kberrmsg kbwizard kbAppSetup kbVBp kbVBp500 kbVBp600 kbOSWin95 kbOSWin98 kbGrpDSVB kbGr
Last Modified: 11-JUL-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Professional Edition for Windows, versions 5.0, 6.0 
- Microsoft Visual Basic Enterprise Edition for Windows, versions 5.0, 6.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you install a Microsoft Visual Basic application, you may receive the
following message:

  Setup cannot continue because some system files are out of date on your
  system. Click OK if you would like setup to update these files for you now.
  You will need to restart Windows before you can run setup again. Click cancel
  to exit setup without updating system files.

After Windows restarts and you begin the installation again, the error message
appears again.

NOTE: This occurs with either the Microsoft Visual Basic 5.0 Application Setup
Wizard (ASW) or the Microsoft Visual Basic 6.0 Package and Deployment Wizard
(PDW).

CAUSE
=====

Both installation programs (ASW and PDW) use the same method to delay the
replacement of in-use system files until reboot. For any system files that are
in use, the new files are saved as temporary files in the Temp folder. In order
to replace the existing files with the .tmp files, the system will use the
Wininit.ini file on WIN 9x systems. On Windows NT and Windows 2000, the system
will call the MoveFileEx function with the MOVEFILE_REPLACE_EXISTING flag. This
function places the file replacement instructions in the following registry
key:

  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session
  Manager\PendingFileRenameOperations

If something interferes with this replace and rename operation, these files are
not updated. Therefore, once the computer reboots and restarts the installation
program, the same error message appears.

There are a number of reasons why this can happen, but the two most common are as
follows:

- The .tmp files are being deleted.

- The Temp folder is on a different drive or partition from the operating
  system. By default, the operating system is installed to either the Windows
  or Winnt folder.

RESOLUTION
==========

The following are resolutions to this problem:

1. Copy the TEMP and TMP environment variables to a folder that is in the same
  drive partition as the Windows system files. To do this, open a command
  prompt window and type the following at the prompt:

  " Set TMP=C:\TEMP
  Set TEMP=C:\TEMP " (without the quotation marks)

  This will save the TEMP and TMP environment variables to a folder named "Temp"
  that resides on the C: drive.

  NOTE: The folder must exist prior to carrying out these steps.

  Once these environment variables are set, the application should then install
  and continue past the message on reboot.

2. If your Autoexec.bat file contains the following line (or similar):

  If exists c:\temp\*.tmp del c:\temp\*.tmp

  comment it out by placing "REM" in front of it.

3. Disable any Anti-virus software (or other memory resident programs) and try
  running Setup again. Often the best way to accomplish this is to run setup in
  Safe Mode. It may also be necessary to copy all of the setup files to a
  temporary folder on the hard drive disk and run Setup.exe from there.

4. Leftover files from a failed Setup attempt can also cause this problem. If
  found, delete the msftqws.pdw subfolder and its contents from the Temp
  folder. Also look in the Windows or Winnt folder for Setup1.exe and any *.CAB
  files from previous installs, and delete them. This should be done after each
  failed install.

5. Some logon scripts can cause this problem, so try to run Setup before logging
  on to the network.

6. Make sure you are deploying the same file versions that you are using on your
  development machine. The wizards have a special folder where they look first
  for files to package. If found, a file is used from this source instead of
  the file your system is running.

  For Visual Basic 6.0, it is especially important to make sure that you are
  deploying the proper version of Mdac_Typ.exe. The version of this file should
  match the Reference to "Microsoft ActiveX Data Objects 2.x Library" in your
  project. The default locations for this folder are as follows:

  For Visual Basic 5.0:

  C:\Program Files\DevStudio\VB\setupkit\kitfil32\sys32

  For Visual Basic 6.0:

  C:\Program Files\Microsoft Visual Studio\VB98\Wizards\PDWizard\Redist

7. The system files that may need to be updated are listed in the Bootstrap or
  Bootstrap Files section of the Setup.lst file created with your package.
  These files can also be installed separately from self-extracting files found
  on Microsoft's support web site. Please see the References section for
  information about obtaining these files.

8. You can also edit the Setup.lst file. Look in the Setup1 Files or Files
  section for files to be copied to either $(WinSysPath) or
  $(WinSysPathSysFile). For example, Msvcrt.dll and Mfc42.dll. You can copy
  these lines to the end of the Bootstrap or Bootstrap Files section. You must
  renumber these lines so that the File numbers are sequential, for example
  "File1=...", File2=..." and so on. If these lines are removed from their
  original section, the remaining lines must be renumbered to maintain a
  sequential list.

STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products that are
listed at the beginning of this article.

REFERENCES
==========

For additional information, click the article numbers below to view the articles
in the Microsoft Knowledge Base:

  Q140570 HOWTO: Move Files That Are Currently in Use


  Q174135 PRB: Setup Cannot Continue...System Files Are Out of Date

  Q189743 INFO: Description of Setup.lst Sections

  Q180071 FILE: Msvbvm50.exe Installs Visual Basic 5.0 Run-Time Files

  Q192461 FILE: Visual Basic 6.0 Sample Installs Run-Time Files

  Q290887 FILE: VBRun60sp5.exe Installs Visual Basic 6.0 SP5 Run-Time Files

  Q279764 PRB: Multiple "System Files Are Out of Date" Errors When Visual Basic
  6.0 Application Installed on Windows 2000 Computer

Visual Basic 5.0 Programmer's Guide, Chapter 17 "Distributing Your Applications"

Online Help for Microsoft Visual Basic, version 6.0

Additional query words: directory machine

======================================================================
Keywords          : kberrmsg kbwizard kbAppSetup kbVBp kbVBp500 kbVBp600 kbOSWin95 kbOSWin98 kbGrpDSVB kbGrpDSVBDB kbDSupport kbOSWinME 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB500Search kbVB600Search kbVB500 kbVB600
Version           : :5.0,6.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>