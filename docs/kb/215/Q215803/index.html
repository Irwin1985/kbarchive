<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q215803: SNA Server 4.0 Service Pack 2 Readme.txt File | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q215803: SNA Server 4.0 Service Pack 2 Readme.txt File" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/215/Q215803/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/215/Q215803/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q215803: SNA Server 4.0 Service Pack 2 Readme.txt File","url":"http://jeffpar.github.io/kbarchive/kb/215/Q215803/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q215803-sna-server-40-service-pack-2-readmetxt-file">Q215803: SNA Server 4.0 Service Pack 2 Readme.txt File</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q215803
Product(s): Microsoft SNA Server
Version(s): 4.0SP2
Operating System(s): 
Keyword(s): 
Last Modified: 29-JUL-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft SNA Server, version 4.0SP2 
-------------------------------------------------------------------------------

SUMMARY
=======

This article contains a copy of the information in the Readme.txt included in
SNA Server 4.0 Service Pack 2

MORE INFORMATION
================

Microsoft SNA Server 4.0 Service Pack 2
---------------------------------------

Electronic Release Notes
------------------------

REVISION HISTORY

January 25, 1999 - Initial posting

Copyright Microsoft Corporation, 1997, 1998, 1999

These materials are provided "as-is," for informational purposes only.

Neither Microsoft nor its suppliers makes any warranty, express or implied with
respect to the content of these materials or the accuracy of any information
contained herein, including, without limitation, the implied warranties of
merchantability or fitness for a particular purpose. Because some
states/jurisdictions do not allow exclusions of implied warranties, the above
limitation may not apply to you.

Neither Microsoft nor its suppliers shall have any liability for any damages
whatsoever including consequential incidental, direct, indirect, special, and
loss profits. Because some states/jurisdictions do not allow exclusions of
implied warranties, the above limitation may not apply to you. In any event,
Microsoft's and its suppliers' entire liability in any manner arising out of
these materials, whether by tort, contract, or otherwise shall not exceed the
suggested retail price of these materials.

=====================================================================

Ordering the SNA Server 4.0 Service Pack 2 CD
---------------------------------------------

Microsoft SNA Server 4.0 U.S. Service Pack 2 (SP2) is available in CD media
format by ordering the following part number from Microsoft at (800) 936-3500:

  #211-00319 SNA Svr 4.0 English Patch CD SP2

Downloading SNA Server 4.0 Service Pack 2
-----------------------------------------

Self-extracting executable files containing updated 4.0 SP2 SNA Server and client
files can be downloaded electronically from www.microsoft.com, which points to:

ftp://ftp.microsoft.com/bussys/winnt/sna-public/fixes/sna40/ussp2

The following files comprise the updated SNA Server and client files for SNA
Server 4.0 SP2:

 40SP2TXT.EXE  - 4.0 SP2 Release Notes and Help File
 40SP2IS.EXE   - 4.0 SP2 Server Update (Intel) (NOTE 1,2)
 40SP2AS.EXE   - 4.0 SP2 Server Update (Alpha) (NOTE 1,2)
 40SP2IC.EXE   - 4.0 SP2 Windows NT Client Update (Intel) (NOTE 2)
 40SP2AC.EXE   - 4.0 SP2 Windows NT Client Update (Alpha) (NOTE 2)
 40SP29X.EXE   - 4.0 SP2 Windows 95 Client Update (NOTE 2)
 40SP2CLR.EXE  - 4.0 SP2 Windows 3.x, MS-DOS, WEB Client Refresh (NOTE 3)
 40SP2IHS.EXE  - 4.0 SP2 Host Security Refresh (Intel)
 40SP2AHS.EXE  - 4.0 SP2 Host Security Refresh (Alpha)
 40SP2SDK.EXE  - 4.0 SP2 Software Development Kit Files
 40SP2MQ.EXE   - 4.0 SP2 MSMQ-MQSeries Bridge

All of these files are self extracting Win32 executables.

For information about changes and new features implemented in 4.0 SP2, see the
Snasp.hlp file and Readme.txt release notes file included in 40sp2txt.exe,
40sp2is.exe or 40sp2as.exe. Snasp.hlp describes new features added in the
service pack and articles describing the symptoms and causes for problems fixed
in the service pack.

NOTE 1: The SNA Server 4.0 SP2 includes updates to the SNA Server, Print Service,
COM Transaction Integrator, SNA OLE/DB Interface, TN3270 Service, TN5250
Service, AFTP, and Shared Folders Gateway.

NOTE 2: After the 4.0 SP2 update is applied, there is no way to uninstall (or
"roll back") the service pack without reinstalling the previous SNA Server 4.0
release. The SNA Server, Windows 95 and Windows NT client update programs
automatically invoke the MDAC installation program, required by SNA Server 4.0
SP2, regardless of what is currently installed on the server or client. Unlike
SNA 4.0 SP1, the required MDAC and MMC files are already included in these self
extracting images.

NOTE 3: The SNA Server Windows 3.x, and MS-DOS clients are unchanged from SNA 4.0
SP1. There is no update installer for these clients. The Web-installable clients
has been updated in SNA 4.0 SP2.

Instructions for Decompressing the Server or Client Update Files
----------------------------------------------------------------

The SNA Server and client update files automatically extract and run the Update
program. When extracted, these files require the following free disk space:

 Server Update (Intel) - 40SP2IS.EXE:  138 MB
 Server Update (Alpha) - 40SP2AS.EXE:  166 MB
 Windows NT Client Update (Intel) - 40SP2IC.EXE: 95 MB
 Windows NT Client Update (Alpha) - 40SP2AC.EXE: 121 MB
 Windows 95 Client Update         - 40SP29X.EXE: 30 MB

Microsoft recommends that these files are extracted to a persistent, shared
network location and made available to server and client computers across the
network. Users can then connect to this shared directory and install the service
pack by running the Update program from this network location. To do this,
perform the following steps:

1. Extract the desired service pack files to one or more directories on a
  network server. These files can be extracted to a separate directory by using
  the /x or /X option. For example:

  40SP2IS /x

2. Share the desired service pack files to network users.

The full directory structure of the extracted files must be available to the user
who runs the Update program, since the Update program automatically spawns the
MDAC and MMC installation programs. For example, "40SP2IS /X" will extract into
the following directory structure:

  \ 
  \I386\... (SNA Server 4.0 SP2 files)
  \MMC      (MMC installation)
  \MDAC     (MS DAC installation)
  \REG2UDL  (utility used by Setup)

Similarly, the SNA Windows NT Intel client update (40sp2ic.exe) extracts into the
following directory structure:

 \ 
 \CLIENTS\WINNT\I386  (SNA Server 4.0 SP2 Windows NT client files)
 \MMC                 (MMC installation)
 \MDAC                (MS DAC installation)
 \REG2UDL             (utility used by Setup)

Users must run the Update program to install the service pack.

To apply the service pack, the Update should be run from the appropriate shared
directory:

SNA Server (Intel):  \I386
SNA Server (Alpha):  \ALPHA
SNA Windows NT client (Intel):  \CLIENTS\WINNT\I386
SNA Windows NT client (Alpha):  \CLIENTS\WINNT\ALPHA
SNA Windows 9x client: \CLIENTS\WIN9X

**********************************************************************
WARNING: The Update.exe program should always be used to install the service
pack, which automatically spawns the Setup program in "quiet" mode, and requires
limited user interaction. The Setup program should not be run directly, because
the user will be required to select the existing installation path, user
credentials and components to install. If these options are chosen incorrectly,
this can damage the installation of the service pack on the destination
computer.
**********************************************************************

If the self-extracting files are run without the /X option, the update program
will be run automatically. When running Update automatically, all files are
automatically extracted to the directory where the TMP, TEMP, or WINROOT
environment variable is pointing (trying in that order). So, if the SET command
shows that TMP=C:\TMP, and C: does not have sufficient storage to extract the
files, change TMP to point to a drive which has sufficient space. For example:

  SET TMP=D:\TEMP

NOTE: Once Update has completed, the SNA Server source installation directory
will point to the directory where Update was run. If SNA Setup is run from SNA
Server program group, Setup will attempt to locate this directory when adding or
removing SNA Server components.
For more information about the service pack installation process and possible
errors that might occur, see the "More Information" section below.

How To Disable the MDAC Installation
------------------------------------

The 4.0 SP2 Update program for SNA Server, Windows NT and Windows 9x will
automatically spawn the MDAC installation program whenever Update is run. This
new version of MDAC must be installed so that the new data access features of
4.0 SP2 will function properly. If these data access features are not being
used, the automatic MDAC installation can be disabled by modifying the client
Snasetup.ini file from the service pack installation directory prior to running
the Update program. To disable the automatic installation of MDAC,
"InstallMdac=NoInstall" should appear before the other InstallMdac lines. For
example:

   InstallMdac=NoInstall
   InstallMdac=ForcedInstall
   InstallMdac=ContinueInstall

If "InstallMdac=ForcedInstall" is listed first (the default), then MDAC is
automatically installed.

WARNING: No other lines of Snasetup.ini should be modified

Installing the new OLE/DB Provider and ODBC Driver for DB2
----------------------------------------------------------

SNA Server 4.0 SP2 includes a new OLE DB Provider for DB2 and ODBC Driver for
DB2. To install these new features, the server or client computer must first be
upgraded to SNA 4.0 SP2 by running the Update program from a persistent location
(ie. a location where the full extracted files exist). Once installed, the new
drivers may be installed by running the SNA Setup program from the local SNA
Server Program group and by choosing these new components after selecting
Add/Remove Components.

Installing the new MSMQ-MQSeries Bridge
---------------------------------------

SNA Server 4.0 SP2 includes the new MSMQ-MQSeries Bridge (40sp2mq.exe), which can
be downloaded by Microsoft SNA Server 4.0 customers. This new feature is only
supported on Microsoft SNA Server 4.0 SP2 systems. For more information about
this feature, refer to the License.txt and README files included in
40sp2mq.exe.

Upgrading Host Security to 4.0 SP2
----------------------------------

The Host Security updates for SNA 4.0 SP2 (40sp2ihs.exe, 40sp2ahs.exe) must first
be extracted to a directory. To upgrade SNA Server 4.0 or 4.0 SP1 Host Security
to 4.0 SP2, the Setup program must be run and the current installation directory
and Windows NT user context must be entered. No Update program is provided to
upgrade to 4.0 SP2.

Upgrading SNA Windows 3.x and MS-DOS clients to 4.0 SP2
-------------------------------------------------------

The 40sp2clr.exe file contains the SNA Server Windows 3.x, MS-DOS and OS/2 client
files, and is a Win32 self extracting executable. The administrator must first
run this file and choose a directory to place the extracted files. Windows 3.x
clients may then connect across the network and run the Setup program to install
the client files. The setup program can be used to upgrade a previous version of
the SNA client software.

NOTE: The SNA Windows 3.x and MS-DOS clients are unchanged from SNA 4.0 SP1.

Installing the Updated 4.0 SP2 SDK
----------------------------------

The electronic images for SNA Server 4.0 SP2, Windows NT and Windows 9x do not
include the updated SDK files, in order to reduce their download sizes. The SDK
(40sp2sdk.exe) may be downloaded separately, though there is no installation
program. These files are intended to replace the existing 4.0 SDK files located
in the server or client \Sna\SDK directory tree.

Installing the Service Pack Files
---------------------------------

Both the SNA Server and SNA client files have been updated in 4.0 SP2. Updates
may be applied in any order -- to the server and/or to the clients. It is
recommended that all systems running SNA Server 4.0 (that is, SNA Servers and
client computers) are updated to 4.0 SP2. It may not be necessary to update the
client computers to SP2 unless you are experiencing a client problem that has
been fixed in SP2.

WARNING: This service pack update is intended to be applied on systems currently
running SNA Server 4.0 or 4.0 SP1 server or client software. These updates
cannot be applied over systems running SNA Server 3.x or 2.x releases.

** TO BE APPLIED TO SNA SERVER 4.0 SYSTEMS ONLY!! **

Additional Information
----------------------

As noted above, if /X is not used, the file is self-extracted to the directory
where the TMP environment variable is pointing. For example, if TMP=C:\TEMP,
then the C: drive (where this directory exists) must have sufficient disk space
to accommodate the extracted image. If there is insufficient disk space to
accommodate the image size, the following error will occur:

  Extraction Failed Access is denied

  &lt;OK&gt;

If this error occurs, a temporary read-only file may be left in the TMP directory
tree (for example, in C:\Temp\Ext46000\I386\Setup.tdf) which may cause the
service pack file to continue to fail with "Access is denied".
To correct this problem, delete the file indicated in the "To Directory:" within
the progress dialog when the "Access is denied" error is displayed. This file
may have the "read only" attribute set, so the ATTRIB command may be needed to
remove this attribute (i.e. ATTRIB -r &lt;file&gt;) in order to delete this
file.
When Update is run, it displays the following warning:

  WARNING You are about to update your current installation of SNA Server with
  SNA Server 4.0 with Service Pack 2. You will not be able to deinstall this
  Service Pack and get back to your original setup. Click Yes if you wish to
  proceed.

  &lt;Yes&gt; &lt;No&gt;

  Choose Yes to continue (the default is No)

As mentioned above, Update always launches the MDAC Setup program, which displays
the following message box:

   Please wait while MDAC setup completes...


If the following error occurs, then SNA 4.0 SP2 has already been installed:

  Setup Error 689 Setup cannot update an installation interactively in Quiet
  mode. Setup Error 723 Setup was unable to read configuration information from
  the first section of the Setup file: C:\SNA40\Setup\Server\Snafile.stf


Additional query words: readme release notes servpack

======================================================================
Keywords          :  
Technology        : kbAudDeveloper kbSNAServSearch
Version           : :4.0SP2
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>