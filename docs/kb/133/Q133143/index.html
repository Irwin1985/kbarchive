<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q133143: PRB: VFP300.ESL Goes in System Directory, Not App’s Directory | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q133143: PRB: VFP300.ESL Goes in System Directory, Not App’s Directory" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/133/Q133143/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/133/Q133143/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q133143: PRB: VFP300.ESL Goes in System Directory, Not App’s Directory","url":"http://jeffpar.github.io/kbarchive/kb/133/Q133143/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q133143-prb-vfp300esl-goes-in-system-directory-not-apps-directory">Q133143: PRB: VFP300.ESL Goes in System Directory, Not App’s Directory</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q133143
Product(s): Microsoft FoxPro
Version(s): 
Operating System(s): 
Keyword(s): 
Last Modified: 25-AUG-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, version 3.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

By design, the Setup Wizard places the Visual FoxPro version 3.0 runtime library
(VFP300.ESL) into the \Windows\System subdirectory instead of the directory
where the rest of the application files are installed.

NOTE: The advantage of keeping the VFP300.ESL in the \Windows\System subdirectory
is that you can have multiple Visual FoxPro applications share a single
VFP300.ESL runtime library.

RESOLUTION
==========

To install the runtime library (VFP300.ESL) into the application directory
instead of the \Windows\System subdirectory, as the FoxPro version 2.x Setup
Wizard does, follow these steps:

1. Copy VFP300.ESL to your distribution tree directory.

2. Run the Setup Wizard.

3. In step 2 of the Setup Wizard procedure, select the Visual FoxPro 3.0 Runtime
  check box.

4. In step 6 of the Setup Wizard procedure, ensure that VFP300.ESL is set to
  AppDir under the Target Directory column.

  NOTE: The VFP300.ESL file should be listed in the grid of Step 6 because the
  .ESL file is now in your distribution tree directory.

5. In step 7 of the Setup Wizard procedure, click the Finish button.

6. Install the disk images.

Placing the VFP300.ESL file in the application directory provides compatibility
for FoxPro version 2.x applications that have SYS(2004) references. For example,
consider this command:

     SET LIBRARY TO SYS(2004)+"FOXTOOLS.FLL" ADDITIVE

Here FOXTOOLS.FLL is a file in the application directory.

This approach does have a disadvantage. Each Visual FoxPro application must have
its own copy of the runtime library. A better approach is to replace all
SYS(2004) references with SYS(16). The SYS(16) function returns the application
path and at the same time allows you to take advantage of having multiple Visual
FoxPro applications sharing a single VFP300.ESL runtime library.

STATUS
======

This behavior is by design.

MORE INFORMATION
================

Steps to Reproduce Problem
--------------------------

1. Specify the following in the Setup Wizard:

  Step 1: &lt; your Distribution Tree directory &gt;.
  Step 2: Select the Visual FoxPro 3.0 Runtime and Win32s check boxes.
  Steps 3 - 6: Complete as appropriate

  NOTE: In Step 6, you won't see VFP300.ESL listed in the grid. The grid in Step
  6 lists only those files located in &lt; your Distribution Tree directory
  &gt;.

  Step 7: Click Finish.

  The Setup Wizard automatically copies the compressed version of the VFP300.ESL
  file from the \VFP\DISTRIB directory to your disk images directory.

2. Run SETUP.EXE from the disk images. It installs VFP300.ESL in the
  \Windows\System subdirectory.

Additional query words: VFoxWin

======================================================================
Keywords          :  
Technology        : kbVFPsearch kbAudDeveloper kbVFP300

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>