<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q133163: HOWTO: Control Printer Attributes for a Report at Run Time | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q133163: HOWTO: Control Printer Attributes for a Report at Run Time" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/133/Q133163/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/133/Q133163/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q133163: HOWTO: Control Printer Attributes for a Report at Run Time","url":"http://jeffpar.github.io/kbarchive/kb/133/Q133163/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q133163-howto-control-printer-attributes-for-a-report-at-run-time">Q133163: HOWTO: Control Printer Attributes for a Report at Run Time</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q133163
Product(s): Microsoft FoxPro
Version(s): 
Operating System(s): 
Keyword(s): kbcode kbprint kbPrinting kbvfp300 kbvfp500 kbvfp600
Last Modified: 11-SEP-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual FoxPro for Windows, versions 3.0, 5.0, 6.0 
-------------------------------------------------------------------------------

SUMMARY
=======

When designing a report, a developer does not always know which printer will be
used. As a result, the developer needs to give the user a way to change the
printer and printer attributes at run time. This article shows by example how to
write code that does this.

MORE INFORMATION
================

Visual FoxPro has enhanced and added commands and functions for controlling and
getting printer information. Please see the Help menu for more information on
these commands:

  SET PRINTER TO
  APRINTER()
  PRTINFO()
  GETPRINTER()

The following example shows that a report can be sent to an HP LaserJet IIID on
LPT2 with print duplex and landscape selected, and then the same report can be
sent to a Panasonic KX-P1180 on LPT1 using a custom paper size.

To run the example code, you must have the printers installed in Windows. If you
don't, you need to install them, and set up a user-defined paper size under
printer setup in Windows for the Panasonic. Set the user-defined size using
Millimeters (MM) as the measuring unit with the Width at 2159 and the Length at
1778.

For testing purposes, you may connect the printers to FILE instead of LPT1 or
LPT2. If you do connect to FILE, make sure that you also substitute FILE for
LPT1 or LPT2 in the following example code.

For more information on installing or changing Printer settings in Windows,
please see Windows' Help menu.

Step-by-Step Example
--------------------

This example works on the following platforms:

  Windows 3.1
  Windows for Workgroups 3.11
  Windows 95
  Windows NT 3.5 or 3.51
  Windows NT 4.0

NOTE: Visual FoxPro 5.0 and 6.0 run only under 32-bit operating systems such as
Windows 95, Windows NT 3.5 and later.

If you have trouble setting custom paper sizes or other printer attributes,
verify that you have the latest printer driver for your specific platform, and
check the printer documentation or contact the manufacturer to find out more
about your printer's capabilities.

1. Open Testdata.dbc in the Vfp\Samples\Data directory or in Visual FoxPro 6.0,
  the sample path is under _samples+"Testrade\data".

2. Create a new report by using Quick Report. Choose the Customer table and add
  the Cust_id and Company fields to the report. Save the report as Myreport,
  and then close the report.

3. Create a text file called Panprint.txt that contains these lines:

  

     DEVICE=Panasonic KX-P1180
     OUTPUT=LPT1:
     ORIENTATION=0
     PAPERSIZE=256
     PAPERLENGTH=1778
     PAPERWIDTH=2159
     DEFAULTSOURCE=8

  NOTE: Most dot-matrix printers use PAPERSIZE=256 to define a custom paper
  size. If you use a custom paper size, you must include PAPERLENGTH and
  PAPERWIDTH.

4. Create a second text file called Hpprint.txt that contains these lines:

  

     DEVICE=HP LaserJet IIID
     OUTPUT=LPT2:
     ORIENTATION=1
     PAPERSIZE=1
     DEFAULTSOURCE=7
     DUPLEX=2

  NOTE: For more information about the different printer settings, please see
  PRTINFO() in Visual FoxPro Help menu.

5. Create a program called Runrpt.prg, and enter the following code:

  

     USE Myreport.frx  &amp;&amp; Open the FRX as a table
     LOCATE FOR Objtype = 1 AND Objcode = 53  &amp;&amp; find the record that holds
     ** the printer information. For more information on the Table Structure
     ** of an .FRX file, see 'Table Structures of Table Files' in Help.

     REPLACE Tag WITH ""  &amp;&amp; Remove any Printer codes that may be stored in
     ** the Tag memo

     REPLACE Tag2 WITH ""  &amp;&amp; Remove any Printer codes that may be stored in
     ** the Tag2 memo

     APPEND MEMO Expr FROM Hpprint.txt OVERWRITE  &amp;&amp; Replace any printer
     ** setting already there with the HP IIID Settings

     USE  &amp;&amp; Close Myreport.frx
     SET PRINTER TO NAME 'HP LaserJet IIID'
     REPORT FORM Myreport TO PRINT NEXT 60  &amp;&amp; Send the report to the
     ** HP IIID printer using the printer attributes specified in the
     ** Expr memo field.

     USE Myreport.frx  &amp;&amp; Open the FRX as a table
     LOCATE FOR Objtype = 1 AND Objcode = 53  &amp;&amp; find the record that holds
     ** the printer information

     APPEND MEMO Expr FROM Panprint.txt OVERWRITE  &amp;&amp; Replace any printer
     ** setting already there with the Panasonic KX-P1180 Settings

     USE  &amp;&amp; Close Myreport.frx
     SET PRINTER TO NAME 'Panasonic KX-P1180'
     REPORT FORM Myreport TO PRINT NEXT 60  &amp;&amp; Send the report to the
     ** Panasonic KX-P1180 printer using the printer attributes
     ** specified in the Expr memo field.

6. Save and run the program.

Additional query words:

======================================================================
Keywords          : kbcode kbprint kbPrinting kbvfp300 kbvfp500 kbvfp600 
Technology        : kbVFPsearch kbAudDeveloper kbVFP300 kbVFP500 kbVFP600
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>