<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q285642: BUG: Using Add-In to Change Name of UserControl May Cause AV | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q285642: BUG: Using Add-In to Change Name of UserControl May Cause AV" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/285/Q285642/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/285/Q285642/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q285642: BUG: Using Add-In to Change Name of UserControl May Cause AV","url":"http://jeffpar.github.io/kbarchive/kb/285/Q285642/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q285642-bug-using-add-in-to-change-name-of-usercontrol-may-cause-av">Q285642: BUG: Using Add-In to Change Name of UserControl May Cause AV</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q285642
Product(s): Microsoft Visual Basic for Windows
Version(s): 6.0
Operating System(s): 
Keyword(s): kbCtrl kbCtrlCreate kbVBp kbVBp600bug kbIDEProject kbGrpDSVB kbDSupport
Last Modified: 01-APR-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Professional Edition for Windows, version 6.0 
- Microsoft Visual Basic Enterprise Edition for Windows, version 6.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

If you use an add-in to change the name of a UserControl, an access violation
(AV) occurs. The error message is similar to the following:

  VB6.EXE - Application Error
  The instruction at "0x004075a9" referenced memory at "0x0000000c". The memory
  could not be "read".

Modifying the name of Projects, Modules, and Forms with an add-in does not cause
an Access Violation.

STATUS
======

Microsoft has confirmed this to be a bug in the Microsoft products listed at the
beginning of this article.

MORE INFORMATION
================

This appears to be an issue only when you load a project from a file and then
try to change the name of a UserControl in that project. The error message does
not occur if you create a new ActiveX Control Project and then change the name
of the UserControl.

Steps to Reproduce Behavior
---------------------------

1. Create a new Visual Basic add-in project.

2. Open the design window for the form frmAddin and replace the current code for
  the click event of the OKButton with the following:

  Dim oUserCtl As VBComponent
  Dim oProj As VBProject

  VBInstance.VBProjects.AddFromFile VBInstance.ActiveVBProject.FileName, True
  Set oProj = VBInstance.VBProjects.Item("Project1")
  Set oUserCtl = oProj.VBComponents("Usercontrol1")
  ' the following line causes the Access Violation:
  oUserCtl.Name = "CoolName"
  Unload Me

3. Compile the add-in DLL.

4. Start a new ActiveX Control project in Visual Basic.

5. On the File menu, choose Save Project, and then save the project files to a
  folder.

6. If it is not already loaded, load the add-in by using Add-In Manager. The
  name of the add-in should be My Addin.

7. On the Add-Ins menu, select My Addin.

8. Click OK, and note that an access violation occurs.

Additional query words: addin User ctl ctrl

======================================================================
Keywords          : kbCtrl kbCtrlCreate kbVBp kbVBp600bug kbIDEProject kbGrpDSVB kbDSupport 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB600Search kbVBA600 kbVB600
Version           : :6.0
Issue type        : kbbug
Solution Type     : kbpending

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>