<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q243045: XIMS: Internet Mail Service Reroutes Message Even Though the | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q243045: XIMS: Internet Mail Service Reroutes Message Even Though the" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/243/Q243045/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/243/Q243045/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q243045: XIMS: Internet Mail Service Reroutes Message Even Though the","url":"http://jeffpar.github.io/kbarchive/kb/243/Q243045/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q243045-xims-internet-mail-service-reroutes-message-even-though-the">Q243045: XIMS: Internet Mail Service Reroutes Message Even Though the</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q243045
Product(s): Microsoft Exchange
Version(s): winnt:5.5 SP3
Operating System(s): 
Keyword(s): exc55sp3
Last Modified: 29-OCT-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, version 5.5 SP3 
-------------------------------------------------------------------------------


SYMPTOMS
========

When you configure the Microsoft Internet Mail Service for selective IP routing
by clicking to select the "Host and clients with these IP addresses" check box
under Routing Restrictions on the Routing tab of the Internet Mail Service
Properties page, and add host IP addresses and their subnet mask, the host or
client members of this range can route mail, which is the expected behavior.
However, if you then configure the Internet Mail service for no routing by
clicking to select the "Do not reroute incoming SMTP mail" check box on the
Routing tab of the Internet Mail Service Properties page, mail continues to be
routed if it is submitted by the same set of host or client members set during
the first configuration.

CAUSE
=====

When you switch back to the "Do not reroute incoming SMTP mail" option, the
values of the routing flags and routing restriction IP addresses are not removed
from the registry, which causes the behavior described in the "Symptoms"
section.

WORKAROUND
==========

To work around this problem:

1. In the Exchange Server Administrator program, open the Internet Mail Service
  Properties page.

2. Click the Routing tab, and enable rerouting by clicking to select the
  "Reroute incoming SMTP mail" check box.

3. Click the Routing Restrictions button, and remove all the IP addresses.

4. Click OK, and disable routing again by clicking to select the "Do not reroute
  SMTP mail" check box.

5. Restart the Internet Mail Service.

After the address is removed from Routing Restrictions, relaying is prohibited if
you test by using Telnet as mentioned in the "More Information" section.

STATUS
======

Microsoft has confirmed this to be a problem in Microsoft Exchange Server
Version 5.5 Service Pack 3.


MORE INFORMATION
================

Steps to Reproduce the Problem
------------------------------

1. Install Exchange Server 5.5 SP3 with the Internet Mail Service.

2. On the Routing tab of Internet Mail Service Properties page, click to select
  the "Reroute incoming SMTP mail" option.

3. On the Routing Restrictions tab, click to select the "Hosts and clients with
  these IP addresses" check box. Click Add, and type the IP address of a test
  client and subnet mask.

4. Apply the changes, and restart the Internet Mail Service.

5. Telnet to the Internet Mail Service from a test client whose IP you used for
  a restriction in step 3. In the Telnet window, type:

  MAIL FROM:test@test.com
  RCPT TO:anyuser@bogusaddress.com

It should reply with:

  250 OK
  quit

6. Telnet to the Internet Mail Service from another IP address, and attempt to
  use the same SMTP commands as in step 5. You should get a "relaying
  prohibited" error.

7. Return to the Internet Mail Service Properties page, click to select the "Do
  not reroute incoming SMTP mail" check box, and then cycle the Internet Mail
  Service.

8. Attempt to use the commands in step 5 again.

Relaying is successful even though the "Do not reroute incoming SMTP mail" check
box is selected.

Additional query words:

======================================================================
Keywords          : exc55sp3 
Component         : Admin IMS
Technology        : kbExchangeSearch kbZNotKeyword2 kbExchange550SP3
Version           : winnt:5.5 SP3
Issue type        : kbprb
Solution Type     : kbpending

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>