<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q301505: XADM: Directory Service Doesn’t Start, Event Log Error -510 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q301505: XADM: Directory Service Doesn’t Start, Event Log Error -510" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/301/Q301505/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/301/Q301505/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q301505: XADM: Directory Service Doesn’t Start, Event Log Error -510","url":"http://jeffpar.github.io/kbarchive/kb/301/Q301505/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q301505-xadm-directory-service-doesnt-start-event-log-error--510">Q301505: XADM: Directory Service Doesn’t Start, Event Log Error -510</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q301505
Product(s): Microsoft Exchange
Version(s): 5.5
Operating System(s): 
Keyword(s): 
Last Modified: 11-JUL-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange 2000 Server 
- Microsoft Exchange Server, version 5.5 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you attempt to start the directory service, a pop-up window reports the
following error:

  Could not start the Microsoft Exchange Directory service on \\SERVERNAME
  Error 2140: An internal Windows NT error occurred.

The event log shows the following events:

Event ID: 109
Source: ESE97
Type: Information
MSExchangeDS (988) the database engine is replaying log file
R:\LogFiles\DSAData\edb.log.

Event ID: 110
Source: ESE97
Type: Information
MSExchangeDS (988) the database engine has successfully completed recovery
steps.

Event ID: 0
Source: ESE97
Type: Information
MSExchangeDS (988) -510

Event ID: 1166
Source: ESE97
Type: Information
Error -510 has occurred (internal ID 2030148). Contact Microsoft Technical
Support for assistance.

Event ID: 1002
Source: ESE97
Type: Information
The Microsoft Exchange Server database (EDB) could not be initialized and
returned error -510. Unrecoverable error, the directory can't continue.

CAUSE
=====

Error -510 corresponds to JET_errLogWriteFail. The error can be caused by a
corrupted Edb.log file.

WORKAROUND
==========

To work around this issue, follow these steps:

1. Backup your current database.

2. Check whether Dir.edb is consistent by using eseutil /mh.

3. Do one of the following:

   - If Dir.edb is consistent, remove all log files and start the directory
     service.

     -or-

   - If Dir.edb is inconsistent, restore from backup.

4. When you restore from Online Backup, replay only transaction logs older than
  the corrupted one.

5. When you restore from Offline Backup, empty the database and transaction log
  directories and restore only Dir.edb.

Additional query words: exch2kp2w

======================================================================
Keywords          :  
Technology        : kbExchangeSearch kbExchange550 kbZNotKeyword2 kbExchange2000Search kbExchange2000Serv
Version           : :5.5
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>