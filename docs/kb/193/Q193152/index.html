<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q193152: Preserving Virtual Directories and Servers During Uninstall | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q193152: Preserving Virtual Directories and Servers During Uninstall" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/193/Q193152/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/193/Q193152/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q193152: Preserving Virtual Directories and Servers During Uninstall","url":"http://jeffpar.github.io/kbarchive/kb/193/Q193152/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q193152-preserving-virtual-directories-and-servers-during-uninstall">Q193152: Preserving Virtual Directories and Servers During Uninstall</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q193152
Product(s): Internet Information Server
Version(s): winnt:4.0
Operating System(s): 
Keyword(s): 
Last Modified: 11-JUN-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Server version 4.0 
-------------------------------------------------------------------------------

SUMMARY
=======

It may be necessary to uninstall and reinstall Internet Information Server
(IIS). If there are directory mappings to virtual servers, these mappings will
be lost during the uninstall process unless the following steps are followed.

MORE INFORMATION
================

To create a backup of the IIS 4.0 metabase, perform the following steps:

1. Open the Microsoft Management Console (MMC).

2. Expand the Internet Information Server snap-in under Console Root.

3. Right-click on the name of your computer.

4. Select the Backup/Restore Configuration option. This will display a dialog
  box that allows you to make a backup of the entire IIS 4.0 metabase for that
  computer.

5. After you back up the metabase, close the MMC.

6. When you are prompted to save the settings in the Iis.msc file, click Yes.

7. In Windows NT Explorer, copy the &lt;%System_Root%&gt;\System32\Inetsrv
  folder to a disk or another drive partition.

To view and confirm settings for virtual servers, you can use the MetaEdit
utility that comes with the IIS 4.0 Resource Kit.

IMPORTANT: Some of the instructions below regard the use of MetaEdit, which is
found on the IIS 4.0 Resource Kit. Microsoft Product Support Services is unable
to provide support for MetaEdit at this time.

To view virtual directories in the IIS 4.0 metabase, start MetaEdit and expand
the folder for LM\W3SVC. In the directory tree below, you will see folders
numbered 1, 2, and possibly 3 and beyond. Sites 1 and 2 are created by IIS Setup
for the default and administrative Web sites, respectively. Subsequent folders
are mapped to virtual servers created by the user, assigned in the order in
which they were created. For example:

  1
  (Default Site Settings)
     virtual directories

  2
  (Admin Site Settings)
      virtual directories

  3
  (Added Virtual Server Settings)
     virtual directories

  and so on.

FTP virtual servers are mapped similarly. For example:

  LM\MSFTPSVC\ 
     1
     (default FTP site)
        virtual directories
     2
     (Added FTP Server Settings)
        virtual directories

For additional information, please see the following article in the Microsoft
Knowledge Base:

  Q185383 : How to Remove and Reinstall IIS 4.0

Additional query words:

======================================================================
Keywords          :  
Technology        : kbiisSearch kbiis400
Version           : winnt:4.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>