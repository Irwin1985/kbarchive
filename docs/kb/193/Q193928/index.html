<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q193928: XCON:Internet Mail Service Won’t Start - Event ID 4007 &amp; 4020 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q193928: XCON:Internet Mail Service Won’t Start - Event ID 4007 &amp; 4020" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/193/Q193928/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/193/Q193928/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q193928: XCON:Internet Mail Service Won’t Start - Event ID 4007 &amp; 4020","url":"http://jeffpar.github.io/kbarchive/kb/193/Q193928/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q193928-xconinternet-mail-service-wont-start---event-id-4007--4020">Q193928: XCON:Internet Mail Service Won’t Start - Event ID 4007 &amp; 4020</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q193928
Product(s): Microsoft Exchange
Version(s): winnt:5.0,5.5
Operating System(s): 
Keyword(s): 
Last Modified: 06-AUG-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, versions 5.0, 5.5 
-------------------------------------------------------------------------------

SYMPTOMS
========

The Internet Mail Service does not start, and the following error messages are
displayed:

  Error 2140: An Internal Windows NT error

  Event ID: 4007
  Source: MSExchangeIMC
  Description: The following error occurred while trying to bind the TCP/IP
  listener socket (10050)

  Event ID: 4020
  Source: MSExchangeIMC
  Description: Unable to start service because Winsock could not be initialized.

WORKAROUND
==========

These error messages can be generated by one of the following scenarios, and
corrected by the instructions provided with each scenario.

Scenario A:

After the Exchange Server computer has been configured as a proxy client, within
the Mspclnt.ini file, there is a section called [Servers IP Address], with the
following entry:

  Name = &lt;NetBIOS name&gt;

When this entry is changed to the IP Address of the proxy server, the Internet
Mail Service will start.

NOTE: The problem is that once the computer is restarted, the Mspclnt.ini entry
reverts back to the NetBIOS name. To stop this from happening, a setting on the
proxy server needs to be reconfigured to use the IP address instead of the
NetBIOS name. Follow these steps:

1. Open Internet Service Manager.

2. Open the Properties for Web Proxy, Winsock Proxy, or Socks Proxy.

  (NOTE: They are all linked).

3. Select the Services tab.

4. Select Client Configuration.

5. Select the IP Address option.

6. Click OK.

7. Click OK.

8. Stop all three proxies (mentioned in step 2), restart them, and then Goto
  client.

9. In the WSP client in Control Panel, click Update.

Scenario B:

If you are connecting through any firewall besides Microsoft Proxy Server, make
sure that the Microsoft Proxy client is disabled.

Scenario C:

Check on the Proxy 2 server for the existence of the SMTP Windows NT Option Pack
service that comes with the Windows NT 4.0 Options Pack. If the service is
installed, do the following:

1. Click Start, point to Settings, click Control Panel, and then double-click
  Services.

2. Change the Microsoft SMTP service to manual.

3. Stop the Windows NT Option Pack service.

After the SMTP Windows NT Option Pack service has been stopped, the Internet Mail
Service will run.

Scenario D:

Try to Ping the Proxy server by name. If you cannot, do the following:

1. Map a drive to the Proxy server.

2. Go to the Winnt\System32\Drivers\Etc directory, and edit the host file.

3. Type the internal IP of the Proxy server, tab over once, type the server
  name, and press ENTER. You should be able to ping the Proxy server at this
  point.

Additional query words:

======================================================================
Keywords          :  
Technology        : kbExchangeSearch kbExchange500 kbExchange550 kbZNotKeyword2
Version           : winnt:5.0,5.5
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>