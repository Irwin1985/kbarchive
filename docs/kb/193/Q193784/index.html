<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q193784: PCM &quot;Execute&quot; Button Unavailable or Dimmed | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q193784: PCM &quot;Execute&quot; Button Unavailable or Dimmed" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/193/Q193784/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/193/Q193784/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q193784: PCM &quot;Execute&quot; Button Unavailable or Dimmed","url":"http://jeffpar.github.io/kbarchive/kb/193/Q193784/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q193784-pcm-execute-button-unavailable-or-dimmed">Q193784: PCM "Execute" Button Unavailable or Dimmed</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q193784
Product(s): Microsoft Systems Management Server
Version(s): 1.2 SP4
Operating System(s): 
Keyword(s): kbPCM smspcm
Last Modified: 20-MAY-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Systems Management Server version 1.2 SP4 
-------------------------------------------------------------------------------

SYMPTOMS
========

If a "Run Command on Workstation" job is run through Package Command Manager
(PCM) and the package for the job was created from a .pdf file that contains
"SynchronousSystemExitRequired", PCM may stop in a state where the Execute
button is unavailable or dimmed. The PCM log will show that the job is
continuing indefinitely. Subsequent jobs sent to the computer will also have the
Execute button unavailable, and also will not run.

Viewing the Pcmwin.log file in smstrace reveals that the log is continuously
filling up with messages similar to the following:

     [09/28/98 18:21:05] Package Command Manager ==&gt; The running process
     handle is 0
     [09/28/98 18:21:05] Package Command Manager ==&gt; A job is not in process.
     [09/28/98 18:21:07] Package Command Manager ==&gt; Monitoring running job.
     [09/28/98 18:21:07] Package Command Manager ==&gt; The running process
     handle is 0
     [09/28/98 18:21:07] Package Command Manager ==&gt; A job is not in process.
     [09/28/98 18:21:09] Package Command Manager ==&gt; Monitoring running job.
     [09/28/98 18:21:09] Package Command Manager ==&gt; The running process
     handle is 0
     [09/28/98 18:21:09] Package Command Manager ==&gt; A job is not in process.

If the job is run by using the Package Command Manager service, the job may
appear to finish successfully but subsequent jobs may not run and the Pacman.log
file may show entries similar to:

  Job still running............~   $$&lt;SMS_PACKAGE_COMMAND_MANAGER_NT&gt;&lt;Tue Nov 10 17:56:25 1998~&gt;&lt;thread=112&gt;
  Job still running............~   $$&lt;SMS_PACKAGE_COMMAND_MANAGER_NT&gt;&lt;Tue Nov 10 17:56:27 1998~&gt;&lt;thread=112&gt;
  Job still running............~   $$&lt;SMS_PACKAGE_COMMAND_MANAGER_NT&gt;&lt;Tue Nov 10 17:56:29 1998~&gt;&lt;thread=112&gt;
  Job still running............~   $$&lt;SMS_PACKAGE_COMMAND_MANAGER_NT&gt;&lt;Tue Nov 10 17:56:31 1998~&gt;&lt;thread=112&gt;
  Job still running............~   $$&lt;SMS_PACKAGE_COMMAND_MANAGER_NT&gt;&lt;Tue Nov 10 17:56:33 1998~&gt;&lt;thread=112&gt;

CAUSE
=====

This problem only occurs if the .pdf file used to create the package contains
"SynchronousSystemExitRequired".

RESOLUTION
==========

A supported fix that corrects this problem is now available from Microsoft, but
has not been fully regression tested and should be applied only to systems
experiencing this specific problem. If you are not severely affected by this
specific problem, Microsoft recommends that you wait for the next Systems
Management Server service pack that contains this fix.

To resolve this problem immediately, contact Microsoft Product Support Services
to obtain the fix. For a complete list of Microsoft Product Support Services
phone numbers and information on support costs, please go to the following
address on the World Wide Web:

  http://support.microsoft.com/default.aspx?scid=fh;EN-US;CNTACTMS

The English version of this fix should have the following file attributes or
later:

  Date       Time       Size     File name    Platform
  ----------------------------------------------------
  9/21/98    6:50pm     442 KB   Pcmwin16.exe (x86)
  9/21/98    6:50pm     455 KB   Pcmwin32.exe (x86)
  9/24/98   10:54am     260 KB   Pcmsvc32.exe (x86)

  9/21/98    6:50pm   1,142 KB   Pcmwin32.exe (Alpha)
  9/24/98   10:53am     776 KB   Pcmsvc32.exe (Alpha)


WORKAROUND
==========

To work around this problem, try any of the following:

- Remove the SynchronousSystemExitRequired from the PDF.

  -or-

- Use the PCM from Systems Management Server Service Pack 3.

  -or-

- Make the job mandatory.

STATUS
======

Microsoft has confirmed this to be a problem in Systems Management Server
version 1.2 Service Pack 4.

MORE INFORMATION
================

To install the hotfix, perform the following steps on the Systems Management
Server site server:

1. Replace the Pcmwin32.exe file in the
  &lt;SMS_root_directory&gt;\Site.srv\Maincfg.box\Client.src\&lt;Platform&gt;.bin
  directory with the hotfixed version.

2. Replace the Pcmwin16.exe file in the
  &lt;SMS_root_directory&gt;\Site.srv\Maincfg.box\Client.src\X86.bin directory
  with the hotfixed version.

3. Maintenance manager will replicate the new Pcmwin16.exe and Pcmwin32.exe
  files to the Logon.srv\&lt;Platform&gt;.bin directory on the Systems
  Management Server logon servers during its next work cycle. After that
  occurs, you can update the clients.

  To update the clients, either manually run Upgrade.bat on each client, or
  follow the instructions in the following article in the Microsoft Knowledge
  Base:

  Q166771 SMS: How to Force Site-Wide Client Updates

4. Replace the Pcmsvc32.exe file in the
  &lt;SMS_root_directory&gt;\Site.srv\&lt;platform&gt;.bin with the hotfixed
  version. After Systems Management Server has completed a work cycle and has
  updated the Pcmsvc32.exe file on all Systems Management Server member
  servers, restart the Systems Management Server member servers or stop and
  start the SMS_PACKAGE_COMMAND_MANAGER_NT service, to ensure that the service
  is running with the newly updated version of Pcmsvc32.exe.

5. To distribute the new version of Pcmsvc32.exe to non-Systems Management
  Server member servers and workstations, use the Rservice utility. For
  instructions on how to use the Rservice utility, read the Install.doc file
  that is included with Microsoft Systems Management Server 1.2 Service Pack 4
  in the Support\Pcmsvc32 directory.

Additional query words: prodsms dim gray grey greyed grayed out freeze hang

======================================================================
Keywords          : kbPCM smspcm 
Technology        : kbSMSSearch kbSMS120SP4
Version           : :1.2 SP4
Issue type        : kbprb
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>