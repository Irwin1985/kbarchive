<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q193926: XFOR: TURFDIR Must Be Manually Created for Message Filtering | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q193926: XFOR: TURFDIR Must Be Manually Created for Message Filtering" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/193/Q193926/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/193/Q193926/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q193926: XFOR: TURFDIR Must Be Manually Created for Message Filtering","url":"http://jeffpar.github.io/kbarchive/kb/193/Q193926/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q193926-xfor-turfdir-must-be-manually-created-for-message-filtering">Q193926: XFOR: TURFDIR Must Be Manually Created for Message Filtering</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q193926
Product(s): Microsoft Exchange
Version(s): 5.5
Operating System(s): 
Keyword(s): 
Last Modified: 11-JUN-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, version 5.5 
-------------------------------------------------------------------------------


IMPORTANT: This article contains information about modifying the registry. Before you modify the registry, make sure to back it up and make sure that you understand how to restore the registry if a problem occurs. For information about how to back up, restore, and edit the registry, click the following article number to view the article in the Microsoft Knowledge Base:

  Q256986 Description of the Microsoft Windows Registry

SYMPTOMS
========

When using the message filtering option on the Microsoft Exchange Server
Internet Mail Service, the default option is to delete the filtered messages.
This can be changed to send the messages to a "turf" directory. However, when
the option to save the filtered messages is selected, the Exchange Server
administrator will notice that the messages are not being saved. The following
event will be recorded in the Windows NT Application Log:

  Event ID 4192      MSExchangeIMC        Message Transfer
  Delivery of a message was aborted because it appeared to be an
  impersonation attempt or unwanted bulk mail. The 821 originator was
  joes@spam.net. Either this address or the 822 message triggered this
  based on TurfTable entries  in the registry. The message that caused
  this was PBF3S5YB. This message will not be delivered. It will be copied
  to \turfdir.

CAUSE
=====

The reason for this behavior is that by default the turf directory is set to
\Turfdir in the registry. This directory is not created by the Microsoft
Exchange Server setup process.

WORKAROUND
==========

WARNING: If you use Registry Editor incorrectly, you may cause serious problems
that may require you to reinstall your operating system. Microsoft cannot
guarantee that you can solve problems that result from using Registry Editor
incorrectly. Use Registry Editor at your own risk.

- Create a directory called Turfdir in the root of the hard disk that holds the
  Exchange system files. This should allow the messages to be copied to that
  directory.

  - or -

- Create a directory elsewhere, and change the registry to point to the path of
  this new directory. You can accomplish this by performing the following
  steps:

1. Start Registry Editor (Regedt32.exe).

2. Locate the TURFDIR value under the following key in the registry:

  HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\MSExchangeIMC
  \Parameters\

  NOTE: The above registry key is one path; it has been wrapped for readability.

3. Highlight the TURFDIR value and on the Edit menu, select String. Change the
  string to reflect the desired path. Add the drive letter if a drive other
  then C is desired.

4. Quit Registry Editor.

Additional query words: imc spam bulk junk turftable

======================================================================
Keywords          :  
Technology        : kbExchangeSearch kbExchange550 kbZNotKeyword2
Version           : :5.5
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>