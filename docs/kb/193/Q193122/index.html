<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q193122: XFOR: 0-Byte Message or Print Spool File Causes VM2DIA to Stop | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q193122: XFOR: 0-Byte Message or Print Spool File Causes VM2DIA to Stop" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/193/Q193122/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/193/Q193122/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q193122: XFOR: 0-Byte Message or Print Spool File Causes VM2DIA to Stop","url":"http://jeffpar.github.io/kbarchive/kb/193/Q193122/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q193122-xfor-0-byte-message-or-print-spool-file-causes-vm2dia-to-stop">Q193122: XFOR: 0-Byte Message or Print Spool File Causes VM2DIA to Stop</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q193122
Product(s): Microsoft Exchange
Version(s): 3.2
Operating System(s): 
Keyword(s): 
Last Modified: 20-MAY-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- LinkAge Message Exchange, version 3.2 
-------------------------------------------------------------------------------


SYMPTOMS
========

Messages may stop flowing from Exchange to a PROFS system through the OV/VM
LinkAge 3.2 connector. A zero-byte message or a print spool file, sent from the
PROFS system, may cause the VM2DIA process to stop. This, in turn, causes the
connector to stop processing all inbound messages until the user manually
removes the problem message from the queue.

One or more of the following event errors may be logged in the Exchange event
viewer log:

- Event ID 23853

- Event ID 23923 (Peeking the NJE data record has failed.)

- Event ID 40507, 40517, and 40512 (The RSCS fails in vm2dia.c.)

- Event ID 40003 (Transform terminated.)

- Event ID 23179 (SYSOUT_INBOUND has failed.)

- Event ID 23106

- Event ID 40501

- Event ID 4065 (Critical error when attempting to process an inbound item.)

- Event ID 62302

The following errors will be recorded in the LinkAge browser log:

- LME-PROFS-VMDIA(0124) 4 23713:DATA SET HEADER record received &gt;&gt;
  rscsclnt(802)

- LME-PROFS-VMDIA(0124) 4 23919:No more data set header received &gt;&gt;
  rscsclnt(769)

- LME-PROFS-VMDIA(0124) 1 23853:Buffer of size 80 is too small for an NJE
  record; it must be at least 132 bytes in size &gt;&gt; njeclnt(806)

- LME-PROFS-VMDIA(0124) 1 23923:Error occurred when peeking on an NJE data
  record from the NJE server &gt;&gt; rscsclnt(955)

- LME-PROFS-VMDIA(0124) 1 40507:RSCS client failed to peek record &gt;&gt;
  vm2dia(1613)

- LME-PROFS-VMDIA(0124) 1 40517:Failed to identify the contents of the OV/VM
  data stream &gt;&gt; vm2dia(1496)

- LME-PROFS-VMDIA(0124) 1 40512:Failed to parse the OV/VM distribution &gt;&gt;
  vm2dia(1522)

- LME-PROFS-VMDIA(0124) 1 40003:Transform has terminated with an error &gt;&gt;
  vm2dia(1167)

- LME-PROFS-VMDIA(0124) 3 00505:LME-PROFS-VMDIA is ending, last return code was
  {Successful} &gt;&gt; stdmain(953)

- LME-PROFS-VMDIA(0124) 4 40627:Terminating the RSCS client &gt;&gt;
  vm2dia(783)

- LME-PROFS-VMDIA(0124) 4 40584:Closed OV/VM note string table &gt;&gt;
  vmsvc(246)

- LME-PROFS-VMDIA(0124) 4 04101:Queue Manager successfully terminated &gt;&gt;
  qm(754)

- LME-PROFS-VMDIA(0124) 2 44001:OV/VM-DIA Transform terminated successfully
  &gt;&gt; vm2dia(865)

- LME-PROFS-DIAVM(01d5) 2 23834:Named pipe to server has been disconnected. NJE
  Client is shutting down &gt;&gt; njeclnt(2456)

- LME-PROFS-DIAVM(01d5) 1 23929:Error occurred while deallocating a session
  normally &gt;&gt; rscsclnt(634)

- LME-PROFS-DIAVM(01d5) 1 40508:RSCS client failed to deallocate a session for
  the outbound distribution &gt;&gt; dia2vm(5382)

- LME-PROFS-DIAVM(01d5) 2 23834:Named pipe to server has been disconnected. NJE
  Client is shutting down &gt;&gt; njeclnt(2456)

- LME-PROFS-DIAVM(01d5) 1 23928:Error occurred while deallocating a session
  abnormally &gt;&gt; rscsclnt(629)

- LME-PROFS-DIAVM(01d5) 1 40508:RSCS client failed to deallocate a session for
  the outbound distribution &gt;&gt; dia2vm(5406)

CAUSE
=====

A message in the PROFS environment, located in the Exchange-bound queue and
listed with a 0-byte length, does not match the expected record length in bytes
in the linked list element. The program then pads the difference, and the buffer
size is too small, generating a 23853 and then fails peeking the NJE data record
with a 23923. The RSCS fails parsing the OV/VM distribution and log. After the
failure, the system attempts an outbound session and generates a 40501, causing
the subsystem load to fail and generating a critical error 4065. The Directory
Exchange Manager (DXM) mainline processing function fails, being unable to
return an error code to the PROFS system, which leaves the bad message in the
queue.


Note that this problem also occurs when a print spool file is sent from the OV
environment in an MVS system through a JES3 (Job Entry System3) connection to
the VM system and then routed to the PROFS connector.

RESOLUTION
==========

A supported fix that corrects this problem is now available from Microsoft, but
has not been fully regression-tested and should be applied only to systems
experiencing this specific problem. If you are not severely affected by this
specific problem, Microsoft recommends that you wait for the next service pack
that contains this fix.

To resolve this problem immediately, contact Microsoft Product Support Services
to obtain the fix. For a complete list of Microsoft Product Support Services
phone numbers and information on support costs, please go to the following
address on the World Wide Web:

  http://support.microsoft.com/default.aspx?scid=fh;EN-US;CNTACTMS

The English version of this fix should have the following file attributes or
later:

  File Name     Date
  ---------------------
  Lsvmdia.exe   3/13/98


STATUS
======

Microsoft has confirmed this to be a problem in LinkAge Message Exchange version
3.2.
======================================================================
Keywords          :  
Technology        : kbZNotKeyword6 kbExchangeSearch kbLinkAgeSearch kbLinkAge320
Version           : 3.2
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>