<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q193174: PRB: Filename Must Contain Text Error Msg When Packaging Project | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q193174: PRB: Filename Must Contain Text Error Msg When Packaging Project" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/193/Q193174/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/193/Q193174/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q193174: PRB: Filename Must Contain Text Error Msg When Packaging Project","url":"http://jeffpar.github.io/kbarchive/kb/193/Q193174/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q193174-prb-filename-must-contain-text-error-msg-when-packaging-project">Q193174: PRB: Filename Must Contain Text Error Msg When Packaging Project</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q193174
Product(s): Microsoft Visual Basic for Windows
Version(s): WINDOWS:6.0
Operating System(s): 
Keyword(s): kberrmsg kbwizard kbAppSetup kbVBp kbVBp600 kbGrpDSVB kbDSupport
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Professional Edition for Windows, version 6.0 
- Microsoft Visual Basic Enterprise Edition for Windows, version 6.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When attempting to use the Package and Deployment Wizard (PDW) to package an
ActiveX DLL/EXE project, the following error is received:

  Filename must contain text

This occurs when the ActiveX DLL/EXE project is part of a project group that
contains and references a UserControl project, and the projects are saved before
being compiled.

CAUSE
=====

The PDW reads all of the objects and references out of the VBP file. When you
compile the control only after saving both the ActiveX Control project and the
ActiveX DLL/EXE project, the latter's VBP does not reflect the current state of
the referenced control and is therefore invalid. When you open the VBP in
Notepad, note that the reference to the control is:

Object=*\A[Name of Control Project].vbp

However, if you choose to save the projects, the correct reference is saved:

Object={GUID}#version#version; [Name of Control Project].ocx

When the PDW fails to parse correctly in the first case, it tries to add a file
named "" to make up for the name of the compiled OCX. This results in the above
error.

RESOLUTION
==========

To update the VBP file with correct references, save both projects before using
the PDW to package them.

STATUS
======

This behavior is by design.

MORE INFORMATION
================

Steps to Reproduce Behavior
---------------------------

1. Create a new ActiveX DLL in Visual Basic. Class1 is created by default.

2. In Project Explorer, right-click Class1 and select Remove Class1.

3. Add a User Document (UserDocument1) to Project1.

4. Add an ActiveX Control project (Project2). UserControl1 is created by
  default.

5. Close the designer of UserControl1. The control becomes visible in the
  toolbar. Place an instance of the control on UserDocument1 of Project1.

6. Save the projects in the project group by selecting Save Project Group under
  the File menu. Accept the default location suggested by Visual Basic.

7. Click on Project2 and select Make Project2.ocx under the File menu.

8. Click on Project1 and select Make Project1.dll under the File menu.

9. Select Add-In Manager under Add-Ins and select Package and Deployment Wizard
  (PDW) to load it.

10. Select Project1 and start the PDW by selecting it from the Add-Ins menu.

11. Choose No when asked to save the projects before packaging, and then select
  Package.

Note that the following error occurs and further attempts to package the project
result in the same error:

  Filename must contain text

Additional query words:

======================================================================
Keywords          : kberrmsg kbwizard kbAppSetup kbVBp kbVBp600 kbGrpDSVB kbDSupport 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB600Search kbVBA600 kbVB600
Version           : WINDOWS:6.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>