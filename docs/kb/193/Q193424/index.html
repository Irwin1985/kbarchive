<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q193424: BUG: Excel 97 Menus Fail with In-Place Activation from MDI Child | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q193424: BUG: Excel 97 Menus Fail with In-Place Activation from MDI Child" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/193/Q193424/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/193/Q193424/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q193424: BUG: Excel 97 Menus Fail with In-Place Activation from MDI Child","url":"http://jeffpar.github.io/kbarchive/kb/193/Q193424/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q193424-bug-excel-97-menus-fail-with-in-place-activation-from-mdi-child">Q193424: BUG: Excel 97 Menus Fail with In-Place Activation from MDI Child</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q193424
Product(s): Microsoft Visual Basic for Windows
Version(s): WINDOWS:5.0,6.0,97
Operating System(s): 
Keyword(s): kbGrpDSVB
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Learning Edition for Windows, versions 5.0, 6.0 
- Microsoft Visual Basic Professional Edition for Windows, versions 5.0, 6.0 
- Microsoft Visual Basic Enterprise Edition for Windows, versions 5.0, 6.0 
- Microsoft Excel 97 for Windows 
-------------------------------------------------------------------------------

SYMPTOMS
========

When Excel worksheets are used as embedded objects on MDI Child forms in Visual
Basic, the Excel menus that appear for in-place activation will either not
respond or will generate an Invalid Page Fault when selected.

STATUS
======

Microsoft has confirmed this to be a bug in the Microsoft products listed at the
beginning of this article.

MORE INFORMATION
================

Steps to Reproduce Behavior
---------------------------

There are two ways to reproduce the problem. The first method is to use the
Olecont.vbp sample shipped with Visual Basic 5.0. If you only have Visual Basic
6.0 installed, use the second method.

Method 1: Use the Olecont.vbp Sample
------------------------------------

1. Start Visual Basic and open the sample project Olecont.vbp. By default this
  project is located in the following folder:

  Program Files\DevStudio\VB\Samples\PGuide\olecont

2. Press the F5 key to run the project.

3. Select New from the File menu.

4. In the Insert Object DialogBox, select Create New and "Microsoft Excel
  Worksheet" under Object Type.

5. Repeat steps 3 and 4 so that you have two MDI children with embedded
  worksheets.

6. Put some data in some cells on both worksheets.

7. Select a cell on the 2nd worksheet. From the Edit menu, select Clear and then
  All.

8. Repeat step 7 with the first worksheet. The menu commands do not react and
  cells are not cleared. If you choose some other menu items, they are either
  ignored or cause an IPF and shut down the program.

Method 2: Create New Standard EXE Project
-----------------------------------------

1. Create a Standard EXE project in Visual Basic. Form1 is created default.

2. Set Form1's MDIChild property to True.

3. Place an instance of the OLE control on Form1. In the Insert Object
  DialogBox, select Create New and "Microsoft Excel Worksheet" under Object
  Type.

4. Add a new form (Form2) and repeat steps 2 and 3 for Form2.

5. Add an MDIForm (MDIForm1) to the project and paste the following code in to
  MDIForm1:

        Private Sub MDIForm_Load()
           form1.show
           form2.show
        End Sub

6. Select Project1 Properties from the Project menu and set the Startup Object
  as MDIForm1.

7. Press the F5 key to run the project.

8. Double-click in Worksheet on Form2 and enter some numbers in some cells.

9. Repeat step 8 for Form1.

10. Switch back to Form2 and, from the Edit menu, select Clear and then select
  All.

11. Repeat step 10 for Form1. On one of the forms, the command works but on the
  other form, the command fails to respond.

REFERENCES
==========

For additional information, please see the following article in the Microsoft
Knowledge Base:

  Q191615 BUG: Menu Disabled in Application Activated Using OLE Control


Additional query words: kbdss kbDSupport kbVBp kbVBp500bug kbVBp600bug kbActiveX kbExcel kbOLE

======================================================================
Keywords          : kbGrpDSVB 
Technology        : kbVBSearch kbExcelSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB500Search kbVB600Search kbVBA500 kbVBA600 kbVB500 kbVB600 kbExcel97Search kbZNotKeyword3
Version           : WINDOWS:5.0,6.0,97
Issue type        : kbbug

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>