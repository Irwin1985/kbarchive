<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q150199: DOC: ThreadingModel Is Not a Subkey | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q150199: DOC: ThreadingModel Is Not a Subkey" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/150/Q150199/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/150/Q150199/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q150199: DOC: ThreadingModel Is Not a Subkey","url":"http://jeffpar.github.io/kbarchive/kb/150/Q150199/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q150199-doc-threadingmodel-is-not-a-subkey">Q150199: DOC: ThreadingModel Is Not a Subkey</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q150199
Product(s): Microsoft C Compiler
Version(s): 2.0,2.1,2.2,4.0,4.1,4.2
Operating System(s): 
Keyword(s): kbdocfix kbdocerr kbVC420fix
Last Modified: 14-NOV-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual C++, 32-bit Editions, versions 2.0, 2.1, 2.2, 4.0, 4.1 
- Microsoft Visual C++, 32-bit Enterprise Edition, version 4.2 
- Microsoft Visual C++, 32-bit Professional Edition, version 4.2 
-------------------------------------------------------------------------------

IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information about how to do this, view the "Restoring
the Registry" Help topic in Regedit.exe or the "Restoring a Registry Key"
Help topic in Regedt32.exe.

SUMMARY
=======

In the article "Processes and Threads" from the OLE Programmer's Reference,
paragraph 12 gives the following incorrect information:

  For thread-aware DLL-based or in-process objects, you need to set the
  threading model in the registry. The default model when you do not specify a
  threading model is single-thread-per-process. To specify a model, you add the
  ThreadingModel subkey to the InprocServer32 key in the registration database.

ThreadingModel is not a subkey; it is a named value.

This documentation error was fixed in the "Processes and Threads" article of the
Visual C++ 4.2 CD online OLE Programmer[ASCII 146]s reference. The text has been
modified as follows:

  For thread-aware DLL-based or in-process objects, you need to set the
  threading model in the registry. The default model when you do not specify a
  threading model is single-thread-per-process. To specify a model, you add the
  ThreadingModel named-value to the InprocServer32 key in the registration
  database.

MORE INFORMATION
================

To set the threading model, perform these steps:

1. Run Regedit in Windows 95, or run Regedt32 in Windows NT.

  WARNING: Using Registry Editor incorrectly can cause serious problems that may
  require you to reinstall your operating system. Microsoft cannot guarantee
  that problems resulting from the incorrect use of Registry Editor can be
  solved. Use Registry Editor at your own risk.

  For information about how to edit the registry, view the "Changing Keys And
  Values" Help topic in Registry Editor (Regedit.exe) or the "Add and Delete
  Information in the Registry" and "Edit Registry Data" Help topics in
  Regedt32.exe. Note that you should back up the registry before you edit it.
  If you are running Windows NT, you should also update your Emergency Repair
  Disk (ERD).

2. Choose the HKEY_CLASSES_ROOT folder, and then choose the CLSID folder.

3. Find the GUID for the object you want to enable with apartment-model
  threading. Then expand the object's folder.

4. Expand the InprocServer32 key.

5. From the Windows 95 Edit menu, select New. Then select String Value, and type
  ThreadingModel. Select the name just typed from the Edit menu, select Modify,
  and type Apartment for Value data.

  -or-

  From the Windows NT Edit menu, select Add Value. Type ThreadingModel for the
  Value Name. Click OK, and type Apartment for the String value.

Additional query words: kbVC400bug thread apartment

======================================================================
Keywords          : kbdocfix kbdocerr kbVC420fix 
Technology        : kbVCsearch kbVC400 kbAudDeveloper kbVC220 kbVC410 kbVC420 kbVC200 kbVC210 kbVC32bitSearch
Version           : :2.0,2.1,2.2,4.0,4.1,4.2
Issue type        : kbbug

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>