<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q325889: HOW TO: Remove and Reinstall IIS 5.0 and 5.1 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q325889: HOW TO: Remove and Reinstall IIS 5.0 and 5.1" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/325/Q325889/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/325/Q325889/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q325889: HOW TO: Remove and Reinstall IIS 5.0 and 5.1","url":"http://jeffpar.github.io/kbarchive/kb/325/Q325889/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q325889-how-to-remove-and-reinstall-iis-50-and-51">Q325889: HOW TO: Remove and Reinstall IIS 5.0 and 5.1</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q325889
Product(s): Internet Information Server
Version(s): 5.0
Operating System(s): 
Keyword(s): kbHOWTOmaster
Last Modified: 06-AUG-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Services version 5.0 
- Microsoft Internet Information Services version 5.1 
-------------------------------------------------------------------------------


IN THIS TASK
------------

- SUMMARY

   - Back Up the IIS Configuration
- Remove or Reinstall IIS
- Restore the IIS Configuration

   - Restore the IIS Configuration After an IIS Reinstallation
- Restore the IIS Configuration Without an IIS Reinstallation

- REFERENCES

SUMMARY
=======

This step-by-step article explains how to remove and reinstall Internet
Information Services (IIS) versions 5.0 and 5.1.

Back Up the IIS Configuration
-----------------------------

If you already have IIS 5.0 (which comes with Microsoft Windows 2000) or IIS 5.1
(which comes with Microsoft Windows XP Professional) installed and configured,
you may want to back up that configuration before you remove and reinstall IIS
so that you do not have to rebuild all of your Web sites from scratch if you
want to restore the configuration.

To back up your IIS configuration, follow these steps:

NOTE: This backup method restores only your IIS settings, not your content files.
This backup method does not work if you reinstall your operating system. Backup
files cannot be used to restore an IIS configuration on other computers that are
running Windows 2000.

1. Click Start, point to Programs, click Administrative Tools, and then click
  Internet Services Manager.

2. Expand &lt;Server Name&gt;.

3. For IIS 5.0:

  Click Action, and then click Backup/Restore Configuration.

  For IIS 5.1:

  Click Action, click All Tasks, and then click Backup/Restore Configuration.

4. Click Create backup, name your backup file, and then click OK.

  NOTE: If you are using Windows XP, you can also click to select Encrypt backup
  with Password, and then provide and confirm a password.

NOTE: The default location of the backup is the
%SystemRoot%\system32\inetsrv\MetaBack folder. By default, C:\Winnt is the
%SystemRoot% folder in Windows 2000 and C:\Windows is the %SystemRoot% folder in
Windows XP Professional. If you want to save your backup file to another
location, you can copy the file from this default location to another location.
Keep a copy in the default location to allow for an easy restoration.

5. Click Close.

6. Use your regular backup program software to back up your content files for
  your Web sites.

Remove or Reinstall IIS
-----------------------

To remove, install, or reinstall IIS 5.0 or 5.1, follow these steps:

1. In Control Panel, double-click Add/Remove Programs.

2. In the Add/Remove Programs window, click Add/Remove Windows Components.

3. In the Components box of the Windows Components Wizard, locate Internet
  Information Services (IIS). To install IIS, click to select this check box;
  to remove IIS, click to clear this check box.

4. In the Windows Components Wizard, click Next.

5. When the Windows Components Wizard completes the installation, click Finish.

Restore the IIS Configuration
-----------------------------

The steps to restore a configuration differ depending on whether you removed and
reinstalled IIS.

NOTE: If you want to restore your IIS configuration and only an older copy or no
copy of the metabase file exists, you must follow a different procedure. For
additional information, click the article number below to view the article in
the Microsoft Knowledge Base:

  Q234429 How to Manually Restore the Metabase When No Proper Backup Exists or
  When the MMC Does Not Start

Restore the IIS Configuration After an IIS Reinstallation:

To restore your IIS configuration after you have removed and reinstalled IIS,
follow these steps:

1. Use your regular backup program software to restore your content files for
  your Web sites.

2. Click Start, point to Programs, click Administrative Tools, and then click
  Internet Services Manager.

3. Expand &lt;Server Name&gt;.

4. For IIS 5.0:

  Click Action, and then click Backup/Restore Configuration.

  For IIS 5.1:

  Click Action, click All Tasks, and then click Backup/Restore Configuration.

5. In the Configuration Backup Name dialog box, select the backup file that you
  created, and then click Restore.

NOTE: If you are using Windows XP and you selected Encrypt backup with Password,
provide and confirm the password.
You may receive an error message that states that the restoration has failed, but
a portion of your backed-up configuration is restored. To resolve this error
message:

NOTE: Leave the Configuration Backup Dialog box open.

1. At a command prompt, type the following (where X is the letter of the drive
  on which IIS is installed), and then press ENTER:

  cscript.exe X:\InetPub\AdminScripts\Adsutil.vbs enum w3svc

NOTE: To use the Adsutil.vbs utility, you must have Windows Script Host
installed.

2. In the listed settings, locate the WamUserName value.

3. In Control Panel, double-click Administrative Tools, and then double-click
  Computer Management. Click Local Users and Groups, and then click Users.

4. Double-click the IWAM_computername user account. Type a password for this
  account, and then click OK.

5. At a command prompt, type the following (where X is the letter of the drive
  on which IIS is installed), and then press ENTER:

  cscript.exe X:\InetPub\AdminScripts\Synciwam.vbs

6. In the Configuration Backup Name dialog box, click to select the backup file
  that you created, and then click Restore. This fully restores your
  configuration.

  NOTE: If you change the identity of your out-of-process applications, those
  applications revert back to the previous IWAM user name.

Restore the IIS Configuration Without an IIS Reinstallation:

To restore your IIS configuration if you have not removed and reinstalled IIS,
follow these steps:

1. Click Start, point to Programs, click Administrative Tools, and then click
  Internet Services Manager.

2. Expand &lt;Server Name&gt;.

3. For IIS 5.0:

  Click Action, and then click Backup/Restore Configuration.

  For IIS 5.1:

  Click Action, select All Tasks, and then click Backup/Restore Configuration.

4. In the Configuration Backup Name dialog box, select the backup file that you
  created, and then click Restore.

NOTE: If you are using Windows XP and you selected Encrypt backup with Password,
provide and confirm the password.

5. When you are prompted to restore your configuration settings, click Yes.

REFERENCES
==========

For additional information, click the article number below to view the article
in the Microsoft Knowledge Base:

  Q302573 HOW TO: Back Up and Restore IIS

Additional query words: remove reinstall iis

======================================================================
Keywords          : kbHOWTOmaster 
Technology        : kbiisSearch kbiis500 kbiis510
Version           : :5.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>