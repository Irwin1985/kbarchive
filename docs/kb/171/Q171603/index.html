<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q171603: HOWTO: Get the Unread Message Count from an Outlook Folder | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q171603: HOWTO: Get the Unread Message Count from an Outlook Folder" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/171/Q171603/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/171/Q171603/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q171603: HOWTO: Get the Unread Message Count from an Outlook Folder","url":"http://jeffpar.github.io/kbarchive/kb/171/Q171603/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q171603-howto-get-the-unread-message-count-from-an-outlook-folder">Q171603: HOWTO: Get the Unread Message Count from an Outlook Folder</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q171603
Product(s): Microsoft Visual Basic for Windows
Version(s): WINDOWS:5.0,6.0,97
Operating System(s): 
Keyword(s): kbnokeyword kbVBp500 kbVBp600 kbGrpDSVBDB
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Control Creation Edition for Windows, versions 5.0, 6.0 
- Microsoft Visual Basic Learning Edition for Windows, versions 5.0, 6.0 
- Microsoft Visual Basic Professional Edition for Windows, versions 5.0, 6.0 
- Microsoft Visual Basic Enterprise Edition for Windows, versions 5.0, 6.0 
- Microsoft Outlook 97 
-------------------------------------------------------------------------------

SUMMARY
=======

The following code sample demonstrates how to determine the count of all unread
messages on a per folder basis for all folders grouped under a specified
Microsoft Outlook folder. The sample assumes that the Microsoft Outlook mail
client is installed.

MORE INFORMATION
================

The code below uses a recursive routine to iterate through a mail folder to
produce a list of all its sub-folders and a count of corresponding unread
messages. The data is then displayed in the Visual Basic Immediate Window. The
code takes advantage of the UnReadItemCount property of the Outlook MAPIFolder
object.

1. Open a Standard EXE project in Visual Basic.

2. Select References from the Project menu.

3. Select "Microsoft Outlook 8.0 Object Library" (msoutl8.olb), and click OK.

4. Select Project1 Properties on the Project menu and set the Startup Object to
  "Sub Main".

5. Select Add Module from the Project menu to add a module to the project.

6. Add the following sample code to Module1:

  NOTE: Modify the FOLDER_TO_OPEN constant as appropriate.

Sample Code
-----------

  Option Explicit

     Private Sub Main()
        Dim olMAPI As Outlook.NameSpace
        Dim Folder As Outlook.MAPIFolder
        Const FOLDER_TO_OPEN = "Mailbox - John Doe"   'Modify as appropriate

        Set olMAPI = GetObject("", "Outlook.Application") _
                                .GetNamespa   ce("MAPI")
        Call PrintFolderNames(olMAPI.Folders(FOLDER_TO_OPEN), "-&gt;")
        Set olMAPI = Nothing
     End Sub

     Sub PrintFolderNames(tempfolder As Outlook.MAPIFolder, a$)
        Dim i As Integer
        If tempfolder.Folders.Count Then
           Debug.Print a$ &amp; " " &amp; tempfolder.Name &amp; "  ";
           Debug.Print tempfolder.UnReadItemCount
           For i = 1 To tempfolder.Folders.Count
             Call PrintFolderNames(tempfolder.Folders(i), a$ &amp; "-&gt;")
           Next i
        Else
           Debug.Print a$ &amp; " " &amp; tempfolder.Name &amp; "  ";
           Debug.Print tempfolder.UnReadItemCount
        End If
     End Sub

7. Run the program.

RESULT: The unread message count for the folder FOLDER_TO_OPEN appears in the
Immediate Window.

Additional query words:

======================================================================
Keywords          : kbnokeyword kbVBp500 kbVBp600 kbGrpDSVBDB 
Technology        : kbVBSearch kbOutlookSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB500Search kbVB600Search kbVBA500Search kbVBA500 kbVBA600 kbVB500 kbVB600 kbOutlook97Search kbZNotKeyword3
Version           : WINDOWS:5.0,6.0,97
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>