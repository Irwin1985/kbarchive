<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q171816: FIX: IPF Opening or Saving Form with Tab Control | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q171816: FIX: IPF Opening or Saving Form with Tab Control" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/171/Q171816/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/171/Q171816/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q171816: FIX: IPF Opening or Saving Form with Tab Control","url":"http://jeffpar.github.io/kbarchive/kb/171/Q171816/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q171816-fix-ipf-opening-or-saving-form-with-tab-control">Q171816: FIX: IPF Opening or Saving Form with Tab Control</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q171816
Product(s): Microsoft Visual Basic for Windows
Version(s): WINDOWS:5.0
Operating System(s): 
Keyword(s): kbVBp500 kbVS97sp2fix kbGrpDSVB kbvbp500sp2fixkbbuglist kbfixlist
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Learning Edition for Windows, version 5.0 
- Microsoft Visual Basic Professional Edition for Windows, version 5.0 
- Microsoft Visual Basic Enterprise Edition for Windows, version 5.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

Attempting to open or save a form containing an SSTab control may cause Visual
Basic to terminate with one of the following errors:

  "VB5 caused an invalid page fault in module TABCTL32.OCX at 0137:212fef0b"

  -or-

  "VB5 caused an invalid page fault in module OLEAUT32.DLL at 0137:653468ec"

  -or-

  "VB5.exe Exception: Access violation (if using Windows NT or Windows 2000)"

CAUSE
=====

This problem can occur if the form (.frm file) contains incorrect information
for the SSTab's child controls. This problem should only occur when the .frm
file has been incorrectly edited outside of Visual Basic (such as with a text
editor), or if the .frm file is otherwise corrupt.

STATUS
======

Microsoft has confirmed this to be a bug in the Microsoft products listed at the
beginning of this article. This bug has been fixed in Visual Studio 97 Service
Pack 2.

For more information on the Visual Studio 97 Service Pack 2, please see the
following article in the Microsoft Knowledge Base:

  Q170365 : INFO: Visual Studio 97 Service Packs - What, Where, and Why

For a list of the Visual Basic 5.0 bugs that were fixed in the Visual Studio 97
Service Pack 2, please see the following article in the Microsoft Knowledge
Base:

  Q171554 : INFO: Visual Basic 5.0 Fixes in Visual Studio 97 Service Pack 2

MORE INFORMATION
================

Steps to Reproduce Behavior
---------------------------

1. Start a new "Standard EXE" project in Visual Basic 5.0.

2. Choose Components from the Project menu and select "Microsoft Tabbed Dialog
  Control 5.0."

3. Place an SSTab control on Form1.

4. Add two TextBox controls (Text1, Text2) to Tab 0.

5. Add two TextBox controls (Text3, Text4) to Tab 1.

6. Save the project (Form1.frm and Project1.vbp).

7. Exit Visual Basic.

8. Start Notepad and open Form1.frm.

9. Delete the following lines from Form1.frm:

        Tab(0).Control(1)=   "Text2"
        Tab(0).Control(1).Enabled=   0   'False
        ...
        Tab(1).Control(1)=   "Text4"
        Tab(1).Control(1).Enabled=   0   'False
        ...
        Begin VB.TextBox Text4
           Height          =   495
           Left            =   840
           TabIndex        =   4
           Text            =   "Text4"
           Top             =   1200
           Width           =   2775
        End
        ...
        Begin VB.TextBox Text2
           Height          =   495
           Left            =   -74160
           TabIndex        =   2
           Text            =   "Text2"
           Top             =   1200
           Width           =   2055

        End

10. Save Form1.frm and close Notepad.

11. Restart Visual Basic and open Project1.vbp. Note that an error occurs.

These steps will also reproduce the problem if you create the original project in
Visual Basic 4.0, edit the .frm file, then open the project in Visual Basic 5.0.
In this case, the problem will occur when attempting to save the form.

Additional query words: crash gpf

======================================================================
Keywords          : kbVBp500 kbVS97sp2fix kbGrpDSVB kbvbp500sp2fix kbbuglist kbfixlist
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB500Search kbVBA500 kbVB500
Version           : WINDOWS:5.0
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>