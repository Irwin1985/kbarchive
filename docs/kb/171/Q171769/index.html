<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q171769: Restoring a User Profile On a Windows NT Workstation or Server | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q171769: Restoring a User Profile On a Windows NT Workstation or Server" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/171/Q171769/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/171/Q171769/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q171769: Restoring a User Profile On a Windows NT Workstation or Server","url":"http://jeffpar.github.io/kbarchive/kb/171/Q171769/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q171769-restoring-a-user-profile-on-a-windows-nt-workstation-or-server">Q171769: Restoring a User Profile On a Windows NT Workstation or Server</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q171769
Product(s): Microsoft Windows NT
Version(s): WinNT:3.51,4.0
Operating System(s): 
Keyword(s): kbsetup
Last Modified: 09-AUG-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows NT Workstation versions 3.51, 4.0 
- Microsoft Windows NT Server versions 3.51, 4.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

After you run the repair process in Windows NT and select the options below on
the restore registry screen, all default settings are restored. No user accounts
exist, and the administrator password is returned to the password in use at the
time the Emergency Repair Disk (ERD) was made or updated.

[X] SYSTEM (System Configuration)
[X] SOFTWARE (Software Information)
[X] DEFAULT (Default User Profile)
[X] SECURITY (Security Policy) and SAM (User Accounts Database)

CAUSE
=====

Choosing to overwrite the registry and replace all SAM and security information
creates this situation.

RESOLUTION
==========

The recommended method to restore the proper user account database and domain
password is to restore the registry from a current tape backup. If a current
tape backup is not available, or, restoring from tape will cause other problems,
the following method can be used to restore users. If using this method causes
other problems, restore the registry from backup or recreate the user accounts.

This resolution assumes that you have the administrator password needed to sign
on to the local computer and that the user is local, or their profile is stored
locally (or the user is on the domain but their profile is stored locally).

NOTE: This is not a feasible solution for restoring more than a few users. This
resolution does not insure that applications will function correctly. Some
applications replace Windows NT files and can not work with the Windows NT files
that are restored from the selected options through the ERD process.
Applications may need to be reinstalled.

If the User Logs On to the Computer Locally
-------------------------------------------

1. Log on to the local computer with administrator privileges.

2. Recreate the user of the workstation in User Manager.

3. Go to the %SystemRoot%\Profiles\ directory and rename the Default User
  profile to Default Old.

4. Rename the user profile of the user you are trying to restore, Default User.

5. Log on to the local computer as that user and the Default profile will be
  assigned to them.

6. Log off the computer as the user, log on to the computer as administrator,
  and delete the Default User profile.

7. Repeat steps 1-6 to restore user's profiles.

8. Rename Default Old to Default User.

If the User Logs On to the Domain but the Profile is Stored Locally
-------------------------------------------------------------------

1. Delete the machine account from the domain.

2. Log on to the local computer with administrator privileges and rejoin the
  domain.

3. Perform steps 3-8 above.

If the User has Successfully Logged On to the
Computer at Least Once and Created a New Profile
----------------------------------------------------------------------------------------------

1. Log on to the local computer with administrator privileges.

2. Go to the %SystemRoot%\Profiles directory, and delete the user.000 profile.

3. Perform steps 3-8 above.

For more information regarding Security IDs and the ERD, refer to the following
Microsoft Knowledge Base articles

  Q162001 Do Not Disk Duplicate Installed Versions of Windows NT


  Q150919 How to Prevent a User from Changing the User Profile Type

  Q122857 RDISK /S and RDISK /S- Options in Windows NT

  Q126464 Repair Disk Utility Does Not Update SAM and Security

  Q129037 Windows NT 3.5x and 4.0 Emergency Repair Process Screens

Additional query words: ERD emergency repair disk rdisk rdisk/s
======================================================================
Keywords          : kbsetup 
Technology        : kbWinNTsearch kbWinNTWsearch kbWinNTW400 kbWinNTW400search kbWinNT351search kbWinNT400search kbWinNTW351search kbWinNTW351 kbWinNTSsearch kbWinNTS400search kbWinNTS400 kbWinNTS351 kbWinNTS351search
Version           : WinNT:3.51,4.0
Hardware          : x86
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>