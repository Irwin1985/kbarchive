<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q87922: CodeView Gives &quot;Bad DLL Format in ‘Filename’&quot; | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q87922: CodeView Gives &quot;Bad DLL Format in ‘Filename’&quot;" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/087/Q87922/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/087/Q87922/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q87922: CodeView Gives &quot;Bad DLL Format in ‘Filename’&quot;","url":"http://jeffpar.github.io/kbarchive/kb/087/Q87922/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q87922-codeview-gives-bad-dll-format-in-filename">Q87922: CodeView Gives "Bad DLL Format in ‘Filename’"</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q87922
Product(s): Microsoft Programming Utilities
Version(s): 
Operating System(s): 
Keyword(s): kberrmsg kb16bitonly kbCodeView kbDebug kbVC
Last Modified: 26-JUN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft CodeView for MS-DOS 
- Microsoft CodeView for Windows 
-------------------------------------------------------------------------------

SUMMARY
=======

Attempting to have CodeView for Windows version 4.0x or 4.1 or CodeView for
Win32s version 4.25 load one of the DOS expression evaluators through an Eval
statement in the [CVW] section of the TOOLS.INI file will cause the following
error message to be displayed:

  bad DLL format in 'filename'

'filename' is the name of the expression evaluator that CodeView for Windows or
CodeView for Win32s is trying to load, and will be either EED1CAN.DLL or
EED1CXX.DLL. The message is issued immediately after the file to be debugged has
been specified.

If an expression evaluator designed to run in the Windows environment is loaded
by CodeView under MS-DOS, CodeView will cause the following error message to be
displayed when run under Windows:

  This application has violated system integrity
  due to an invalid general protection fault and
  will be terminated.

  Quit all applications, quit Windows, and then restart you computer.

If CodeView is run outside of Windows, it will either generate a R6915 unhandled
exception or hang the machine.

MORE INFORMATION
================

CodeView versions 4.0x and 4.1, CodeView for Windows versions 4.0x and 4.1, and
CodeView for Win32s version 4.25 use expression evaluators to look up symbols,
parse, and evaluate expressions. The expression evaluators are provided in the
form of dynamic-link libraries (DLLs).

The Eval statement can be used in the TOOLS.INI file to tell CodeView to load a
specific expression evaluator. If no Eval statement is used, CodeView loads the
C++ expression evaluator by default.

The expression evaluators used by CodeView under MS-DOS are different than those
used by CodeView for Windows or CodeView for Win32s because the environments
they operate in are different. The names of the expression evaluators identify
the environment they were designed to run in and use the following naming
convention:

  EEhost evaluator.DLL

The "host" portion is either D1 for MS-DOS or W0 for Windows. The "evaluator"
part is either CAN for C or MASM, or CXX for C, C++, or MASM. For example, the
EED1CAN.DLL expression evaluator is the C and MASM expression evaluator for
CodeView under MS-DOS. EEW0CAN.DLL is the C and MASM expression evaluator for
CodeView for Windows.

Additional query words: kbinf 4.00 4.10

======================================================================
Keywords          : kberrmsg kb16bitonly kbCodeView kbDebug kbVC 
Technology        : kbAudDeveloper kbCodeView kbZNotKeyword3
Version           : :

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>