<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q162159: SAMPLE:TREESCRL Scrolls in a Tree Control During Drag-and-Drop | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q162159: SAMPLE:TREESCRL Scrolls in a Tree Control During Drag-and-Drop" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/162/Q162159/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/162/Q162159/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q162159: SAMPLE:TREESCRL Scrolls in a Tree Control During Drag-and-Drop","url":"http://jeffpar.github.io/kbarchive/kb/162/Q162159/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q162159-sampletreescrl-scrolls-in-a-tree-control-during-drag-and-drop">Q162159: SAMPLE:TREESCRL Scrolls in a Tree Control During Drag-and-Drop</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q162159
Product(s): Microsoft C Compiler
Version(s): winnt:2.0,2.1,2.2,4.0,4.1,4.2
Operating System(s): 
Keyword(s): kbcode kbfile kbsample kbui kbMFC kbTreeView KbUIDesign kbVC kbVC200 kbVC400 kbVC420 kb
Last Modified: 04-MAY-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- The Microsoft Foundation Classes (MFC), used with:
   - Microsoft Visual C++, 32-bit Editions, versions 2.0, 2.1, 2.2, 4.0, 4.1 
   - Microsoft Visual C++, 32-bit Enterprise Edition, version 4.2 
   - Microsoft Visual C++, 32-bit Professional Edition, version 4.2 
-------------------------------------------------------------------------------

SUMMARY
=======

A TreeView control is one capable of displaying items in a tree-like
hierarchical fashion. The control supports drag-and-drop. When an item is
dragged to the top or bottom of the control, the control does not automatically
scroll vertically.

Treescrl.exe shows how to add scrolling functionality to a tree control during
drag-and-drop.

The following files are available for download from the Microsoft Download
Center:

  TreescrA.exe
  (http://download.microsoft.com/download/vc42ent/Sample23/1/W9XNT4/EN-US/TreescrA.exe)

For additional information about how to download Microsoft Support files, click
the article number below to view the article in the Microsoft Knowledge Base:

  Q119591 How to Obtain Microsoft Support Files from Online Services

Microsoft used the most current virus detection software available on the date of
posting to scan this file for viruses. Once posted, the file is housed on secure
servers that prevent any unauthorized changes to the file.

MORE INFORMATION
================

TREESCRL uses the CTreeView view class that encapsulates the functionality of a
view and a tree control. The sample's drag-and-drop functionality is similar to
the one demonstrated in CMNCTRLS, a sample shipped with the Visual C++ product.
When TREESCRL is built and run, an SDI window with a CTreeView comes up. When
you grab a tree control item (parent or child), and drag it above/below the
top/bottom of the view window, the tree control starts scrolling
upward/downward.

The idea behind TREESCRL is to install a timer when a drag-and-drop operation
starts. In the handler for the WM_TIMER message, it is first determined if
scrolling is needed. If it is, then the appropriate scroll message is sent to
the control. When the drag-and-drop operation terminates, the timer is killed.
The sample shows how to draw the drag image and how to select the drop site
during the dragging phase.

The tree control can scroll in different modes. During the drag phase, when the
mouse cursor is close to the top or the bottom border of the view, scrolling is
slow. The control scrolls at this slow speed when the horizontal distance
between the mouse and the corresponding view border (top/bottom) is less than
the width of a horizontal scrollbar. Scrolling speeds up when the mouse is taken
further away from either border.

SLOWSCROLL_FREQUENCY is a macro symbol in the view's .cpp file. This symbol
determines the relative speeds of normal and slow scrolling. Normal scrolling
occurs approximately every 75 milliseconds (the frequency of the timer). In the
sample, SLOWSCROLL_FREQUENCY is defined to be three (3), which means slow
scrolling is three times slower than normal scrolling. To change the slow
scrolling speed, modify this value to a positive integer.

Additional query words:

======================================================================
Keywords          : kbcode kbfile kbsample kbui kbMFC kbTreeView KbUIDesign kbVC kbVC200 kbVC400 kbVC420 kbGrpDSMFCATL 
Technology        : kbAudDeveloper kbMFC
Version           : winnt:2.0,2.1,2.2,4.0,4.1,4.2
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>