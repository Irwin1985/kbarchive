<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q123286: WINNT /D Does Not Delete System Files | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q123286: WINNT /D Does Not Delete System Files" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/123/Q123286/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/123/Q123286/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q123286: WINNT /D Does Not Delete System Files","url":"http://jeffpar.github.io/kbarchive/kb/123/Q123286/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q123286-winnt-d-does-not-delete-system-files">Q123286: WINNT /D Does Not Delete System Files</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q123286
Product(s): Microsoft Windows NT
Version(s): 
Operating System(s): 
Keyword(s): 
Last Modified: 08-AUG-2001

3.50

WINDOWS

kbnetwork kbbug3.50

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows NT Workstation version 3.5 
- Microsoft Windows NT Server version 3.5 
-------------------------------------------------------------------------------

SYMPTOMS
========

The following error message appears when you attempt to run WINNT.EXE with the
/D switch (for example: WINNT /D:C:\WINNT) to delete Windows NT:

  Setup was unable to open the log file named below.

  C:\WINNT\SETUP.LOG

  Setup is unable to remove Windows NT files from the specified directory.

If you copy the SETUP.LOG file from the %SYSTEMROOT%\REPAIR directory (where it
resides with Windows NT version 3.5) into the %SYSTEMROOT% directory (in this
example, C:\WINNT), the following error message appears:

  Setup is unable to find the Repair.WinntFiles section in the setup log file
  named below.

  C:\WINNT\SETUP.LOG

  Setup is unable to remove Windows NT files from the specified directory.

CAUSE
=====

WINNT.EXE is looking for the SETUP.LOG file in the %SYSTEMROOT% directory, where
it resides with Windows NT version 3.1, instead of %SYSTEMROOT%\REPAIR, where it
resides with Windows NT version 3.5. WINNT.EXE is also looking for the section
names as they exist under Windows NT version 3.1; for example,
Repair.WinntFiles, which is actually named Files.Winnt with Windows NT version
3.5.

WINNT.EXE /D is designed to delete Windows NT system files from %SYSTEMROOT%. It
is not designed to delete the entire directory structure, nor is it designed to
delete the boot files or modify the boot sector.

RESOLUTION
==========

As a workaround, you can manually remove Windows NT by proceeding with the
following.

NOTE: The following assumes that your system is currently configured to start
into Windows NT or MS-DOS (that both are startup options) and that your system
partition is using the FAT file system. If your configuration differs from that
just mentioned, do not proceed with the following. Instead, contact Microsoft
Product Support for other uninstall/configuration options.

1. Start your system from an MS-DOS bootable floppy disk that contains the file
  SYS.COM.

2. From the A:\ prompt, type "sys c:" (without the quotation marks).

3. Start your system from the hard drive to ensure that the system starts from
  the hard drive into MS-DOS.

4. Use the MS-DOS ATTRIB command (for example, ATTRIB -r -h -s &lt;filename&gt;)
  to remove the read only, hidden, and system attributes from the following
  files, found in the root directory of your system partition:

     BOOT.INI
     BOOTSECT.DOS
     NTBOOTDD.SYS (if it exists)
     NTDETECT.COM
     NTLDR

5. Delete the files mentioned in step 4 above and the file PAGEFILE.SYS.

6. Delete the directory %SYSTEMROOT%\SYSTEM32 and %SYSTEMROOT%\REPAIR.

7. Optionally, you can also delete the USERS and WIN32APP directories, found in
  the root directory, provided there are no important user files located there.


STATUS
======

Microsoft has confirmed this to be a problem in Windows NT version 3.5. We are
researching this problem and will post new information here in the Microsoft
Knowledge Base as it becomes available.

Additional query words: prodnt deinstall

======================================================================
Keywords          :  
Technology        : kbWinNTsearch kbWinNTWsearch kbWinNT350search kbWinNTW350 kbWinNTW350search kbWinNTSsearch kbWinNTS350 kbWinNTS350search

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>