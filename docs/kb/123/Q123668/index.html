<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q123668: PRB: LNK4022 &amp; LNK4006 Warnings When Build PowerStation 32 DLL | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q123668: PRB: LNK4022 &amp; LNK4006 Warnings When Build PowerStation 32 DLL" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/123/Q123668/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/123/Q123668/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q123668: PRB: LNK4022 &amp; LNK4006 Warnings When Build PowerStation 32 DLL","url":"http://jeffpar.github.io/kbarchive/kb/123/Q123668/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q123668-prb-lnk4022--lnk4006-warnings-when-build-powerstation-32-dll">Q123668: PRB: LNK4022 &amp; LNK4006 Warnings When Build PowerStation 32 DLL</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q123668
Product(s): Microsoft Fortran Compiler
Version(s): 1.0,4.0
Operating System(s): 
Keyword(s): kbcode kbFortranPS kbLangFortran
Last Modified: 05-NOV-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Fortran Powerstation 32 for Windows NT, versions 1.0, 4.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

The following errors are generated when building a DLL using a module definition
(.DEF) file that does not use the fully decorated name of a function named
testing:

  warning LNK4022: cannot find unique match for symbol "TESTING"
  warning LNK4006: _TESTING already defined in test.obj; second definition
  ignored
  warning LNK4006: _TESTING@4 already defined in test.obj; second definition
  ignored
  LINK : error LNK1141: failure during build of exports file

RESOLUTION
==========

Use the fully decorated name in the EXPORTS section of the DEF file or the LINK
command line.

MORE INFORMATION
================

There may be times when it is desirable not to modify the Fortran source code to
add the DLLEXPORT attribute to a function. For example, you might want to
maintain a common code base for several computer platforms. In this case, the
exports must be identified in the EXPORTS section of a .DEF file or the LINK
command line. In either case, if the name specified is not the fully decorated
name, the errors described above will be generated by the linker.

Steps to Reproduce Problem
--------------------------

1. Use the sample code listed at the end of this article and this definitions
  file:

  library test
  EXPORTS TESTING

2. Use the following LINK command to generate the error messages:

  link test.obj /dll /def:test.def msfrt.lib msvcrt.lib

NOTE: The second LNK4006 error generated by the linker gives the correct fully
decorated name "_TESTING@4". The @4 in the name indicates the number of bytes in
the function parameters.

Example Resolution
------------------

To successfully link and produce a DLL, include the fully decorated name in the
.DEF file:

  library test
  EXPORTS _TESTING@4

or in the EXPORT LINK option:

  link test.obj /dll /export:_TESTING@4 msfrt.lib msvcrt.lib

Sample Code
-----------

  C Compile options needed: none
          subroutine testing(i)
          integer i
          i = i*2
          end

Additional query words: 1.00 4.00

======================================================================
Keywords          : kbcode kbFortranPS kbLangFortran 
Technology        : kbAudDeveloper kbFortranSearch kbZNotKeyword2 kbFORTRANPower32100NT kbFORTRANPower32400NT
Version           : :1.0,4.0

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>