<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q123319: PC Win: Err Msg: Mailbag File Required for Accessing Message.. | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q123319: PC Win: Err Msg: Mailbag File Required for Accessing Message.." />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/123/Q123319/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/123/Q123319/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q123319: PC Win: Err Msg: Mailbag File Required for Accessing Message..","url":"http://jeffpar.github.io/kbarchive/kb/123/Q123319/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q123319-pc-win-err-msg-mailbag-file-required-for-accessing-message">Q123319: PC Win: Err Msg: Mailbag File Required for Accessing Message..</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q123319
Product(s): Microsoft Mail For PC Networks
Version(s): WINDOWS:3.0,3.0b,3.2,3.2a
Operating System(s): 
Keyword(s): 
Last Modified: 30-OCT-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Mail for Windows, versions 3.0, 3.0b, 3.2, 3.2a 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you access the New Messages option from the View menu in Microsoft Mail for
Windows, you may get the following error message:

  The mailbag file for accessing your messages is missing or invalid, contact
  your administrator to restore from a backup.

CAUSE
=====

This is caused by either corruption in the .MBG file or a corrupt message
sitting in the Inbox of the Microsoft Mail for PC Networks, MS-DOS workstation.

RESOLUTION
==========

The following procedure will resolve this issue:

1. Run LISTUSER.EXE to determine the hex-id for the user.

2. Check to see if the user's (hex-id).KEY and (hex-id).MBG files are locked
  open or ownerless. To check if a file is locked open, you can try renaming
  the file. If it allows you to do so, the file is not locked open. Make sure
  that you rename it back once tested.

3. Login to mail in the MS-DOS client (MAIL.EXE) as this user and check the
  messages in the Inbox for possible corruption. You should check for
  abnormalities such as all fives in the time and date stamp of the message or
  graphics characters in the subject and/or body of the message.

4. Delete the corrupt messages. If unable to do so, continue to the next step.

5. Reset the user's (hex-id).KEY and (hex-id).MBG files. This can be done with
  the following two procedures:

  a. Procedure 1

     To manually reset (hex-id).KEY:

  DEBUG (hex-id).KEY [return]
  -f100,32f,0 [return] (this resets the file)
  -w [return] (to write the file)
  -q [return] (to quit debug)m

     The correct filesize should be 560 bytes.

     To manually reset (hex-id).MBG:

  TYPE NUL &gt; (hex-id).MBG

     The correct filesize should be 0 bytes.

  b. Procedure 2

     1. Run ADMIN.EXE and create a test user.

     2. Run LISTUSER.EXE to determine the hex-id of the test user.

     3. Copy (test user).KEY and .MBG to (user).KEY and .MBG.

     4. Run ADMIN.EXE and delete the test user.

Additional query words: 3.00 3.00b 3.20 3.20a reset .key

======================================================================
Keywords          :  
Technology        : kbMailSearch kbZNotKeyword3 kbMail300 kbMail320 kbMail300b kbMail320a
Version           : WINDOWS:3.0,3.0b,3.2,3.2a

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>