<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q311846: INFO: Names and IP Addresses an MSDTC Client Must Have | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q311846: INFO: Names and IP Addresses an MSDTC Client Must Have" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/311/Q311846/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/311/Q311846/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q311846: INFO: Names and IP Addresses an MSDTC Client Must Have","url":"http://jeffpar.github.io/kbarchive/kb/311/Q311846/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q311846-info-names-and-ip-addresses-an-msdtc-client-must-have">Q311846: INFO: Names and IP Addresses an MSDTC Client Must Have</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q311846
Product(s): Microsoft Programming Utilities
Version(s): 1.0,2.0,4.0,5.0
Operating System(s): 
Keyword(s): kbnokeyword
Last Modified: 17-JUN-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft COM+, version 1.0 
- Microsoft Transaction Server 2.0 
- Microsoft SQL Server 
- Microsoft SQL Server 2000 (all editions) 
- Microsoft Cluster Server 
- Microsoft Internet Information Server versions 4.0, 5.0 
-------------------------------------------------------------------------------

SUMMARY
=======

The purpose of this article is to help you in the setup or in the
troubleshooting of a configuration for a COM+ Application Server or a
configuration for an Internet Information Server (IIS) computer that interacts
with a clustered server that uses Microsoft Cluster Server (MSCS) that is behind
a firewall.

You may have one of the following scenarios:

- COM+ or IIS computer (client computer)

- SQL Server clustered that uses MSCS

- Microsoft Distributed Transaction Coordinator (MSDTC) as a clustered resource
  in its own resource group (own name and IP address)

- Cluster and client computer that are separated by a firewall

Certain Internet Protocol (IP) addresses and their corresponding network names
must be known by the client computer for MSDTC to work correctly. The client
computer can resolve the following names and the following IP addresses by using
Domain Name System (DNS), hosts file, or another name resolution method:

- MSDTC resource

- An instance of SQL Server if the cluster configuration is either
  active-passive or active-active

- Cluster Name

Certain IP addresses and their corresponding network names must be known by the
nodes in the cluster for MSDTC to work correctly. Both nodes in the cluster can
resolve the client computer name to an IP address by using DNS, hosts file, or
another name resolution method.

MORE INFORMATION
================

Additionally, the firewall must be configured to allow bidirectional traffic to
occur between the client computer and the cluster. The firewall rules must
include the following:

- The IP network names and the addresses of both physical nodes on the cluster

- The SQL Server Instances network names and address

- The client network name and addresses

- The child network name and IP resource of the MSDTC Resource

Firewall rules must include the range of IP ports that are defined in the
registry to allow traffic. See the "References" section.

You may also have to open an additional range of available IP ports as a
requirement for the cluster server. See the "References" section for more
information.

REFERENCES
==========

For additional information, click the article numbers below to view the articles
in the Microsoft Knowledge Base:

  Q250367 INFO: Configuring Microsoft Distributed Transaction Coordinator (DTC)
  to Work Through a Firewall

  Q258469 Cluster Service May Not Start After You Restrict Available IP Ports
  for Remote Procedure Call

For information about Distributed Component Object Model (DCOM) and Remote
Procedure Call (RPC) with firewalls, visit the following Microsoft Web site:

  Using Distributed COM with Firewalls
  http://www.microsoft.com/com/wpaper/dcomfw.asp

Additional query words:

======================================================================
Keywords          : kbnokeyword 
Technology        : kbSQLServSearch kbMTSsearch kbiisSearch kbAudDeveloper kbClustServSearch kbiis500 kbiis400 kbSQLServ2000Search kbCOMPlusSearch kbCOMPlus100 kbSQLServ2000 kbMTS200 kbComSearch
Version           : :1.0,2.0,4.0,5.0
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>