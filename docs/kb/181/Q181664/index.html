<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q181664: PRB: Rich Edit Control Message Handlers Are Not Called | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q181664: PRB: Rich Edit Control Message Handlers Are Not Called" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/181/Q181664/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/181/Q181664/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q181664: PRB: Rich Edit Control Message Handlers Are Not Called","url":"http://jeffpar.github.io/kbarchive/kb/181/Q181664/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q181664-prb-rich-edit-control-message-handlers-are-not-called">Q181664: PRB: Rich Edit Control Message Handlers Are Not Called</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q181664
Product(s): Microsoft C Compiler
Version(s): winnt:5.0,6.0
Operating System(s): 
Keyword(s): kbwizard kbCtrl kbVC500 kbVC600 kbprb
Last Modified: 17-JUL-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual C++, 32-bit Enterprise Edition, versions 5.0, 6.0 
- Microsoft Visual C++, 32-bit Professional Edition, versions 5.0, 6.0 
- Microsoft Visual C++, 32-bit Learning Edition, version 6.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

There is a problem with the message-map entries that ClassWizard creates to
handle the following Rich Edit control messages: EN_SETFOCUS, EN_KILLFOCUS. The
message-map entry created by ClassWizard does not call the handler for these
messages.

CAUSE
=====

The wrong message map entries are added.

RESOLUTION
==========

Replace the message-map entries generated for EN_SETFOCUS and EN_KILLFOCUS with
the following entries:

  ON_EN_SETFOCUS(IDC_RICHEDIT1, OnSetfocusRichedit1)

  ON_EN_KILLFOCUS(IDC_RICHEDIT1, OnKillfocusRichedit1)

Note: You need to alter IDC_RICHEDIT1 to match the ID of your control. You will
also need to change the prototypes for the message handlers generated by the
wizard to:

  afx_msg void OnSetfocusRichedit1();

  afx_msg void OnKillfocusRichedit1();

STATUS
======

Microsoft has confirmed this to be a bug in the Microsoft products listed at the
beginning of this article.

MORE INFORMATION
================

Steps to Reproduce Behavior
---------------------------

1. Use the MFC AppWizard to create a dialog-based application.

2. Drag a RichEdit control from the Controls palette onto the Dialog template
  using the Dialog Resource Editor.

3. Open ClassWizard, and choose IDC_RICHEDIT1 for the ObjectID. To add message
  handlers for the EN_SETFOCUS and the EN_KILLFOCUS messages, highlight the
  message and click Add Function.

4. Click OK, and look at the code. The following entry appears in the
  message-map if you selected EN_SETFOCUS:

  ON_NOTIFY(EN_SETFOCUS, IDC_RICHEDIT1, OnSetfocusRichedit1)

  However, this message-map entry should be:

  ON_EN_SETFOCUS(IDC_RICHEDIT1, OnSetfocusRichedit1)

  The following entry is also in the message-map if you selected EN_KILLFOCUS:

  ON_NOTIFY(EN_KILLFOCUS, IDC_RICHEDIT1, OnKillfocusRichedit1)

  However, this message-map entry should be:

  ON_EN_KILLFOCUS(IDC_RICHEDIT1, OnKillfocusRichedit1)

5. If you build and run this project to see the problematic behavior, remember
  to add the line AfxInitRichEdit(); in the InitInstance()

     function of the CWinApp derived class.

6. You can use the default handler created by ClassWizard and add a TRACE
  statement. Following is an example for the EN_KILLFOCUS message:

        void CMyDialog::OnSetfocusRichedit1(NMHDR* pNMHDR, LRESULT* pResult)
        {
           TRACE("This function will never be called\n");
           *pResult = 0;
        }

7. The TRACE statement does not execute when you run a Debug build.

REFERENCES
==========

For additional information, please see the following articles in the Microsoft
Knowledge Base:

  Q166132 PRB: Dialog With RichEdit May Fail During Creation

  Q165744 BUG: RichEditCtrl IDs Not Shown in Member Variables Tab

Additional query words: CRichEditCtrl EN_SETFOCUS EN_KILLFOCUS RichEdit Class Wizard

======================================================================
Keywords          : kbwizard kbCtrl kbVC500 kbVC600 kbprb 
Technology        : kbVCsearch kbAudDeveloper kbVC500 kbVC600 kbVC32bitSearch kbVC500Search
Version           : winnt:5.0,6.0
Issue type        : kbbug kbprb
Solution Type     : kbpending

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>