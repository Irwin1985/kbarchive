<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q168015: Files Not Replaced When Running Emergency Repair on X86 Intel | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q168015: Files Not Replaced When Running Emergency Repair on X86 Intel" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/168/Q168015/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/168/Q168015/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q168015: Files Not Replaced When Running Emergency Repair on X86 Intel","url":"http://jeffpar.github.io/kbarchive/kb/168/Q168015/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q168015-files-not-replaced-when-running-emergency-repair-on-x86-intel">Q168015: Files Not Replaced When Running Emergency Repair on X86 Intel</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q168015
Product(s): Microsoft Windows NT
Version(s): winnt:4.0
Operating System(s): 
Keyword(s): kbusage kbhowto
Last Modified: 09-AUG-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows NT Workstation version 4.0 
- Microsoft Windows NT Server version 4.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

Some or all of the files you specify to repair when you run an Emergency Repair
may not be replaced.

CAUSE
=====

The Setupdd.sys file drives the Emergency Repair process. After you select to
replace files, the version of Setupdd.sys included on the original Windows NT
4.0 CD-ROM makes an additional check of these files.

The Emergency Repair process searches the Setup.log file for the files to
replace. After you select to replace the files, Setupdd.sys compares the files
to the files on the original CD-ROM. If the files are different you are prompted
to replace the files. If you choose to replace the files, Setupdd.sys reads the
files from the CD-ROM and compares the Version Resource date of the files on the
CD-ROM to the Version Resource date of the files on the computer. If the Version
Resource date of the file on the computer is newer, then the file is not
replaced. The Emergency Repair process does not indicate that the file is not
going to be replaced.

RESOLUTION
==========

The Setupdd.sys file in Service Pack 2 or later has the Version Resource date
checking disabled. In order to ensure all files selected during an Emergency
Repair process are properly replaced you must replace the Setupdd.sys file on
disk 2 of the Installation disk set with the Setupdd.sys file from Service Pack
2 or later.

NOTE: If your computer (stops responding) hangs while reading the CD-ROM path to
Autochk.exe, press ENTER to proceed.

If Service Pack 5 or later is installed on the computer, you may receive the
following error message:

  File setupdd.sys could not be loaded. The error code is 7

  Setup cannot continue. Press any key to exit.

To work around this behavior, use the Setupdd.sys file from Service Pack 4.


MORE INFORMATION
================

When running an Emergency Repair on an Intel-based computer, you must start your
computer using the three installation boot disks. If you choose the "Verify
Windows NT system files" option, the Emergency Repair process continues and
prompts you for the Emergency Repair Disk (ERD). You are then prompted to
replace files that it detects are different from those listed in your Setup.log
file. You have the option to select an individual file or to select all files.
After you choose to replace files and you restart your computer, there may still
be files on the system that you requested to replace.

Additional query words: 4.00 prodnt STOP ntoskrnl.exe fastfat.sys ntfs.sys SP3

======================================================================
Keywords          : kbusage kbhowto 
Technology        : kbWinNTsearch kbWinNTWsearch kbWinNTW400 kbWinNTW400search kbWinNT400search kbWinNTSsearch kbWinNTS400search kbWinNTS400
Version           : winnt:4.0
Hardware          : x86
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>