<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q160041: HOWTO: Modify the Windows Default Cursor | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q160041: HOWTO: Modify the Windows Default Cursor" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/160/Q160041/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/160/Q160041/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q160041: HOWTO: Modify the Windows Default Cursor","url":"http://jeffpar.github.io/kbarchive/kb/160/Q160041/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q160041-howto-modify-the-windows-default-cursor">Q160041: HOWTO: Modify the Windows Default Cursor</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q160041
Product(s): Microsoft Visual Basic for Windows
Version(s): WINDOWS:4.0,5.0,6.0
Operating System(s): 
Keyword(s): kbAPI kbVBp kbVBp400 kbVBp600 kbGrpDSVB kbDSupport
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Learning Edition for Windows, versions 5.0, 6.0 
- Microsoft Visual Basic Professional Edition for Windows, versions 5.0, 6.0 
- Microsoft Visual Basic Enterprise Edition for Windows, versions 5.0, 6.0 
- Microsoft Visual Basic Standard Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 32-bit, for Windows, version 4.0 
-------------------------------------------------------------------------------

SUMMARY
=======

The MousePointer property in Visual Basic (which applies to Form, MDIForm, and a
set of selected controls) allows you to modify the cursor's shape for a Visual
Basic application. However, if the cursor is moved away from the Visual Basic
application, its shape is determined by other applications or by the Desktop.

This article describes how to modify the cursor's default settings so that these
changes are reflected throughout the Desktop.

NOTE: Due to a bug in Windows NT, this article only applies to Windows 95 and
Windows 98. Microsoft is researching this issue and will post new information
here in the Microsoft Knowledge Base as it becomes available.

On Windows 2000, this program works but not as expected. In the code that
follows, in Command1_Click toggles the pointer between an arrow and an
arrow/hourglass icon. And the code in Command2_Click has no affect.

MORE INFORMATION
================

At times, you may want to design an application in Visual Basic that allows the
user to run other applications or tasks within the same application while a task
is running.

A simple way to inform the user that this particular state exists is to modify
the cursor to be both an arrow and an hourglass until the first task is
completed. You can accomplished this easily with the SetSystemCursor API.

Step-by-Step Example
--------------------

The following example simulates starting a task with the first CommandButton and
halting it with the second CommandButton:.

1. Start a new project in Visual Basic. Form1 is created by default.

2. Add the following code to the General Declarations section of Form1:

     Private Const IDC_APPSTARTING = 32650&amp;
     Private Const IDC_ARROW = 32512&amp;
     Private Const OCR_NORMAL = 32512&amp;

     Private Declare Function LoadCursor Lib "user32" Alias "LoadCursorA"
     (ByVal hInstance As Long, ByVal lpCursorName As Long) As Long
     Private Declare Function SetSystemCursor Lib "user32" (ByVal hcur As
     Long, ByVal id As Long) As Boolean

3. Add two CommandButtons, Command1 and Command2, to Form1.

4. Add the following code to the Click event of Command1:

     Private Sub Command1_Click()
     Dim hcursor As Long, ret_val As Long

         hcursor = LoadCursor(0, IDC_APPSTARTING)
         ret_val = SetSystemCursor(hcursor, OCR_NORMAL)

     End Sub

5. Add the following code to the Click event of Command2:

     Private Sub Command2_Click()
     Dim hcursor As Long, ret_val As Long

         hcursor = LoadCursor(0, IDC_ARROW)
         ret_val = SetSystemCursor(hcursor, OCR_NORMAL)

     End Sub

6. Run the project by pressing the F5 key. Click on Command1 to modify the
  cursor. Move the cursor around over other applications and click on them for
  activation. Finally, click on Command2 to restore the cursor to its original
  shape.

Additional query words:

======================================================================
Keywords          : kbAPI kbVBp kbVBp400 kbVBp600 kbGrpDSVB kbDSupport 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB500Search kbVB600Search kbVBA500 kbVBA600 kbVB500 kbVB600 kbVB400Search kbVB400
Version           : WINDOWS:4.0,5.0,6.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>