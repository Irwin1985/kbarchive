<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q160968: PRB: VB5 Components Distribute Improperly with VB4 Setup Kit | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q160968: PRB: VB5 Components Distribute Improperly with VB4 Setup Kit" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/160/Q160968/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/160/Q160968/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q160968: PRB: VB5 Components Distribute Improperly with VB4 Setup Kit","url":"http://jeffpar.github.io/kbarchive/kb/160/Q160968/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q160968-prb-vb5-components-distribute-improperly-with-vb4-setup-kit">Q160968: PRB: VB5 Components Distribute Improperly with VB4 Setup Kit</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q160968
Product(s): Microsoft Visual Basic for Windows
Version(s): WINDOWS:4.0,5.0
Operating System(s): 
Keyword(s): kbVBp400 kbVBp500 kbGrpDSVB kbhowto
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Control Creation Edition for Windows, version 5.0 
- Microsoft Visual Basic Standard Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 32-bit, for Windows, version 4.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

Microsoft Visual Basic 4.0 distributions built using the Setup Wizard will not
work properly if created on a system that also has Microsoft Visual Basic
Control Creation Edition version 5.0 installed.

CAUSE
=====

Microsoft Visual Basic Control Creation Edition 5.0 installs components that are
incompatible with Microsoft Visual Basic 4.0's Setup Wizard. These components
require different runtime components than the earlier Microsoft Visual Basic 4.0
versions. The new controls that are affected are:

  COMCTL32.OCX
  COMDLG32.OCX

The files upon which these controls depend are:

  ASYCFILT.DLL OLEAUT32.DLL OLEPRO32.DLL STDOLE32.TLB

Changing the SWDEPEND.INI file for Microsoft Visual Basic 4.0's Setup Wizard
usually allows the appropriate files (above) to be included with the distributed
diskettes. However, OLEAUT32.DLL is a System file that is commonly in use by the
operating system, even with no other applications running. This situation
requires a system reboot to update OLEAUT32.DLL properly. The Setup Wizard
included with Microsoft Visual Basic 4.0 does not support rebooting.

RESOLUTION
==========

There are two possible workarounds for this behavior.

NOTE: If a Microsoft Visual Basic 4.0 application has already been distributed to
a target machine with the new .OCX components (as described above), you must
uninstall the application and manually remove or replace the updated components.
This is necessary because the workarounds below make use of the Microsoft Visual
Basic 4.0 components. The Setup Wizard is incapable of replacing a later version
of a component with an earlier one.

Workaround 1
------------

Prior to installing Microsoft Visual Basic Control Creation Edition version 5.0,
copy the following components:

  COMCTL32.OCX
  COMDLG32.OCX
  OLEPRO32.DLL
  MFC40.DLL
  MSVCRT40.DLL

to the following folder:

  C:\Program Files\Microsoft Visual Basic\Setupkit\Kitfil32\sys32

Microsoft Visual Basic 4.0's Setup Wizard always looks at the above folder first
when searching for dependent files.

Next, when you create distribution disks with Microsoft Visual Basic 4.0's Setup
Wizard, follow these steps:

1. Deselect the COMCTL32.OCX and COMDLG32.OCX references in step 5.

2. Manually add COMCTL32.OCX and COMDLG32.OCX from the above folder during step
  7.

Again, this will only be necessary when creating distribution disks for
applications that use the COMCTL32.OCX or COMDLG32.OCX controls.

Workaround 2
------------

Another workaround is to maintain a pure Microsoft Visual Basic 4.0 system (one
without Microsoft Visual Basic Control Creation Edition version 5.0 installed)
for the purpose of creating Setup distribution files.

STATUS
======

This behavior is by design.

Additional query words:

======================================================================
Keywords          : kbVBp400 kbVBp500 kbGrpDSVB kbhowto 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbVBA500Search kbVB500 kbVB400Search kbVB400 kbZNotKeyword3
Version           : WINDOWS:4.0,5.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>