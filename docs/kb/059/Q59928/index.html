<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q59928: Error R6001 Generated by Compiler in Huge Model | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q59928: Error R6001 Generated by Compiler in Huge Model" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/059/Q59928/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/059/Q59928/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q59928: Error R6001 Generated by Compiler in Huge Model","url":"http://jeffpar.github.io/kbarchive/kb/059/Q59928/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q59928-error-r6001-generated-by-compiler-in-huge-model">Q59928: Error R6001 Generated by Compiler in Huge Model</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q59928
Product(s): See article
Version(s): 2.00 2.01
Operating System(s): MS-DOS
Keyword(s): ENDUSER | buglist2.00 buglist2.01 fixlist2.50 fixlist2.51 | mspl13_c
Last Modified: 15-APR-1990

When casting the result of pointer arithmetic to either a double or a
float, QuickC Version 2.00 or QuickAssembler Version 2.01 may produce
the following error when compiling in the huge model:

   run-time error R6001
   - null pointer assignment

This error occurs in the huge memory model only. Turning off all
optimizations using the /Od switch does not help.

The compiler does produce an OBJ file, but this file is not valid. If
an attempt is made to link this OBJ into an executable, the following
error will be issued by the linker:

   xxx.obj (xxx.c) : error L2029 : '__' : unresolved external

The following code reproduces the error:

void main(void)
{
        char * foo = "abcdef",
             * bar = foo + 5 ;
        double dbl;

        dbl = (double) (foo-bar) ;
}

Substituting "float" for "double" produces the same error.

In memory models other than huge, this same situation generates the
following error message:

   fatal error C1001: Internal Compiler Error
   (compiler file 'gencode.c', line 389)
   Contact Microsoft Product Support

For more information, query on the following words:

   ICE and error and casting and pointer and arithmetic

Workaround
----------

The problem can be solved by using a temporary variable of type long to
store the result of the pointer arithmetic. The temporary variable
used to store the result of the pointer arithmetic is of type long
because all huge pointer arithmetic is done using 4-byte signed (that
is, long) arithmetic.

The following is the same as the above example, but uses a temporary
variable:

void main(void)
{
        char * foo = "abcdef",
             * bar = foo + 5 ;
        double dbl ;
        long   temp ;

        temp = foo-bar ;
        temp = (double) temp ;
}

Microsoft has confirmed this to be a problem with QuickC Version 2.00
and QuickAssembler Version 2.01. It has been corrected in QuickC
Version 2.50 and Quick Assembler 2.51.
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>