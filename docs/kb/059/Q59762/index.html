<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q59762: QB 4.00 &quot;String Space Corrupt&quot; F8/F10 Step on CALL Breakpoint | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q59762: QB 4.00 &quot;String Space Corrupt&quot; F8/F10 Step on CALL Breakpoint" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/059/Q59762/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/059/Q59762/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q59762: QB 4.00 &quot;String Space Corrupt&quot; F8/F10 Step on CALL Breakpoint","url":"http://jeffpar.github.io/kbarchive/kb/059/Q59762/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q59762-qb-400-string-space-corrupt-f8f10-step-on-call-breakpoint">Q59762: QB 4.00 "String Space Corrupt" F8/F10 Step on CALL Breakpoint</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q59762
Product(s): See article
Version(s): 4.00 4.00b
Operating System(s): MS-DOS
Keyword(s): ENDUSER | SR# S890919-123 buglist4.00 buglist4.00b fixlist4.50 B_Basic | mspl13_basic
Last Modified: 26-MAR-1990

A "String Space Corrupt" error occurs in QuickBASIC Versions 4.00 and
4.00b when the code sample listed below is run using the steps
described below. The general background on the problem is as follows.
If a program is STOPped during the execution of a procedure, a
breakpoint is set on a subsequent CALL to the same procedure that is
currently executing, and execution of the program is continued, then a
"String space corrupt" error occurs. However, this problem occurs only
under very specific conditions which are described in comments in the
code below.

Microsoft has confirmed this to be a problem in QB.EXE in Microsoft
QuickBASIC Versions 4.00 and 4.00b and Microsoft BASIC Compiler
Versions 6.00 and 6.00b for MS-DOS (buglist6.00, buglist6.00b). This
problem was corrected in QB.EXE in Microsoft QuickBASIC Version 4.50
and QBX.EXE in Microsoft BASIC Professional Development System (PDS)
Version 7.00 (fixlist7.00).

Use the following steps to produce a "String Space Corrupt" error in
QuickBASIC 4.00 and 4.00b with the code listed below:

1. Press SHIFT+F5 to run the program.

   The program stops on the STOP statement in ASub.

2. Set a breakpoint (press F9) on the second CALL statement in the
   module-level code.

3. Press F5 to continue.

   The program breaks on the second CALL.

4. Press F8 or F10 to step and produce the "String Space Corrupt"
   error.

Code Example
------------

The following code example causes a "String Space Corrupt" error in
QB.EXE in QuickBASIC 4.00 and 4.00b and exits back to DOS when the
above steps are followed:

'NOTE: Parameter must be a nonzero length literal string.
'      If you use a variable, the problem will not occur.
CALL ASub("X")

'NOTE: The parameter can be any length or can be a variable.
'Set breakpoint (F9) &amp; Press F8 or F10 to cause "String Space Corrupt"
CALL ASub("")
END

SUB ASub (s$)
'Now, go back and set a breakpoint on second CALL at module-level code
'(press F2 followed by RETURN). After setting the breakpoint, continue
'executing (press F5).
STOP
END SUB
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>