<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q230515: COMTI Method Invocation Fails With Runtime Error 1426 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q230515: COMTI Method Invocation Fails With Runtime Error 1426" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/230/Q230515/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/230/Q230515/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q230515: COMTI Method Invocation Fails With Runtime Error 1426","url":"http://jeffpar.github.io/kbarchive/kb/230/Q230515/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q230515-comti-method-invocation-fails-with-runtime-error-1426">Q230515: COMTI Method Invocation Fails With Runtime Error 1426</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q230515
Product(s): Microsoft SNA Server
Version(s): WINDOWS:4.0 SP2,4.0SP2
Operating System(s): 
Keyword(s): kbsna400sp3fix
Last Modified: 06-AUG-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft COM Transaction Integrator for CICS and IMS, version 4.0 SP2 
- Microsoft SNA Server, version 4.0SP2 
-------------------------------------------------------------------------------


SYMPTOMS
========

A COM Transaction Integrator (COMTI) method may fail to invoke properly when all
of the following conditions are true:

- The "Authenticate with User Credentials" check box is enabled in the Remote
  Environment (RE).

- The Windows NT domain name derived from the invoking user/process is 15
  characters in length.

- The application is not using explicit security credentials (application
  override feature).

The following error message may be posted to the Windows NT application event log
if this problem occurs:

  (102) COM Transaction Integrator reported the following exception to the
  client:

  Component: &lt;COMTI Component Name&gt;
  Method: &lt;COMTI Method&gt;

  Exception description: (1426) Could not derive object creator's domain and
  user name from MTS context SID. System error 8004ff05.

  EXPLANATION: An Automation exception representing an error condition was
  returned to a COM Transaction Integrator client. The description shown above
  contains more information about the exception that was reported.

  ACTION: The exception may be caused by communication problems or errors in
  your host application. See the exception description for corrective actions

NOTE: This problem does not occur when the "Authenticate with Package
Credentials" check box is enabled in the RE for the COMTI component.

CAUSE
=====

COMTI fails to allocate a memory buffer large enough to handle Windows NT domain
names that are 15 characters in length.

RESOLUTION
==========

To resolve this problem, obtain the latest service pack for SNA Server version
4.0. For additional information, click the following article number to view the
article in the Microsoft Knowledge Base:

  Q215838 How to Obtain the Latest SNA Server Version 4.0 Service Pack


STATUS
======

Microsoft has confirmed that this is a problem in Microsoft SNA Server version
4.0 SP2. This problem was first corrected in SNA Server version 4.0 Service Pack
3.

MORE INFORMATION
================

When user-level security is enabled in the RE and the end-user application is
not taking advantage of explicit security callbacks, COMTI must extract the
domain and user account name of the base client that initiated the MTS activity
and (indirectly) forward this along to the host account cache. If, for example,
the COMTI component uses an RE configured for LU6.2 transport, the domain and
user name extracted from the calling process are passed in the MC_ALLOCATE verb
along with a flag indicating "privileged proxy" is specified for the account. If
the RE is configured to use TCP/IP, COMTI will pass the extracted information
directly to host account cache. If everything is configured correctly, the
appropriate mainframe credentials are sent to the host.

When this particular problem occurs, COMTI is unable to properly build the domain
name, which results in a failed method invocation.

Additional query words:

======================================================================
Keywords          : kbsna400sp3fix 
Technology        : kbAudDeveloper kbSNAServSearch kbCOMTISearch kbCOMTI400SP2 kbComSearch
Version           : WINDOWS:4.0 SP2,4.0SP2
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>