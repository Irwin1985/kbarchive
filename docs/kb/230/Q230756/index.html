<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q230756: BUG: Windows CE Emulation Serial Communications Bugs | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q230756: BUG: Windows CE Emulation Serial Communications Bugs" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/230/Q230756/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/230/Q230756/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q230756: BUG: Windows CE Emulation Serial Communications Bugs","url":"http://jeffpar.github.io/kbarchive/kb/230/Q230756/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q230756-bug-windows-ce-emulation-serial-communications-bugs">Q230756: BUG: Windows CE Emulation Serial Communications Bugs</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q230756
Product(s): Microsoft C Compiler
Version(s): WINDOWS:5.0,6.0
Operating System(s): 
Keyword(s): kbAPI kbCommPort kbKernBase kbSDKWin32 kbOSWinCE200bug kbOSWinCE210bug kbFAQ
Last Modified: 05-MAY-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows CE Toolkit for Visual C++, versions 5.0, 6.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When running under the Windows CE emulator, the following are some issues you
might encounter with serial communications:

- Using HPC Pro emulation, attempting to open a comm port with the CreateFile
  API returns INVALID_HANDLE_VALUE, and GetLastError() returns
  ERROR_ALREADY_EXISTS.

- Using HPC emulation, attempting to open a comm port with the CreateFile API
  returns returns ERROR_INVALID_HANDLE, and GetLastError() returns 0.

- When using the serial port in the Windows CE emulator, the serial port works
  normally for a while, but after a certain number of calls to ReadFile or
  WriteFile, future calls to ReadFile/WriteFile seems to hang.

RESOLUTION
==========

Regardless of whether you run into any of these issues, it is highly recommended
that you test and debug your application running on the actual target hardware.
Differences in timing and serial hardware such as the UART can cause enough
differences that testing on the actual target hardware is the only way to ensure
your application performs as desired.

If your CE device only has one serial port, you can debug using an Ethernet
connection so that your serial port can be used by your application. For more
information about remotely debugging over an Ethernet connection, please see the
documentation included with the Windows CE Toolkit for Visual C++.

STATUS
======

Microsoft has confirmed this to be a bug in the Microsoft products listed at the
beginning of this article.

REFERENCES
==========

Q175029 INFO: Troubleshooting Windows CE Emulation

Additional query words:

======================================================================
Keywords          : kbAPI kbCommPort kbKernBase kbSDKWin32 kbOSWinCE200bug kbOSWinCE210bug kbFAQ 
Technology        : kbVCsearch kbAudDeveloper kbWinCETKVCSearch kbWinCESearch kbWinCETK500VC kbWinCETK600VC
Version           : WINDOWS:5.0,6.0
Issue type        : kbbug

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>