<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q230250: XFOR:Internet Mail Service Failed to Deliver Message, Error 4117 | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q230250: XFOR:Internet Mail Service Failed to Deliver Message, Error 4117" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/230/Q230250/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/230/Q230250/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q230250: XFOR:Internet Mail Service Failed to Deliver Message, Error 4117","url":"http://jeffpar.github.io/kbarchive/kb/230/Q230250/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q230250-xforinternet-mail-service-failed-to-deliver-message-error-4117">Q230250: XFOR:Internet Mail Service Failed to Deliver Message, Error 4117</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q230250
Product(s): Microsoft Exchange
Version(s): winnt:4.0,5.0,5.5
Operating System(s): 
Keyword(s): exc4 exc5 exc55
Last Modified: 22-JUL-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, versions 4.0, 5.0, 5.5 
-------------------------------------------------------------------------------

SYMPTOMS
========

The Internet Mail Service may fail to deliver inbound Internet messages if the
Character Sets setting is improperly configured. An Event Log entry similar to
the following appears in the Windows NT application log:

  Event ID: 4117
  Source: MSExchangeIMC
  Description:
  An error was returned from the messaging software the Internet Mail Service
  uses to process messages on the Microsoft Exchange Server. As a result, the
  message in spool file Jtmrmaqv failed to be delivered. The message has been
  moved to the IMCDATA\IN\ARCHIVE directory.

The spool file name may vary from computer to computer.

CAUSE
=====

The Character Sets setting on Internet Mail Service is improperly configured.
This usually happens if the default Character Sets setting was changed.

The setting is on the Internet Mail tab of Internet Mail Service Properties page.
The default setting for either MIME or Non-MIME is "Western European
(ISO-8859-1)."

This can also occur if antivirus software that is not "Exchange aware" is running
on the system. Use of antivirus software that is not "Exchange aware" is highly
discouraged.

RESOLUTION
==========

To resolve this problem, you need to reconfigure the Character Sets setting
using the following procedure:

1. Check the 4117 event, locate the spool file name ("Jtmrmaqv" in the above
  example).

2. Open this file under Exchsrvr\Imcdata\In\Archive with Notepad.exe.

3. The majority of this file is in plain text format. It contains the header and
  body of the inbound message to be delivered. The character set of the message
  is included in lines similar to:

  Content-Type: text/plain;
  charset="ISO-8859-1"

4. Open the Exchange Server Administrator program, and open the properties for
  the Internet Mail Service.

5. On the Internet Mail tab, reset the character sets to correspond with the
  character set name you find in step 3. (If this problem only happens to
  certain domains, you may prefer per-domain setting by clicking the E-Mail
  Domain button.)

6. Stop and restart Internet Mail Service.

MORE INFORMATION
================

To test the new setting:

1. Stop the Internet Mail Service.

2. Move files under Exchsrvr\Imcdata\In\Archive to Exchsrvr\Imcdata\In.

3. Restart the Internet Mail Service.

Messages are delivered to corresponding mailboxes and no event 4117 appears in
the application log.

Additional query words: MSExchangeIMC

======================================================================
Keywords          : exc4 exc5 exc55 
Component         : IMC IMS
Technology        : kbExchangeSearch kbExchange500 kbExchange550 kbExchange400 kbZNotKeyword2
Version           : winnt:4.0,5.0,5.5
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>