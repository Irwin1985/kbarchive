<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q97020: OS_VERSION Points to Incorrect COMMAND.COM on Novell | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q97020: OS_VERSION Points to Incorrect COMMAND.COM on Novell" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/097/Q97020/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/097/Q97020/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q97020: OS_VERSION Points to Incorrect COMMAND.COM on Novell","url":"http://jeffpar.github.io/kbarchive/kb/097/Q97020/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q97020-os_version-points-to-incorrect-commandcom-on-novell">Q97020: OS_VERSION Points to Incorrect COMMAND.COM on Novell</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q97020
Product(s): Microsoft Disk Operating System
Version(s): MS-DOS:6.0,6.2,6.21,6.22
Operating System(s): 
Keyword(s): msdos
Last Modified: 19-NOV-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft MS-DOS operating system versions 6.0, 6.2, 6.21, 6.22 
-------------------------------------------------------------------------------

SYMPTOMS
========

If you are using MS-DOS 6.0 or 6.2 with a Novell network, you may receive the
following error message or your system may stop responding (hang).

  Bad or missing Command Interpreter

CAUSE
=====

Because the Novell NET.COM file requires that you use SETVER (set for MS-DOS
version 5.0 by default), the OS_VERSION environment variable is set to the
current version as follows:

  OS_VERSION=V5.00

Many Novell system login scripts map the COMSPEC environment variable to the
OS_VERSION variable. (This is not an MS-DOS environment variable.) Under this
configuration, when MS-DOS needs to find the transient portion of COMMAND.COM,
it looks in the V5.00 directory on the network and may lock the computer or
generate the error message above.

WORKAROUND
==========

To temporarily work around this problem, do the following:

1. Create a directory for the MS-DOS files called V4.60 on the network.

2. Copy the MS-DOS 6.0 files to the V4.60 directory.

3. Modify the SETVER.EXE table by typing the following at the MS-DOS command
  prompt:

  " setver netx.com 4.60 " (without the quotation marks)

4. Restart your computer by pressing CTRL+ALT+DEL.


NOTE: This procedure requires that you use a directory name with a version number
earlier than 5.0 (4.40, 4.50, and so forth). The actual directory name doesn't
matter since NETX depends on the major version number only.

MORE INFORMATION
================

The new Novell shell (version 3.32) is compatible with MS-DOS 6.0. The new shell
is available for download from the NOVFILES area on CompuServe in the file
DOSUP7.EXE.

NOTE: To make this version work correctly, you must remove the SETVER entry for
NETX.EXE, BNETX.EXE, EMSNETX.EXE, or XMSNETX.EXE. For example, type "setver
netx.exe /d" (without the quotation marks) at the MS-DOS command prompt and then
press ENTER.

If you are using MS-DOS 6.2 with the Novell 3.32 shell, you still need to use a
directory called V6.00 if you want to use %OS_VERSION. This information may
change when Novell releases an MS-DOS 6.2-compatible version of its shell.

Additional query words: 6.22 6.00 6.20 %osver% os_ver os ver netware osver invalid OS_VER=DOS5.00

======================================================================
Keywords          : msdos 
Technology        : kbMSDOSSearch kbMSDOS621 kbMSDOS622 kbMSDOS620 kbMSDOS600
Version           : MS-DOS:6.0,6.2,6.21,6.22

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>