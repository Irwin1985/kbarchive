<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q186618: New System Policy Options in Terminal Server | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q186618: New System Policy Options in Terminal Server" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/186/Q186618/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/186/Q186618/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q186618: New System Policy Options in Terminal Server","url":"http://jeffpar.github.io/kbarchive/kb/186/Q186618/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q186618-new-system-policy-options-in-terminal-server">Q186618: New System Policy Options in Terminal Server</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q186618
Product(s): Microsoft Windows NT
Version(s): WinNT:4.0
Operating System(s): 
Keyword(s): 
Last Modified: 11-DEC-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows NT Server version 4.0, Terminal Server Edition 
-------------------------------------------------------------------------------

IMPORTANT: This article contains information about editing the registry.
Before you edit the registry, make sure you understand how to restore it if
a problem occurs. For information on how to do this, view the "Restoring
the Registry" online Help topic in Regedit.exe or the "Restoring a Registry
Key" online Help topic in Regedt32.exe.

SUMMARY
=======

Terminal Server includes four new user policy options.

- Remove Windows NT Security Item from Start Menu
- Remove Disconnect Item from Start Menu
- Remove Logoff Item from Start Menu
- Prevent users from creating global file associations

These options are found under the User policy in Windows NT Shell\Restrictions
and can be implemented globally under Default User or in
administratively-created specific user or group policies.

MORE INFORMATION
================

WARNING: Using Registry Editor incorrectly can cause serious problems that may
require you to reinstall your operating system. Microsoft cannot guarantee that
problems resulting from the incorrect use of Registry Editor can be solved. Use
Registry Editor at your own risk.

For information about how to edit the registry, view the "Changing Keys And
Values" Help topic in Registry Editor (Regedit.exe) or the "Add and Delete
Information in the Registry" and "Edit Registry Data" Help topics in
Regedt32.exe. Note that you should back up the registry before you edit it. If
you are running Windows NT, you should also update your Emergency Repair Disk
(ERD).

User Policy Changes
-------------------

The User policy is implemented by loading settings into the HKEY_CURRENT_USER
section of the registry when a user's profile is loaded at logon time. These new
settings are REG_DWORD with values of 0x0 (do not apply this policy) or 0x1
(apply the policy). The default is to not apply the policy. The values set in
the registry include:

  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion
  \Policies\Explorer\ 

NOTE: The above registry key is one path; it has been wrapped for readability.

Value: NoNtSecurity (REG_DWORD) 0x1 = Hide Windows NT Security menu item

Value: NoDisconnect (REG_DWORD) 0x1 = Hide Disconnect menu item

Value: NoLogoff (REG_DWORD) 0x1 = Hide Logoff menu item

In addition to the Explorer Shell, these policies will also be applied to the
Windows NT Security dialog by using CTRL+ALT+DEL on the console or by the
Windows NT Security item (or CTRL-ALT-END) in the Start menu from a client. The
Logoff and Disconnect buttons will be disabled based on the NoDisconnect and
NoLogoff policies.

Another small change includes the removal of the Windows NT Security menu item
from the Start menu for the console. This removal is to ensure the console
functions like Windows NT Server or Workstation, which requires a user to press
CTRL+ALT+DEL to access the Windows NT Security dialog box.

Preventing Users from Changing Global File Associations
-------------------------------------------------------

In Windows, file types are associated with tools by mapping a file's extension to
an executable program (for example, .xls files are associated with Excel.exe).
The shell is aware of these file associations and runs Excel when you open an
.xls file. The problem on Terminal Server is that these file associations are
stored under HKEY_LOCAL_MACHINE, making them "global" associations.

The shell also makes it easy to change these associations through a GUI
interface, making it easy for a single user to change an association. Because
the associations are global, it is easy for a single user to change the expected
behavior of the entire system.

To prevent this problem, Terminal Server includes a user policy that disables the
file association functionality in the graphical user interface. This policy is
set using System Policy Editor and is located under Default User\Windows NT
Shell\Restrictions and is called "Prevent user from changing file type
associations."

Additional query words:

======================================================================
Keywords          :  
Technology        : kbWinNTsearch kbWinNT400search kbWinNTSsearch kbWinNTS400search kbNTTermServ400 kbNTTermServSearch
Version           : WinNT:4.0
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>