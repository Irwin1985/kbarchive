<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q179381: PRB: Error Connecting to MS Query with UserConnection Designer | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q179381: PRB: Error Connecting to MS Query with UserConnection Designer" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/179/Q179381/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/179/Q179381/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q179381: PRB: Error Connecting to MS Query with UserConnection Designer","url":"http://jeffpar.github.io/kbarchive/kb/179/Q179381/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q179381-prb-error-connecting-to-ms-query-with-userconnection-designer">Q179381: PRB: Error Connecting to MS Query with UserConnection Designer</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q179381
Product(s): Microsoft Visual Basic for Windows
Version(s): 
Operating System(s): 
Keyword(s): kbnokeyword kbVBp500 kbVBp600 kbGrpDSVBDB
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Learning Edition for Windows, versions 5.0, 6.0 
- Microsoft Visual Basic Professional Edition for Windows, versions 5.0, 6.0 
- Microsoft Visual Basic Enterprise Edition for Windows, versions 5.0, 6.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When using the UserConnection Designer, you receive the following message when
attempting to build a query:

  There was a problem attempting to communicate with MS Query.

CAUSE
=====

The UserConnection Designer cannot find where MS Query is located on the system.

RESOLUTION
==========

Make sure the proper registry key is pointing to where MS Query is located on
the system. To do so, you must use RegEdit.

WARNING: Using Registry Editor incorrectly can cause serious, system-wide
problems that may require you to reinstall Windows to correct them. Microsoft
cannot guarantee that any problems resulting from the use of Registry Editor can
be solved. Use this tool at your own risk.

The correct registry key is found at the following location:

  HKEY_LOCAL_MACHINE\Software\Microsoft\Shared Tools\VBQuery

The Path value should be set correctly to where MS Query is located. The MS Query
executable is named Msqry32.exe.

MORE INFORMATION
================

Steps to Reproduce
------------------

1. Launch Regedit.exe (click Run on the Start menu, choose REGEDIT, and click
  OK).

2. Go to the HKEY_LOCAL_MACHINE\Software\Microsoft\Shared Tools\VBQuery key.

3. This key has two data values. Edit the "Path" value to make it invalid (for
  example, change the name of Msqry32.exe to Msqry3.exe).

4. Start Visual Basic and select a standard EXE.

5. Click Add ActiveX Designer on the Project menu, and select "Microsoft
  UserConnection."

6. When the UserConnection property page appears, select "User DNS-Less
  Connection String."

7. Under "ODBC Driver," select "Microsoft Access Driver (*.mdb)" and click OK.

8. Under the UserConnections form, right-click UserConnection1 and select
  "Insert Query."

9. When the ODBC Microsoft Access 97 Setup dialog box appears, click OK.

10. When the Select Database dialog box appears, choose the "NWIND.MDB"
  database, and click OK.

11. When the Query1 dialog box appears, click the "Based On User-Defined SQL"
  option.

12. Type in the SQL statement "Select * from customers" (without the quotation
  marks) in the text box, then click the "Build" button.

  Visual Basic will hang for a few seconds, one of the following will happen:

   - You will receive the following message:

  There was a problem attempting to communicate with MS Query.

   - Your SQL statement will be erased.

13. Edit the HKEY_LOCAL_MACHINE\Software\Microsoft\Shared Tools\VBQuery key back
  to its original value.

14. Repeat steps 4-12, and MS Query will launch properly.

Additional query words: user connection msquery

======================================================================
Keywords          : kbnokeyword kbVBp500 kbVBp600 kbGrpDSVBDB 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2 kbVB500Search kbVB600Search kbVBA500 kbVBA600 kbVB500 kbVB600
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>