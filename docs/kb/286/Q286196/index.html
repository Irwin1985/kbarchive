<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q286196: IISReset May Not Save IIS Configuration Changes | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q286196: IISReset May Not Save IIS Configuration Changes" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/286/Q286196/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/286/Q286196/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q286196: IISReset May Not Save IIS Configuration Changes","url":"http://jeffpar.github.io/kbarchive/kb/286/Q286196/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q286196-iisreset-may-not-save-iis-configuration-changes">Q286196: IISReset May Not Save IIS Configuration Changes</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q286196
Product(s): Internet Information Server
Version(s): 5.0
Operating System(s): 
Keyword(s): 
Last Modified: 15-MAR-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Services version 5.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you make changes to your Internet Information Services (IIS) configuration
through the Microsoft Management Console (MMC) or through scripting, some
changes may not be saved after you use the iisreset command from the MMC or from
a command prompt with no switches.

CAUSE
=====

The IISReset command line tool waits for a normal shutdown of the services
before it starts them again. Because of the number of services that are
dependent on the IISAdmin service, the shutdown may not occur in a timely
manner. When this happens, IISReset forces the shutdown of the services. This
can result in metabase changes that are not saved properly.

WORKAROUND
==========

To save the IIS configuration to the metabase, use the net stop and the net
start commands to stop and start your services, or stop and start the services
from the MMC snap-in. To locate the snap-in, follow these steps:

1. On the task bar click Start, point to Programs, point to Administrative
  Tools, and then click Services.

2. Right-click IISAdmin Service and click Stop.

The following examples illustrate the commands that are necessary to stop and
start IIS from a command prompt. To stop IIS from a command prompt:

  net stop iisadmin /y

NOTE: Take note of each of the services that depend on the IISAdmin Service,
because you need to restart each of these services in the next step.

To start IIS from a command prompt:

  net start w3svc
  net start msftpsvc
  net start smtpsvc
  net start &lt;short name for any other services that are listed when you stop IIS&gt;

NOTE: Because W3SVC and the other services that are listed depend on the IISAdmin
Service, the the IISAdmin Service is started automatically when the W3SVC
service is started.

For additional information on finding the short names of services, click the
article number below to view the article in the Microsoft Knowledge Base:

  Q271362 How to Find the Short Names of Services

MORE INFORMATION
================

Do not use IISReset to force IIS configuration changes to be saved to the
metabase. Only use IISReset to recover from serious problems that a Web server
experiences. For example, when a Web server stops responding (hangs) or crashes,
or when 100% CPU utilization occurs.

For more information, see the notes in the IISReset window in the MMC.

Additional query words: IIS IISRESET Metabase

======================================================================
Keywords          :  
Technology        : kbiisSearch kbiis500
Version           : :5.0
Issue type        : kbprb
Solution Type     : kbpending

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>