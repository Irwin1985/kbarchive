<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q149425: IDC: Error Performing Query, Not Defined as a Valid User | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q149425: IDC: Error Performing Query, Not Defined as a Valid User" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/149/Q149425/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/149/Q149425/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q149425: IDC: Error Performing Query, Not Defined as a Valid User","url":"http://jeffpar.github.io/kbarchive/kb/149/Q149425/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q149425-idc-error-performing-query-not-defined-as-a-valid-user">Q149425: IDC: Error Performing Query, Not Defined as a Valid User</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q149425
Product(s): Internet Information Server
Version(s): 1.0 3.51
Operating System(s): 
Keyword(s): kbnetwork
Last Modified: 02-MAY-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Server 1.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you access an IDC script, you may receive the following error message:

  Error Performing Query
  *[State=3700][Error=18450][Microsoft][ODBC SQL Driver][SQL Server]
  Login failed- User: _ Reason: Not defined as a valid user of a
  trusted SQL Server Connection.

CAUSE
=====

The error message above may occur in the following conditions:

- Your SQL Server is not the same computer as your Internet Information Server
  (IIS).

- You are using Microsoft Windows NT Challenge/Response authentication on IIS.

- You are using Integrated or Mixed Security on the Microsoft SQL Server.

- You are not are not providing the Username: or Password: values in your IDC
  Script.

WORKAROUND
==========

There are two possible workarounds:

- Install SQL Server on the same computer as the Internet Information Server
  and set up your ODBC System DSN to be Local Server instead or a remote
  computer name.

  -or-

- Use Basic Authentication instead of Windows NT Challenge/Response (for
  example, the user will be prompted to login using a dialog box)

MORE INFORMATION
================

When the client executes the IDC script, IIS must determine whether the
datasource is local or remote. If the datasource defined as Local System, the
query is passed to the SQL Server on the same computer. If the datasource is
remote, IIS must make a network connection to SQL Server. When it does, it does
not pass the credentials of user logged on to the client computer; instead, it
passes a blank username and password.

The SQL Server tries to validate a user without a username; it fails, and it
returns the following message to IIS:

  Login failed- User: _ Reason: Not defined as a
  valid user of a trusted SQL Server Connection

The Internet Information Server then passes the results of the query to the
client web browser.

Additional query words: prodiis winnt
======================================================================
Keywords          : kbnetwork 
Technology        : kbiisSearch kbiis100
Version           : 1.0 3.51

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>