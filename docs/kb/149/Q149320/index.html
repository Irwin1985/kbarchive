<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q149320: BUG: First ListItem Truncated with ListView in Report View | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q149320: BUG: First ListItem Truncated with ListView in Report View" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/149/Q149320/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/149/Q149320/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q149320: BUG: First ListItem Truncated with ListView in Report View","url":"http://jeffpar.github.io/kbarchive/kb/149/Q149320/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q149320-bug-first-listitem-truncated-with-listview-in-report-view">Q149320: BUG: First ListItem Truncated with ListView in Report View</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q149320
Product(s): Microsoft Visual Basic for Windows
Version(s): 4.00 | 4.00
Operating System(s): 
Keyword(s): kbbuglist
Last Modified: 11-JAN-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Standard Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Professional Edition, 32-bit, for Windows, version 4.0 
- Microsoft Visual Basic Enterprise Edition, 32-bit, for Windows, version 4.0 
-------------------------------------------------------------------------------

SYMPTOMS
========

If the first item added to a ListView control set to Report view mode is added
outside of the Form_Load event, the text of that item can be truncated and not
displayed completely. Subsequent ListItem objects added to the ListView display
their text correctly. The problem does not occur if the text of the ListItem
object is specified with the Add method of the ListItem collection instead of as
a separate property assignment.

Another article detailing a somewhat similar problem with the ListView in Report,
rather than List, view mode is article Q149264, "BUG: ListView in Report View
Truncates First ListItem." This article outlines the different symptoms of that
problem in addition to a different workaround.

WORKAROUND
==========

This problem can be avoided in two ways:

- Add the initial ListItem to the ListView during the Form_Load event rather
  than adding at a later time.

-or-

- Specify the text of the initial ListItem in the Add method of the ListItem
  collection object instead of as a separate property assignment. For example,
  instead of using this code (assuming lv is a ListItem object)

        Set lv = ListView1.ListItems.Add
        lv.Text = "This is the string"

  use:

        Set lv = listview1.ListItems.Add(, , "This is the string")

  Any strings added after the initial item can be added in any manner from any
  where in code.

STATUS
======

Microsoft has confirmed this to be an issue in the Microsoft products listed at
the beginning of this article. Microsoft is researching this problem and will
post new information here in the Microsoft Knowledge Base as it becomes
available.

MORE INFORMATION
================

Steps to Reproduce
------------------

1. Start Visual Basic 4.0. Form1 is created by default.

2. Add a single ListView control to the form1.

3. Add this code to the project:

     Private Sub Form_Load()
         ListView1.View = lvwReport
         ListView1.ColumnHeaders.Add , , "Goo"
     End Sub

     Private Sub FOrm_Click()
         Dim lv As ListItem

         Set lv = listView1.ListItems.Add
         lv.Text = "THIS IS A VERY LONG STRING"
     End Sub

4. Press F5 or select Start from the Run menu to run the application.

5. Click the form once and see that the new entry to the ListView is truncated
  and is not completely displayed. Any subsequent clicks to the form after this
  will result in the correct string being displayed.

Additional query words: 4.00 vb4win vb432

======================================================================
Keywords          :  kbbuglist
Technology        : kbVBSearch kbAudDeveloper kbVB400Search kbVB400
Version           : 4.00 | 4.00
Issue type        : kbbug

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>