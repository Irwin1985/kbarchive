<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q149343: HOWTO: Implement Context-Sensitive Help for Dialog Controls | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q149343: HOWTO: Implement Context-Sensitive Help for Dialog Controls" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/149/Q149343/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/149/Q149343/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q149343: HOWTO: Implement Context-Sensitive Help for Dialog Controls","url":"http://jeffpar.github.io/kbarchive/kb/149/Q149343/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q149343-howto-implement-context-sensitive-help-for-dialog-controls">Q149343: HOWTO: Implement Context-Sensitive Help for Dialog Controls</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q149343
Product(s): Microsoft C Compiler
Version(s): winnt:4.0,4.1
Operating System(s): 
Keyword(s): kbCSHelp kbMFC kbVC400 kbGrpDSMFCATL
Last Modified: 30-JUL-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- The Microsoft Foundation Classes (MFC), included with:
   - Microsoft Visual C++, 32-bit Editions, versions 4.0, 4.1 
-------------------------------------------------------------------------------

SUMMARY
=======

Context-Sensitive Help for dialog controls can be easily provided with the help
of the resource editor. Using the resource editor eliminates the need to build a
help ID array in memory.

MORE INFORMATION
================

The resource editor has the ability to automatically generate context help IDs
for dialog controls. To start the process, double-click the control in the
resource editor. This opens the control's property page. Select the Help ID
check box in the general tab. Then save the resource. The resource editor then
generates a file named Resource.hm, which contains help contexts and
corresponding ID numbers in the form of #define.

To add the Context-Sensitive Help button to the dialog itself, bring up the
properties for the dialog template. Click the Extended Styles tab, and select
the Context Help check box.

The help context is generated by prepending an H to the control ID in Resource.h.
The help context is what the help text author uses to identify Help topics in
.rtf file. The help context ID number is what the programmer associates with
each resource. The help context IDs are generated by adding 0x80000000 +
(IDD_DIALOG &lt;&lt; 16) to the control ID in Resource.h. The help contexts and
ID numbers are mapped together in the [MAP] section of the .hpj file.

When your application calls WinHelp, the Windows Help engine uses the context ID
your application passes to locate and display the Help topic denoted by that
context. At run time, the framework manages the process of supplying the
appropriate help context ID. These context help IDs are passed as the
dwContextID member of the HELPINFO structure. To provide context help for the
dialog control, handle the WM_HELP message for the dialog, and in the handler,
call WinHelp with context help ID as the last parameter. Also include the
Resource.hm file in the [MAP] section of the .hpj file.

How to Provide Context Help for Property Sheet or Win32s Application
--------------------------------------------------------------------

When you add a help ID to any control on a dialog, the resource editor uses a
DIALOGEX dialog template for the dialog. DIALOGEX templates are not supported
for property sheets or on Win32s. To provide context help for a property sheet
or Win32s application, see the DLGHLP32 sample in the following article in the
Microsoft Knowledge Base:

  Q141724 SAMPLE: Context-Sensitive Help in a CDialog Object

In the help project (.hpj) file include Resource.hm:

      [MAP]
      #include &lt;resource.hm&gt;

Sample Code
-----------

  BEGIN_MESSAGE_MAP(CMyDialog, CDialog)
      ON_WM_HELPINFO()
  END_MESSAGE_MAP()

  BOOL CMyDialog::OnHelpInfo(HELPINFO* pHelpInfo)
  {
      if (pHelpInfo-&gt;iContextType == HELPINFO_WINDOW)
      {
          AfxGetApp()-&gt;WinHelp( pHelpInfo-&gt;dwContextId,
                                HELP_CONTEXTPOPUP);
      }

      return TRUE;
  }

Additional query words: MfcHelp

======================================================================
Keywords          : kbCSHelp kbMFC kbVC400 kbGrpDSMFCATL 
Technology        : kbAudDeveloper kbMFC
Version           : winnt:4.0,4.1
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>