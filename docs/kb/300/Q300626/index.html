<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q300626: FIX: Unable to Specify Folder Path for Moderated Newsgroups | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q300626: FIX: Unable to Specify Folder Path for Moderated Newsgroups" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/300/Q300626/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/300/Q300626/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q300626: FIX: Unable to Specify Folder Path for Moderated Newsgroups","url":"http://jeffpar.github.io/kbarchive/kb/300/Q300626/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q300626-fix-unable-to-specify-folder-path-for-moderated-newsgroups">Q300626: FIX: Unable to Specify Folder Path for Moderated Newsgroups</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q300626
Product(s): Internet Information Server
Version(s): 2.0,2.5,4.0,5.0
Operating System(s): 
Keyword(s): tslic_tslic
Last Modified: 08-MAY-2002

IMPORTANT: This article contains information about editing the metabase. Before you edit the metabase, verify that you have a backup copy that can be restored if a problem occurs. For information about how to do this, view the "Configuration Backup/Restore" Help topic in Microsoft Management Console (MMC).
-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Internet Information Server versions 4.0, 5.0 
- Microsoft Commercial Internet System versions 2.0, 2.5 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you try to specify a folder path for a moderated newsgroup under the
Network News Transfer Protocol (NNTP) virtual server settings, you may receive
the following error message:

  The domain name is not valid.

CAUSE
=====

The Internet Information Services (IIS) Help documentation states that you can
either specify a Simple Mail Transfer Protocol (SMTP) server name or a folder
path for moderated newsgroups. The IIS Management Console only allows
alphanumeric characters and a period (.) to specify a valid server name or fully
qualified domain name (FQDN).

RESOLUTION
==========

WARNING: Editing the metabase incorrectly can cause serious problems that may
require you to reinstall any product that uses the metabase. Microsoft cannot
guarantee that problems resulting from incorrectly editing the metabase can be
solved. Edit the metabase at your own risk.

NOTE: You should always back up the metabase before you edit it.

To work around this problem, specify the folder path as a value to the SMTP
virtual server metabase key. To do this, follow these steps:

1. Locate the Adsutil.vbs script file that is installed by IIS. You will use
  this file to modify the metabase.

2. Specify the folder path name for moderated newsgroups. The syntax is as
  follows:

  cscript adsutil.vbs set nntpsvc/&lt;virtual server instance id&gt;/smtpserver "&lt;path&gt;"

For example, if you want to specify the path as C:\Moderated for the default NNTP
server instance, run the following from a command prompt:

  cscript adsutil.vbs set nntpsvc/1/smtpserver "c:\moderated"

3. After the setting is applied, you can either restart all of the IIS services
  or restart the server.

STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft products that are
listed at the beginning of this article.


MORE INFORMATION
================

Steps to Reproduce Behavior
---------------------------

The problem occurs on a new installation of an NNTP server, where no moderated
path has been specified and does not exist for the nntpsvc/1/smtpserver key in
the metabase. You must have the Web server, SMTP server, and NNTP services
installed from the Microsoft Windows 2000 or Microsoft Windows NT Option Pack,
or equivalent services from Microsoft Commercial Internet System (MCIS) version
2.0.

1. Start the Internet Service Manager (ISM), which loads the IIS snap-in for the
  Microsoft Management Console (MMC).

2. Right-click Default NNTP Virtual Server and click Properties.

3. Click the Settings tab.

4. Under SMTP server for moderated groups type a valid folder path (for example,
  C:\Inetpub or \Inetpub) and click either Apply or OK.

Additional query words: Windows NT4, Option Pack 4, MCIS 2.0, SMTP, NNTP, IIS

======================================================================
Keywords          : tslic_tslic 
Technology        : kbiisSearch kbAudDeveloper kbiis500 kbiis400 kbMCISSearch kbMCIS200 kbMCIS250
Version           : :2.0,2.5,4.0,5.0
Issue type        : kbbug
Solution Type     : kbfix

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>