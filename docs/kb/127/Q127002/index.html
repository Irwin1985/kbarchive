<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q127002: PC Ext: Err Msg: A Critical Error Has Occurred… | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q127002: PC Ext: Err Msg: A Critical Error Has Occurred…" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/127/Q127002/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/127/Q127002/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q127002: PC Ext: Err Msg: A Critical Error Has Occurred…","url":"http://jeffpar.github.io/kbarchive/kb/127/Q127002/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q127002-pc-ext-err-msg-a-critical-error-has-occurred">Q127002: PC Ext: Err Msg: A Critical Error Has Occurred…</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q127002
Product(s): Microsoft Mail For PC Networks
Version(s): WINDOWS:3.0a,3.2,3.2a
Operating System(s): 
Keyword(s): 
Last Modified: 05-NOV-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Mail for PC Networks, versions 3.0a, 3.2, 3.2a 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you run EXTERNAL.EXE, the following error may be displayed and placed in
the SESSION.LOG (if logging is enabled):

  12-30-94 09:47 A Critical error has occurred M:KEY\xxxxxxxx.KEY

where M: can be any drive letter that a PO is mapped to, and xxxxxxxx.KEY can be
any address for an external postoffice.

CAUSE
=====

NOTE: Critical errors may also be due to hardware or network problems. For
further information, query on "error code =" and "device =".

Hidden, locked, or corrupt .KEY files may cause the above error. Check the screen
or the SESSION.LOG for lines matching the above description. It may be necessary
to activate the /LogVerbose (-v) and /LogSession (-l) options to accomplish
this.


RESOLUTION
==========

Make sure the specified files are not locked, hidden, or corrupt. If the file is
corrupt, either restore the file from backup or reset the &lt;hex- id&gt;.KEY
and &lt;hex-id&gt;.MBG files. This can be done with one of the following
procedures:

Procedure 1
-----------

  To RESET the &lt;hex-id&gt;.KEY to 560 bytes, type:
  " DEBUG &lt;hex-id&gt;.KEY" (without the quotation marks) &lt;Enter&gt;
  At the "-" type "F100,32F,0" (without the quotation marks) &lt;Enter&gt;
  At the "-" type "RCX" (without the quotation marks) &lt;Enter&gt;
  The following will then be displayed:

  CX 1230
  :

  At the ":" type "230" (without the quotation marks) &lt;Enter&gt; (this resets
  the file to 560 bytes)
  At the "-" type "W" (without the quotation marks) &lt;Enter&gt; (you should
  see the message "Writing 00230 bytes")
  At the "-" type "Q" (without the quotation marks) &lt;Enter&gt; (to quit
  DEBUG)

The filesize should be 560 bytes.

To RESET the &lt;hex-id&gt;.MBG to 0 bytes, type:
" TYPE NUL &gt; &lt;hex-id&gt;.MBG" (without the quotation marks)

The correct filesize should be 0 bytes.

Procedure 2
-----------

1. Run Admin, Local-Admin, Create to create a test user.

2. Run LISTUSER.EXE with the -f option against the PO to determine the hex-id of
  the test user.

3. Copy the test user's &lt;hex-id&gt;.KEY and &lt;hex-id&gt;.MBG to the corrupt
  &lt;hex-id&gt;.KEY and &lt;hex-id&gt;.MBG.

4. Run Admin, Local-Admin, Delete to delete the test user.

MORE INFORMATION
================

For additional information, please see the following articles in the Microsoft
Knowledge Base:

  Q117427 MS-DOS External 3.2 and RebootOnCE

  Q116434 EXTERNAL.INI Equivalents to -Qx Command-Line Options

Additional query words: 3.00a 3.20 3.20a external critical error key

======================================================================
Keywords          :  
Technology        : kbMailSearch kbZNotKeyword3 kbMailPCN320 kbMailPCN320a kbMailPCN300a
Version           : WINDOWS:3.0a,3.2,3.2a

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>