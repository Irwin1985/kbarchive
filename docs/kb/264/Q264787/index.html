<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q264787: WD97: Blank Line Is Not Suppressed in a Conditional Mail Merge | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q264787: WD97: Blank Line Is Not Suppressed in a Conditional Mail Merge" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/264/Q264787/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/264/Q264787/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q264787: WD97: Blank Line Is Not Suppressed in a Conditional Mail Merge","url":"http://jeffpar.github.io/kbarchive/kb/264/Q264787/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q264787-wd97-blank-line-is-not-suppressed-in-a-conditional-mail-merge">Q264787: WD97: Blank Line Is Not Suppressed in a Conditional Mail Merge</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q264787
Product(s): Word 97 for Windows
Version(s): 
Operating System(s): 
Keyword(s): kbdta word8 kbfield word97 kbmerge
Last Modified: 19-MAR-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Word 97 for Windows 
-------------------------------------------------------------------------------

SUMMARY
=======

By default, Microsoft Word suppresses blank lines in a mail merge when the
result of a MERGEFIELD is blank.

However, when you perform a conditional mail merge, the result of a conditional
field may be blank. This causes an extra blank line.

For example, in a mail merge, you may want to display a special message for
residents of a particular state and not display that message to residents of
other states. You might create a letter main document that looks similar to the
following example:

  {&lt;B7&gt;MERGEFIELD&lt;B7&gt;NAME&lt;B7&gt;}&lt;B6&gt;
  {&lt;B7&gt;MERGEFIELD&lt;B7&gt;ADDRESS1&lt;B7&gt;}&lt;B6&gt;
  {&lt;B7&gt;MERGEFIELD&lt;B7&gt;CITY&lt;B7&gt;},&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;STATE&lt;B7&gt;}&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;POSTALCODE&lt;B7&gt;}&lt;B6&gt;
&lt;B6&gt;
  Dear&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;NAME&lt;B7&gt;},&lt;B6&gt;
&lt;B6&gt;
  {&lt;B7&gt;IF&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;STATE&lt;B7&gt;}&lt;B7&gt;=&lt;B7&gt;"WA"&lt;B7&gt;"For&lt;B7&gt;Washington&lt;B7&gt;state&lt;B7&gt;residents,&lt;B7&gt;
  we&lt;B7&gt;offer&lt;B7&gt;special&lt;B7&gt;rates&lt;B7&gt;to&lt;B7&gt;the&lt;B7&gt;Far&lt;B7&gt;East&lt;B7&gt;and&lt;B7&gt;Japan."}&lt;B6&gt;
&lt;B6&gt;
  &lt;Body of letter...&gt;

When you perform the merge, the merged document for a resident of Washington
state may appear correctly as the following:

  Name&lt;B6&gt;
  Address&lt;B6&gt;
  City,&lt;B7&gt;State&lt;B7&gt;PostalCode&lt;B6&gt;
&lt;B6&gt;
  Dear&lt;B7&gt;Name,&lt;B6&gt;
&lt;B6&gt;
  For&lt;B7&gt;Washington&lt;B7&gt;state&lt;B7&gt;residents,&lt;B7&gt;we&lt;B7&gt;offer&lt;B7&gt;special&lt;B7&gt;rates&lt;B7&gt;to&lt;B7&gt;the&lt;B7&gt;Far&lt;B7&gt;East&lt;B7&gt;and&lt;B7&gt;Japan.&lt;B6&gt;
&lt;B6&gt;
  &lt;Body of letter...&gt;

But the merged document for a resident of a different state may appear as the
following:

  Name&lt;B6&gt;
  Address&lt;B6&gt;
  City,&lt;B7&gt;State&lt;B7&gt;PostalCode&lt;B6&gt;
&lt;B6&gt;
  Dear&lt;B7&gt;Name,&lt;B6&gt;
&lt;B6&gt;
&lt;B6&gt;
&lt;B6&gt;
  &lt;Body of letter...&gt;

The result for a non-Washington state resident is additional space (blank lines)
between the greeting and the body of the letter.

This article demonstrates how to use an IF field as a conditional statement to
evaluate the results of the field and suppress the line, if the result is blank.

MORE INFORMATION
================

This article provides two examples of how to use a conditional statement to
suppress the extra line when the result is blank. Use the following examples as
appropriate in your situation.

Example 1:

To correct the problem as described in the "Summary" section of this article, use
an IF field as a conditional statement that compares whether a MERGEFIELD meets
a certain value, as in the following example:

  {&lt;B7&gt;IF&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;}&lt;B7&gt;=&lt;B7&gt;"&lt;value&gt;"&lt;B7&gt;"True"&lt;B7&gt;"False"&lt;B7&gt;}&lt;B6&gt;

This conditional IF field states that if the MERGEFIELD is equal to
&lt;value&gt;, do the True part; otherwise, do the False part.

If the condition is met, the conditional statement inserts the text "Dear NAME,
For Washington state residents, we offer special rates to the Far East and
Japan." as you specified; however, if the condition is not met, only the
greeting "Dear NAME," appears.

Use the following example to suppress the message to Washington state residents
when the MERGEFIELD STATE is not equal to WA:

  {&lt;B7&gt;MERGEFIELD&lt;B7&gt;NAME&lt;B7&gt;}&lt;B6&gt;
  {&lt;B7&gt;MERGEFIELD&lt;B7&gt;ADDRESS1&lt;B7&gt;}&lt;B6&gt;
  {&lt;B7&gt;MERGEFIELD&lt;B7&gt;CITY&lt;B7&gt;},&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;STATE&lt;B7&gt;}&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;POSTALCODE&lt;B7&gt;}&lt;B6&gt;
&lt;B6&gt;
  {&lt;B7&gt;IF&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;STATE&lt;B7&gt;}&lt;B7&gt;=&lt;B7&gt;"WA"&lt;B7&gt;"Dear&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;NAME&lt;B7&gt;},&lt;B6&gt;
&lt;B6&gt;
  For&lt;B7&gt;Washington&lt;B7&gt;state&lt;B7&gt;residents,&lt;B7&gt;we&lt;B7&gt;offer&lt;B7&gt;special&lt;B7&gt;rates&lt;B7&gt;to&lt;B7&gt;the&lt;B7&gt;Far&lt;B7&gt;East&lt;B7&gt;and&lt;B7&gt;Japan."&lt;B7&gt;"Dear&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;NAME&lt;B7&gt;},"}

Example 2:

Microsoft Word suppresses blank lines when the result of a MERGEFIELD is blank.
This is especially useful in an address. Word suppresses the blank line when the
result of the MERGEFIELD on that line is blank.

NOTE: There must not be any additional text, punctuation, spaces, or fields on
the same line that contains the MERGEFIELD.

However, there may be some occasion when you need to use a conditional statement
in an address. This example demonstrates how to suppress the second address
line, if the result of ADDRESS2 is blank.

If your address list contains some records that have a second line for the
address (ADDRESS2) and some records that do not have a second line, a blank line
may result in your address, as in the following example:

  Microsoft Corporation
  One Microsoft Way

  Redmond, WA 98052-6399

To correct this problem, use an IF field as a conditional statement that compares
whether a MERGEFIELD meets a certain value, as in the following example:

  {&lt;B7&gt;IF&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;}&lt;B7&gt;&lt;&gt;&lt;B7&gt;""&lt;B7&gt;"True"&lt;B7&gt;"False"&lt;B7&gt;}&lt;B6&gt;

This conditional IF field states that if the MERGEFIELD is not equal to nothing,
do the True part; otherwise, do the False part.

If the condition is met, the conditional statement inserts the results of the
field (ADDRESS2) as you specified; however, if the condition is not met, the
results of the False part of the statement appear.

Use the following example to suppress the second address line when the result of
the ADDRESS2 MERGEFIELD is blank:

  {&lt;B7&gt;MERGEFIELD&lt;B7&gt;NAME&lt;B7&gt;}&lt;B6&gt;
  {&lt;B7&gt;MERGEFIELD&lt;B7&gt;ADDRESS1&lt;B7&gt;}&lt;B6&gt;
  {&lt;B7&gt;IF&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;ADDRESS2&lt;B7&gt;}&lt;B7&gt;&lt;&gt;&lt;B7&gt;""&lt;B7&gt;"{&lt;B7&gt;MERGEFIELD&lt;B7&gt;ADDRESS2&lt;B7&gt;}&lt;B6&gt;
  {&lt;B7&gt;MERGEFIELD&lt;B7&gt;CITY&lt;B7&gt;}&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;STATE&lt;B7&gt;}&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;POSTALCODE&lt;B7&gt;}"&lt;B7&gt;
  "{&lt;B7&gt;MERGEFIELD&lt;B7&gt;CITY&lt;B7&gt;}&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;STATE&lt;B7&gt;}&lt;B7&gt;{&lt;B7&gt;MERGEFIELD&lt;B7&gt;POSTALCODE&lt;B7&gt;}"}

Non-Printing Characters Used in This Article:

Character   Description      Press These Keys
------------------------------------------------

  &lt;B7&gt;        Space            Press SPACEBAR
  &lt;B6&gt;        Paragraph Mark   Press ENTER
  {}       Field Braces     Press CTRL+F9

To view these non-printing characters in your Word document, do the following:

1. On the Tools menu, click Options.

2. On the View tab, click to select the Field Codes check box (listed in the
  Show section) and the All check box (listed in the "Nonprinting characters"
  section).

3. Click OK to close the Options dialog box.

REFERENCES
==========

For additional information about how to suppress blank lines in a mail merge,
click the article number below to view the article in the Microsoft Knowledge
Base:

  Q264723 WD97: How to Suppress Blank Lines During a Mail Merge

For additional information about a similar problem in which Word may not suppress
blank spaces for a conditional statement in a mail merge, click the article
number below to view the article in the Microsoft Knowledge Base:

  Q72441 WD97: Suppressing Blank Spaces in a Print Merge (Mail Merge)

For more information about a conditional IF field, click "Contents and Index" on
the Help menu, click the Index tab in Microsoft Word Help, type the following
text

  IF field

and then double-click the selected text to go to the "Specify multiple conditions
with an IF field" topic. If you are unable to find the information you need, ask
the Office Assistant.

Additional query words:

======================================================================
Keywords          : kbdta word8 kbfield word97 kbmerge 
Technology        : kbWordSearch kbWord97 kbWord97Search kbZNotKeyword2
Version           : :
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>