<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q238166: Administrator Is Unable to Delete Local Profile in Windows NT | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q238166: Administrator Is Unable to Delete Local Profile in Windows NT" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/238/Q238166/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/238/Q238166/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q238166: Administrator Is Unable to Delete Local Profile in Windows NT","url":"http://jeffpar.github.io/kbarchive/kb/238/Q238166/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q238166-administrator-is-unable-to-delete-local-profile-in-windows-nt">Q238166: Administrator Is Unable to Delete Local Profile in Windows NT</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q238166
Product(s): Microsoft Windows NT
Version(s): winnt:4.0
Operating System(s): 
Keyword(s): kbenv
Last Modified: 11-JUN-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows NT Server version 4.0 
- Microsoft Windows NT Workstation version 4.0 
- Microsoft Windows NT Server version 4.0, Terminal Server Edition 
-------------------------------------------------------------------------------

IMPORTANT: This article contains information about modifying the registry. Before you modify the registry, make sure to back it up and make sure that you understand how to restore the registry if a problem occurs. For information about how to back up, restore, and edit the registry, click the following article number to view the article in the Microsoft Knowledge Base:

  Q256986 Description of the Microsoft Windows Registry

SYMPTOMS
========

When an administrator attempts to delete a local user profile in Windows NT 4.0,
one of the following error messages may be displayed.

- The following error message may be displayed when the administrator tries to
  delete the profile for a user account used to start a service:

  Can not delete Ntuser.dat. There has been sharing violation.
  The source or destination file may be in use.

- The following error message may be displayed when the administrator tries to
  delete the profile folder of a user who is currently logged on:

  "Profile Folder" is a windows system folder and is required for Windows to
  run properly. It cannot be deleted.

- The following error message may be displayed when the administrator tries to
  delete a profile in Windows NT Server, Terminal Server Edition, for a user
  who currently has a Terminal Server session:

  Can not remove desktop folder. There has been a sharing violation. The source
  or destination file may be in use.

CAUSE
=====

These error messages occur when the profile is in use. The user might still be
logged on or the user's session might not have closed completely.

RESOLUTION
==========

To resolve this issue, log that user account off, and/or stop any services that
are configured to start with that user account.

MORE INFORMATION
================

WARNING: If you use Registry Editor incorrectly, you may cause serious problems
that may require you to reinstall your operating system. Microsoft cannot
guarantee that you can solve problems that result from using Registry Editor
incorrectly. Use Registry Editor at your own risk.

For additional information about user profiles that appear to not be unloading
properly on Terminal Server, please click the article number below to view the
article in the Microsoft Knowledge Base:

  Q234606 Terminal Server User Profiles Do Not Unload

You can determine which user profiles are loaded by looking at the Security
Identifiers (SIDs) in the HKEY_USERS subtree in the registry.

To View the SIDs Loaded in the HKEY_USERS Subtree
-------------------------------------------------

1. Start Registry Editor (Regedt32.exe).

2. On the Window menu, click HKEY_USERS. A default folder and the SIDs of the
  user or users (in Terminal Server) logged on to the computer is displayed.
  The SIDs for user accounts used for services are also displayed.

To Determine Which SID Corresponds to a User Account
----------------------------------------------------

1. Start Registry Editor (Regedt32.exe).

2. On the Window menu, click HKEY_LOCAL_MACHINE.

3. Double-click each of the following keys to to open them:

  Software
  Microsoft
  Windows NT
  CurrentVersion
  ProfileList

A list of all of the SIDs for users who have logged on to the computer once are
displayed under the ProfileList key. The ProfileImagePath value is displayed in
the right pane, which lists the user's profile folder name, which generally
corresponds with the user account name.

Additional query words:

======================================================================
Keywords          : kbenv 
Technology        : kbWinNTsearch kbWinNTWsearch kbWinNTW400 kbWinNTW400search kbWinNT400search kbWinNTSsearch kbWinNTS400search kbWinNTS400 kbNTTermServ400 kbNTTermServSearch
Version           : winnt:4.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>