<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q238774: PRB: ODBC Driver Manager Error: &quot;Program Type out of Range&quot; | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q238774: PRB: ODBC Driver Manager Error: &quot;Program Type out of Range&quot;" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/238/Q238774/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/238/Q238774/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q238774: PRB: ODBC Driver Manager Error: &quot;Program Type out of Range&quot;","url":"http://jeffpar.github.io/kbarchive/kb/238/Q238774/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q238774-prb-odbc-driver-manager-error-program-type-out-of-range">Q238774: PRB: ODBC Driver Manager Error: "Program Type out of Range"</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q238774
Product(s): Open Database Connectivity (ODBC)
Version(s): 3.7
Operating System(s): 
Keyword(s): kbODBC kbGrpDSVCDB kbGrpDSMDAC kbDSupport kbMDAC260
Last Modified: 23-AUG-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft ODBC Driver for SQL Server, version 3.7 
-------------------------------------------------------------------------------

SYMPTOMS
========

A call to SQLBindCol may return a SQL_ERROR when you attempt to bind to the
results from a SQL Server 7.0 field defined with the data type "sysname" using
the Microsoft ODBC Driver for SQL Server version 3.7. The resulting message from
the ODBC Driver manager indicates that the reason for the failure is:

  Program Type out of Range (0)

The illustration of the error was generated using the default ODBC Trace DLL,
where an application named MYAPP is attempting to retrieve the results from the
following query in SQL Server 7.0:

  select name from master..sysdatabases where dbid=1

The process of managing the result set generated by the preceding query, using
ODBC, requires that you use both the SQLDescribeCol and the SQLBindCol
functions. SQLDescribeCol returns the result descriptor, column name, type,
column size, decimal digits, and nullability, for one column in the result set.
SQLBindCol is used to bind application data buffers to columns in the result
set. The following list shows the ODBC Trace SQL.log entries for both the
SQLDescribeCol and SQLBindCol function calls:

  MYAPP             ab:40	ENTER SQLDescribeCol 
  		HSTMT               0x00db2360
  		UWORD                        1 
  		UCHAR *             0x0004ec24 
  		SWORD                      128 
  		SWORD *             0x0004ec1c
  		SWORD *             0x0004ec0c
  		UDWORD *            0x0004ec08
  		SWORD *             0x0004eda8
  		SWORD *             0x0004ed94

  MYAPP             ab:40	EXIT  SQLDescribeCol  with return code 0 (SQL_SUCCESS)
  		HSTMT               0x00db2360
  		UWORD                        1 
  		UCHAR *             0x0004ec24 
  		SWORD                      128 
  		SWORD *             0x0004ec1c (4)
  		SWORD *             0x0004ec0c (-9)
  		UDWORD *            0x0004ec08 (128)
  		SWORD *             0x0004eda8 (0)
  		SWORD *             0x0004ed94 (1)

NOTE: A number of ODBC API Entry/Exit Points may be displayed here.

  MYAPP             ab:40	ENTER SQLBindCol 
  		HSTMT               0x00db2360
  		UWORD                        1 
  		SWORD                    32767 &lt;unknown&gt;
  		PTR                 0x000c34e4
  		SDWORD                       0
  		SDWORD *            0x000c34a8

  MYAPP             ab:40	EXIT  SQLBindCol  with return code -1 (SQL_ERROR)
  		HSTMT               0x00db2360
  		UWORD                        1 
  		SWORD                    32767 &lt;unknown&gt;
  		PTR                 0x000c34e4
  		SDWORD                       0
  		SDWORD *            0x000c34a8
  		DIAG [S1003] [Microsoft][ODBC Driver Manager] Program type out of range (0) 

Note that SQLDescribeCol indicates that the SQLDataType being returned is (-9)
and that the ColumnSize is (128). It is also important to note that the
CDatatype defined in the call to SQLBindCol is 32767 or &lt;unknown&gt; and
subsequently results in the error reported by the ODBC Driver Manager.

CAUSE
=====

The Microsoft ODBC Driver for SQL Server 3.7 has been changed to work with the
SQL_WVARCHAR, which was defined for ODBC 3.5. When retrieving results from a
column or field defined with the SQL Server system data type of "sysname",
SQLDescribeCol reports the result set column data type as SQL_WVARCHAR. If the
application was generated using an older version of the Microsoft Data Access
Components (MDAC) Software Development Kit (SDK) this newer ODBC data type may
not be defined and the CDataType information provided by SQLDescribeCol and
subsequently used by SQLBindCol is not valid.

WORKAROUND
==========

There are three possible methods to resolve or work around this problem. The
first and most immediate method to deal with this problem is to execute the
ODBCCMPT utility against the application. For example:

  odbccmpt myapp.exe

The second method is to change the SQL Statement so that SQL Server 7.0 converts
the column result to a data type that will be translated to an ODBC SQLDataType
of SQL_VARCHAR:

  select convert(varchar(30),name) from master..sysdatabases where dbid = 1

  -or-

  select cast(name as varchar(30)) from master..sysdatabases where dbid = 1

The third method is to alter the application so that it is aware of the new data
types being used by SQL Server 7.0 and the SQL Server 7.0 ODBC Driver. You can
accomplish this by incorporating the Sqlucode.h include file that contains the
#define for SQL_WVARCHAR into the application project.

The Sqlucode.h include file is located in the following directory on a SQL Server
7.0 installation where the Development Tools for SQL Server are installed:

  &lt;drive&gt;:\&lt;MSSQL7_Install_Directory&gt;\DevTools\Include

The Sqlucode.h file is also available from the MDAC SDK 2.1 update for MDAC SDK
2.0. This update is available for download at:

  http://www.microsoft.com/data/download.htm
  (http://www.microsoft.com/data/download.htm)

MORE INFORMATION
================

SQL Server 7.0 contains a number of changes, in which one of the changes is a
redefinition of the system data type "sysname" from varchar(30) to nvarchar(128)
in order to support Unicode.


REFERENCES
----------

SQL Server 7.0 Books OnLine; topic: "ODBCCMPT Utility"

For information regarding the "sysname" data type change in SQL Server 7.0: SQL
Server 7.0 Books OnLine; topic: "SQL Server Backward Compatibility Details -
Backward Compatibility Details (Level 2)"; "Changes to Columns in System Tables"

Additional query words: SQL_WVARCHAR SQLDescribeCol SQLBindCol

======================================================================
Keywords          : kbODBC kbGrpDSVCDB kbGrpDSMDAC kbDSupport kbMDAC260 
Technology        : kbSQLServSearch kbAudDeveloper kbODBCSearch kbODBCSQLServ370
Version           : :3.7
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>