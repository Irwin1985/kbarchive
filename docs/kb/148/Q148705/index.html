<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q148705: PC DirSync ErrMsg: NSDA -x Terminated Abnormally w/ Exit Code | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q148705: PC DirSync ErrMsg: NSDA -x Terminated Abnormally w/ Exit Code" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/148/Q148705/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/148/Q148705/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q148705: PC DirSync ErrMsg: NSDA -x Terminated Abnormally w/ Exit Code","url":"http://jeffpar.github.io/kbarchive/kb/148/Q148705/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q148705-pc-dirsync-errmsg-nsda--x-terminated-abnormally-w-exit-code">Q148705: PC DirSync ErrMsg: NSDA -x Terminated Abnormally w/ Exit Code</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q148705
Product(s): Microsoft Mail For PC Networks
Version(s): 3.5
Operating System(s): 
Keyword(s): 
Last Modified: 28-JAN-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Mail for PC Networks, version 3.5 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you run Directory Synchronization (Dir-Sync), you may see the following
error on the Dispatch screen or in the Dispatch session log:

  INST1 02/02/96 13:18 Checking the process table on NET1\PO1
  INST1 02/02/96 13:18 Running NSDA - xx
  INST1 02/02/96 13:18 "NSDA - xx" terminated abnormally with exit code 65

where -xx could be -RT, -S, or -RR.

CAUSE
=====

This error will occur if some portion of the NDSA process does not complete.

RESOLUTION
==========

The Dir-Sync process, DISPATCH.EXE, consists of three phases: T1, T2, and T3.
The three phases are spawned by NSDA -RT, NSDA -S, and, and NSDA -RR,
respectively. NSDA will in turn spawn another process, as follows:

  T1: NSDA -RT will spawn reqmain.
  T2: NSDA -S will spawn srvmain.
  T3: NSDA -RR will spawn reqmain, import, and rebuild.

To determine the source of the exit code 65, use the following steps.

1. Check several lines above the exit code to find the postoffice responsible
  for the error. Make a note of the time stamp and postoffice generating the
  error.

2. Go to the postoffice that reported the error, and check the DIRSYNC.LOG file.
  Locate the entries with the same date and time stamp. There may be a more
  specific error listed that will assist in locating the problem.

  For example, if the Mail Administrator program (ADMIN.EXE) is running against
  NET1\PO1, Import will not be able to complete, and you will see the following
  entries in the DIRSYNC.LOG on the DSServer:

  02/02/96 13:18 | 1 -1 Microsoft  Mail DirSync Requestor
  V3.5.12
        02/02/96 13:18 | 1 105 36
        02/02/96 13:18 | 2 91 ADMIN
  02/02/96 13:18 | 2 -1 Mailbox name:
  Admin. 02/02/96 13:18 | 2 -1 Full name:
  Administrator. 02/02/96 13:18 | 2 -1
  FLAG.GLB is locked open. 02/02/96 13:18 |
  1 -1 Import is finished

  In the DSSERVER.LOG on the requestor, you will see the following entries:

  02/02/96 13:18 | Status Microsoft  Mail DirSync Requestor
  V3.5.12 02/02/96 13:18 | Status Requestor updates received:
  36
  02/02/96 13:18 | Fatal [91] The database is locked by
  another process: ADMIN
        02/02/96 13:18 | Fatal [  ]   Mailbox name:
  Admin.
  02/02/96 13:18 | Fatal [  ]   Full name:
  Administrator.
  02/02/96 13:18 | Fatal [  ]   FLAG.GLB is locked open.
  02/02/96 13:18 | Status Import is finished

  In this case to correct the problem, close ADMIN.EXE on the problem postoffice
  and then let Dir-Sync run again.

3. If there are no associated error messages in the DIRSYNC.LOG, go to the
  following steps.

  Determine which stage the error occurred:

   - NSDA -RT (T1 time)

   - NSDA -S (T2 time - runs only on DS server)

   - NSDA -RR (T3 time)

4. If the error occurs in T1 (NSDA -RT), check the following:

   - REQCONF.GLB should be 512 bytes only and accessible.

   - REQTRANS.GLB should be accessible (not locked).

   - REQMAIN.EXE is in the correct location and accessible by DISPATCH.EXE.

5. If the error occurs in T2 (NSDA -S), check the following:

  NOTE: Only the Dir-Sync server should be running T2.

   - SRVCONF.GLB should be divisible by 1024 and accessible.

   - MSTTRANS.GLB should be accessible.

   - SYSTEM.KEY should be 560 bytes only.

   - SYSTEM.MBG should be divisible by 116 bytes and accessible.

   - SRVMAIN.EXE is in the correct location and accessible by DISPATCH.EXE If
     the two SYSTEM files do not divide evenly, or if the SYSTEM.MBG file is
     very large (quotient larger than 100), you may want to reset the two
     SYSTEM files. Refer to "Directory Synchronization (Dir- Sync)" document
     for the resetting procedures.

     You can obtain this document from the following sources:

      - Microsoft's World Wide Web Site on the Internet

      - The Internet (Microsoft anonymous ftp server)

      - The Microsoft Network (MSN)

      - Microsoft Product Support Services

     The following self-extracting file is available for download from the
     Microsoft Download Center:

  Wa0725.exe

     The following file is available for download from the Microsoft Download
     Center:

  DownloadDownload Wa0725.exe now
  (http://download.microsoft.com/download/pcmail/Utility/23/WIN/EN-US/Wa0725.exe)

     For additional information about how to download Microsoft Support files,
     click the article number below to view the article in the Microsoft
     Knowledge Base:

  Q119591 How to Obtain Microsoft Support Files from Online Services

     Microsoft used the most current virus detection software available on the
     date of posting to scan this file for viruses. Once posted, the file is
     housed on secure servers that prevent any unauthorized changes to the
     file.

     This document has also been posted to the following Internet location:

  ftp://ftp.microsoft.com/bussys/mail/pcmail public/WA0725/

     For more information about how to obtain this document, please see the
     following article in the Microsoft Knowledge Base:

  Q96060 PC DirSync: Directory Synchronization (Dir-Sync)

6. If the error occurs in T3 (NSDA -RR), check the following:

   - SRVTRANS.GLB should be 0 bytes after T3 completion if it is not at 0
     bytes, reset the file with the following command:

  "TYPE NUL &gt; SRVTRANS.GLB" (without the quotation marks)

   - USRTRANS.GLB same conditions as above.

   - NMETRANS.GLB same conditions as above.

   - GWTRANS.GLB same conditions as above.

   - GWTRANS.GLB should not be present; if it is delete it.

   - INMETRAN.GLB should not be present; if it is delete it.

   - IUSRTRAN.GLB should not be present; if it is delete it.

   - SRVUPDS.GLB should not be present; if it is delete it.

   - REQUPDS.GLB should not be present; if it is delete it.

   - Any SORTxxxx.GLB where xxxx is a number should not be present, if so
     delete it.

   - REQMAIN.EXE is in the correct location and accessible by DISPATCH.EXE.

   - IMPORT.EXE is in the correct location and accessible by DISPATCH.EXE.

   - REBUILD.EXE is in the correct location and accessible by DISPATCH.EXE.

7. Because the REBUILD.EXE process in T3 is the most time and resource consuming
  process, the following conditions may also cause the exit code 65 error:

   - Lack of disk space on postoffice server.

   - Ownerless files (Novell only) on postoffice server.

   - Lack of available memory on Dispatch computer.

MORE INFORMATION
================

There may be other factors and possible causes that are not mentioned here. This
article is intended to provide a more defined starting point to begin
troubleshooting this error.


For additional information, see Chapter 14 in the "Administrator's Guide" for
Microsoft Mail for PC Networks.

Also see the DIRSYNC.TXT file on Disk 1 of your Microsoft Mail for PC Networks
disks.

Additional query words: 3.50 fatal error 91

======================================================================
Keywords          :  
Technology        : kbMailSearch kbZNotKeyword3 kbMailPCN350
Version           : :3.5

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>