<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q148367: Possible Network File Damage with Redirector Caching | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q148367: Possible Network File Damage with Redirector Caching" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/148/Q148367/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/148/Q148367/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q148367: Possible Network File Damage with Redirector Caching","url":"http://jeffpar.github.io/kbarchive/kb/148/Q148367/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q148367-possible-network-file-damage-with-redirector-caching">Q148367: Possible Network File Damage with Redirector Caching</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q148367
Product(s): Microsoft Windows 95.x Retail Product
Version(s): 
Operating System(s): 
Keyword(s): kbfile kbnetwork win95 kbgraphxlinkcritical
Last Modified: 11-JUN-2002

IMPORTANT: This article contains information about modifying the registry. Before you modify the registry, make sure to back it up and make sure that you understand how to restore the registry if a problem occurs. For information about how to back up, restore, and edit the registry, click the following article number to view the article in the Microsoft Knowledge Base:

  Q256986 Description of the Microsoft Windows Registry

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Windows 95 
-------------------------------------------------------------------------------

SYMPTOMS
========

When you use the Microsoft Client for Microsoft Networks, a file on a Microsoft
networking server (such as a Microsoft Windows NT, Windows 95, Microsoft Windows
for Workgroups, or Microsoft LAN Manager server) may become damaged or may
contain invalid data if multiple workstations access the file at the same time.

CAUSE
=====

The network redirector (Vredir.vxd) caches data locally for files it accesses on
a Microsoft networking server. If the file size does not change or if the last
modified time does not change within a two-second period, the redirector reads
file data from the locally stored cache rather than from the file on the server.

RESOLUTION
==========

WARNING: If you use Registry Editor incorrectly, you may cause serious problems
that may require you to reinstall your operating system. Microsoft cannot
guarantee that you can solve problems that result from using Registry Editor
incorrectly. Use Registry Editor at your own risk.

This issue is resolved by the following updated file for Windows 95:

  VREDIR.VXD version 4.00.1112 (dated 2/11/97) and later

The following file is available for download from the Microsoft Download Center:

  Download Vredrupd.exe now
  (http://download.microsoft.com/download/win95upg/vredir/1/W95/EN-US/vredrupd.exe)

For additional information about how to download Microsoft Support files, click
the article number below to view the article in the Microsoft Knowledge Base:

  Q119591 How to Obtain Microsoft Support Files from Online Services

Microsoft used the most current virus detection software available on the date of
posting to scan this file for viruses. After it is posted, the file is housed on
secure servers that prevent any unauthorized changes to the file.


This update resolves this issue by disabling caching on all FileOpen calls only
if the following binary value is present in the registry:

  HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\VxD\VREDIR
  Value Name: DiscardCacheOnOpen
  Value: 01 00 00 00

If this value is not present or is set to 0, this update behaves the same as
Vredir.vxd versions 4.00.955 and earlier.

This value is not added by default and must be added manually in order to disable
caching when opening files.

STATUS
======

This issue is resolved in Microsoft Windows 98.

MORE INFORMATION
================

For additional information about issues resolved by updates to this component,
please see the following articles in the Microsoft Knowledge Base:

  Q172594 Cannot Connect to Server with 15 Characters and Period in Name

  Q165402 Windows 95 Update to Encrypt Passwords in Memory

  Q161100 File May Be Truncated When Copied to a Full Network Drive

  Q157114 "Access Denied" Attempting to Run File on LM/X Server

  Q152186 Possible Network Data Corruption If Locking Not Used

  Q142803 Hang or Locking Error Accessing Database Files Over Network

  Q140558 Deleting Files on Samba Servers May Delete Local Files Instead

  Q138249 Updated Vredir.vxd Corrects Errors Running Files on LMX

  Q160807 Cannot Connect to Windows NT Server with Many Shares

  Q150215 Disabling Automatic Network Shortcut Resolution

  Q138014 File May Be Truncated to Zero Bytes When Copied Onto Itself

  Q136834 Error Copying Read-Only Files to Core SMB Server

Additional query words: corrupt w95cn

======================================================================
Keywords          : kbfile kbnetwork win95 kbgraphxlinkcritical 
Technology        : kbWin95search kbZNotKeyword3
Version           : :
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>