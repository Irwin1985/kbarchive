<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q156732: HOWTO: Print from the Microsoft WebBrowser Control | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q156732: HOWTO: Print from the Microsoft WebBrowser Control" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/156/Q156732/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/156/Q156732/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q156732: HOWTO: Print from the Microsoft WebBrowser Control","url":"http://jeffpar.github.io/kbarchive/kb/156/Q156732/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q156732-howto-print-from-the-microsoft-webbrowser-control">Q156732: HOWTO: Print from the Microsoft WebBrowser Control</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q156732
Product(s): Microsoft C Compiler
Version(s): 4.0,4.01,5.0
Operating System(s): 
Keyword(s): kbole kbprint kbIE300 kbIE301 kbIE400 kbie401 kbMFC kbPrinting kbVC kbIE302 kbhowto
Last Modified: 07-SEP-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual C++, 32-bit Enterprise Edition, version 5.0 
- Microsoft Visual C++, 32-bit Professional Edition, version 5.0 
- Microsoft Internet Explorer (Programming) versions 4.0, 4.01 
-------------------------------------------------------------------------------

SUMMARY
=======

The Web Browser component of Internet Explorer 3.x and 4.x does not support a
Print method. You can still print the contents of the Web Browser control using
one of these methods:

- Set focus to the Web Browser control and send a key combination of CTRL+P.

  -or-

- Call the GetDocument() method that returns an IDispatch*. Using the
  IDispatch*, call QueryInterface() on IID_IOleCommandTarget. With the object
  pointer returned, call Exec(NULL, OLECMDID_PRINT,0, NULL,NULL).

MORE INFORMATION
================

The following code can be used to cause the Web Browser control to print its
contents. In this example, m_ctlWebBrowser is an instance of the wrapper class
generated by Class Wizard for the control. m_ctlWebBrowser is contained in a
dialog and initialized in the OnInitDialog function. A Print button on the
dialog is wired to an OnPrint function. The Print button is enabled in response
to the NavigateComplete event of the Web Browser control.


Sample Code
-----------

  BOOL CAboutDlg::OnInitDialog()
     {
         CDialog::OnInitDialog();

         m_ctlWebBrowser.Navigate(_T("http://www.microsoft.com"),
                                  NULL, NULL, NULL, NULL);
         return TRUE;
     }
     

First Method
------------

     
   void CAboutDlg::OnPrint()
     {
         CWnd* pWnd = GetFocus ();

         m_ctlWebBrowser.SetFocus ();
         // send Ctrl-P
         keybd_event (VK_CONTROL, 0, 0, 0);
         keybd_event ('P', 0, 0, 0);

         // set focus to control that previously had focus
         if (pWnd);
             pWnd-&gt;SetFocus ();
     }

Second Method
-------------

     // DOCOBJ.H comes with the Internet Client SDK and is installed by
     // default in the "\INetSDK\Include" directory
     #include &lt;docobj.h&gt;

     void CAboutDlg::OnPrint()
     {
         LPDISPATCH lpDispatch = NULL;
         LPOLECOMMANDTARGET lpOleCommandTarget = NULL;

         lpDispatch = m_ctlWebBrowser.GetDocument();
         ASSERT(lpDispatch);

         lpDispatch-&gt;QueryInterface(IID_IOleCommandTarget,
                                    (void**)&amp;lpOleCommandTarget);
         ASSERT(lpOleCommandTarget);

         lpDispatch-&gt;Release();

         // print contents of web browser control
         lpOleCommandTarget-&gt;Exec(NULL, OLECMDID_PRINT, 0, NULL,NULL);

         lpOleCommandTarget-&gt;Release();
     }
   

REFERENCES
==========

Internet Client SDK Online documentation.

Additional query words:

======================================================================
Keywords          : kbole kbprint kbIE300 kbIE301 kbIE400 kbie401 kbMFC kbPrinting kbVC kbIE302 kbhowto 
Technology        : kbVCsearch kbIEsearch kbAudDeveloper kbSDKIESearch kbSDKIE400 kbSDKIE401 kbVC500 kbVC32bitSearch kbVC500Search
Version           : :4.0,4.01,5.0
Issue type        : kbhowto

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>