<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q156051: PRB: Messages Not Received by Dynamically Created Control | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q156051: PRB: Messages Not Received by Dynamically Created Control" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/156/Q156051/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/156/Q156051/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q156051: PRB: Messages Not Received by Dynamically Created Control","url":"http://jeffpar.github.io/kbarchive/kb/156/Q156051/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q156051-prb-messages-not-received-by-dynamically-created-control">Q156051: PRB: Messages Not Received by Dynamically Created Control</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q156051
Product(s): Microsoft C Compiler
Version(s): 4.0,4.1,4.2,5.0,6.0
Operating System(s): 
Keyword(s): kbActiveX kbCOMt kbContainer kbCtrlCreate kbMFC kbVC400 kbVC410 kbVC420 kbVC500 kbVC600
Last Modified: 11-JUN-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- The Microsoft Foundation Classes (MFC), used with:
   - Microsoft Visual C++, 32-bit Editions, versions 4.0, 4.1 
   - Microsoft Visual C++, 32-bit Enterprise Edition, versions 4.2, 5.0, 6.0 
   - Microsoft Visual C++, 32-bit Professional Edition, versions 4.2, 5.0, 6.0 
   - Microsoft Visual C++, 32-bit Learning Edition, version 6.0 
   - Microsoft Visual C++.NET (2002) 
-------------------------------------------------------------------------------

NOTE: Microsoft Visual C++ NET (2002) supported both the managed code model that is provided by the .NET Framework and the unmanaged native Windows code model. The information in this article applies to unmanaged Visual C++ code only.

SYMPTOMS
========

When you create ActiveX Controls dynamically via CWnd::CreateControl(), Windows
messages are not sent to your CWnd-derived class. For example, if you create a
handler for WM_KILLFOCUS, it is not called.

CAUSE
=====

CWnd::CreateControl() does not subclass the HWND associated with the control.

RESOLUTION
==========

To work around this problem, you must subclass the control after it has been
created.

The following steps illustrate how to insert an ActiveX Control and create a
message handler for it:

1. From the Project menu in Visual Studio, select Add to Project, and then
  select Components and Controls. This will bring up a dialog box. Select the
  folder Registered ActiveX Controls. Select a control to insert. As a result,
  a C++ wrapper class will be generated.

2. Declare a member variable that is a pointer to the class just added in the
  class that will create the control.

3. In the header file of the wrapper class generated by Component Gallery, add
  these lines at the end of the class declaration:

  //{{AFX_MSG(CMyClass)
  //}}AFX_MSG
  DECLARE_MESSAGE_MAP()

  Replace CMyClass with the actual class name.

4. In the .cpp file of the wrapper class generated by Component Gallery, add
  these lines after the #include section:

  BEGIN_MESSAGE_MAP(CMyClass, CWnd)
      //{{AFX_MSG_MAP(CMyClass)
      //}}AFX_MSG_MAP
  END_MESSAGE_MAP()

  Again, replace CMyClass with the actual class name.

5. Delete the .clw file for your project, and then start the class wizard. This
  will give you a message box that says "The class wizard database for this
  project does not exist, do you wish to create it from the source files?"
  Click yes. In the dialog box that opens, click Add All to add all project
  files.

6. Use class wizard to add your message handler for the wrapper class.

After modifying the wrapper class and adding the message handler, you must create
the control and subclass it. The following code shows how to dynamically create
an Microsoft FlexGrid control and subclass it so that the MFC wrapper class can
receive Windows messages:

  void CSDIApp2View::OnInitialUpdate() 
  {
  	CView::OnInitialUpdate();
  	
  	m_pFlexGrid = new CMSFlexGrid;

  	CRect rect;
  	GetClientRect(&amp;rect);
  	m_pFlexGrid-&gt;Create(NULL, WS_CHILD | WS_VISIBLE, rect, this, IDC_FLEXGRID);
  	HWND hWnd = m_pFlexGrid-&gt;Detach();
  	m_pFlexGrid-&gt;SubclassWindow(hWnd);
  }

STATUS
======

This is by design.

Additional query words: subclass AfxWndProc message routing map architecture

======================================================================
Keywords          : kbActiveX kbCOMt kbContainer kbCtrlCreate kbMFC kbVC400 kbVC410 kbVC420 kbVC500 kbVC600 kbDSupport kbGrpDSMFCATL kbArchitecture 
Technology        : kbAudDeveloper kbMFC
Version           : :4.0,4.1,4.2,5.0,6.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>