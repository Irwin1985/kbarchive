<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q156503: BUG: Error When Deleting a Record Using the Apex Grid Control | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q156503: BUG: Error When Deleting a Record Using the Apex Grid Control" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/156/Q156503/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/156/Q156503/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q156503: BUG: Error When Deleting a Record Using the Apex Grid Control","url":"http://jeffpar.github.io/kbarchive/kb/156/Q156503/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q156503-bug-error-when-deleting-a-record-using-the-apex-grid-control">Q156503: BUG: Error When Deleting a Record Using the Apex Grid Control</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q156503
Product(s): Microsoft C Compiler
Version(s): 4.20
Operating System(s): 
Keyword(s): kbVC kbHWx86kbbuglist
Last Modified: 31-JUL-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual C++, 32-bit Enterprise Edition, versions 4.2, 4.2b 
- Microsoft Visual C++, 32-bit Professional Edition, versions 4.2, 4.2b 
-------------------------------------------------------------------------------

SYMPTOMS
========

When deleting a record in the data-bound Apex Grid Control (DBGRID32.OCX), the
following error appears in a message box:

  

  37000: [Microsoft][ODBC Microsoft Access 7.0 Driver]
      Syntax error in query expression 'current of SQL_CUR12522868X'

The actual cursor name may vary, so instead of "SQL_CUR12522868X," you may see
"SQL_CURXXXXXXXXX" where the X can be any value.

CAUSE
=====

This is a problem in the Apex Grid control.

RESOLUTION
==========

To work around the problem, set the CursorDriver property of the Remote Data
Control (RDC) to one of the following:

- ODBC Cursor

- Server-side cursor

STATUS
======

Microsoft has confirmed this to be a problem the Microsoft products listed at
the beginning of this article. We are researching this problem and will post new
information here in the Microsoft Knowledge Base as it becomes available.

MORE INFORMATION
================

The Apex Grid Control issues positioned deletes of the form:

     DELETE FROM &lt;table&gt; WHERE CURRENT OF &lt;cursor name&gt;

Most ODBC drivers need the cursor library to support such statements. If the
CursorDriver property is set to 0, the cursor library does not get loaded and
the positioned delete statement causes the error mentioned above. Setting this
property to 1 (ODBC Cursors) forces the cursor library to be used.

Setting CursorDriver to 2 (Server-side cursors) causes the Apex Grid control to
delete records using keyset cursors (SQLSetPos) and the problem is resolved.

Additional query words: 4.20 kbdsd DBGRID

======================================================================
Keywords          : kbVC kbHWx86 kbbuglist
Technology        : kbVCsearch kbAudDeveloper kbVC420 kbVC32bitSearch kbVC420b
Version           : 4.20

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>