<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q246125: XADM: Exchange Server 5.5 Performance Optimizer Verbose Mode | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q246125: XADM: Exchange Server 5.5 Performance Optimizer Verbose Mode" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/246/Q246125/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/246/Q246125/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q246125: XADM: Exchange Server 5.5 Performance Optimizer Verbose Mode","url":"http://jeffpar.github.io/kbarchive/kb/246/Q246125/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q246125-xadm-exchange-server-55-performance-optimizer-verbose-mode">Q246125: XADM: Exchange Server 5.5 Performance Optimizer Verbose Mode</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q246125
Product(s): Microsoft Exchange
Version(s): winnt:5.5
Operating System(s): 
Keyword(s): exc55
Last Modified: 27-NOV-1999

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, version 5.5 
-------------------------------------------------------------------------------

SUMMARY
=======

Exchange Server 5.5 Performance Optimizer can be run in Verbose mode which
presents the user with additional screens that contain specific options and
settings that aren't normally displayed. Each of these options and settings are
discussed in the "More Information" section of this article.

MORE INFORMATION
================

To run Performance Optimizer in Verbose mode, type the following command at a
command prompt in the Exchsrvr\Bin folder:

  "perfwiz.exe -v" (without the quotation marks)

To view the current settings without stopping the services, run the Performance
Optimizer with the -r option by typing the following command at a command prompt
in the Exchsrvr\Bin folder:

  "perfwiz.exe -r" (without the quotation marks)

Options and Settings Unique to Verbose Mode
-------------------------------------------

Disk Analysis:

The Performance Optimizer allows you to choose whether or not you want to analyze
specific disk drives. For those disk drives that you select, it analyzes each to
determine the best locations for Microsoft Exchange Server files. This test
analyzes disks simultaneously to determine which drives provide the best
performance for different Microsoft Exchange Server service data files. The
analysis uses a test file in available space on the drive to test the speed of:

  Sequential access (write data sequentially)
  Random access (write/read data randomly)

The Performance Optimizer takes the average access times, writing and reading
large amounts of data, so the test may take some time. This test does not affect
your hard drive contents. The access times for each selected disk drive are
displayed for the user after the tests have been completed.

Editable Performance Optimizer Settings:

You can edit the values of the following are options:

WARNING: Changing the values for the options listed below can and may adversely
affect your Exchange Server computer's performance and functionality. You are
strongly cautioned against changing any of these values without first consulting
with Microsoft Product Support Services.

- Number of information store buffers - The maximum number of 4-KB buffers
  allocated to the information store database.

- Number of directory buffers - The maximum number of 4-KB buffers allocated to
  the directory store database.

- Minimum number of information store threads - The minimum number of threads
  that the information store will use to service Messaging Application
  Programming Interface (MAPI) clients, such as Microsoft Outlook.

- Maximum number of information store threads - The maximum number of threads
  that the information store will use to service MAPI clients, such as
  Microsoft Outlook.

- Number of directory threads - The maximum number of threads used by the
  directory.

- Maximum number of concurrent read threads - The maximum number of directory
  threads available to service replication requests.

- Number of background threads - The number of threads available for background
  tasks and for the Gateway In/Out and Send and Delivery thread pool.

- Number of heaps - The number of areas of memory used for dynamic memory
  allocation.

- Number of private information store send threads - The number of threads that
  process messages submitted by MAPI clients, such as Microsoft Outlook.

- Number of private information store delivery threads - The number of threads
  that the private information store can use to deliver messages to mailboxes.

- Number of public information store send threads - The number of threads that
  process public folder replication messages and messages generated by public
  folder rules.

- Number of public information store delivery threads - The number of threads
  that the public information store can use to deliver messages to public
  folders.

- Number of information store gateway in threads - The number of information
  store threads that deliver mail from the message transfer agent (MTA) to the
  information store for routing elsewhere. For optimal performance, the number
  of threads should be increased only if the server has multiple processors.

- Number of information store gateway out threads - The number of information
  store threads delivering mail from the information store to local mailboxes,
  or to the MTA. For optimal performance, the number of threads should be
  increased only if the server has multiple processors.

- Buffer threshold low percent - The percentage of available buffers remaining
  before buffers are flushed to disk. Lower values limit the number of writes
  to disk; however, low values can degrade performance.

- Buffer threshold high percent - The percentage of available buffers that must
  be reached before the flushing of buffers to disk stops. For optimal
  performance, set the percentage value equal to, or slightly greater than, the
  buffer threshold low percent.

- Maximum number of pool threads - The maximum number of threads servicing
  Internet connections such as Internet Message Access Protocol, Version 4rev1
  (IMAP4), Post Office Protocol version 3 (POP3), and Network News Transfer
  Protocol ( NNTP) into the information store. This value is per processor.

- Number of information store users - The number of users for which this server
  will route mail.

- Number of concurrent connections to LAN-MTAs - The number of concurrent
  network associations to MTAs.

- Number of concurrent connections to RAS LAN-MTAs - The minimum number of
  concurrent network associations to Remote Access Service (RAS) MTAs.

- Number of LAN-MTAs - The minimum number of network MTAs supported by the MTA.

- Number of X.400 gateways - The maximum number of remote MTAs connecting
  through X.400 using X.25, Transport Control Protocol/Internet Protocol
  (TCP/IP), or Transport Class 4 (TP4).

- ds_read cache latency (secs) - The number of seconds before the directory
  service read cache expires. Performance improves when items are loaded in the
  cache by limiting the number of directory service reads.

- Number of dispatcher threads - The total number of threads used to route
  messages.

- Number of transfer threads - The total number of threads used to transfer
  messages.

- Number of kernel threads - The total number of threads allocated to process
  the Open Systems Interconnection (OSI) protocol stack.

- Number of submit/deliver threads - The total number of MTA submit and deliver
  threads.

- Number of RAS LAN-MTAs - The maximum supported number of concurrent network
  associations to other RAS MTAs.

- Number of database data buffers per object - The number of 4-KB buffers
  configured for each cached MTA database file. The MTA saves a copy of each
  message until the message has been accepted by the information store, or
  another MTA.

- Number of RTS threads - The total number of threads available to the Reliable
  Transfer Service (RTS) level of the OSI protocol stack.

- Number of concurrent MDB/delivery queue clients - The maximum number of
  information store and XAPI MA delivery queue clients supported. Each client
  can have more than one session. For optimal performance, the value should be
  at least two, to support both the public and private databases.

- Number of concurrent XAPI sessions - The maximum number of sessions to
  information store and X.400 application programming interface (XAPI) MA
  delivery queue clients, XAPI MA retrieval queue clients, and XAPI MT gateway
  clients.

- Max Number of RPC calls outstanding - The maximum number of concurrent remote
  procedure call (RPC) threads. This limits the maximum number of RPCs that
  will be processed at one time.

- Min Number of RPC threads - The minimum number of concurrent RPC threads.
  This sets the minimum number of RPCs that will be processed at one time.

- Number of MT gateway clients - The maximum number of XAPI MT gateway clients
  supported, which is the maximum number of gateways the MTA can support.

- Number of retrieval queue clients - The maximum number of XAPI MA retrieval
  queue clients supported.

- Number of TCP/IP control blocks - The maximum number of TCP/IP connections
  supported.

- Number of TCP/IP threads - The maximum number of MTA DMOD threads processing
  TCP/IP connections.

- Number of TP4 control blocks - Maximum number of supported concurrent TP4
  connections.

- Number of TP4 threads - Maximum number of MTA DMOD threads processingTP4
  connections, including multiple thread connections.

If the Internet Mail Service is already installed, the following options will
also appear:

- Number of inbound threads - The number of threads available to perform
  content conversion and move inbound mail from the Internet Mail Service to
  the information store.

- Number of outbound threads - The number of threads available to perform
  content conversion and move outbound mail to the Internet Mail Service and
  from the information store.

- Number of InOut threads - The number of threads available to perform content
  conversion and move both inbound and outbound mail between the Internet Mail
  Service and the information store.

- Number of threads per processor - The number of threads available for traffic
  between the Internet Mail Service and the Internet.

Performance Optimizer Log
-------------------------

The Performance Optimizer log file, located in the Winnt\System32 folder,
includes information that can be used to track changes made to your server and
to report problems. Each time you run the Performance Optimizer, log entries are
appended to this file.

Additional query words:

======================================================================
Keywords          : exc55 
Technology        : kbExchangeSearch kbExchange550 kbZNotKeyword2
Version           : winnt:5.5
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>