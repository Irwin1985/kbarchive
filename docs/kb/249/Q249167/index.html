<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q249167: BUG: SNAOLEDB Does Not Support Pessimistic Locking | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q249167: BUG: SNAOLEDB Does Not Support Pessimistic Locking" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/249/Q249167/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/249/Q249167/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q249167: BUG: SNAOLEDB Does Not Support Pessimistic Locking","url":"http://jeffpar.github.io/kbarchive/kb/249/Q249167/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q249167-bug-snaoledb-does-not-support-pessimistic-locking">Q249167: BUG: SNAOLEDB Does Not Support Pessimistic Locking</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q249167
Product(s): Microsoft SNA Server
Version(s): WINDOWS:4.0 SP2,4.0 SP3
Operating System(s): 
Keyword(s): kbOLEDB kbGrpDSVCDB kbGrpDSMDAC kbDSupport
Last Modified: 19-JUL-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft OLE DB Provider for AS/400 and VSAM, versions 4.0 SP2, 4.0 SP3 
-------------------------------------------------------------------------------

SYMPTOMS
========

The Microsoft OLEDB Provider for AS/400 and VSAM (SNAOLEDB) does not support
pessimistic locking.

In the Microsoft SNA SDK documentation under the "ADO Recordset Object in the OLE
DB Provider for AS/400 and VSAM" topic, it is mentioned under LockType that
SNAOLEDB supports all four lock types. Namely adLockReadOnly, adLockOptimistic,
adLockPessimistic, and adLockBatchOptimistic. The preceding statement is not
true and SNAOLEDB does not currently support adLockPessimistic from an ADO
recordset object.

The ADO Client side cursor does not support "pessimistic" locking. ADO server
side cursor support "pessimistic" locking if the corresponding provider supports
this property. SNAOLEDB does not support "pessimistic" locking. If an
unsupported value is set, then no error occurs and the closest supported
LockType is used instead. If from an ADO program you set the LockType property
to adLockPessimistic, when you open an updateable recordset with server side
cursor it automatically maps to either adLockOptimistic or
adLockBatchOptimistic.

STATUS
======

Microsoft has confirmed this to be a problem in the Microsoft SNA Server version
4.0 Service Pack 2 (SP2) and Service Pack 3 (SP3) SDK documentation.

MORE INFORMATION
================

The OLEDB Provider for AS/400 and VSAM (SNAOLEDB) comes with SNA Server/Client
version 4.0 SP2 or SP3. It uses the DDM RLIO protocol to provide OLEDB consumers
with access to VSAM and AS/400 record-level data. This provider complies with
Level 4 of the IBM Distributed Data Management (DDM) architecture and the OLE DB
architecture. It uses SNA Server, the reliable platform for host integration as
the networking bridge between the SNA host and the Windows NT operating
systems.

The Microsoft OLE DB Provider for AS/400 and VSAM supports the following
features:

- Set attributes and a record description of a host file (column information).

- Position to the beginning record or the ending record in a file.

- Navigate to the previous or next record in a file.

- Seek to a record based on an index.

- Lock records.

- Change records in a file.

- Insert new records and delete records in a file.

- Preserve file and record attributes.

SNAOLEDB does not support "pessimistic" locking.

REFERENCES
==========

For more information, please refer to the following article in the Microsoft
Knowledge Base:

  Q190625 FIX: ADO Client Cursors Report LockType = adLockPessimistic

SNA SDK Documentation

Additional query words:

======================================================================
Keywords          : kbOLEDB kbGrpDSVCDB kbGrpDSMDAC kbDSupport 
Technology        : kbAudDeveloper kbOLEDBSearch kbOLEDBProvAS400VSAM400SP2 kbOLEDBProvAS400VSAM400SP3 kbOLEDBProvSearch
Version           : WINDOWS:4.0 SP2,4.0 SP3
Issue type        : kbbug
Solution Type     : kbpending

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>