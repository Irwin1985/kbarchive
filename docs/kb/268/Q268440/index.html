<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q268440: INFO: MAPI Is Not Suitable for HTML Messages | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q268440: INFO: MAPI Is Not Suitable for HTML Messages" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/268/Q268440/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/268/Q268440/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q268440: INFO: MAPI Is Not Suitable for HTML Messages","url":"http://jeffpar.github.io/kbarchive/kb/268/Q268440/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q268440-info-mapi-is-not-suitable-for-html-messages">Q268440: INFO: MAPI Is Not Suitable for HTML Messages</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q268440
Product(s): Microsoft Exchange
Version(s): 1.0,1.1,1.2,1.21,5.5
Operating System(s): 
Keyword(s): kbCDO kbMsg kbOLEMsg kbOutlook kbOutlookObj kbCDONTS kbGrpDSMsg kbDSupport
Last Modified: 12-NOV-2001

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Exchange Server, version 5.5 
- Collaboration Data Objects (CDO), versions 1.0, 1.1, 1.2, 1.21 
- Collaboration Data Objects (CDO) for NTS, version 1.2 
- Extended Messaging Application Programming Interface (MAPI), version 1.0 
- Microsoft Collaboration Data Objects for Windows 2000 
-------------------------------------------------------------------------------

SUMMARY
=======

Extended Messaging Application Programming Interface (MAPI) should not be used
to generate HTML-formatted messages. As an alternative, consider using the
Microsoft Outlook Object Model, CDONTS, CDOSYS, CDOEX, or a third-party SMTP
control.

MORE INFORMATION
================

MAPI 1.0 was written before HTML mail was developed and does not reliably
support the creation of HTML-formatted messages. MAPI 1.0 is the version
supported by all versions of Microsoft Exchange through version 5.5 (and all
Service Packs). This includes the following subordinate technologies:

- Simple MAPI
- Extended MAPI
- OLE Messaging
- Active Messaging (Collaboration Data Objects (CDO) 1.1)
- CDO versions 1.2 and 1.21
- MAPI controls (Msmapi32.ocx)

If messages are needed in HTML format, such as for sending text formatted in
other languages, alternative technologies that provide more reliable support for
HTML messages are recommended:

- CDONTS
- CDO for Windows 2000 (CDOSYS)
- CDO for Exchange 2000 (CDOEX)
- Outlook Object Model of Microsoft Outlook 98 or later
- SMTP-capable ActiveX controls obtained from third-party vendors

How Outlook Generates MAPI-based HTML Mail
------------------------------------------

The interfaces that Outlook uses to generate and work with HTML-formatted mail
are not exposed externally except for what is exposed through the HTMLBody
property. Outlook stores the HTML data as a specially encoded RTF stream in the
MAPI property PR_RTF_COMPRESSED. There are no public interfaces for generating,
reading, or manipulating this complex stream as HTML data. PR_BODY contains the
plain text translation of the message body.

What About PR_BODY_HTML?:

According to the documentation on PR_BODY_HTML, this property is only supported
by a message store if the store returns STORE_HTML_OK in the
PR_STORE_SUPPORT_MASK property. No Microsoft message store supports this flag.
Some third-party store providers may choose to support this flag and property.


REFERENCES
==========

For additional information about MAPI technologies, click the article number
below to view the article in the Microsoft Knowledge Base:

  Q200018 INFO: Differences Between CDO, Simple MAPI, and Extended MAPI

Additional query words: Internet Explorer IE UTF-8 Japanese PR_INTERNET_CPID

======================================================================
Keywords          : kbCDO kbMsg kbOLEMsg kbOutlook kbOutlookObj kbCDONTS kbGrpDSMsg kbDSupport 
Technology        : kbAudDeveloper kbCDOsearch kbMAPISearch kbExchangeSearch kbExchange550 kbZNotKeyword kbZNotKeyword2 kbCDO100 kbCDO110 kbCDO120 kbCDO121 kbCDO120NTS kbCDOWin2000 kbMAPIExt
Version           : :1.0,1.1,1.2,1.21,5.5
Issue type        : kbinfo

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>