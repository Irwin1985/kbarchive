<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q272532: PRB: DatePicker Value Is Incorrect When You Enter Invalid Date | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q272532: PRB: DatePicker Value Is Incorrect When You Enter Invalid Date" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/272/Q272532/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/272/Q272532/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q272532: PRB: DatePicker Value Is Incorrect When You Enter Invalid Date","url":"http://jeffpar.github.io/kbarchive/kb/272/Q272532/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q272532-prb-datepicker-value-is-incorrect-when-you-enter-invalid-date">Q272532: PRB: DatePicker Value Is Incorrect When You Enter Invalid Date</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q272532
Product(s): Microsoft Visual Basic for Windows
Version(s): 6.0
Operating System(s): 
Keyword(s): kbCmnCtrls kbCtrl kbVBp kbVBp600 kbOSWin95 kbOSWin98 kbGrpDSVB kbDSupport kbOSWinME
Last Modified: 26-JUL-2002

-------------------------------------------------------------------------------
The information in this article applies to:

- Microsoft Visual Basic Professional Edition for Windows, version 6.0, used with:
   - the operating system: Microsoft Windows 95 
   - the operating system: Microsoft Windows 98 
   - the operating system: Microsoft Windows Millennium Edition 
- Microsoft Visual Basic Enterprise Edition for Windows, version 6.0, used with:
   - the operating system: Microsoft Windows 95 
   - the operating system: Microsoft Windows 98 
   - the operating system: Microsoft Windows Millennium Edition 
-------------------------------------------------------------------------------

SYMPTOMS
========

When a form that contains a DateTimePicker control is loaded, and you change the
date from today's date to "00", the date should revert to its original value
(today's date) because the date is invalid. However, on Windows 95, Windows 98
and Windows Millennium Edition (Me), the data that is contained in the value
property displays the last day of the previous month instead of the today's
date.

This behavior does not occur on Windows 2000 or Windows NT.

RESOLUTION
==========

To resolve this problem, test the Day property, and set it to the original value
if an invalid date is entered as follows:

1. Start a new project in Visual Basic. Form1 is created by default.

2. On the Project menu, click Components, and then select the Windows Common
  Controls 2 check box. Click OK.

3. On the form, find an instance of the DateTimePicker control.

4. In the code module of Form1, paste the following code:

  Dim s As String

  Private Sub DTPicker1_Change()
      If DTPicker1.Day = 0 Then
          DTPicker1.Value = s
      Else
          s = DTPicker1.Value
      End If
  End Sub

  Private Sub Form_Load()
      s = DTPicker1.Value
  End Sub

5. Press the F5 key to run the project. You see today's date in the
  DateTimePicker text area.

6. Change the date to "0" (without the quotation marks) or "00" (without the
  quotation marks). The date reverts to today's date.

MORE INFORMATION
================

Steps to Reproduce Behavior
---------------------------

1. On a system that runs Window 95, Windows 98, or Windows Me, start a new
  project in Visual Basic. Form1 is created by default.

2. On the Project menu, click Components, and then select the Windows Common
  Controls 2 check box. Click OK.

3. On the form, find an instance of the DateTimePicker control.

4. Press F5 to run the project, and you see today's date in the DateTimePicker
  text area.

5. Change the date to "0" (without the quotation marks). This value immediately
  changes to "00" as the control tries to verify the date. Then, the date in
  DateTimePicker changes to "0" instead of today's date.

6. If you examine the data that is contained in the value property, as
  demonstrated in the code below, the data displays the last day of the
  previous month.

  Private Sub Form_Click()
     MsgBox DTPicker1.Value
  End Sub

Additional query words: dtpicker

======================================================================
Keywords          : kbCmnCtrls kbCtrl kbVBp kbVBp600 kbOSWin95 kbOSWin98 kbGrpDSVB kbDSupport kbOSWinME 
Technology        : kbVBSearch kbAudDeveloper kbZNotKeyword6 kbZNotKeyword2
Version           : :6.0
Issue type        : kbprb

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>