<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/kbarchive/assets/css/style.css?v=d2057ae472d963fbdcbf65805f43123bccb709dc">
    <link rel="stylesheet" type="text/css" href="/kbarchive/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Q130961: TCP/IP Upgrade from Windows NT 3.1 Requires User Interaction | KnowledgeBase Archive</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Q130961: TCP/IP Upgrade from Windows NT 3.1 Requires User Interaction" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<meta property="og:description" content="An Archive of Early Microsoft KnowledgeBase Articles" />
<link rel="canonical" href="http://jeffpar.github.io/kbarchive/kb/130/Q130961/" />
<meta property="og:url" content="http://jeffpar.github.io/kbarchive/kb/130/Q130961/" />
<meta property="og:site_name" content="KnowledgeBase Archive" />
<script type="application/ld+json">
{"headline":"Q130961: TCP/IP Upgrade from Windows NT 3.1 Requires User Interaction","url":"http://jeffpar.github.io/kbarchive/kb/130/Q130961/","description":"An Archive of Early Microsoft KnowledgeBase Articles","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
<div id="container">
    <div class="inner">

        <header>
            <h1><a href="/kbarchive">KnowledgeBase Archive</a></h1>
            <h2>An Archive of Early Microsoft KnowledgeBase Articles</h2>
        </header>
        <section id="downloads" class="clearfix">
            
            
            <a href="https://github.com/jeffpar/kbarchive" id="view-on-github" class="button"><span>View on GitHub</span></a>
            
        </section>
        <hr>
        <section id="main_content">
                <div>
        <h2 id="q130961-tcpip-upgrade-from-windows-nt-31-requires-user-interaction">Q130961: TCP/IP Upgrade from Windows NT 3.1 Requires User Interaction</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Article: Q130961
Product(s): Windows for Workgroups and Windows NT Networking Issues
Version(s): 3.5
Operating System(s): 
Keyword(s): 
Last Modified: 15-DEC-2000

-------------------------------------------------------------------------------
The information in this article applies to:

- MSPRESS Microsoft Windows NT Resource Kit, version 3.5 
-------------------------------------------------------------------------------

SYMPTOMS
========

UNATTEND.TXT, included in the Resource Kit for Windows NT 3.5, implies that you
can automatically upgrade a Windows NT 3.1 system to Windows NT 3.5 and have the
system configured with dynamic host configuration protocol (DHCP). You can
select to install TCP/IP with DHCP using Setup Manager, but during the setup
process, if you choose to "Upgrade existing Windows NT installation," the
following warning message appears:

  You have chosen to upgrade an existing Windows NT system. Setup will use the
  current system information and ignore parameters specified in the unattended
  answer file.

This does not correlate with the information in the following sections excerpted
from the default UNATTEND.TXT file:

  ; For unattended UPGRADES of Windows NT 3.1 and Windows NT Advanced
  ; Server 3.1, you may not need to specify an unattended answer file. You
  ; should specify an answer file if upgrading TCP/IP. For unattended
  ; upgrades, do:
  ;
  ;    winnt32 /u
  ;
  ; For unattended installation using winnt.exe or winnt32.exe do:
  ;
  ;    winnt[32] /u:&lt;script_file&gt; /s:&lt;source&gt;
     .
     .
     .
  ;[GuiUnattended]
  ;
  ; You need to define the !UpgradeEnableDhcp if you upgrade from Windows
    NT 3.1 to Windows NT Workstation v3.5. Specify for upgrades ONLY!
  ;
  ; !UpgradeEnableDhcp = YES | NO

The section above implies that the switch, !UpgradeEnableDhcp, will be set to YES
in the script file for an unattended installation, thereby automatically
enabling DHCP during the upgrade.

RESOLUTION
==========

Setup Manager does set !UpgradeEnableDhcp equal to YES. However, if you didn't
have TCP/IP installed under Windows NT 3.1, you will not have TCP/IP installed
after you upgrade to Windows NT 3.5. If you did have TCP/IP installed, you are
prompted during the upgrade process to configure TCP/IP with a static IP address
or with DHCP.

STATUS
======

Microsoft has confirmed this to be a problem in Windows NT version 3.5. We are
researching this problem and will post new information here in the Microsoft
Knowledge Base as it becomes available.

MORE INFORMATION
================

The help file for Windows NT Setup Manager includes the same incorrect
information as the UNATTEND.TXT file. Under the heading "Upgrading Windows NT
using an Unattended Answer File" it states that existing configuration
information for an upgrade will take precedence over settings in the unattended
answer file. The help file also states that this precedence applies for network
configuration information. However, the help file then states:

  The one exception to this case is the Enable DHCP entry which is used only
  during upgrades.

Additional query words: 3.50 prodnt reskit unattend.txt setupmgr dhcp upgrade tcpip

======================================================================
Keywords          :  
Technology        : kbMSPressSearch kbZNotKeyword6 kbZNotKeyword2
Version           : :3.5

=============================================================================
</code></pre></div></div>


        <p>
            THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
            PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
            ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
            OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
            EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
            ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
            CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
            MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
            OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
            SO THE FOREGOING LIMITATION MAY NOT APPLY.
        </p>
        <p>Copyright Microsoft Corporation 1986-2002.</p>
    </div>

        </section>

        <footer>
            
            KnowledgeBase Archive is maintained by <a href="https://www.pcjs.org">PCjs</a>.<br>
            
            This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

    </div>
</div>


<script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49658648-3', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>